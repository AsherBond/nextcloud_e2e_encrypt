(function(){"use strict";try{if(typeof document<"u"){var i=document.createElement("style");i.appendChild(document.createTextNode("/*!\n * SPDX-FileCopyrightText: 2019 Nextcloud GmbH and Nextcloud contributors\n * SPDX-License-Identifier: AGPL-3.0-or-later\n */.toastify.dialogs{min-width:200px;background:none;background-color:var(--color-main-background);color:var(--color-main-text);box-shadow:0 0 6px 0 var(--color-box-shadow);padding:0 12px;margin-top:45px;position:fixed;z-index:10100;border-radius:var(--border-radius);display:flex;align-items:center;min-height:50px}.toastify.dialogs .toast-loader-container,.toastify.dialogs .toast-undo-container{display:flex;align-items:center;width:100%}.toastify.dialogs .toast-undo-button,.toastify.dialogs .toast-close{position:static;overflow:hidden;box-sizing:border-box;min-width:44px;height:100%;padding:12px;white-space:nowrap;background-repeat:no-repeat;background-position:center;background-color:transparent;min-height:0}.toastify.dialogs .toast-undo-button.toast-close,.toastify.dialogs .toast-close.toast-close{text-indent:0;opacity:.4;border:none;min-height:44px;margin-left:10px;font-size:0}.toastify.dialogs .toast-undo-button.toast-close:before,.toastify.dialogs .toast-close.toast-close:before{background-image:url(\"data:image/svg+xml,%3csvg%20viewBox='0%200%2016%2016'%20height='16'%20width='16'%20xmlns='http://www.w3.org/2000/svg'%20xml:space='preserve'%20style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2'%3e%3cpath%20d='M6.4%2019%205%2017.6l5.6-5.6L5%206.4%206.4%205l5.6%205.6L17.6%205%2019%206.4%2013.4%2012l5.6%205.6-1.4%201.4-5.6-5.6L6.4%2019Z'%20style='fill-rule:nonzero'%20transform='matrix(.85714%200%200%20.85714%20-2.286%20-2.286)'/%3e%3c/svg%3e\");content:\" \";filter:var(--background-invert-if-dark);display:inline-block;width:16px;height:16px}.toastify.dialogs .toast-undo-button.toast-undo-button,.toastify.dialogs .toast-close.toast-undo-button{height:calc(100% - 6px);margin:3px 3px 3px 12px}.toastify.dialogs .toast-undo-button:hover,.toastify.dialogs .toast-undo-button:focus,.toastify.dialogs .toast-undo-button:active,.toastify.dialogs .toast-close:hover,.toastify.dialogs .toast-close:focus,.toastify.dialogs .toast-close:active{cursor:pointer;opacity:1}.toastify.dialogs.toastify-top{right:10px}.toastify.dialogs.toast-with-click{cursor:pointer}.toastify.dialogs.toast-error{border-left:3px solid var(--color-error)}.toastify.dialogs.toast-info{border-left:3px solid var(--color-primary)}.toastify.dialogs.toast-warning{border-left:3px solid var(--color-warning)}.toastify.dialogs.toast-success,.toastify.dialogs.toast-undo{border-left:3px solid var(--color-success)}.toastify.dialogs.toast-loading{border-left:3px solid var(--color-primary)}.toastify.dialogs.toast-loading .toast-loader{display:inline-block;width:20px;height:20px;animation:rotate var(--animation-duration, .8s) linear infinite;margin-left:auto}.theme--dark .toastify.dialogs .toast-close.toast-close:before{background-image:url(\"data:image/svg+xml,%3csvg%20viewBox='0%200%2016%2016'%20height='16'%20width='16'%20xmlns='http://www.w3.org/2000/svg'%20xml:space='preserve'%20style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2'%3e%3cpath%20d='M6.4%2019%205%2017.6l5.6-5.6L5%206.4%206.4%205l5.6%205.6L17.6%205%2019%206.4%2013.4%2012l5.6%205.6-1.4%201.4-5.6-5.6L6.4%2019Z'%20style='fill:%23fff;fill-rule:nonzero'%20transform='matrix(.85714%200%200%20.85714%20-2.286%20-2.286)'/%3e%3c/svg%3e\")}.nc-generic-dialog .dialog__actions{justify-content:space-between;min-width:calc(100% - 12px)}/*!\n * SPDX-FileCopyrightText: 2023-2024 Nextcloud GmbH and Nextcloud contributors\n * SPDX-License-Identifier: AGPL-3.0-or-later\n */._file-picker__file-icon_19mjt_9{width:32px;height:32px;min-width:32px;min-height:32px;background-repeat:no-repeat;background-size:contain;display:flex;justify-content:center}tr.file-picker__row[data-v-15187afc]{height:var(--row-height, 50px)}tr.file-picker__row td[data-v-15187afc]{cursor:pointer;overflow:hidden;text-overflow:ellipsis;border-bottom:none}tr.file-picker__row td.row-checkbox[data-v-15187afc]{padding:0 2px}tr.file-picker__row td[data-v-15187afc]:not(.row-checkbox){padding-inline:14px 0}tr.file-picker__row td.row-size[data-v-15187afc]{text-align:end;padding-inline:0 14px}tr.file-picker__row td.row-name[data-v-15187afc]{padding-inline:2px 0}@keyframes gradient-15187afc{0%{background-position:0% 50%}50%{background-position:100% 50%}to{background-position:0% 50%}}.loading-row .row-checkbox[data-v-15187afc]{text-align:center!important}.loading-row span[data-v-15187afc]{display:inline-block;height:24px;background:linear-gradient(to right,var(--color-background-darker),var(--color-text-maxcontrast),var(--color-background-darker));background-size:600px 100%;border-radius:var(--border-radius);animation:gradient-15187afc 12s ease infinite}.loading-row .row-wrapper[data-v-15187afc]{display:inline-flex;align-items:center}.loading-row .row-checkbox span[data-v-15187afc]{width:24px}.loading-row .row-name span[data-v-15187afc]:last-of-type{margin-inline-start:6px;width:130px}.loading-row .row-size span[data-v-15187afc]{width:80px}.loading-row .row-modified span[data-v-15187afc]{width:90px}/*!\n* SPDX-FileCopyrightText: 2023-2024 Nextcloud GmbH and Nextcloud contributors\n* SPDX-License-Identifier: AGPL-3.0-or-later\n*/tr.file-picker__row[data-v-cb12dccb]{height:var(--row-height, 50px)}tr.file-picker__row td[data-v-cb12dccb]{cursor:pointer;overflow:hidden;text-overflow:ellipsis;border-bottom:none}tr.file-picker__row td.row-checkbox[data-v-cb12dccb]{padding:0 2px}tr.file-picker__row td[data-v-cb12dccb]:not(.row-checkbox){padding-inline:14px 0}tr.file-picker__row td.row-size[data-v-cb12dccb]{text-align:end;padding-inline:0 14px}tr.file-picker__row td.row-name[data-v-cb12dccb]{padding-inline:2px 0}.file-picker__row--selected[data-v-cb12dccb]{background-color:var(--color-background-dark)}.file-picker__row[data-v-cb12dccb]:hover{background-color:var(--color-background-hover)}.file-picker__name-container[data-v-cb12dccb]{display:flex;justify-content:start;align-items:center;height:100%}.file-picker__file-name[data-v-cb12dccb]{padding-inline-start:6px;min-width:0;overflow:hidden;text-overflow:ellipsis}.file-picker__file-extension[data-v-cb12dccb]{color:var(--color-text-maxcontrast);min-width:fit-content}.file-picker__header-preview[data-v-006fdbd0]{width:22px;height:32px;flex:0 0 auto}.file-picker__files[data-v-006fdbd0]{margin:2px;margin-inline-start:12px;overflow:scroll auto}.file-picker__files table[data-v-006fdbd0]{width:100%;max-height:100%;table-layout:fixed}.file-picker__files th[data-v-006fdbd0]{position:-webkit-sticky;position:sticky;z-index:1;top:0;background-color:var(--color-main-background);padding:2px}.file-picker__files th .header-wrapper[data-v-006fdbd0]{display:flex}.file-picker__files th.row-checkbox[data-v-006fdbd0]{width:44px}.file-picker__files th.row-name[data-v-006fdbd0]{width:230px}.file-picker__files th.row-size[data-v-006fdbd0]{width:100px}.file-picker__files th.row-modified[data-v-006fdbd0]{width:120px}.file-picker__files th[data-v-006fdbd0]:not(.row-size) .button-vue__wrapper{justify-content:start;flex-direction:row-reverse}.file-picker__files th[data-v-006fdbd0]:not(.row-size) .button-vue{padding-inline:16px 4px}.file-picker__files th.row-size[data-v-006fdbd0] .button-vue__wrapper{justify-content:end}.file-picker__files th[data-v-006fdbd0] .button-vue__wrapper{color:var(--color-text-maxcontrast)}.file-picker__files th[data-v-006fdbd0] .button-vue__wrapper .button-vue__text{font-weight:400}.file-picker__breadcrumbs[data-v-b357227a]{flex-grow:0!important}.file-picker__side[data-v-b42054b8]{display:flex;flex-direction:column;align-items:stretch;gap:.5rem;min-width:200px;padding:2px;margin-block-start:7px;overflow:auto}.file-picker__side[data-v-b42054b8] .button-vue__wrapper{justify-content:start}.file-picker__filter-input[data-v-b42054b8]{margin-block:7px;max-width:260px}@media (max-width: 736px){.file-picker__side[data-v-b42054b8]{flex-direction:row;min-width:unset}}@media (max-width: 512px){.file-picker__side[data-v-b42054b8]{flex-direction:row;min-width:unset}.file-picker__filter-input[data-v-b42054b8]{max-width:unset}}.file-picker__navigation{padding-inline:8px 2px}.file-picker__navigation,.file-picker__navigation *{box-sizing:border-box}.file-picker__navigation .v-select.select{min-width:220px}@media (min-width: 513px) and (max-width: 736px){.file-picker__navigation{gap:11px}}@media (max-width: 512px){.file-picker__navigation{flex-direction:column-reverse!important}}.file-picker__view[data-v-20b719ba]{height:50px;display:flex;justify-content:start;align-items:center}.file-picker__view h3[data-v-20b719ba]{font-weight:700;height:fit-content;margin:0}.file-picker__main[data-v-20b719ba]{box-sizing:border-box;width:100%;display:flex;flex-direction:column;min-height:0;flex:1;padding-inline:2px}.file-picker__main *[data-v-20b719ba]{box-sizing:border-box}[data-v-20b719ba] .file-picker{height:min(80vh,800px)!important}@media (max-width: 512px){[data-v-20b719ba] .file-picker{height:calc(100% - 16px - var(--default-clickable-area))!important}}[data-v-20b719ba] .file-picker__content{display:flex;flex-direction:column;overflow:hidden}.material-design-icon[data-v-ceb23641]{display:flex;align-self:center;justify-self:center;align-items:center;justify-content:center}.input-field[data-v-ceb23641]{--input-border-radius: var(--border-radius-element, var(--border-radius-large));--input-padding-start: var(--border-radius-large);--input-padding-end: var(--border-radius-large);position:relative;width:100%;margin-block-start:6px}.input-field--disabled[data-v-ceb23641]{opacity:.4;filter:saturate(.4)}.input-field--label-outside[data-v-ceb23641]{margin-block-start:0}.input-field--leading-icon[data-v-ceb23641]{--input-padding-start: calc(var(--default-clickable-area) - var(--default-grid-baseline))}.input-field--trailing-icon[data-v-ceb23641]{--input-padding-end: calc(var(--default-clickable-area) - var(--default-grid-baseline))}.input-field--pill[data-v-ceb23641]{--input-border-radius: var(--border-radius-pill)}.input-field__main-wrapper[data-v-ceb23641]{height:var(--default-clickable-area);position:relative}.input-field__input[data-v-ceb23641]{--input-border-width-offset: calc(var(--border-width-input-focused, 2px) - var(--border-width-input, 2px));background-color:var(--color-main-background);color:var(--color-main-text);border:var(--border-width-input, 2px) solid var(--color-border-maxcontrast);border-radius:var(--input-border-radius);cursor:pointer;-webkit-appearance:textfield!important;-moz-appearance:textfield!important;appearance:textfield!important;font-size:var(--default-font-size);text-overflow:ellipsis;height:calc(var(--default-clickable-area) - 2 * var(--input-border-width-offset))!important;width:100%;padding-inline:calc(var(--input-padding-start) + var(--input-border-width-offset)) calc(var(--input-padding-end) + var(--input-border-width-offset));padding-block:var(--input-border-width-offset)}.input-field__input[data-v-ceb23641]::placeholder{color:var(--color-text-maxcontrast)}.input-field__input[data-v-ceb23641]:active:not([disabled]),.input-field__input[data-v-ceb23641]:hover:not([disabled]),.input-field__input[data-v-ceb23641]:focus:not([disabled]){border-color:var(--color-main-text);border-width:var(--border-width-input-focused, 2px);box-shadow:0 0 0 2px var(--color-main-background)!important;--input-border-width-offset: 0px}.input-field__input:focus+.input-field__label[data-v-ceb23641],.input-field__input:hover:not(:placeholder-shown)+.input-field__label[data-v-ceb23641]{color:var(--color-main-text)}.input-field__input[data-v-ceb23641]:focus{cursor:text}.input-field__input[data-v-ceb23641]:disabled{cursor:default}.input-field__input[data-v-ceb23641]:focus-visible{box-shadow:unset!important}.input-field__input--success[data-v-ceb23641]{border-color:var(--color-success)!important}.input-field__input--success[data-v-ceb23641]:focus-visible{box-shadow:#f8fafc 0 0 0 2px,var(--color-primary-element) 0 0 0 4px,#0000000d 0 1px 2px}.input-field__input--error[data-v-ceb23641],.input-field__input[data-v-ceb23641]:invalid{border-color:var(--color-error)!important}.input-field__input--error[data-v-ceb23641]:focus-visible,.input-field__input[data-v-ceb23641]:invalid:focus-visible{box-shadow:#f8fafc 0 0 0 2px,var(--color-primary-element) 0 0 0 4px,#0000000d 0 1px 2px}.input-field:not(.input-field--label-outside) .input-field__input[data-v-ceb23641]:not(:focus)::placeholder{opacity:0}.input-field__label[data-v-ceb23641]{--input-label-font-size: var(--default-font-size);position:absolute;margin-inline:var(--input-padding-start) var(--input-padding-end);max-width:fit-content;font-size:var(--input-label-font-size);inset-block-start:calc((var(--default-clickable-area) - 1lh) / 2);inset-inline:var(--border-width-input-focused, 2px);color:var(--color-text-maxcontrast);white-space:nowrap;overflow:hidden;text-overflow:ellipsis;pointer-events:none;transition:height var(--animation-quick),inset-block-start var(--animation-quick),font-size var(--animation-quick),color var(--animation-quick),background-color var(--animation-quick) var(--animation-slow)}.input-field__input:focus+.input-field__label[data-v-ceb23641],.input-field__input:not(:placeholder-shown)+.input-field__label[data-v-ceb23641]{--input-label-font-size: 13px;line-height:1.5;inset-block-start:calc(-1.5 * var(--input-label-font-size) / 2);font-weight:500;border-radius:var(--default-grid-baseline) var(--default-grid-baseline) 0 0;background-color:var(--color-main-background);padding-inline:var(--default-grid-baseline);margin-inline:calc(var(--input-padding-start) - var(--default-grid-baseline)) calc(var(--input-padding-end) - var(--default-grid-baseline));transition:height var(--animation-quick),inset-block-start var(--animation-quick),font-size var(--animation-quick),color var(--animation-quick)}.input-field__icon[data-v-ceb23641]{position:absolute;height:var(--default-clickable-area);width:var(--default-clickable-area);display:flex;align-items:center;justify-content:center;opacity:.7;inset-block-end:0}.input-field__icon--leading[data-v-ceb23641]{inset-inline-start:0px}.input-field__icon--trailing[data-v-ceb23641]{inset-inline-end:0px}.input-field__trailing-button[data-v-ceb23641]{--button-size: calc(var(--default-clickable-area) - 2 * var(--border-width-input-focused, 2px)) !important;--button-radius: calc(var(--input-border-radius) - var(--border-width-input-focused, 2px))}.input-field__trailing-button.button-vue[data-v-ceb23641]{position:absolute;top:var(--border-width-input-focused, 2px);inset-inline-end:var(--border-width-input-focused, 2px)}.input-field__trailing-button.button-vue[data-v-ceb23641]:focus-visible{box-shadow:none!important}.input-field__helper-text-message[data-v-ceb23641]{padding-block:4px;padding-inline:var(--border-radius-large);display:flex;align-items:center;color:var(--color-text-maxcontrast)}.input-field__helper-text-message__icon[data-v-ceb23641]{margin-inline-end:8px}.input-field__helper-text-message--error[data-v-ceb23641]{color:var(--color-error-text)}.input-field__helper-text-message--success[data-v-ceb23641]{color:var(--color-success-text)}")),document.head.appendChild(i)}}catch(t){console.error("vite-plugin-css-injected-by-js",t)}})();
var Fw=Object.defineProperty,Jw=Object.defineProperties;var qw=Object.getOwnPropertyDescriptors;var Lp=Object.getOwnPropertySymbols;var Ww=Object.prototype.hasOwnProperty,Gw=Object.prototype.propertyIsEnumerable;var jp=r=>{throw TypeError(r)};var Gh=(r,e,t)=>e in r?Fw(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,nt=(r,e)=>{for(var t in e||(e={}))Ww.call(e,t)&&Gh(r,t,e[t]);if(Lp)for(var t of Lp(e))Gw.call(e,t)&&Gh(r,t,e[t]);return r},ns=(r,e)=>Jw(r,qw(e));var Ue=(r,e,t)=>Gh(r,typeof e!="symbol"?e+"":e,t),_h=(r,e,t)=>e.has(r)||jp("Cannot "+t);var F=(r,e,t)=>(_h(r,e,"read from private field"),t?t.call(r):e.get(r)),kt=(r,e,t)=>e.has(r)?jp("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(r):e.set(r,t),Pe=(r,e,t,s)=>(_h(r,e,"write to private field"),s?s.call(r,t):e.set(r,t),t),Ws=(r,e,t)=>(_h(r,e,"access private method"),t);import{p as We,g as Ct,l as rp,a as yf,b as ap,U as _w,c as Xw,o as zw,d as Pg,v as Og,n as Hh,N as Qw,G as Yw,r as Zw,t as ey,e as ty,C as sy,f as Xh,h as ry,i as zh,j as $p,k as vf,m as ay,q as vo}from"./_plugin-vue2_normalizer-BvyFPmFz.chunk.mjs";import{f as Re,B as ge,s as bo,a as yh,O as M,N as Me,g as y,S as I,I as R,C as D,R as ee,c as U,b as K,d as W,e as ne,h as Ne,A as Z,P as Y,i as he,j as Fe,k as ql,n as ny,l as Wl,m as vh,u as ho,t as bf,G as ke,o as ra,U as Sf,T as Af,p as Bs,q as Nf,r as bh,v as kf,w as Bg,x as jc,V as iy,y as oy,z as uy,D as ly,E as cy,F as Gl,H as hy,J as Up,K as Kp,X as my,L as fy}from"./ArrowRight-CY2b9hgN-CuNLe1ar.chunk.mjs";import{N as py,a as dy,b as gy,s as wy}from"./NcCheckboxRadioSwitch-CCuKA55c-dHN0zdj_.chunk.mjs";import{C as yy}from"./Check-BkThHPH7-B1cVjS0E.chunk.mjs";import{u as Dg}from"./useModelMigration-EhAWvqDD-DPga5beH.chunk.mjs";function Zs(r,e,t){return e in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function Hp(r,e,t){vy(r,e),e.set(r,t)}function vy(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function rt(r,e){var t=Tg(r,e,"get");return by(r,t)}function by(r,e){return e.get?e.get.call(r):e.value}function Mp(r,e,t){var s=Tg(r,e,"set");return Sy(r,s,t),t}function Tg(r,e,t){if(!e.has(r))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(r)}function Sy(r,e,t){if(e.set)e.set.call(r,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}var Ay=typeof Symbol<"u"?Symbol.toStringTag:"@@toStringTag",it=new WeakMap,xo=new WeakMap;class Mh{constructor(e){var{executor:t=()=>{},internals:s=ip(),promise:a=new Promise((u,c)=>t(u,c,i=>{s.onCancelList.push(i)}))}=e;Hp(this,it,{writable:!0,value:void 0}),Hp(this,xo,{writable:!0,value:void 0}),Zs(this,Ay,"CancelablePromise"),this.cancel=this.cancel.bind(this),Mp(this,it,s),Mp(this,xo,a||new Promise((u,c)=>t(u,c,i=>{s.onCancelList.push(i)})))}then(e,t){return $c(rt(this,xo).then(nc(e,rt(this,it)),nc(t,rt(this,it))),rt(this,it))}catch(e){return $c(rt(this,xo).catch(nc(e,rt(this,it))),rt(this,it))}finally(e,t){return t&&rt(this,it).onCancelList.push(e),$c(rt(this,xo).finally(nc(()=>{if(e)return t&&(rt(this,it).onCancelList=rt(this,it).onCancelList.filter(s=>s!==e)),e()},rt(this,it))),rt(this,it))}cancel(){rt(this,it).isCanceled=!0;var e=rt(this,it).onCancelList;rt(this,it).onCancelList=[];for(var t of e)if(typeof t=="function")try{t()}catch(s){console.error(s)}}isCanceled(){return rt(this,it).isCanceled===!0}}class er extends Mh{constructor(e){super({executor:e})}}Zs(er,"all",function(r){return ic(r,Promise.all(r))}),Zs(er,"allSettled",function(r){return ic(r,Promise.allSettled(r))}),Zs(er,"any",function(r){return ic(r,Promise.any(r))}),Zs(er,"race",function(r){return ic(r,Promise.race(r))}),Zs(er,"resolve",function(r){return Fp(Promise.resolve(r))}),Zs(er,"reject",function(r){return Fp(Promise.reject(r))}),Zs(er,"isCancelable",np);function Fp(r){return $c(r,ip())}function np(r){return r instanceof er||r instanceof Mh}function nc(r,e){if(r)return t=>{if(!e.isCanceled){var s=r(t);return np(s)&&e.onCancelList.push(s.cancel),s}return t}}function $c(r,e){return new Mh({internals:e,promise:r})}function ic(r,e){var t=ip();return t.onCancelList.push(()=>{for(var s of r)np(s)&&s.cancel()}),new Mh({internals:t,promise:e})}function ip(){return{isCanceled:!1,onCancelList:[]}}var Qh={},Ny={2:r=>{function e(a,u,c){a instanceof RegExp&&(a=t(a,c)),u instanceof RegExp&&(u=t(u,c));var i=s(a,u,c);return i&&{start:i[0],end:i[1],pre:c.slice(0,i[0]),body:c.slice(i[0]+a.length,i[1]),post:c.slice(i[1]+u.length)}}function t(a,u){var c=u.match(a);return c?c[0]:null}function s(a,u,c){var i,o,n,l,m,h=c.indexOf(a),g=c.indexOf(u,h+1),p=h;if(h>=0&&g>0){for(i=[],n=c.length;p>=0&&!m;)p==h?(i.push(p),h=c.indexOf(a,p+1)):i.length==1?m=[i.pop(),g]:((o=i.pop())<n&&(n=o,l=g),g=c.indexOf(u,p+1)),p=h<g&&h>=0?h:g;i.length&&(m=[n,l])}return m}r.exports=e,e.range=s},101:function(r,e,t){var s;r=t.nmd(r),function(a){var u=(r&&r.exports,typeof Ct=="object"&&Ct);u.global!==u&&u.window;var c=function(m){this.message=m};(c.prototype=new Error).name="InvalidCharacterError";var i=function(m){throw new c(m)},o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n=/[\t\n\f\r ]/g,l={encode:function(m){m=String(m),/[^\0-\xFF]/.test(m)&&i("The string to be encoded contains characters outside of the Latin1 range.");for(var h,g,p,w,b=m.length%3,d="",f=-1,A=m.length-b;++f<A;)h=m.charCodeAt(f)<<16,g=m.charCodeAt(++f)<<8,p=m.charCodeAt(++f),d+=o.charAt((w=h+g+p)>>18&63)+o.charAt(w>>12&63)+o.charAt(w>>6&63)+o.charAt(63&w);return b==2?(h=m.charCodeAt(f)<<8,g=m.charCodeAt(++f),d+=o.charAt((w=h+g)>>10)+o.charAt(w>>4&63)+o.charAt(w<<2&63)+"="):b==1&&(w=m.charCodeAt(f),d+=o.charAt(w>>2)+o.charAt(w<<4&63)+"=="),d},decode:function(m){var h=(m=String(m).replace(n,"")).length;h%4==0&&(h=(m=m.replace(/==?$/,"")).length),(h%4==1||/[^+a-zA-Z0-9/]/.test(m))&&i("Invalid character: the string to be decoded is not correctly encoded.");for(var g,p,w=0,b="",d=-1;++d<h;)p=o.indexOf(m.charAt(d)),g=w%4?64*g+p:p,w++%4&&(b+=String.fromCharCode(255&g>>(-2*w&6)));return b},version:"1.0.0"};(s=function(){return l}.call(e,t,e,r))===void 0||(r.exports=s)}()},172:(r,e)=>{e.d=function(t){if(!t)return 0;for(var s=(t=t.toString()).length,a=t.length;a--;){var u=t.charCodeAt(a);56320<=u&&u<=57343&&a--,127<u&&u<=2047?s++:2047<u&&u<=65535&&(s+=2)}return s}},526:r=>{var e={utf8:{stringToBytes:function(t){return e.bin.stringToBytes(unescape(encodeURIComponent(t)))},bytesToString:function(t){return decodeURIComponent(escape(e.bin.bytesToString(t)))}},bin:{stringToBytes:function(t){for(var s=[],a=0;a<t.length;a++)s.push(255&t.charCodeAt(a));return s},bytesToString:function(t){for(var s=[],a=0;a<t.length;a++)s.push(String.fromCharCode(t[a]));return s.join("")}}};r.exports=e},298:r=>{var e,t;e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t={rotl:function(s,a){return s<<a|s>>>32-a},rotr:function(s,a){return s<<32-a|s>>>a},endian:function(s){if(s.constructor==Number)return 16711935&t.rotl(s,8)|4278255360&t.rotl(s,24);for(var a=0;a<s.length;a++)s[a]=t.endian(s[a]);return s},randomBytes:function(s){for(var a=[];s>0;s--)a.push(Math.floor(256*Math.random()));return a},bytesToWords:function(s){for(var a=[],u=0,c=0;u<s.length;u++,c+=8)a[c>>>5]|=s[u]<<24-c%32;return a},wordsToBytes:function(s){for(var a=[],u=0;u<32*s.length;u+=8)a.push(s[u>>>5]>>>24-u%32&255);return a},bytesToHex:function(s){for(var a=[],u=0;u<s.length;u++)a.push((s[u]>>>4).toString(16)),a.push((15&s[u]).toString(16));return a.join("")},hexToBytes:function(s){for(var a=[],u=0;u<s.length;u+=2)a.push(parseInt(s.substr(u,2),16));return a},bytesToBase64:function(s){for(var a=[],u=0;u<s.length;u+=3)for(var c=s[u]<<16|s[u+1]<<8|s[u+2],i=0;i<4;i++)8*u+6*i<=8*s.length?a.push(e.charAt(c>>>6*(3-i)&63)):a.push("=");return a.join("")},base64ToBytes:function(s){s=s.replace(/[^A-Z0-9+\/]/gi,"");for(var a=[],u=0,c=0;u<s.length;c=++u%4)c!=0&&a.push((e.indexOf(s.charAt(u-1))&Math.pow(2,-2*c+8)-1)<<2*c|e.indexOf(s.charAt(u))>>>6-2*c);return a}},r.exports=t},635:(r,e,t)=>{const s=t(31),a=t(338),u=t(221);r.exports={XMLParser:a,XMLValidator:s,XMLBuilder:u}},118:r=>{r.exports=function(e){return typeof e=="function"?e:Array.isArray(e)?t=>{for(const s of e)if(typeof s=="string"&&t===s||s instanceof RegExp&&s.test(t))return!0}:()=>!1}},705:(r,e)=>{const t=":A-Za-z_\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD",s="["+t+"]["+t+"\\-.\\d\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*",a=new RegExp("^"+s+"$");e.isExist=function(u){return u!==void 0},e.isEmptyObject=function(u){return Object.keys(u).length===0},e.merge=function(u,c,i){if(c){const o=Object.keys(c),n=o.length;for(let l=0;l<n;l++)u[o[l]]=i==="strict"?[c[o[l]]]:c[o[l]]}},e.getValue=function(u){return e.isExist(u)?u:""},e.isName=function(u){return a.exec(u)!=null},e.getAllMatches=function(u,c){const i=[];let o=c.exec(u);for(;o;){const n=[];n.startIndex=c.lastIndex-o[0].length;const l=o.length;for(let m=0;m<l;m++)n.push(o[m]);i.push(n),o=c.exec(u)}return i},e.nameRegexp=s},31:(r,e,t)=>{const s=t(705),a={allowBooleanAttributes:!1,unpairedTags:[]};function u(f){return f===" "||f==="	"||f==="\n"||f==="\r"}function c(f,A){const C=A;for(;A<f.length;A++)if(!(f[A]!="?"&&f[A]!=" ")){const S=f.substr(C,A-C);if(A>5&&S==="xml")return p("InvalidXml","XML declaration allowed only at the start of the document.",b(f,A));if(f[A]=="?"&&f[A+1]==">"){A++;break}}return A}function i(f,A){if(f.length>A+5&&f[A+1]==="-"&&f[A+2]==="-"){for(A+=3;A<f.length;A++)if(f[A]==="-"&&f[A+1]==="-"&&f[A+2]===">"){A+=2;break}}else if(f.length>A+8&&f[A+1]==="D"&&f[A+2]==="O"&&f[A+3]==="C"&&f[A+4]==="T"&&f[A+5]==="Y"&&f[A+6]==="P"&&f[A+7]==="E"){let C=1;for(A+=8;A<f.length;A++)if(f[A]==="<")C++;else if(f[A]===">"&&(C--,C===0))break}else if(f.length>A+9&&f[A+1]==="["&&f[A+2]==="C"&&f[A+3]==="D"&&f[A+4]==="A"&&f[A+5]==="T"&&f[A+6]==="A"&&f[A+7]==="["){for(A+=8;A<f.length;A++)if(f[A]==="]"&&f[A+1]==="]"&&f[A+2]===">"){A+=2;break}}return A}e.validate=function(f,A){A=Object.assign({},a,A);const C=[];let S=!1,v=!1;f[0]==="\uFEFF"&&(f=f.substr(1));for(let k=0;k<f.length;k++)if(f[k]==="<"&&f[k+1]==="?"){if(k+=2,k=c(f,k),k.err)return k}else{if(f[k]!=="<"){if(u(f[k]))continue;return p("InvalidChar","char '"+f[k]+"' is not expected.",b(f,k))}{let x=k;if(k++,f[k]==="!"){k=i(f,k);continue}{let V=!1;f[k]==="/"&&(V=!0,k++);let O="";for(;k<f.length&&f[k]!==">"&&f[k]!==" "&&f[k]!=="	"&&f[k]!=="\n"&&f[k]!=="\r";k++)O+=f[k];if(O=O.trim(),O[O.length-1]==="/"&&(O=O.substring(0,O.length-1),k--),E=O,!s.isName(E)){let L;return L=O.trim().length===0?"Invalid space after '<'.":"Tag '"+O+"' is an invalid name.",p("InvalidTag",L,b(f,k))}const P=l(f,k);if(P===!1)return p("InvalidAttr","Attributes for '"+O+"' have open quote.",b(f,k));let B=P.value;if(k=P.index,B[B.length-1]==="/"){const L=k-B.length;B=B.substring(0,B.length-1);const H=h(B,A);if(H!==!0)return p(H.err.code,H.err.msg,b(f,L+H.err.line));S=!0}else if(V){if(!P.tagClosed)return p("InvalidTag","Closing tag '"+O+"' doesn't have proper closing.",b(f,k));if(B.trim().length>0)return p("InvalidTag","Closing tag '"+O+"' can't have attributes or invalid starting.",b(f,x));if(C.length===0)return p("InvalidTag","Closing tag '"+O+"' has not been opened.",b(f,x));{const L=C.pop();if(O!==L.tagName){let H=b(f,L.tagStartPos);return p("InvalidTag","Expected closing tag '"+L.tagName+"' (opened in line "+H.line+", col "+H.col+") instead of closing tag '"+O+"'.",b(f,x))}C.length==0&&(v=!0)}}else{const L=h(B,A);if(L!==!0)return p(L.err.code,L.err.msg,b(f,k-B.length+L.err.line));if(v===!0)return p("InvalidXml","Multiple possible root nodes found.",b(f,k));A.unpairedTags.indexOf(O)!==-1||C.push({tagName:O,tagStartPos:x}),S=!0}for(k++;k<f.length;k++)if(f[k]==="<"){if(f[k+1]==="!"){k++,k=i(f,k);continue}if(f[k+1]!=="?")break;if(k=c(f,++k),k.err)return k}else if(f[k]==="&"){const L=g(f,k);if(L==-1)return p("InvalidChar","char '&' is not expected.",b(f,k));k=L}else if(v===!0&&!u(f[k]))return p("InvalidXml","Extra text at the end",b(f,k));f[k]==="<"&&k--}}}var E;return S?C.length==1?p("InvalidTag","Unclosed tag '"+C[0].tagName+"'.",b(f,C[0].tagStartPos)):!(C.length>0)||p("InvalidXml","Invalid '"+JSON.stringify(C.map(k=>k.tagName),null,4).replace(/\r?\n/g,"")+"' found.",{line:1,col:1}):p("InvalidXml","Start tag expected.",1)};const o='"',n="'";function l(f,A){let C="",S="",v=!1;for(;A<f.length;A++){if(f[A]===o||f[A]===n)S===""?S=f[A]:S!==f[A]||(S="");else if(f[A]===">"&&S===""){v=!0;break}C+=f[A]}return S===""&&{value:C,index:A,tagClosed:v}}const m=new RegExp("(\\s*)([^\\s=]+)(\\s*=)?(\\s*(['\"])(([\\s\\S])*?)\\5)?","g");function h(f,A){const C=s.getAllMatches(f,m),S={};for(let v=0;v<C.length;v++){if(C[v][1].length===0)return p("InvalidAttr","Attribute '"+C[v][2]+"' has no space in starting.",d(C[v]));if(C[v][3]!==void 0&&C[v][4]===void 0)return p("InvalidAttr","Attribute '"+C[v][2]+"' is without value.",d(C[v]));if(C[v][3]===void 0&&!A.allowBooleanAttributes)return p("InvalidAttr","boolean attribute '"+C[v][2]+"' is not allowed.",d(C[v]));const E=C[v][2];if(!w(E))return p("InvalidAttr","Attribute '"+E+"' is an invalid name.",d(C[v]));if(S.hasOwnProperty(E))return p("InvalidAttr","Attribute '"+E+"' is repeated.",d(C[v]));S[E]=1}return!0}function g(f,A){if(f[++A]===";")return-1;if(f[A]==="#")return function(S,v){let E=/\d/;for(S[v]==="x"&&(v++,E=/[\da-fA-F]/);v<S.length;v++){if(S[v]===";")return v;if(!S[v].match(E))break}return-1}(f,++A);let C=0;for(;A<f.length;A++,C++)if(!(f[A].match(/\w/)&&C<20)){if(f[A]===";")break;return-1}return A}function p(f,A,C){return{err:{code:f,msg:A,line:C.line||C,col:C.col}}}function w(f){return s.isName(f)}function b(f,A){const C=f.substring(0,A).split(/\r?\n/);return{line:C.length,col:C[C.length-1].length+1}}function d(f){return f.startIndex+f[1].length}},221:(r,e,t)=>{const s=t(87),a=t(118),u={attributeNamePrefix:"@_",attributesGroupName:!1,textNodeName:"#text",ignoreAttributes:!0,cdataPropName:!1,format:!1,indentBy:"  ",suppressEmptyNode:!1,suppressUnpairedNode:!0,suppressBooleanAttributes:!0,tagValueProcessor:function(l,m){return m},attributeValueProcessor:function(l,m){return m},preserveOrder:!1,commentPropName:!1,unpairedTags:[],entities:[{regex:new RegExp("&","g"),val:"&amp;"},{regex:new RegExp(">","g"),val:"&gt;"},{regex:new RegExp("<","g"),val:"&lt;"},{regex:new RegExp("'","g"),val:"&apos;"},{regex:new RegExp('"',"g"),val:"&quot;"}],processEntities:!0,stopNodes:[],oneListGroup:!1};function c(l){this.options=Object.assign({},u,l),this.options.ignoreAttributes===!0||this.options.attributesGroupName?this.isAttribute=function(){return!1}:(this.ignoreAttributesFn=a(this.options.ignoreAttributes),this.attrPrefixLen=this.options.attributeNamePrefix.length,this.isAttribute=n),this.processTextOrObjNode=i,this.options.format?(this.indentate=o,this.tagEndChar=">\n",this.newLine="\n"):(this.indentate=function(){return""},this.tagEndChar=">",this.newLine="")}function i(l,m,h,g){const p=this.j2x(l,h+1,g.concat(m));return l[this.options.textNodeName]!==void 0&&Object.keys(l).length===1?this.buildTextValNode(l[this.options.textNodeName],m,p.attrStr,h):this.buildObjectNode(p.val,m,p.attrStr,h)}function o(l){return this.options.indentBy.repeat(l)}function n(l){return!(!l.startsWith(this.options.attributeNamePrefix)||l===this.options.textNodeName)&&l.substr(this.attrPrefixLen)}c.prototype.build=function(l){return this.options.preserveOrder?s(l,this.options):(Array.isArray(l)&&this.options.arrayNodeName&&this.options.arrayNodeName.length>1&&(l={[this.options.arrayNodeName]:l}),this.j2x(l,0,[]).val)},c.prototype.j2x=function(l,m,h){let g="",p="";const w=h.join(".");for(let b in l)if(Object.prototype.hasOwnProperty.call(l,b))if(l[b]===void 0)this.isAttribute(b)&&(p+="");else if(l[b]===null)this.isAttribute(b)?p+="":b[0]==="?"?p+=this.indentate(m)+"<"+b+"?"+this.tagEndChar:p+=this.indentate(m)+"<"+b+"/"+this.tagEndChar;else if(l[b]instanceof Date)p+=this.buildTextValNode(l[b],b,"",m);else if(typeof l[b]!="object"){const d=this.isAttribute(b);if(d&&!this.ignoreAttributesFn(d,w))g+=this.buildAttrPairStr(d,""+l[b]);else if(!d)if(b===this.options.textNodeName){let f=this.options.tagValueProcessor(b,""+l[b]);p+=this.replaceEntitiesValue(f)}else p+=this.buildTextValNode(l[b],b,"",m)}else if(Array.isArray(l[b])){const d=l[b].length;let f="",A="";for(let C=0;C<d;C++){const S=l[b][C];if(S!==void 0)if(S===null)b[0]==="?"?p+=this.indentate(m)+"<"+b+"?"+this.tagEndChar:p+=this.indentate(m)+"<"+b+"/"+this.tagEndChar;else if(typeof S=="object")if(this.options.oneListGroup){const v=this.j2x(S,m+1,h.concat(b));f+=v.val,this.options.attributesGroupName&&S.hasOwnProperty(this.options.attributesGroupName)&&(A+=v.attrStr)}else f+=this.processTextOrObjNode(S,b,m,h);else if(this.options.oneListGroup){let v=this.options.tagValueProcessor(b,S);v=this.replaceEntitiesValue(v),f+=v}else f+=this.buildTextValNode(S,b,"",m)}this.options.oneListGroup&&(f=this.buildObjectNode(f,b,A,m)),p+=f}else if(this.options.attributesGroupName&&b===this.options.attributesGroupName){const d=Object.keys(l[b]),f=d.length;for(let A=0;A<f;A++)g+=this.buildAttrPairStr(d[A],""+l[b][d[A]])}else p+=this.processTextOrObjNode(l[b],b,m,h);return{attrStr:g,val:p}},c.prototype.buildAttrPairStr=function(l,m){return m=this.options.attributeValueProcessor(l,""+m),m=this.replaceEntitiesValue(m),this.options.suppressBooleanAttributes&&m==="true"?" "+l:" "+l+'="'+m+'"'},c.prototype.buildObjectNode=function(l,m,h,g){if(l==="")return m[0]==="?"?this.indentate(g)+"<"+m+h+"?"+this.tagEndChar:this.indentate(g)+"<"+m+h+this.closeTag(m)+this.tagEndChar;{let p="</"+m+this.tagEndChar,w="";return m[0]==="?"&&(w="?",p=""),!h&&h!==""||l.indexOf("<")!==-1?this.options.commentPropName!==!1&&m===this.options.commentPropName&&w.length===0?this.indentate(g)+"<!--".concat(l,"-->")+this.newLine:this.indentate(g)+"<"+m+h+w+this.tagEndChar+l+this.indentate(g)+p:this.indentate(g)+"<"+m+h+w+">"+l+p}},c.prototype.closeTag=function(l){let m="";return this.options.unpairedTags.indexOf(l)!==-1?this.options.suppressUnpairedNode||(m="/"):m=this.options.suppressEmptyNode?"/":"></".concat(l),m},c.prototype.buildTextValNode=function(l,m,h,g){if(this.options.cdataPropName!==!1&&m===this.options.cdataPropName)return this.indentate(g)+"<![CDATA[".concat(l,"]]>")+this.newLine;if(this.options.commentPropName!==!1&&m===this.options.commentPropName)return this.indentate(g)+"<!--".concat(l,"-->")+this.newLine;if(m[0]==="?")return this.indentate(g)+"<"+m+h+"?"+this.tagEndChar;{let p=this.options.tagValueProcessor(m,l);return p=this.replaceEntitiesValue(p),p===""?this.indentate(g)+"<"+m+h+this.closeTag(m)+this.tagEndChar:this.indentate(g)+"<"+m+h+">"+p+"</"+m+this.tagEndChar}},c.prototype.replaceEntitiesValue=function(l){if(l&&l.length>0&&this.options.processEntities)for(let m=0;m<this.options.entities.length;m++){const h=this.options.entities[m];l=l.replace(h.regex,h.val)}return l},r.exports=c},87:r=>{function e(c,i,o,n){let l="",m=!1;for(let h=0;h<c.length;h++){const g=c[h],p=t(g);if(p===void 0)continue;let w="";if(w=o.length===0?p:"".concat(o,".").concat(p),p===i.textNodeName){let A=g[p];a(w,i)||(A=i.tagValueProcessor(p,A),A=u(A,i)),m&&(l+=n),l+=A,m=!1;continue}if(p===i.cdataPropName){m&&(l+=n),l+="<![CDATA[".concat(g[p][0][i.textNodeName],"]]>"),m=!1;continue}if(p===i.commentPropName){l+=n+"<!--".concat(g[p][0][i.textNodeName],"-->"),m=!0;continue}if(p[0]==="?"){const A=s(g[":@"],i),C=p==="?xml"?"":n;let S=g[p][0][i.textNodeName];S=S.length!==0?" "+S:"",l+=C+"<".concat(p).concat(S).concat(A,"?>"),m=!0;continue}let b=n;b!==""&&(b+=i.indentBy);const d=n+"<".concat(p).concat(s(g[":@"],i)),f=e(g[p],i,w,b);i.unpairedTags.indexOf(p)!==-1?i.suppressUnpairedNode?l+=d+">":l+=d+"/>":f&&f.length!==0||!i.suppressEmptyNode?f&&f.endsWith(">")?l+=d+">".concat(f).concat(n,"</").concat(p,">"):(l+=d+">",f&&n!==""&&(f.includes("/>")||f.includes("</"))?l+=n+i.indentBy+f+n:l+=f,l+="</".concat(p,">")):l+=d+"/>",m=!0}return l}function t(c){const i=Object.keys(c);for(let o=0;o<i.length;o++){const n=i[o];if(c.hasOwnProperty(n)&&n!==":@")return n}}function s(c,i){let o="";if(c&&!i.ignoreAttributes)for(let n in c){if(!c.hasOwnProperty(n))continue;let l=i.attributeValueProcessor(n,c[n]);l=u(l,i),l===!0&&i.suppressBooleanAttributes?o+=" ".concat(n.substr(i.attributeNamePrefix.length)):o+=" ".concat(n.substr(i.attributeNamePrefix.length),'="').concat(l,'"')}return o}function a(c,i){let o=(c=c.substr(0,c.length-i.textNodeName.length-1)).substr(c.lastIndexOf(".")+1);for(let n in i.stopNodes)if(i.stopNodes[n]===c||i.stopNodes[n]==="*."+o)return!0;return!1}function u(c,i){if(c&&c.length>0&&i.processEntities)for(let o=0;o<i.entities.length;o++){const n=i.entities[o];c=c.replace(n.regex,n.val)}return c}r.exports=function(c,i){let o="";return i.format&&i.indentBy.length>0&&(o="\n"),e(c,i,"",o)}},193:(r,e,t)=>{const s=t(705);function a(m,h){let g="";for(;h<m.length&&m[h]!=="'"&&m[h]!=='"';h++)g+=m[h];if(g=g.trim(),g.indexOf(" ")!==-1)throw new Error("External entites are not supported");const p=m[h++];let w="";for(;h<m.length&&m[h]!==p;h++)w+=m[h];return[g,w,h]}function u(m,h){return m[h+1]==="!"&&m[h+2]==="-"&&m[h+3]==="-"}function c(m,h){return m[h+1]==="!"&&m[h+2]==="E"&&m[h+3]==="N"&&m[h+4]==="T"&&m[h+5]==="I"&&m[h+6]==="T"&&m[h+7]==="Y"}function i(m,h){return m[h+1]==="!"&&m[h+2]==="E"&&m[h+3]==="L"&&m[h+4]==="E"&&m[h+5]==="M"&&m[h+6]==="E"&&m[h+7]==="N"&&m[h+8]==="T"}function o(m,h){return m[h+1]==="!"&&m[h+2]==="A"&&m[h+3]==="T"&&m[h+4]==="T"&&m[h+5]==="L"&&m[h+6]==="I"&&m[h+7]==="S"&&m[h+8]==="T"}function n(m,h){return m[h+1]==="!"&&m[h+2]==="N"&&m[h+3]==="O"&&m[h+4]==="T"&&m[h+5]==="A"&&m[h+6]==="T"&&m[h+7]==="I"&&m[h+8]==="O"&&m[h+9]==="N"}function l(m){if(s.isName(m))return m;throw new Error("Invalid entity name ".concat(m))}r.exports=function(m,h){const g={};if(m[h+3]!=="O"||m[h+4]!=="C"||m[h+5]!=="T"||m[h+6]!=="Y"||m[h+7]!=="P"||m[h+8]!=="E")throw new Error("Invalid Tag instead of DOCTYPE");{h+=9;let p=1,w=!1,b=!1,d="";for(;h<m.length;h++)if(m[h]!=="<"||b)if(m[h]===">"){if(b?m[h-1]==="-"&&m[h-2]==="-"&&(b=!1,p--):p--,p===0)break}else m[h]==="["?w=!0:d+=m[h];else{if(w&&c(m,h)){let f,A;h+=7,[f,A,h]=a(m,h+1),A.indexOf("&")===-1&&(g[l(f)]={regx:RegExp("&".concat(f,";"),"g"),val:A})}else if(w&&i(m,h))h+=8;else if(w&&o(m,h))h+=8;else if(w&&n(m,h))h+=9;else{if(!u)throw new Error("Invalid DOCTYPE");b=!0}p++,d=""}if(p!==0)throw new Error("Unclosed DOCTYPE")}return{entities:g,i:h}}},63:(r,e)=>{const t={preserveOrder:!1,attributeNamePrefix:"@_",attributesGroupName:!1,textNodeName:"#text",ignoreAttributes:!0,removeNSPrefix:!1,allowBooleanAttributes:!1,parseTagValue:!0,parseAttributeValue:!1,trimValues:!0,cdataPropName:!1,numberParseOptions:{hex:!0,leadingZeros:!0,eNotation:!0},tagValueProcessor:function(s,a){return a},attributeValueProcessor:function(s,a){return a},stopNodes:[],alwaysCreateTextNode:!1,isArray:()=>!1,commentPropName:!1,unpairedTags:[],processEntities:!0,htmlEntities:!1,ignoreDeclaration:!1,ignorePiTags:!1,transformTagName:!1,transformAttributeName:!1,updateTag:function(s,a,u){return s}};e.buildOptions=function(s){return Object.assign({},t,s)},e.defaultOptions=t},299:(r,e,t)=>{const s=t(705),a=t(365),u=t(193),c=t(494),i=t(118);function o(v){const E=Object.keys(v);for(let k=0;k<E.length;k++){const x=E[k];this.lastEntities[x]={regex:new RegExp("&"+x+";","g"),val:v[x]}}}function n(v,E,k,x,V,O,P){if(v!==void 0&&(this.options.trimValues&&!x&&(v=v.trim()),v.length>0)){P||(v=this.replaceEntitiesValue(v));const B=this.options.tagValueProcessor(E,v,k,V,O);return B==null?v:typeof B!=typeof v||B!==v?B:this.options.trimValues||v.trim()===v?S(v,this.options.parseTagValue,this.options.numberParseOptions):v}}function l(v){if(this.options.removeNSPrefix){const E=v.split(":"),k=v.charAt(0)==="/"?"/":"";if(E[0]==="xmlns")return"";E.length===2&&(v=k+E[1])}return v}const m=new RegExp("([^\\s=]+)\\s*(=\\s*(['\"])([\\s\\S]*?)\\3)?","gm");function h(v,E,k){if(this.options.ignoreAttributes!==!0&&typeof v=="string"){const x=s.getAllMatches(v,m),V=x.length,O={};for(let P=0;P<V;P++){const B=this.resolveNameSpace(x[P][1]);if(this.ignoreAttributesFn(B,E))continue;let L=x[P][4],H=this.options.attributeNamePrefix+B;if(B.length)if(this.options.transformAttributeName&&(H=this.options.transformAttributeName(H)),H==="__proto__"&&(H="#__proto__"),L!==void 0){this.options.trimValues&&(L=L.trim()),L=this.replaceEntitiesValue(L);const z=this.options.attributeValueProcessor(B,L,E);O[H]=z==null?L:typeof z!=typeof L||z!==L?z:S(L,this.options.parseAttributeValue,this.options.numberParseOptions)}else this.options.allowBooleanAttributes&&(O[H]=!0)}if(!Object.keys(O).length)return;if(this.options.attributesGroupName){const P={};return P[this.options.attributesGroupName]=O,P}return O}}const g=function(v){v=v.replace(/\r\n?/g,"\n");const E=new a("!xml");let k=E,x="",V="";for(let O=0;O<v.length;O++)if(v[O]==="<")if(v[O+1]==="/"){const P=f(v,">",O,"Closing Tag is not closed.");let B=v.substring(O+2,P).trim();if(this.options.removeNSPrefix){const z=B.indexOf(":");z!==-1&&(B=B.substr(z+1))}this.options.transformTagName&&(B=this.options.transformTagName(B)),k&&(x=this.saveTextToParentTag(x,k,V));const L=V.substring(V.lastIndexOf(".")+1);if(B&&this.options.unpairedTags.indexOf(B)!==-1)throw new Error("Unpaired tag can not be used as closing tag: </".concat(B,">"));let H=0;L&&this.options.unpairedTags.indexOf(L)!==-1?(H=V.lastIndexOf(".",V.lastIndexOf(".")-1),this.tagsNodeStack.pop()):H=V.lastIndexOf("."),V=V.substring(0,H),k=this.tagsNodeStack.pop(),x="",O=P}else if(v[O+1]==="?"){let P=A(v,O,!1,"?>");if(!P)throw new Error("Pi Tag is not closed.");if(x=this.saveTextToParentTag(x,k,V),!(this.options.ignoreDeclaration&&P.tagName==="?xml"||this.options.ignorePiTags)){const B=new a(P.tagName);B.add(this.options.textNodeName,""),P.tagName!==P.tagExp&&P.attrExpPresent&&(B[":@"]=this.buildAttributesMap(P.tagExp,V,P.tagName)),this.addChild(k,B,V)}O=P.closeIndex+1}else if(v.substr(O+1,3)==="!--"){const P=f(v,"-->",O+4,"Comment is not closed.");if(this.options.commentPropName){const B=v.substring(O+4,P-2);x=this.saveTextToParentTag(x,k,V),k.add(this.options.commentPropName,[{[this.options.textNodeName]:B}])}O=P}else if(v.substr(O+1,2)==="!D"){const P=u(v,O);this.docTypeEntities=P.entities,O=P.i}else if(v.substr(O+1,2)==="!["){const P=f(v,"]]>",O,"CDATA is not closed.")-2,B=v.substring(O+9,P);x=this.saveTextToParentTag(x,k,V);let L=this.parseTextData(B,k.tagname,V,!0,!1,!0,!0);L==null&&(L=""),this.options.cdataPropName?k.add(this.options.cdataPropName,[{[this.options.textNodeName]:B}]):k.add(this.options.textNodeName,L),O=P+2}else{let P=A(v,O,this.options.removeNSPrefix),B=P.tagName;const L=P.rawTagName;let H=P.tagExp,z=P.attrExpPresent,re=P.closeIndex;this.options.transformTagName&&(B=this.options.transformTagName(B)),k&&x&&k.tagname!=="!xml"&&(x=this.saveTextToParentTag(x,k,V,!1));const _=k;if(_&&this.options.unpairedTags.indexOf(_.tagname)!==-1&&(k=this.tagsNodeStack.pop(),V=V.substring(0,V.lastIndexOf("."))),B!==E.tagname&&(V+=V?"."+B:B),this.isItStopNode(this.options.stopNodes,V,B)){let X="";if(H.length>0&&H.lastIndexOf("/")===H.length-1)B[B.length-1]==="/"?(B=B.substr(0,B.length-1),V=V.substr(0,V.length-1),H=B):H=H.substr(0,H.length-1),O=P.closeIndex;else if(this.options.unpairedTags.indexOf(B)!==-1)O=P.closeIndex;else{const G=this.readStopNodeData(v,L,re+1);if(!G)throw new Error("Unexpected end of ".concat(L));O=G.i,X=G.tagContent}const J=new a(B);B!==H&&z&&(J[":@"]=this.buildAttributesMap(H,V,B)),X&&(X=this.parseTextData(X,B,V,!0,z,!0,!0)),V=V.substr(0,V.lastIndexOf(".")),J.add(this.options.textNodeName,X),this.addChild(k,J,V)}else{if(H.length>0&&H.lastIndexOf("/")===H.length-1){B[B.length-1]==="/"?(B=B.substr(0,B.length-1),V=V.substr(0,V.length-1),H=B):H=H.substr(0,H.length-1),this.options.transformTagName&&(B=this.options.transformTagName(B));const X=new a(B);B!==H&&z&&(X[":@"]=this.buildAttributesMap(H,V,B)),this.addChild(k,X,V),V=V.substr(0,V.lastIndexOf("."))}else{const X=new a(B);this.tagsNodeStack.push(k),B!==H&&z&&(X[":@"]=this.buildAttributesMap(H,V,B)),this.addChild(k,X,V),k=X}x="",O=re}}else x+=v[O];return E.child};function p(v,E,k){const x=this.options.updateTag(E.tagname,k,E[":@"]);x===!1||(typeof x=="string"&&(E.tagname=x),v.addChild(E))}const w=function(v){if(this.options.processEntities){for(let E in this.docTypeEntities){const k=this.docTypeEntities[E];v=v.replace(k.regx,k.val)}for(let E in this.lastEntities){const k=this.lastEntities[E];v=v.replace(k.regex,k.val)}if(this.options.htmlEntities)for(let E in this.htmlEntities){const k=this.htmlEntities[E];v=v.replace(k.regex,k.val)}v=v.replace(this.ampEntity.regex,this.ampEntity.val)}return v};function b(v,E,k,x){return v&&(x===void 0&&(x=Object.keys(E.child).length===0),(v=this.parseTextData(v,E.tagname,k,!1,!!E[":@"]&&Object.keys(E[":@"]).length!==0,x))!==void 0&&v!==""&&E.add(this.options.textNodeName,v),v=""),v}function d(v,E,k){const x="*."+k;for(const V in v){const O=v[V];if(x===O||E===O)return!0}return!1}function f(v,E,k,x){const V=v.indexOf(E,k);if(V===-1)throw new Error(x);return V+E.length-1}function A(v,E,k){const x=function(z,re){let _,X=arguments.length>2&&arguments[2]!==void 0?arguments[2]:">",J="";for(let G=re;G<z.length;G++){let q=z[G];if(_)q===_&&(_="");else if(q==='"'||q==="'")_=q;else if(q===X[0]){if(!X[1])return{data:J,index:G};if(z[G+1]===X[1])return{data:J,index:G}}else q==="	"&&(q=" ");J+=q}}(v,E+1,arguments.length>3&&arguments[3]!==void 0?arguments[3]:">");if(!x)return;let V=x.data;const O=x.index,P=V.search(/\s/);let B=V,L=!0;P!==-1&&(B=V.substring(0,P),V=V.substring(P+1).trimStart());const H=B;if(k){const z=B.indexOf(":");z!==-1&&(B=B.substr(z+1),L=B!==x.data.substr(z+1))}return{tagName:B,tagExp:V,closeIndex:O,attrExpPresent:L,rawTagName:H}}function C(v,E,k){const x=k;let V=1;for(;k<v.length;k++)if(v[k]==="<")if(v[k+1]==="/"){const O=f(v,">",k,"".concat(E," is not closed"));if(v.substring(k+2,O).trim()===E&&(V--,V===0))return{tagContent:v.substring(x,k),i:O};k=O}else if(v[k+1]==="?")k=f(v,"?>",k+1,"StopNode is not closed.");else if(v.substr(k+1,3)==="!--")k=f(v,"-->",k+3,"StopNode is not closed.");else if(v.substr(k+1,2)==="![")k=f(v,"]]>",k,"StopNode is not closed.")-2;else{const O=A(v,k,">");O&&((O&&O.tagName)===E&&O.tagExp[O.tagExp.length-1]!=="/"&&V++,k=O.closeIndex)}}function S(v,E,k){if(E&&typeof v=="string"){const x=v.trim();return x==="true"||x!=="false"&&c(v,k)}return s.isExist(v)?v:""}r.exports=class{constructor(v){this.options=v,this.currentNode=null,this.tagsNodeStack=[],this.docTypeEntities={},this.lastEntities={apos:{regex:/&(apos|#39|#x27);/g,val:"'"},gt:{regex:/&(gt|#62|#x3E);/g,val:">"},lt:{regex:/&(lt|#60|#x3C);/g,val:"<"},quot:{regex:/&(quot|#34|#x22);/g,val:'"'}},this.ampEntity={regex:/&(amp|#38|#x26);/g,val:"&"},this.htmlEntities={space:{regex:/&(nbsp|#160);/g,val:" "},cent:{regex:/&(cent|#162);/g,val:"¢"},pound:{regex:/&(pound|#163);/g,val:"£"},yen:{regex:/&(yen|#165);/g,val:"¥"},euro:{regex:/&(euro|#8364);/g,val:"€"},copyright:{regex:/&(copy|#169);/g,val:"©"},reg:{regex:/&(reg|#174);/g,val:"®"},inr:{regex:/&(inr|#8377);/g,val:"₹"},num_dec:{regex:/&#([0-9]{1,7});/g,val:(E,k)=>String.fromCharCode(Number.parseInt(k,10))},num_hex:{regex:/&#x([0-9a-fA-F]{1,6});/g,val:(E,k)=>String.fromCharCode(Number.parseInt(k,16))}},this.addExternalEntities=o,this.parseXml=g,this.parseTextData=n,this.resolveNameSpace=l,this.buildAttributesMap=h,this.isItStopNode=d,this.replaceEntitiesValue=w,this.readStopNodeData=C,this.saveTextToParentTag=b,this.addChild=p,this.ignoreAttributesFn=i(this.options.ignoreAttributes)}}},338:(r,e,t)=>{const{buildOptions:s}=t(63),a=t(299),{prettify:u}=t(728),c=t(31);r.exports=class{constructor(i){this.externalEntities={},this.options=s(i)}parse(i,o){if(typeof i!="string"){if(!i.toString)throw new Error("XML data is accepted in String or Bytes[] form.");i=i.toString()}if(o){o===!0&&(o={});const m=c.validate(i,o);if(m!==!0)throw Error("".concat(m.err.msg,":").concat(m.err.line,":").concat(m.err.col))}const n=new a(this.options);n.addExternalEntities(this.externalEntities);const l=n.parseXml(i);return this.options.preserveOrder||l===void 0?l:u(l,this.options)}addEntity(i,o){if(o.indexOf("&")!==-1)throw new Error("Entity value can't have '&'");if(i.indexOf("&")!==-1||i.indexOf(";")!==-1)throw new Error("An entity must be set without '&' and ';'. Eg. use '#xD' for '&#xD;'");if(o==="&")throw new Error("An entity with value '&' is not permitted");this.externalEntities[i]=o}}},728:(r,e)=>{function t(c,i,o){let n;const l={};for(let m=0;m<c.length;m++){const h=c[m],g=s(h);let p="";if(p=o===void 0?g:o+"."+g,g===i.textNodeName)n===void 0?n=h[g]:n+=""+h[g];else{if(g===void 0)continue;if(h[g]){let w=t(h[g],i,p);const b=u(w,i);h[":@"]?a(w,h[":@"],p,i):Object.keys(w).length!==1||w[i.textNodeName]===void 0||i.alwaysCreateTextNode?Object.keys(w).length===0&&(i.alwaysCreateTextNode?w[i.textNodeName]="":w=""):w=w[i.textNodeName],l[g]!==void 0&&l.hasOwnProperty(g)?(Array.isArray(l[g])||(l[g]=[l[g]]),l[g].push(w)):i.isArray(g,p,b)?l[g]=[w]:l[g]=w}}}return typeof n=="string"?n.length>0&&(l[i.textNodeName]=n):n!==void 0&&(l[i.textNodeName]=n),l}function s(c){const i=Object.keys(c);for(let o=0;o<i.length;o++){const n=i[o];if(n!==":@")return n}}function a(c,i,o,n){if(i){const l=Object.keys(i),m=l.length;for(let h=0;h<m;h++){const g=l[h];n.isArray(g,o+"."+g,!0,!0)?c[g]=[i[g]]:c[g]=i[g]}}}function u(c,i){const{textNodeName:o}=i,n=Object.keys(c).length;return n===0||!(n!==1||!c[o]&&typeof c[o]!="boolean"&&c[o]!==0)}e.prettify=function(c,i){return t(c,i)}},365:r=>{r.exports=class{constructor(e){this.tagname=e,this.child=[],this[":@"]={}}add(e,t){e==="__proto__"&&(e="#__proto__"),this.child.push({[e]:t})}addChild(e){e.tagname==="__proto__"&&(e.tagname="#__proto__"),e[":@"]&&Object.keys(e[":@"]).length>0?this.child.push({[e.tagname]:e.child,":@":e[":@"]}):this.child.push({[e.tagname]:e.child})}}},135:r=>{function e(t){return!!t.constructor&&typeof t.constructor.isBuffer=="function"&&t.constructor.isBuffer(t)}r.exports=function(t){return t!=null&&(e(t)||function(s){return typeof s.readFloatLE=="function"&&typeof s.slice=="function"&&e(s.slice(0,0))}(t)||!!t._isBuffer)}},542:(r,e,t)=>{(function(){var s=t(298),a=t(526).utf8,u=t(135),c=t(526).bin,i=function(o,n){o.constructor==String?o=n&&n.encoding==="binary"?c.stringToBytes(o):a.stringToBytes(o):u(o)?o=Array.prototype.slice.call(o,0):Array.isArray(o)||o.constructor===Uint8Array||(o=o.toString());for(var l=s.bytesToWords(o),m=8*o.length,h=1732584193,g=-271733879,p=-1732584194,w=271733878,b=0;b<l.length;b++)l[b]=16711935&(l[b]<<8|l[b]>>>24)|4278255360&(l[b]<<24|l[b]>>>8);l[m>>>5]|=128<<m%32,l[14+(m+64>>>9<<4)]=m;var d=i._ff,f=i._gg,A=i._hh,C=i._ii;for(b=0;b<l.length;b+=16){var S=h,v=g,E=p,k=w;h=d(h,g,p,w,l[b+0],7,-680876936),w=d(w,h,g,p,l[b+1],12,-389564586),p=d(p,w,h,g,l[b+2],17,606105819),g=d(g,p,w,h,l[b+3],22,-1044525330),h=d(h,g,p,w,l[b+4],7,-176418897),w=d(w,h,g,p,l[b+5],12,1200080426),p=d(p,w,h,g,l[b+6],17,-1473231341),g=d(g,p,w,h,l[b+7],22,-45705983),h=d(h,g,p,w,l[b+8],7,1770035416),w=d(w,h,g,p,l[b+9],12,-1958414417),p=d(p,w,h,g,l[b+10],17,-42063),g=d(g,p,w,h,l[b+11],22,-1990404162),h=d(h,g,p,w,l[b+12],7,1804603682),w=d(w,h,g,p,l[b+13],12,-40341101),p=d(p,w,h,g,l[b+14],17,-1502002290),h=f(h,g=d(g,p,w,h,l[b+15],22,1236535329),p,w,l[b+1],5,-165796510),w=f(w,h,g,p,l[b+6],9,-1069501632),p=f(p,w,h,g,l[b+11],14,643717713),g=f(g,p,w,h,l[b+0],20,-373897302),h=f(h,g,p,w,l[b+5],5,-701558691),w=f(w,h,g,p,l[b+10],9,38016083),p=f(p,w,h,g,l[b+15],14,-660478335),g=f(g,p,w,h,l[b+4],20,-405537848),h=f(h,g,p,w,l[b+9],5,568446438),w=f(w,h,g,p,l[b+14],9,-1019803690),p=f(p,w,h,g,l[b+3],14,-187363961),g=f(g,p,w,h,l[b+8],20,1163531501),h=f(h,g,p,w,l[b+13],5,-1444681467),w=f(w,h,g,p,l[b+2],9,-51403784),p=f(p,w,h,g,l[b+7],14,1735328473),h=A(h,g=f(g,p,w,h,l[b+12],20,-1926607734),p,w,l[b+5],4,-378558),w=A(w,h,g,p,l[b+8],11,-2022574463),p=A(p,w,h,g,l[b+11],16,1839030562),g=A(g,p,w,h,l[b+14],23,-35309556),h=A(h,g,p,w,l[b+1],4,-1530992060),w=A(w,h,g,p,l[b+4],11,1272893353),p=A(p,w,h,g,l[b+7],16,-155497632),g=A(g,p,w,h,l[b+10],23,-1094730640),h=A(h,g,p,w,l[b+13],4,681279174),w=A(w,h,g,p,l[b+0],11,-358537222),p=A(p,w,h,g,l[b+3],16,-722521979),g=A(g,p,w,h,l[b+6],23,76029189),h=A(h,g,p,w,l[b+9],4,-640364487),w=A(w,h,g,p,l[b+12],11,-421815835),p=A(p,w,h,g,l[b+15],16,530742520),h=C(h,g=A(g,p,w,h,l[b+2],23,-995338651),p,w,l[b+0],6,-198630844),w=C(w,h,g,p,l[b+7],10,1126891415),p=C(p,w,h,g,l[b+14],15,-1416354905),g=C(g,p,w,h,l[b+5],21,-57434055),h=C(h,g,p,w,l[b+12],6,1700485571),w=C(w,h,g,p,l[b+3],10,-1894986606),p=C(p,w,h,g,l[b+10],15,-1051523),g=C(g,p,w,h,l[b+1],21,-2054922799),h=C(h,g,p,w,l[b+8],6,1873313359),w=C(w,h,g,p,l[b+15],10,-30611744),p=C(p,w,h,g,l[b+6],15,-1560198380),g=C(g,p,w,h,l[b+13],21,1309151649),h=C(h,g,p,w,l[b+4],6,-145523070),w=C(w,h,g,p,l[b+11],10,-1120210379),p=C(p,w,h,g,l[b+2],15,718787259),g=C(g,p,w,h,l[b+9],21,-343485551),h=h+S>>>0,g=g+v>>>0,p=p+E>>>0,w=w+k>>>0}return s.endian([h,g,p,w])};i._ff=function(o,n,l,m,h,g,p){var w=o+(n&l|~n&m)+(h>>>0)+p;return(w<<g|w>>>32-g)+n},i._gg=function(o,n,l,m,h,g,p){var w=o+(n&m|l&~m)+(h>>>0)+p;return(w<<g|w>>>32-g)+n},i._hh=function(o,n,l,m,h,g,p){var w=o+(n^l^m)+(h>>>0)+p;return(w<<g|w>>>32-g)+n},i._ii=function(o,n,l,m,h,g,p){var w=o+(l^(n|~m))+(h>>>0)+p;return(w<<g|w>>>32-g)+n},i._blocksize=16,i._digestsize=16,r.exports=function(o,n){if(o==null)throw new Error("Illegal argument "+o);var l=s.wordsToBytes(i(o,n));return n&&n.asBytes?l:n&&n.asString?c.bytesToString(l):s.bytesToHex(l)}})()},285:(r,e,t)=>{var s=t(2);r.exports=function(d){return d?(d.substr(0,2)==="{}"&&(d="\\{\\}"+d.substr(2)),b(function(f){return f.split("\\\\").join(a).split("\\{").join(u).split("\\}").join(c).split("\\,").join(i).split("\\.").join(o)}(d),!0).map(l)):[]};var a="\0SLASH"+Math.random()+"\0",u="\0OPEN"+Math.random()+"\0",c="\0CLOSE"+Math.random()+"\0",i="\0COMMA"+Math.random()+"\0",o="\0PERIOD"+Math.random()+"\0";function n(d){return parseInt(d,10)==d?parseInt(d,10):d.charCodeAt(0)}function l(d){return d.split(a).join("\\").split(u).join("{").split(c).join("}").split(i).join(",").split(o).join(".")}function m(d){if(!d)return[""];var f=[],A=s("{","}",d);if(!A)return d.split(",");var C=A.pre,S=A.body,v=A.post,E=C.split(",");E[E.length-1]+="{"+S+"}";var k=m(v);return v.length&&(E[E.length-1]+=k.shift(),E.push.apply(E,k)),f.push.apply(f,E),f}function h(d){return"{"+d+"}"}function g(d){return/^-?0\d/.test(d)}function p(d,f){return d<=f}function w(d,f){return d>=f}function b(d,f){var A=[],C=s("{","}",d);if(!C)return[d];var S=C.pre,v=C.post.length?b(C.post,!1):[""];if(/\$$/.test(C.pre))for(var E=0;E<v.length;E++){var k=S+"{"+C.body+"}"+v[E];A.push(k)}else{var x,V,O=/^-?\d+\.\.-?\d+(?:\.\.-?\d+)?$/.test(C.body),P=/^[a-zA-Z]\.\.[a-zA-Z](?:\.\.-?\d+)?$/.test(C.body),B=O||P,L=C.body.indexOf(",")>=0;if(!B&&!L)return C.post.match(/,.*\}/)?b(d=C.pre+"{"+C.body+c+C.post):[d];if(B)x=C.body.split(/\.\./);else if((x=m(C.body)).length===1&&(x=b(x[0],!1).map(h)).length===1)return v.map(function(Gt){return C.pre+x[0]+Gt});if(B){var H=n(x[0]),z=n(x[1]),re=Math.max(x[0].length,x[1].length),_=x.length==3?Math.abs(n(x[2])):1,X=p;z<H&&(_*=-1,X=w);var J=x.some(g);V=[];for(var G=H;X(G,z);G+=_){var q;if(P)(q=String.fromCharCode(G))==="\\"&&(q="");else if(q=String(G),J){var se=re-q.length;if(se>0){var oe=new Array(se+1).join("0");q=G<0?"-"+oe+q.slice(1):oe+q}}V.push(q)}}else{V=[];for(var xe=0;xe<x.length;xe++)V.push.apply(V,b(x[xe],!1))}for(xe=0;xe<V.length;xe++)for(E=0;E<v.length;E++)k=S+V[xe]+v[E],(!f||B||k)&&A.push(k)}return A}},829:r=>{function e(n){return e=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(l){return typeof l}:function(l){return l&&typeof Symbol=="function"&&l.constructor===Symbol&&l!==Symbol.prototype?"symbol":typeof l},e(n)}function t(n){var l=typeof Map=="function"?new Map:void 0;return t=function(m){if(m===null||(h=m,Function.toString.call(h).indexOf("[native code]")===-1))return m;var h;if(typeof m!="function")throw new TypeError("Super expression must either be null or a function");if(l!==void 0){if(l.has(m))return l.get(m);l.set(m,g)}function g(){return s(m,arguments,u(this).constructor)}return g.prototype=Object.create(m.prototype,{constructor:{value:g,enumerable:!1,writable:!0,configurable:!0}}),a(g,m)},t(n)}function s(n,l,m){return s=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}()?Reflect.construct:function(h,g,p){var w=[null];w.push.apply(w,g);var b=new(Function.bind.apply(h,w));return p&&a(b,p.prototype),b},s.apply(null,arguments)}function a(n,l){return a=Object.setPrototypeOf||function(m,h){return m.__proto__=h,m},a(n,l)}function u(n){return u=Object.setPrototypeOf?Object.getPrototypeOf:function(l){return l.__proto__||Object.getPrototypeOf(l)},u(n)}var c=function(n){function l(m){var h;return function(g,p){if(!(g instanceof p))throw new TypeError("Cannot call a class as a function")}(this,l),(h=function(g,p){return!p||e(p)!=="object"&&typeof p!="function"?function(w){if(w===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return w}(g):p}(this,u(l).call(this,m))).name="ObjectPrototypeMutationError",h}return function(m,h){if(typeof h!="function"&&h!==null)throw new TypeError("Super expression must either be null or a function");m.prototype=Object.create(h&&h.prototype,{constructor:{value:m,writable:!0,configurable:!0}}),h&&a(m,h)}(l,n),l}(t(Error));function i(n,l){for(var m=arguments.length>2&&arguments[2]!==void 0?arguments[2]:function(){},h=l.split("."),g=h.length,p=function(d){var f=h[d];if(!n)return{v:void 0};if(f==="+"){if(Array.isArray(n))return{v:n.map(function(C,S){var v=h.slice(d+1);return v.length>0?i(C,v.join("."),m):m(n,S,h,d)})};var A=h.slice(0,d).join(".");throw new Error("Object at wildcard (".concat(A,") is not an array"))}n=m(n,f,h,d)},w=0;w<g;w++){var b=p(w);if(e(b)==="object")return b.v}return n}function o(n,l){return n.length===l+1}r.exports={set:function(n,l,m){if(e(n)!="object"||n===null||l===void 0)return n;if(typeof l=="number")return n[l]=m,n[l];try{return i(n,l,function(h,g,p,w){if(h===Reflect.getPrototypeOf({}))throw new c("Attempting to mutate Object.prototype");if(!h[g]){var b=Number.isInteger(Number(p[w+1])),d=p[w+1]==="+";h[g]=b||d?[]:{}}return o(p,w)&&(h[g]=m),h[g]})}catch(h){if(h instanceof c)throw h;return n}},get:function(n,l){if(e(n)!="object"||n===null||l===void 0)return n;if(typeof l=="number")return n[l];try{return i(n,l,function(m,h){return m[h]})}catch(m){return n}},has:function(n,l){var m=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(e(n)!="object"||n===null||l===void 0)return!1;if(typeof l=="number")return l in n;try{var h=!1;return i(n,l,function(g,p,w,b){if(!o(w,b))return g&&g[p];h=m.own?g.hasOwnProperty(p):p in g}),h}catch(g){return!1}},hasOwn:function(n,l,m){return this.has(n,l,m||{own:!0})},isIn:function(n,l,m){var h=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};if(e(n)!="object"||n===null||l===void 0)return!1;try{var g=!1,p=!1;return i(n,l,function(w,b,d,f){return g=g||w===m||!!w&&w[b]===m,p=o(d,f)&&e(w)==="object"&&b in w,w&&w[b]}),h.validPath?g&&p:g}catch(w){return!1}},ObjectPrototypeMutationError:c}},47:(r,e,t)=>{var s=t(410),a=function(n){return typeof n=="string"};function u(n,l){for(var m=[],h=0;h<n.length;h++){var g=n[h];g&&g!=="."&&(g===".."?m.length&&m[m.length-1]!==".."?m.pop():l&&m.push(".."):m.push(g))}return m}var c=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,i={};function o(n){return c.exec(n).slice(1)}i.resolve=function(){for(var n="",l=!1,m=arguments.length-1;m>=-1&&!l;m--){var h=m>=0?arguments[m]:We.cwd();if(!a(h))throw new TypeError("Arguments to path.resolve must be strings");h&&(n=h+"/"+n,l=h.charAt(0)==="/")}return(l?"/":"")+(n=u(n.split("/"),!l).join("/"))||"."},i.normalize=function(n){var l=i.isAbsolute(n),m=n.substr(-1)==="/";return(n=u(n.split("/"),!l).join("/"))||l||(n="."),n&&m&&(n+="/"),(l?"/":"")+n},i.isAbsolute=function(n){return n.charAt(0)==="/"},i.join=function(){for(var n="",l=0;l<arguments.length;l++){var m=arguments[l];if(!a(m))throw new TypeError("Arguments to path.join must be strings");m&&(n+=n?"/"+m:m)}return i.normalize(n)},i.relative=function(n,l){function m(f){for(var A=0;A<f.length&&f[A]==="";A++);for(var C=f.length-1;C>=0&&f[C]==="";C--);return A>C?[]:f.slice(A,C+1)}n=i.resolve(n).substr(1),l=i.resolve(l).substr(1);for(var h=m(n.split("/")),g=m(l.split("/")),p=Math.min(h.length,g.length),w=p,b=0;b<p;b++)if(h[b]!==g[b]){w=b;break}var d=[];for(b=w;b<h.length;b++)d.push("..");return(d=d.concat(g.slice(w))).join("/")},i._makeLong=function(n){return n},i.dirname=function(n){var l=o(n),m=l[0],h=l[1];return m||h?(h&&(h=h.substr(0,h.length-1)),m+h):"."},i.basename=function(n,l){var m=o(n)[2];return l&&m.substr(-1*l.length)===l&&(m=m.substr(0,m.length-l.length)),m},i.extname=function(n){return o(n)[3]},i.format=function(n){if(!s.isObject(n))throw new TypeError("Parameter 'pathObject' must be an object, not "+typeof n);var l=n.root||"";if(!a(l))throw new TypeError("'pathObject.root' must be a string or undefined, not "+typeof n.root);return(n.dir?n.dir+i.sep:"")+(n.base||"")},i.parse=function(n){if(!a(n))throw new TypeError("Parameter 'pathString' must be a string, not "+typeof n);var l=o(n);if(!l||l.length!==4)throw new TypeError("Invalid path '"+n+"'");return l[1]=l[1]||"",l[2]=l[2]||"",l[3]=l[3]||"",{root:l[0],dir:l[0]+l[1].slice(0,l[1].length-1),base:l[2],ext:l[3],name:l[2].slice(0,l[2].length-l[3].length)}},i.sep="/",i.delimiter=":",r.exports=i},647:(r,e)=>{var t=Object.prototype.hasOwnProperty;function s(u){try{return decodeURIComponent(u.replace(/\+/g," "))}catch(c){return null}}function a(u){try{return encodeURIComponent(u)}catch(c){return null}}e.stringify=function(u,c){c=c||"";var i,o,n=[];for(o in typeof c!="string"&&(c="?"),u)if(t.call(u,o)){if((i=u[o])||i!=null&&!isNaN(i)||(i=""),o=a(o),i=a(i),o===null||i===null)continue;n.push(o+"="+i)}return n.length?c+n.join("&"):""},e.parse=function(u){for(var c,i=/([^=?#&]+)=?([^&]*)/g,o={};c=i.exec(u);){var n=s(c[1]),l=s(c[2]);n===null||l===null||n in o||(o[n]=l)}return o}},670:r=>{r.exports=function(e,t){if(t=t.split(":")[0],!(e=+e))return!1;switch(t){case"http":case"ws":return e!==80;case"https":case"wss":return e!==443;case"ftp":return e!==21;case"gopher":return e!==70;case"file":return!1}return e!==0}},494:r=>{const e=/^[-+]?0x[a-fA-F0-9]+$/,t=/^([\-\+])?(0*)(\.[0-9]+([eE]\-?[0-9]+)?|[0-9]+(\.[0-9]+([eE]\-?[0-9]+)?)?)$/;!Number.parseInt&&window.parseInt&&(Number.parseInt=window.parseInt),!Number.parseFloat&&window.parseFloat&&(Number.parseFloat=window.parseFloat);const s={hex:!0,leadingZeros:!0,decimalPoint:".",eNotation:!0};r.exports=function(a){let u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(u=Object.assign({},s,u),!a||typeof a!="string")return a;let c=a.trim();if(u.skipLike!==void 0&&u.skipLike.test(c))return a;if(u.hex&&e.test(c))return Number.parseInt(c,16);{const o=t.exec(c);if(o){const n=o[1],l=o[2];let m=((i=o[3])&&i.indexOf(".")!==-1&&((i=i.replace(/0+$/,""))==="."?i="0":i[0]==="."?i="0"+i:i[i.length-1]==="."&&(i=i.substr(0,i.length-1))),i);const h=o[4]||o[6];if(!u.leadingZeros&&l.length>0&&n&&c[2]!=="."||!u.leadingZeros&&l.length>0&&!n&&c[1]!==".")return a;{const g=Number(c),p=""+g;return p.search(/[eE]/)!==-1||h?u.eNotation?g:a:c.indexOf(".")!==-1?p==="0"&&m===""||p===m||n&&p==="-"+m?g:a:l?m===p||n+m===p?g:a:c===p||c===n+p?g:a}}return a}var i}},737:(r,e,t)=>{var s=t(670),a=t(647),u=/^[\x00-\x20\u00a0\u1680\u2000-\u200a\u2028\u2029\u202f\u205f\u3000\ufeff]+/,c=/[\n\r\t]/g,i=/^[A-Za-z][A-Za-z0-9+-.]*:\/\//,o=/:\d+$/,n=/^([a-z][a-z0-9.+-]*:)?(\/\/)?([\\/]+)?([\S\s]*)/i,l=/^[a-zA-Z]:/;function m(f){return(f||"").toString().replace(u,"")}var h=[["#","hash"],["?","query"],function(f,A){return w(A.protocol)?f.replace(/\\/g,"/"):f},["/","pathname"],["@","auth",1],[NaN,"host",void 0,1,1],[/:(\d*)$/,"port",void 0,1],[NaN,"hostname",void 0,1,1]],g={hash:1,query:1};function p(f){var A,C=(typeof window<"u"?window:typeof Ct<"u"?Ct:typeof self<"u"?self:{}).location||{},S={},v=typeof(f=f||C);if(f.protocol==="blob:")S=new d(unescape(f.pathname),{});else if(v==="string")for(A in S=new d(f,{}),g)delete S[A];else if(v==="object"){for(A in f)A in g||(S[A]=f[A]);S.slashes===void 0&&(S.slashes=i.test(f.href))}return S}function w(f){return f==="file:"||f==="ftp:"||f==="http:"||f==="https:"||f==="ws:"||f==="wss:"}function b(f,A){f=(f=m(f)).replace(c,""),A=A||{};var C,S=n.exec(f),v=S[1]?S[1].toLowerCase():"",E=!!S[2],k=!!S[3],x=0;return E?k?(C=S[2]+S[3]+S[4],x=S[2].length+S[3].length):(C=S[2]+S[4],x=S[2].length):k?(C=S[3]+S[4],x=S[3].length):C=S[4],v==="file:"?x>=2&&(C=C.slice(2)):w(v)?C=S[4]:v?E&&(C=C.slice(2)):x>=2&&w(A.protocol)&&(C=S[4]),{protocol:v,slashes:E||w(v),slashesCount:x,rest:C}}function d(f,A,C){if(f=(f=m(f)).replace(c,""),!(this instanceof d))return new d(f,A,C);var S,v,E,k,x,V,O=h.slice(),P=typeof A,B=this,L=0;for(P!=="object"&&P!=="string"&&(C=A,A=null),C&&typeof C!="function"&&(C=a.parse),S=!(v=b(f||"",A=p(A))).protocol&&!v.slashes,B.slashes=v.slashes||S&&A.slashes,B.protocol=v.protocol||A.protocol||"",f=v.rest,(v.protocol==="file:"&&(v.slashesCount!==2||l.test(f))||!v.slashes&&(v.protocol||v.slashesCount<2||!w(B.protocol)))&&(O[3]=[/(.*)/,"pathname"]);L<O.length;L++)typeof(k=O[L])!="function"?(E=k[0],V=k[1],E!=E?B[V]=f:typeof E=="string"?~(x=E==="@"?f.lastIndexOf(E):f.indexOf(E))&&(typeof k[2]=="number"?(B[V]=f.slice(0,x),f=f.slice(x+k[2])):(B[V]=f.slice(x),f=f.slice(0,x))):(x=E.exec(f))&&(B[V]=x[1],f=f.slice(0,x.index)),B[V]=B[V]||S&&k[3]&&A[V]||"",k[4]&&(B[V]=B[V].toLowerCase())):f=k(f,B);C&&(B.query=C(B.query)),S&&A.slashes&&B.pathname.charAt(0)!=="/"&&(B.pathname!==""||A.pathname!=="")&&(B.pathname=function(H,z){if(H==="")return z;for(var re=(z||"/").split("/").slice(0,-1).concat(H.split("/")),_=re.length,X=re[_-1],J=!1,G=0;_--;)re[_]==="."?re.splice(_,1):re[_]===".."?(re.splice(_,1),G++):G&&(_===0&&(J=!0),re.splice(_,1),G--);return J&&re.unshift(""),X!=="."&&X!==".."||re.push(""),re.join("/")}(B.pathname,A.pathname)),B.pathname.charAt(0)!=="/"&&w(B.protocol)&&(B.pathname="/"+B.pathname),s(B.port,B.protocol)||(B.host=B.hostname,B.port=""),B.username=B.password="",B.auth&&(~(x=B.auth.indexOf(":"))?(B.username=B.auth.slice(0,x),B.username=encodeURIComponent(decodeURIComponent(B.username)),B.password=B.auth.slice(x+1),B.password=encodeURIComponent(decodeURIComponent(B.password))):B.username=encodeURIComponent(decodeURIComponent(B.auth)),B.auth=B.password?B.username+":"+B.password:B.username),B.origin=B.protocol!=="file:"&&w(B.protocol)&&B.host?B.protocol+"//"+B.host:"null",B.href=B.toString()}d.prototype={set:function(f,A,C){var S=this;switch(f){case"query":typeof A=="string"&&A.length&&(A=(C||a.parse)(A)),S[f]=A;break;case"port":S[f]=A,s(A,S.protocol)?A&&(S.host=S.hostname+":"+A):(S.host=S.hostname,S[f]="");break;case"hostname":S[f]=A,S.port&&(A+=":"+S.port),S.host=A;break;case"host":S[f]=A,o.test(A)?(A=A.split(":"),S.port=A.pop(),S.hostname=A.join(":")):(S.hostname=A,S.port="");break;case"protocol":S.protocol=A.toLowerCase(),S.slashes=!C;break;case"pathname":case"hash":if(A){var v=f==="pathname"?"/":"#";S[f]=A.charAt(0)!==v?v+A:A}else S[f]=A;break;case"username":case"password":S[f]=encodeURIComponent(A);break;case"auth":var E=A.indexOf(":");~E?(S.username=A.slice(0,E),S.username=encodeURIComponent(decodeURIComponent(S.username)),S.password=A.slice(E+1),S.password=encodeURIComponent(decodeURIComponent(S.password))):S.username=encodeURIComponent(decodeURIComponent(A))}for(var k=0;k<h.length;k++){var x=h[k];x[4]&&(S[x[1]]=S[x[1]].toLowerCase())}return S.auth=S.password?S.username+":"+S.password:S.username,S.origin=S.protocol!=="file:"&&w(S.protocol)&&S.host?S.protocol+"//"+S.host:"null",S.href=S.toString(),S},toString:function(f){f&&typeof f=="function"||(f=a.stringify);var A,C=this,S=C.host,v=C.protocol;v&&v.charAt(v.length-1)!==":"&&(v+=":");var E=v+(C.protocol&&C.slashes||w(C.protocol)?"//":"");return C.username?(E+=C.username,C.password&&(E+=":"+C.password),E+="@"):C.password?(E+=":"+C.password,E+="@"):C.protocol!=="file:"&&w(C.protocol)&&!S&&C.pathname!=="/"&&(E+="@"),(S[S.length-1]===":"||o.test(C.hostname)&&!C.port)&&(S+=":"),E+=S+C.pathname,(A=typeof C.query=="object"?f(C.query):C.query)&&(E+=A.charAt(0)!=="?"?"?"+A:A),C.hash&&(E+=C.hash),E}},d.extractProtocol=b,d.location=p,d.trimLeft=m,d.qs=a,r.exports=d},410:()=>{},388:()=>{},805:()=>{},345:()=>{},800:()=>{}},Jp={};function de(r){var e=Jp[r];if(e!==void 0)return e.exports;var t=Jp[r]={id:r,loaded:!1,exports:{}};return Ny[r].call(t.exports,t,t.exports,de),t.loaded=!0,t.exports}de.n=r=>{var e=r&&r.__esModule?()=>r.default:()=>r;return de.d(e,{a:e}),e},de.d=(r,e)=>{for(var t in e)de.o(e,t)&&!de.o(r,t)&&Object.defineProperty(r,t,{enumerable:!0,get:e[t]})},de.o=(r,e)=>Object.prototype.hasOwnProperty.call(r,e),de.nmd=r=>(r.paths=[],r.children||(r.children=[]),r);var Wt={};de.d(Wt,{hT:()=>yt,O4:()=>Ms,Kd:()=>By,YK:()=>Dy,UU:()=>Uv,Gu:()=>$g,ky:()=>Xg,h4:()=>rc,ch:()=>Fh,hq:()=>Pn,i5:()=>zg});var ky=de(737),Ey=de.n(ky);function Yh(r){if(!Ef(r))throw new Error("Parameter was not an error")}function Ef(r){return!!r&&typeof r=="object"&&(e=r,Object.prototype.toString.call(e)==="[object Error]")||r instanceof Error;var e}class St extends Error{constructor(e,t){const s=[...arguments],{options:a,shortMessage:u}=function(i){let o,n="";if(i.length===0)o={};else if(Ef(i[0]))o={cause:i[0]},n=i.slice(1).join(" ")||"";else if(i[0]&&typeof i[0]=="object")o=Object.assign({},i[0]),n=i.slice(1).join(" ")||"";else{if(typeof i[0]!="string")throw new Error("Invalid arguments passed to Layerr");o={},n=n=i.join(" ")||""}return{options:o,shortMessage:n}}(s);let c=u;if(a.cause&&(c="".concat(c,": ").concat(a.cause.message)),super(c),this.message=c,a.name&&typeof a.name=="string"?this.name=a.name:this.name="Layerr",a.cause&&Object.defineProperty(this,"_cause",{value:a.cause}),Object.defineProperty(this,"_info",{value:{}}),a.info&&typeof a.info=="object"&&Object.assign(this._info,a.info),Error.captureStackTrace){const i=a.constructorOpt||this.constructor;Error.captureStackTrace(this,i)}}static cause(e){return Yh(e),e._cause&&Ef(e._cause)?e._cause:null}static fullStack(e){var s;Yh(e);const t=St.cause(e);return t?"".concat(e.stack,"\ncaused by: ").concat(St.fullStack(t)):(s=e.stack)!=null?s:""}static info(e){Yh(e);const t={},s=St.cause(e);return s&&Object.assign(t,St.info(s)),e._info&&Object.assign(t,e._info),t}toString(){let e=this.name||this.constructor.name||this.constructor.prototype.name;return this.message&&(e="".concat(e,": ").concat(this.message)),e}}var Cy=de(47),Sh=de.n(Cy);const qp="__PATH_SEPARATOR_POSIX__",Wp="__PATH_SEPARATOR_WINDOWS__";function Ee(r){try{const e=r.replace(/\//g,qp).replace(/\\\\/g,Wp);return encodeURIComponent(e).split(Wp).join("\\\\").split(qp).join("/")}catch(e){throw new St(e,"Failed encoding path")}}function Gp(r){return r.startsWith("/")?r:"/"+r}function _l(r){let e=r;return e[0]!=="/"&&(e="/"+e),/^.+\/$/.test(e)&&(e=e.substr(0,e.length-1)),e}function xy(r){let e=new(Ey())(r).pathname;return e.length<=0&&(e="/"),_l(e)}function Ce(){for(var r=arguments.length,e=new Array(r),t=0;t<r;t++)e[t]=arguments[t];return function(){return function(s){var a=[];if(s.length===0)return"";if(typeof s[0]!="string")throw new TypeError("Url must be a string. Received "+s[0]);if(s[0].match(/^[^/:]+:\/*$/)&&s.length>1){var u=s.shift();s[0]=u+s[0]}s[0].match(/^file:\/\/\//)?s[0]=s[0].replace(/^([^/:]+):\/*/,"$1:///"):s[0]=s[0].replace(/^([^/:]+):\/*/,"$1://");for(var c=0;c<s.length;c++){var i=s[c];if(typeof i!="string")throw new TypeError("Url must be a string. Received "+i);i!==""&&(c>0&&(i=i.replace(/^[\/]+/,"")),i=c<s.length-1?i.replace(/[\/]+$/,""):i.replace(/[\/]+$/,"/"),a.push(i))}var o=a.join("/"),n=(o=o.replace(/\/(\?|&|#[^!])/g,"$1")).split("?");return n.shift()+(n.length>0?"?":"")+n.join("&")}(typeof arguments[0]=="object"?arguments[0]:[].slice.call(arguments))}(e.reduce((s,a,u)=>((u===0||a!=="/"||a==="/"&&s[s.length-1]!=="/")&&s.push(a),s),[]))}var Iy=de(542),Io=de.n(Iy);const Vy="abcdef0123456789";function _p(r,e){const t=r.url.replace("//",""),s=t.indexOf("/")==-1?"/":t.slice(t.indexOf("/")),a=r.method?r.method.toUpperCase():"GET",u=!!/(^|,)\s*auth\s*($|,)/.test(e.qop)&&"auth",c="00000000".concat(e.nc).slice(-8),i=function(h,g,p,w,b,d,f){const A=f||Io()("".concat(g,":").concat(p,":").concat(w));return h&&h.toLowerCase()==="md5-sess"?Io()("".concat(A,":").concat(b,":").concat(d)):A}(e.algorithm,e.username,e.realm,e.password,e.nonce,e.cnonce,e.ha1),o=Io()("".concat(a,":").concat(s)),n=u?Io()("".concat(i,":").concat(e.nonce,":").concat(c,":").concat(e.cnonce,":").concat(u,":").concat(o)):Io()("".concat(i,":").concat(e.nonce,":").concat(o)),l={username:e.username,realm:e.realm,nonce:e.nonce,uri:s,qop:u,response:n,nc:c,cnonce:e.cnonce,algorithm:e.algorithm,opaque:e.opaque},m=[];for(const h in l)l[h]&&(h==="qop"||h==="nc"||h==="algorithm"?m.push("".concat(h,"=").concat(l[h])):m.push("".concat(h,'="').concat(l[h],'"')));return"Digest ".concat(m.join(", "))}function Rg(r){return(r.headers&&r.headers.get("www-authenticate")||"").split(/\s/)[0].toLowerCase()==="digest"}var Py=de(101),Lg=de.n(Py);function Xp(r){return Lg().decode(r)}function zp(r,e){var t;return"Basic ".concat((t="".concat(r,":").concat(e),Lg().encode(t)))}const Ah=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope?self:typeof window<"u"?window:globalThis,Oy=Ah.fetch.bind(Ah),By=Ah.Request,Dy=Ah.Response;let yt=function(r){return r.Auto="auto",r.Digest="digest",r.None="none",r.Password="password",r.Token="token",r}({}),Ms=function(r){return r.DataTypeNoLength="data-type-no-length",r.InvalidAuthType="invalid-auth-type",r.InvalidOutputFormat="invalid-output-format",r.LinkUnsupportedAuthType="link-unsupported-auth",r.InvalidUpdateRange="invalid-update-range",r.NotSupported="not-supported",r}({});function jg(r,e,t,s,a){switch(r.authType){case yt.Auto:e&&t&&(r.headers.Authorization=zp(e,t));break;case yt.Digest:r.digest=function(c,i,o){return{username:c,password:i,ha1:o,nc:0,algorithm:"md5",hasDigestAuth:!1}}(e,t,a);break;case yt.None:break;case yt.Password:r.headers.Authorization=zp(e,t);break;case yt.Token:r.headers.Authorization="".concat((u=s).token_type," ").concat(u.access_token);break;default:throw new St({info:{code:Ms.InvalidAuthType}},"Invalid auth type: ".concat(r.authType))}var u}de(345),de(800);const Qp="@@HOTPATCHER",Ty=()=>{};function Zh(r){return{original:r,methods:[r],final:!1}}class Ry{constructor(){this._configuration={registry:{},getEmptyAction:"null"},this.__type__=Qp}get configuration(){return this._configuration}get getEmptyAction(){return this.configuration.getEmptyAction}set getEmptyAction(e){this.configuration.getEmptyAction=e}control(e){let t=arguments.length>1&&arguments[1]!==void 0&&arguments[1];if(!e||e.__type__!==Qp)throw new Error("Failed taking control of target HotPatcher instance: Invalid type or object");return Object.keys(e.configuration.registry).forEach(s=>{this.configuration.registry.hasOwnProperty(s)?t&&(this.configuration.registry[s]=Object.assign({},e.configuration.registry[s])):this.configuration.registry[s]=Object.assign({},e.configuration.registry[s])}),e._configuration=this.configuration,this}execute(e){const t=this.get(e)||Ty;for(var s=arguments.length,a=new Array(s>1?s-1:0),u=1;u<s;u++)a[u-1]=arguments[u];return t(...a)}get(e){const t=this.configuration.registry[e];if(!t)switch(this.getEmptyAction){case"null":return null;case"throw":throw new Error("Failed handling method request: No method provided for override: ".concat(e));default:throw new Error("Failed handling request which resulted in an empty method: Invalid empty-action specified: ".concat(this.getEmptyAction))}return function(){for(var s=arguments.length,a=new Array(s),u=0;u<s;u++)a[u]=arguments[u];if(a.length===0)throw new Error("Failed creating sequence: No functions provided");return function(){for(var c=arguments.length,i=new Array(c),o=0;o<c;o++)i[o]=arguments[o];let n=i;const l=this;for(;a.length>0;)n=[a.shift().apply(l,n)];return n[0]}}(...t.methods)}isPatched(e){return!!this.configuration.registry[e]}patch(e,t){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const{chain:a=!1}=s;if(this.configuration.registry[e]&&this.configuration.registry[e].final)throw new Error("Failed patching '".concat(e,"': Method marked as being final"));if(typeof t!="function")throw new Error("Failed patching '".concat(e,"': Provided method is not a function"));if(a)this.configuration.registry[e]?this.configuration.registry[e].methods.push(t):this.configuration.registry[e]=Zh(t);else if(this.isPatched(e)){const{original:u}=this.configuration.registry[e];this.configuration.registry[e]=Object.assign(Zh(t),{original:u})}else this.configuration.registry[e]=Zh(t);return this}patchInline(e,t){this.isPatched(e)||this.patch(e,t);for(var s=arguments.length,a=new Array(s>2?s-2:0),u=2;u<s;u++)a[u-2]=arguments[u];return this.execute(e,...a)}plugin(e){for(var t=arguments.length,s=new Array(t>1?t-1:0),a=1;a<t;a++)s[a-1]=arguments[a];return s.forEach(u=>{this.patch(e,u,{chain:!0})}),this}restore(e){if(!this.isPatched(e))throw new Error("Failed restoring method: No method present for key: ".concat(e));if(typeof this.configuration.registry[e].original!="function")throw new Error("Failed restoring method: Original method not found or of invalid type for key: ".concat(e));return this.configuration.registry[e].methods=[this.configuration.registry[e].original],this}setFinal(e){if(!this.configuration.registry.hasOwnProperty(e))throw new Error("Failed marking '".concat(e,"' as final: No method found for key"));return this.configuration.registry[e].final=!0,this}}let em=null;function $g(){return em||(em=new Ry),em}function Nh(r){return function(e){if(typeof e!="object"||e===null||Object.prototype.toString.call(e)!="[object Object]")return!1;if(Object.getPrototypeOf(e)===null)return!0;let t=e;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}(r)?Object.assign({},r):Object.setPrototypeOf(Object.assign({},r),Object.getPrototypeOf(r))}function Yp(){for(var r=arguments.length,e=new Array(r),t=0;t<r;t++)e[t]=arguments[t];let s=null,a=[...e];for(;a.length>0;){const u=a.shift();s=s?Ug(s,u):Nh(u)}return s}function Ug(r,e){const t=Nh(r);return Object.keys(e).forEach(s=>{t.hasOwnProperty(s)?Array.isArray(e[s])?t[s]=Array.isArray(t[s])?[...t[s],...e[s]]:[...e[s]]:typeof e[s]=="object"&&e[s]?t[s]=typeof t[s]=="object"&&t[s]?Ug(t[s],e[s]):Nh(e[s]):t[s]=e[s]:t[s]=e[s]}),t}function Ly(r){const e={};for(const t of r.keys())e[t]=r.get(t);return e}function Cf(){for(var r=arguments.length,e=new Array(r),t=0;t<r;t++)e[t]=arguments[t];if(e.length===0)return{};const s={};return e.reduce((a,u)=>(Object.keys(u).forEach(c=>{const i=c.toLowerCase();s.hasOwnProperty(i)?a[s[i]]=u[c]:(s[i]=c,a[c]=u[c])}),a),{})}de(805);const jy=typeof ArrayBuffer=="function",{toString:$y}=Object.prototype;function Kg(r){return jy&&(r instanceof ArrayBuffer||$y.call(r)==="[object ArrayBuffer]")}function Hg(r){return r!=null&&r.constructor!=null&&typeof r.constructor.isBuffer=="function"&&r.constructor.isBuffer(r)}function op(r){return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];try{return Promise.resolve(r.apply(this,e))}catch(s){return Promise.reject(s)}}}function xf(r,e,t){return t?e?e(r):r:(r&&r.then||(r=Promise.resolve(r)),e?r.then(e):r)}const Mg=op(function(r){const e=r._digest;return delete r._digest,e.hasDigestAuth&&(r=Yp(r,{headers:{Authorization:_p(r,e)}})),xf(kh(r),function(t){let s=!1;return a=function(c){return s?c:t},(u=function(){if(t.status==401)return e.hasDigestAuth=function(c,i){if(!Rg(c))return!1;const o=/([a-z0-9_-]+)=(?:"([^"]+)"|([a-z0-9_-]+))/gi;for(;;){const n=c.headers&&c.headers.get("www-authenticate")||"",l=o.exec(n);if(!l)break;i[l[1]]=l[2]||l[3]}return i.nc+=1,i.cnonce=function(){let n="";for(let l=0;l<32;++l)n="".concat(n).concat(Vy[Math.floor(16*Math.random())]);return n}(),!0}(t,e),function(){if(e.hasDigestAuth)return xf(kh(r=Yp(r,{headers:{Authorization:_p(r,e)}})),function(c){return c.status==401?e.hasDigestAuth=!1:e.nc++,s=!0,c})}();e.nc++}())&&u.then?u.then(a):a(u);var a,u})}),Uy=op(function(r,e){return xf(kh(r),function(t){return t.ok?(e.authType=yt.Password,t):t.status==401&&Rg(t)?(e.authType=yt.Digest,jg(e,e.username,e.password,void 0,void 0),r._digest=e.digest,Mg(r)):t})}),Xe=op(function(r,e){return e.authType===yt.Auto?Uy(r,e):r._digest?Mg(r):kh(r)});function ze(r,e,t){const s=Nh(r);return s.headers=Cf(e.headers,s.headers||{},t.headers||{}),t.data!==void 0&&(s.data=t.data),t.signal&&(s.signal=t.signal),e.httpAgent&&(s.httpAgent=e.httpAgent),e.httpsAgent&&(s.httpsAgent=e.httpsAgent),e.digest&&(s._digest=e.digest),typeof e.withCredentials=="boolean"&&(s.withCredentials=e.withCredentials),s}function kh(r){const e=$g();return e.patchInline("request",t=>e.patchInline("fetch",Oy,t.url,function(s){let a={};const u={method:s.method};if(s.headers&&(a=Cf(a,s.headers)),s.data!==void 0){const[c,i]=function(o){if(typeof o=="string")return[o,{}];if(Hg(o))return[o,{}];if(Kg(o))return[o,{}];if(o&&typeof o=="object")return[JSON.stringify(o),{"content-type":"application/json"}];throw new Error("Unable to convert request body: Unexpected body type: "+typeof o)}(s.data);u.body=c,a=Cf(a,i)}return s.signal&&(u.signal=s.signal),s.withCredentials&&(u.credentials="include"),u.headers=a,u}(t)),r)}var Ky=de(285);const Eh=r=>{if(typeof r!="string")throw new TypeError("invalid pattern");if(r.length>65536)throw new TypeError("pattern is too long")},Hy={"[:alnum:]":["\\p{L}\\p{Nl}\\p{Nd}",!0],"[:alpha:]":["\\p{L}\\p{Nl}",!0],"[:ascii:]":["\\x00-\\x7f",!1],"[:blank:]":["\\p{Zs}\\t",!0],"[:cntrl:]":["\\p{Cc}",!0],"[:digit:]":["\\p{Nd}",!0],"[:graph:]":["\\p{Z}\\p{C}",!0,!0],"[:lower:]":["\\p{Ll}",!0],"[:print:]":["\\p{C}",!0],"[:punct:]":["\\p{P}",!0],"[:space:]":["\\p{Z}\\t\\r\\n\\v\\f",!0],"[:upper:]":["\\p{Lu}",!0],"[:word:]":["\\p{L}\\p{Nl}\\p{Nd}\\p{Pc}",!0],"[:xdigit:]":["A-Fa-f0-9",!1]},Vo=r=>r.replace(/[[\]\\-]/g,"\\$&"),Zp=r=>r.join(""),My=(r,e)=>{const t=e;if(r.charAt(t)!=="[")throw new Error("not in a brace expression");const s=[],a=[];let u=t+1,c=!1,i=!1,o=!1,n=!1,l=t,m="";e:for(;u<r.length;){const w=r.charAt(u);if(w!=="!"&&w!=="^"||u!==t+1){if(w==="]"&&c&&!o){l=u+1;break}if(c=!0,w!=="\\"||o){if(w==="["&&!o){for(const[b,[d,f,A]]of Object.entries(Hy))if(r.startsWith(b,u)){if(m)return["$.",!1,r.length-t,!0];u+=b.length,A?a.push(d):s.push(d),i=i||f;continue e}}o=!1,m?(w>m?s.push(Vo(m)+"-"+Vo(w)):w===m&&s.push(Vo(w)),m="",u++):r.startsWith("-]",u+1)?(s.push(Vo(w+"-")),u+=2):r.startsWith("-",u+1)?(m=w,u+=2):(s.push(Vo(w)),u++)}else o=!0,u++}else n=!0,u++}if(l<u)return["",!1,0,!1];if(!s.length&&!a.length)return["$.",!1,r.length-t,!0];if(a.length===0&&s.length===1&&/^\\?.$/.test(s[0])&&!n)return[(h=s[0].length===2?s[0].slice(-1):s[0],h.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")),!1,l-t,!1];var h;const g="["+(n?"^":"")+Zp(s)+"]",p="["+(n?"":"^")+Zp(a)+"]";return[s.length&&a.length?"("+g+"|"+p+")":s.length?g:p,i,l-t,!0]},Jo=function(r){let{windowsPathsNoEscape:e=!1}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return e?r.replace(/\[([^\/\\])\]/g,"$1"):r.replace(/((?!\\).|^)\[([^\/\\])\]/g,"$1$2").replace(/\\([^\/])/g,"$1")},Fy=new Set(["!","?","+","*","@"]),ed=r=>Fy.has(r),tm="(?!\\.)",Jy=new Set(["[","."]),qy=new Set(["..","."]),Wy=new Set("().*{}+?[]^$\\!"),up="[^/]",td=up+"*?",sd=up+"+?";var qe,Ze,Ps,be,Ke,Jr,wn,qr,ls,yn,sc,Vn,Fg,sa,Uc,If,Jg;const ft=class ft{constructor(e,t){kt(this,Vn);Ue(this,"type");kt(this,qe);kt(this,Ze);kt(this,Ps,!1);kt(this,be,[]);kt(this,Ke);kt(this,Jr);kt(this,wn);kt(this,qr,!1);kt(this,ls);kt(this,yn);kt(this,sc,!1);let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};this.type=e,e&&Pe(this,Ze,!0),Pe(this,Ke,t),Pe(this,qe,F(this,Ke)?F(F(this,Ke),qe):this),Pe(this,ls,F(this,qe)===this?s:F(F(this,qe),ls)),Pe(this,wn,F(this,qe)===this?[]:F(F(this,qe),wn)),e!=="!"||F(F(this,qe),qr)||F(this,wn).push(this),Pe(this,Jr,F(this,Ke)?F(F(this,Ke),be).length:0)}get hasMagic(){if(F(this,Ze)!==void 0)return F(this,Ze);for(const e of F(this,be))if(typeof e!="string"&&(e.type||e.hasMagic))return Pe(this,Ze,!0);return F(this,Ze)}toString(){return F(this,yn)!==void 0?F(this,yn):this.type?Pe(this,yn,this.type+"("+F(this,be).map(e=>String(e)).join("|")+")"):Pe(this,yn,F(this,be).map(e=>String(e)).join(""))}push(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];for(const a of t)if(a!==""){if(typeof a!="string"&&!(a instanceof ft&&F(a,Ke)===this))throw new Error("invalid part: "+a);F(this,be).push(a)}}toJSON(){var t;const e=this.type===null?F(this,be).slice().map(s=>typeof s=="string"?s:s.toJSON()):[this.type,...F(this,be).map(s=>s.toJSON())];return this.isStart()&&!this.type&&e.unshift([]),this.isEnd()&&(this===F(this,qe)||F(F(this,qe),qr)&&((t=F(this,Ke))==null?void 0:t.type)==="!")&&e.push({}),e}isStart(){var t;if(F(this,qe)===this)return!0;if(!((t=F(this,Ke))!=null&&t.isStart()))return!1;if(F(this,Jr)===0)return!0;const e=F(this,Ke);for(let s=0;s<F(this,Jr);s++){const a=F(e,be)[s];if(!(a instanceof ft&&a.type==="!"))return!1}return!0}isEnd(){var t,s,a;if(F(this,qe)===this||((t=F(this,Ke))==null?void 0:t.type)==="!")return!0;if(!((s=F(this,Ke))!=null&&s.isEnd()))return!1;if(!this.type)return(a=F(this,Ke))==null?void 0:a.isEnd();const e=F(this,Ke)?F(F(this,Ke),be).length:0;return F(this,Jr)===e-1}copyIn(e){typeof e=="string"?this.push(e):this.push(e.clone(this))}clone(e){const t=new ft(this.type,e);for(const s of F(this,be))t.copyIn(s);return t}static fromGlob(e){var a;let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const s=new ft(null,void 0,t);return Ws(a=ft,sa,Uc).call(a,e,s,0,t),s}toMMPattern(){if(this!==F(this,qe))return F(this,qe).toMMPattern();const e=this.toString(),[t,s,a,u]=this.toRegExpSource();if(!(a||F(this,Ze)||F(this,ls).nocase&&!F(this,ls).nocaseMagicOnly&&e.toUpperCase()!==e.toLowerCase()))return s;const c=(F(this,ls).nocase?"i":"")+(u?"u":"");return Object.assign(new RegExp("^".concat(t,"$"),c),{_src:t,_glob:e})}get options(){return F(this,ls)}toRegExpSource(e){var o;const t=e!=null?e:!!F(this,ls).dot;if(F(this,qe)===this&&Ws(this,Vn,Fg).call(this),!this.type){const n=this.isStart()&&this.isEnd(),l=F(this,be).map(g=>{var f;const[p,w,b,d]=typeof g=="string"?Ws(f=ft,sa,Jg).call(f,g,F(this,Ze),n):g.toRegExpSource(e);return Pe(this,Ze,F(this,Ze)||b),Pe(this,Ps,F(this,Ps)||d),p}).join("");let m="";if(this.isStart()&&typeof F(this,be)[0]=="string"&&(F(this,be).length!==1||!qy.has(F(this,be)[0]))){const g=Jy,p=t&&g.has(l.charAt(0))||l.startsWith("\\.")&&g.has(l.charAt(2))||l.startsWith("\\.\\.")&&g.has(l.charAt(4)),w=!t&&!e&&g.has(l.charAt(0));m=p?"(?!(?:^|/)\\.\\.?(?:$|/))":w?tm:""}let h="";return this.isEnd()&&F(F(this,qe),qr)&&((o=F(this,Ke))==null?void 0:o.type)==="!"&&(h="(?:$|\\/)"),[m+l+h,Jo(l),Pe(this,Ze,!!F(this,Ze)),F(this,Ps)]}const s=this.type==="*"||this.type==="+",a=this.type==="!"?"(?:(?!(?:":"(?:";let u=Ws(this,Vn,If).call(this,t);if(this.isStart()&&this.isEnd()&&!u&&this.type!=="!"){const n=this.toString();return Pe(this,be,[n]),this.type=null,Pe(this,Ze,void 0),[n,Jo(this.toString()),!1,!1]}let c=!s||e||t?"":Ws(this,Vn,If).call(this,!0);c===u&&(c=""),c&&(u="(?:".concat(u,")(?:").concat(c,")*?"));let i="";return i=this.type==="!"&&F(this,sc)?(this.isStart()&&!t?tm:"")+sd:a+u+(this.type==="!"?"))"+(!this.isStart()||t||e?"":tm)+td+")":this.type==="@"?")":this.type==="?"?")?":this.type==="+"&&c?")":this.type==="*"&&c?")?":")".concat(this.type)),[i,Jo(u),Pe(this,Ze,!!F(this,Ze)),F(this,Ps)]}};qe=new WeakMap,Ze=new WeakMap,Ps=new WeakMap,be=new WeakMap,Ke=new WeakMap,Jr=new WeakMap,wn=new WeakMap,qr=new WeakMap,ls=new WeakMap,yn=new WeakMap,sc=new WeakMap,Vn=new WeakSet,Fg=function(){if(this!==F(this,qe))throw new Error("should only call on root");if(F(this,qr))return this;let e;for(this.toString(),Pe(this,qr,!0);e=F(this,wn).pop();){if(e.type!=="!")continue;let t=e,s=F(t,Ke);for(;s;){for(let a=F(t,Jr)+1;!s.type&&a<F(s,be).length;a++)for(const u of F(e,be)){if(typeof u=="string")throw new Error("string part in extglob AST??");u.copyIn(F(s,be)[a])}t=s,s=F(t,Ke)}}return this},sa=new WeakSet,Uc=function(e,t,s,a){var g,p;let u=!1,c=!1,i=-1,o=!1;if(t.type===null){let w=s,b="";for(;w<e.length;){const d=e.charAt(w++);if(u||d==="\\")u=!u,b+=d;else if(c)w===i+1?d!=="^"&&d!=="!"||(o=!0):d!=="]"||w===i+2&&o||(c=!1),b+=d;else if(d!=="[")if(a.noext||!ed(d)||e.charAt(w)!=="(")b+=d;else{t.push(b),b="";const f=new ft(d,t);w=Ws(g=ft,sa,Uc).call(g,e,f,w,a),t.push(f)}else c=!0,i=w,o=!1,b+=d}return t.push(b),w}let n=s+1,l=new ft(null,t);const m=[];let h="";for(;n<e.length;){const w=e.charAt(n++);if(u||w==="\\")u=!u,h+=w;else if(c)n===i+1?w!=="^"&&w!=="!"||(o=!0):w!=="]"||n===i+2&&o||(c=!1),h+=w;else if(w!=="[")if(ed(w)&&e.charAt(n)==="("){l.push(h),h="";const b=new ft(w,l);l.push(b),n=Ws(p=ft,sa,Uc).call(p,e,b,n,a)}else if(w!=="|"){if(w===")")return h===""&&F(t,be).length===0&&Pe(t,sc,!0),l.push(h),h="",t.push(...m,l),n;h+=w}else l.push(h),h="",m.push(l),l=new ft(null,t);else c=!0,i=n,o=!1,h+=w}return t.type=null,Pe(t,Ze,void 0),Pe(t,be,[e.substring(s-1)]),n},If=function(e){return F(this,be).map(t=>{if(typeof t=="string")throw new Error("string type in extglob ast??");const[s,a,u,c]=t.toRegExpSource(e);return Pe(this,Ps,F(this,Ps)||c),s}).filter(t=>!(this.isStart()&&this.isEnd()&&!t)).join("|")},Jg=function(e,t){let s=arguments.length>2&&arguments[2]!==void 0&&arguments[2],a=!1,u="",c=!1;for(let i=0;i<e.length;i++){const o=e.charAt(i);if(a)a=!1,u+=(Wy.has(o)?"\\":"")+o;else if(o!=="\\"){if(o==="["){const[n,l,m,h]=My(e,i);if(m){u+=n,c=c||l,i+=m-1,t=t||h;continue}}o!=="*"?o!=="?"?u+=o.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"):(u+=up,t=!0):(u+=s&&e==="*"?sd:td,t=!0)}else i===e.length-1?u+="\\\\":a=!0}return[u,Jo(e),!!t,c]},kt(ft,sa);let Ch=ft;const mt=function(r,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return Eh(e),!(!t.nocomment&&e.charAt(0)==="#")&&new xh(e,t).match(r)},Gy=/^\*+([^+@!?\*\[\(]*)$/,_y=r=>e=>!e.startsWith(".")&&e.endsWith(r),Xy=r=>e=>e.endsWith(r),zy=r=>(r=r.toLowerCase(),e=>!e.startsWith(".")&&e.toLowerCase().endsWith(r)),Qy=r=>(r=r.toLowerCase(),e=>e.toLowerCase().endsWith(r)),Yy=/^\*+\.\*+$/,Zy=r=>!r.startsWith(".")&&r.includes("."),ev=r=>r!=="."&&r!==".."&&r.includes("."),tv=/^\.\*+$/,sv=r=>r!=="."&&r!==".."&&r.startsWith("."),rv=/^\*+$/,av=r=>r.length!==0&&!r.startsWith("."),nv=r=>r.length!==0&&r!=="."&&r!=="..",iv=/^\?+([^+@!?\*\[\(]*)?$/,ov=r=>{let[e,t=""]=r;const s=qg([e]);return t?(t=t.toLowerCase(),a=>s(a)&&a.toLowerCase().endsWith(t)):s},uv=r=>{let[e,t=""]=r;const s=Wg([e]);return t?(t=t.toLowerCase(),a=>s(a)&&a.toLowerCase().endsWith(t)):s},lv=r=>{let[e,t=""]=r;const s=Wg([e]);return t?a=>s(a)&&a.endsWith(t):s},cv=r=>{let[e,t=""]=r;const s=qg([e]);return t?a=>s(a)&&a.endsWith(t):s},qg=r=>{let[e]=r;const t=e.length;return s=>s.length===t&&!s.startsWith(".")},Wg=r=>{let[e]=r;const t=e.length;return s=>s.length===t&&s!=="."&&s!==".."},Gg=typeof We=="object"&&We?typeof Qh=="object"&&Qh&&Qh.__MINIMATCH_TESTING_PLATFORM__||We.platform:"posix";mt.sep=Gg==="win32"?"\\":"/";const $t=Symbol("globstar **");mt.GLOBSTAR=$t,mt.filter=function(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return t=>mt(t,r,e)};const Lt=function(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Object.assign({},r,e)};mt.defaults=r=>{if(!r||typeof r!="object"||!Object.keys(r).length)return mt;const e=mt;return Object.assign(function(t,s){return e(t,s,Lt(r,arguments.length>2&&arguments[2]!==void 0?arguments[2]:{}))},{Minimatch:class extends e.Minimatch{constructor(t){super(t,Lt(r,arguments.length>1&&arguments[1]!==void 0?arguments[1]:{}))}static defaults(t){return e.defaults(Lt(r,t)).Minimatch}},AST:class extends e.AST{constructor(t,s){super(t,s,Lt(r,arguments.length>2&&arguments[2]!==void 0?arguments[2]:{}))}static fromGlob(t){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return e.AST.fromGlob(t,Lt(r,s))}},unescape:function(t){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return e.unescape(t,Lt(r,s))},escape:function(t){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return e.escape(t,Lt(r,s))},filter:function(t){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return e.filter(t,Lt(r,s))},defaults:t=>e.defaults(Lt(r,t)),makeRe:function(t){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return e.makeRe(t,Lt(r,s))},braceExpand:function(t){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return e.braceExpand(t,Lt(r,s))},match:function(t,s){let a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return e.match(t,s,Lt(r,a))},sep:e.sep,GLOBSTAR:$t})};const _g=function(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Eh(r),e.nobrace||!/\{(?:(?!\{).)*\}/.test(r)?[r]:Ky(r)};mt.braceExpand=_g,mt.makeRe=function(r){return new xh(r,arguments.length>1&&arguments[1]!==void 0?arguments[1]:{}).makeRe()},mt.match=function(r,e){const t=new xh(e,arguments.length>2&&arguments[2]!==void 0?arguments[2]:{});return r=r.filter(s=>t.match(s)),t.options.nonull&&!r.length&&r.push(e),r};const rd=/[?*]|[+@!]\(.*?\)|\[|\]/;class xh{constructor(e){Ue(this,"options");Ue(this,"set");Ue(this,"pattern");Ue(this,"windowsPathsNoEscape");Ue(this,"nonegate");Ue(this,"negate");Ue(this,"comment");Ue(this,"empty");Ue(this,"preserveMultipleSlashes");Ue(this,"partial");Ue(this,"globSet");Ue(this,"globParts");Ue(this,"nocase");Ue(this,"isWindows");Ue(this,"platform");Ue(this,"windowsNoMagicRoot");Ue(this,"regexp");let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Eh(e),t=t||{},this.options=t,this.pattern=e,this.platform=t.platform||Gg,this.isWindows=this.platform==="win32",this.windowsPathsNoEscape=!!t.windowsPathsNoEscape||t.allowWindowsEscape===!1,this.windowsPathsNoEscape&&(this.pattern=this.pattern.replace(/\\/g,"/")),this.preserveMultipleSlashes=!!t.preserveMultipleSlashes,this.regexp=null,this.negate=!1,this.nonegate=!!t.nonegate,this.comment=!1,this.empty=!1,this.partial=!!t.partial,this.nocase=!!this.options.nocase,this.windowsNoMagicRoot=t.windowsNoMagicRoot!==void 0?t.windowsNoMagicRoot:!(!this.isWindows||!this.nocase),this.globSet=[],this.globParts=[],this.set=[],this.make()}hasMagic(){if(this.options.magicalBraces&&this.set.length>1)return!0;for(const e of this.set)for(const t of e)if(typeof t!="string")return!0;return!1}debug(){}make(){const e=this.pattern,t=this.options;if(!t.nocomment&&e.charAt(0)==="#")return void(this.comment=!0);if(!e)return void(this.empty=!0);this.parseNegate(),this.globSet=[...new Set(this.braceExpand())],t.debug&&(this.debug=function(){return console.error(...arguments)}),this.debug(this.pattern,this.globSet);const s=this.globSet.map(u=>this.slashSplit(u));this.globParts=this.preprocess(s),this.debug(this.pattern,this.globParts);let a=this.globParts.map((u,c,i)=>{if(this.isWindows&&this.windowsNoMagicRoot){const o=!(u[0]!==""||u[1]!==""||u[2]!=="?"&&rd.test(u[2])||rd.test(u[3])),n=/^[a-z]:/i.test(u[0]);if(o)return[...u.slice(0,4),...u.slice(4).map(l=>this.parse(l))];if(n)return[u[0],...u.slice(1).map(l=>this.parse(l))]}return u.map(o=>this.parse(o))});if(this.debug(this.pattern,a),this.set=a.filter(u=>u.indexOf(!1)===-1),this.isWindows)for(let u=0;u<this.set.length;u++){const c=this.set[u];c[0]===""&&c[1]===""&&this.globParts[u][2]==="?"&&typeof c[3]=="string"&&/^[a-z]:$/i.test(c[3])&&(c[2]="?")}this.debug(this.pattern,this.set)}preprocess(e){if(this.options.noglobstar)for(let s=0;s<e.length;s++)for(let a=0;a<e[s].length;a++)e[s][a]==="**"&&(e[s][a]="*");const{optimizationLevel:t=1}=this.options;return t>=2?(e=this.firstPhasePreProcess(e),e=this.secondPhasePreProcess(e)):e=t>=1?this.levelOneOptimize(e):this.adjascentGlobstarOptimize(e),e}adjascentGlobstarOptimize(e){return e.map(t=>{let s=-1;for(;(s=t.indexOf("**",s+1))!==-1;){let a=s;for(;t[a+1]==="**";)a++;a!==s&&t.splice(s,a-s)}return t})}levelOneOptimize(e){return e.map(t=>(t=t.reduce((s,a)=>{const u=s[s.length-1];return a==="**"&&u==="**"?s:a===".."&&u&&u!==".."&&u!=="."&&u!=="**"?(s.pop(),s):(s.push(a),s)},[])).length===0?[""]:t)}levelTwoFileOptimize(e){Array.isArray(e)||(e=this.slashSplit(e));let t=!1;do{if(t=!1,!this.preserveMultipleSlashes){for(let a=1;a<e.length-1;a++){const u=e[a];a===1&&u===""&&e[0]===""||u!=="."&&u!==""||(t=!0,e.splice(a,1),a--)}e[0]!=="."||e.length!==2||e[1]!=="."&&e[1]!==""||(t=!0,e.pop())}let s=0;for(;(s=e.indexOf("..",s+1))!==-1;){const a=e[s-1];a&&a!=="."&&a!==".."&&a!=="**"&&(t=!0,e.splice(s-1,2),s-=2)}}while(t);return e.length===0?[""]:e}firstPhasePreProcess(e){let t=!1;do{t=!1;for(let s of e){let a=-1;for(;(a=s.indexOf("**",a+1))!==-1;){let c=a;for(;s[c+1]==="**";)c++;c>a&&s.splice(a+1,c-a);let i=s[a+1];const o=s[a+2],n=s[a+3];if(i!==".."||!o||o==="."||o===".."||!n||n==="."||n==="..")continue;t=!0,s.splice(a,1);const l=s.slice(0);l[a]="**",e.push(l),a--}if(!this.preserveMultipleSlashes){for(let c=1;c<s.length-1;c++){const i=s[c];c===1&&i===""&&s[0]===""||i!=="."&&i!==""||(t=!0,s.splice(c,1),c--)}s[0]!=="."||s.length!==2||s[1]!=="."&&s[1]!==""||(t=!0,s.pop())}let u=0;for(;(u=s.indexOf("..",u+1))!==-1;){const c=s[u-1];if(c&&c!=="."&&c!==".."&&c!=="**"){t=!0;const i=u===1&&s[u+1]==="**"?["."]:[];s.splice(u-1,2,...i),s.length===0&&s.push(""),u-=2}}}}while(t);return e}secondPhasePreProcess(e){for(let t=0;t<e.length-1;t++)for(let s=t+1;s<e.length;s++){const a=this.partsMatch(e[t],e[s],!this.preserveMultipleSlashes);if(a){e[t]=[],e[s]=a;break}}return e.filter(t=>t.length)}partsMatch(e,t){let s=arguments.length>2&&arguments[2]!==void 0&&arguments[2],a=0,u=0,c=[],i="";for(;a<e.length&&u<t.length;)if(e[a]===t[u])c.push(i==="b"?t[u]:e[a]),a++,u++;else if(s&&e[a]==="**"&&t[u]===e[a+1])c.push(e[a]),a++;else if(s&&t[u]==="**"&&e[a]===t[u+1])c.push(t[u]),u++;else if(e[a]!=="*"||!t[u]||!this.options.dot&&t[u].startsWith(".")||t[u]==="**"){if(t[u]!=="*"||!e[a]||!this.options.dot&&e[a].startsWith(".")||e[a]==="**"||i==="a")return!1;i="b",c.push(t[u]),a++,u++}else{if(i==="b")return!1;i="a",c.push(e[a]),a++,u++}return e.length===t.length&&c}parseNegate(){if(this.nonegate)return;const e=this.pattern;let t=!1,s=0;for(let a=0;a<e.length&&e.charAt(a)==="!";a++)t=!t,s++;s&&(this.pattern=e.slice(s)),this.negate=t}matchOne(e,t){let s=arguments.length>2&&arguments[2]!==void 0&&arguments[2];const a=this.options;if(this.isWindows){const w=typeof e[0]=="string"&&/^[a-z]:$/i.test(e[0]),b=!w&&e[0]===""&&e[1]===""&&e[2]==="?"&&/^[a-z]:$/i.test(e[3]),d=typeof t[0]=="string"&&/^[a-z]:$/i.test(t[0]),f=b?3:w?0:void 0,A=!d&&t[0]===""&&t[1]===""&&t[2]==="?"&&typeof t[3]=="string"&&/^[a-z]:$/i.test(t[3])?3:d?0:void 0;if(typeof f=="number"&&typeof A=="number"){const[C,S]=[e[f],t[A]];C.toLowerCase()===S.toLowerCase()&&(t[A]=C,A>f?t=t.slice(A):f>A&&(e=e.slice(f)))}}const{optimizationLevel:u=1}=this.options;u>=2&&(e=this.levelTwoFileOptimize(e)),this.debug("matchOne",this,{file:e,pattern:t}),this.debug("matchOne",e.length,t.length);for(var c=0,i=0,o=e.length,n=t.length;c<o&&i<n;c++,i++){this.debug("matchOne loop");var l=t[i],m=e[c];if(this.debug(t,l,m),l===!1)return!1;if(l===$t){this.debug("GLOBSTAR",[t,l,m]);var h=c,g=i+1;if(g===n){for(this.debug("** at the end");c<o;c++)if(e[c]==="."||e[c]===".."||!a.dot&&e[c].charAt(0)===".")return!1;return!0}for(;h<o;){var p=e[h];if(this.debug("\nglobstar while",e,h,t,g,p),this.matchOne(e.slice(h),t.slice(g),s))return this.debug("globstar found match!",h,o,p),!0;if(p==="."||p===".."||!a.dot&&p.charAt(0)==="."){this.debug("dot detected!",e,h,t,g);break}this.debug("globstar swallow a segment, and continue"),h++}return!(!s||(this.debug("\n>>> no match, partial?",e,h,t,g),h!==o))}let w;if(typeof l=="string"?(w=m===l,this.debug("string match",l,m,w)):(w=l.test(m),this.debug("pattern match",l,m,w)),!w)return!1}if(c===o&&i===n)return!0;if(c===o)return s;if(i===n)return c===o-1&&e[c]==="";throw new Error("wtf?")}braceExpand(){return _g(this.pattern,this.options)}parse(e){Eh(e);const t=this.options;if(e==="**")return $t;if(e==="")return"";let s,a=null;(s=e.match(rv))?a=t.dot?nv:av:(s=e.match(Gy))?a=(t.nocase?t.dot?Qy:zy:t.dot?Xy:_y)(s[1]):(s=e.match(iv))?a=(t.nocase?t.dot?uv:ov:t.dot?lv:cv)(s):(s=e.match(Yy))?a=t.dot?ev:Zy:(s=e.match(tv))&&(a=sv);const u=Ch.fromGlob(e,this.options).toMMPattern();return a&&typeof u=="object"&&Reflect.defineProperty(u,"test",{value:a}),u}makeRe(){if(this.regexp||this.regexp===!1)return this.regexp;const e=this.set;if(!e.length)return this.regexp=!1,this.regexp;const t=this.options,s=t.noglobstar?"[^/]*?":t.dot?"(?:(?!(?:\\/|^)(?:\\.{1,2})($|\\/)).)*?":"(?:(?!(?:\\/|^)\\.).)*?",a=new Set(t.nocase?["i"]:[]);let u=e.map(o=>{const n=o.map(l=>{if(l instanceof RegExp)for(const m of l.flags.split(""))a.add(m);return typeof l=="string"?l.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"):l===$t?$t:l._src});return n.forEach((l,m)=>{const h=n[m+1],g=n[m-1];l===$t&&g!==$t&&(g===void 0?h!==void 0&&h!==$t?n[m+1]="(?:\\/|"+s+"\\/)?"+h:n[m]=s:h===void 0?n[m-1]=g+"(?:\\/|"+s+")?":h!==$t&&(n[m-1]=g+"(?:\\/|\\/"+s+"\\/)"+h,n[m+1]=$t))}),n.filter(l=>l!==$t).join("/")}).join("|");const[c,i]=e.length>1?["(?:",")"]:["",""];u="^"+c+u+i+"$",this.negate&&(u="^(?!"+u+").+$");try{this.regexp=new RegExp(u,[...a].join(""))}catch(o){this.regexp=!1}return this.regexp}slashSplit(e){return this.preserveMultipleSlashes?e.split("/"):this.isWindows&&/^\/\/[^\/]+/.test(e)?["",...e.split(/\/+/)]:e.split(/\/+/)}match(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.partial;if(this.debug("match",e,this.pattern),this.comment)return!1;if(this.empty)return e==="";if(e==="/"&&t)return!0;const s=this.options;this.isWindows&&(e=e.split("\\").join("/"));const a=this.slashSplit(e);this.debug(this.pattern,"split",a);const u=this.set;this.debug(this.pattern,"set",u);let c=a[a.length-1];if(!c)for(let i=a.length-2;!c&&i>=0;i--)c=a[i];for(let i=0;i<u.length;i++){const o=u[i];let n=a;if(s.matchBase&&o.length===1&&(n=[c]),this.matchOne(n,o,t))return!!s.flipNegate||!this.negate}return!s.flipNegate&&this.negate}static defaults(e){return mt.defaults(e).Minimatch}}function lp(r){const e=new Error("".concat(arguments.length>1&&arguments[1]!==void 0?arguments[1]:"","Invalid response: ").concat(r.status," ").concat(r.statusText));return e.status=r.status,e.response=r,e}function Qe(r,e){const{status:t}=e;if(t===401&&r.digest)return e;if(t>=400)throw lp(e);return e}function Pn(r,e){return arguments.length>2&&arguments[2]!==void 0&&arguments[2]?{data:e,headers:r.headers?Ly(r.headers):{},status:r.status,statusText:r.statusText}:e}mt.AST=Ch,mt.Minimatch=xh,mt.escape=function(r){let{windowsPathsNoEscape:e=!1}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return e?r.replace(/[?*()[\]]/g,"[$&]"):r.replace(/[?*()[\]\\]/g,"\\$&")},mt.unescape=Jo;const hv=(ad=function(r,e,t){let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};const a=ze({url:Ce(r.remoteURL,Ee(e)),method:"COPY",headers:{Destination:Ce(r.remoteURL,Ee(t)),Overwrite:s.overwrite===!1?"F":"T",Depth:s.shallow?"0":"infinity"}},r,s);return c=function(i){Qe(r,i)},(u=Xe(a,r))&&u.then||(u=Promise.resolve(u)),c?u.then(c):u;var u,c},function(){for(var r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];try{return Promise.resolve(ad.apply(this,r))}catch(t){return Promise.reject(t)}});var ad,cp=de(635),mv=de(829),Vs=de.n(mv),oo=function(r){return r.Array="array",r.Object="object",r.Original="original",r}(oo||{});function oc(r,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:oo.Original;const s=Vs().get(r,e);return t==="array"&&Array.isArray(s)===!1?[s]:t==="object"&&Array.isArray(s)?s[0]:s}function rc(r){return new Promise(e=>{e(function(t){const{multistatus:s}=t;if(s==="")return{multistatus:{response:[]}};if(!s)throw new Error("Invalid response: No root multistatus found");const a={multistatus:Array.isArray(s)?s[0]:s};return Vs().set(a,"multistatus.response",oc(a,"multistatus.response",oo.Array)),Vs().set(a,"multistatus.response",Vs().get(a,"multistatus.response").map(u=>function(c){const i=Object.assign({},c);return i.status?Vs().set(i,"status",oc(i,"status",oo.Object)):(Vs().set(i,"propstat",oc(i,"propstat",oo.Object)),Vs().set(i,"propstat.prop",oc(i,"propstat.prop",oo.Object))),i}(u))),a}(new cp.XMLParser({allowBooleanAttributes:!0,attributeNamePrefix:"",textNodeName:"text",ignoreAttributes:!1,removeNSPrefix:!0,numberParseOptions:{hex:!0,leadingZeros:!1},attributeValueProcessor:(t,s,a)=>s==="true"||s==="false"?s==="true":s,tagValueProcessor(t,s,a){if(!a.endsWith("propstat.prop.displayname"))return s}}).parse(r)))})}function Fh(r,e){let t=arguments.length>2&&arguments[2]!==void 0&&arguments[2];const{getlastmodified:s=null,getcontentlength:a="0",resourcetype:u=null,getcontenttype:c=null,getetag:i=null}=r,o=u&&typeof u=="object"&&u.collection!==void 0?"directory":"file",n={filename:e,basename:Sh().basename(e),lastmod:s,size:parseInt(a,10),type:o,etag:typeof i=="string"?i.replace(/"/g,""):null};return o==="file"&&(n.mime=c&&typeof c=="string"?c.split(";")[0]:""),t&&(r.displayname!==void 0&&(r.displayname=String(r.displayname)),n.props=r),n}function Xg(r,e){let t=arguments.length>2&&arguments[2]!==void 0&&arguments[2],s=null;try{r.multistatus.response[0].propstat&&(s=r.multistatus.response[0])}catch(l){}if(!s)throw new Error("Failed getting item stat: bad response");const{propstat:{prop:a,status:u}}=s,[c,i,o]=u.split(" ",3),n=parseInt(i,10);if(n>=400){const l=new Error("Invalid response: ".concat(n," ").concat(o));throw l.status=n,l}return Fh(a,_l(e),t)}function zg(r){switch(String(r)){case"-3":return"unlimited";case"-2":case"-1":return"unknown";default:return parseInt(String(r),10)}}function sm(r,e,t){return t?e?e(r):r:(r&&r.then||(r=Promise.resolve(r)),e?r.then(e):r)}const hp=function(r){return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];try{return Promise.resolve(r.apply(this,e))}catch(s){return Promise.reject(s)}}}(function(r,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const{details:s=!1}=t,a=ze({url:Ce(r.remoteURL,Ee(e)),method:"PROPFIND",headers:{Accept:"text/plain,application/xml",Depth:"0"}},r,t);return sm(Xe(a,r),function(u){return Qe(r,u),sm(u.text(),function(c){return sm(rc(c),function(i){const o=Xg(i,e,s);return Pn(u,o,s)})})})});function Qg(r,e,t){return t?e?e(r):r:(r&&r.then||(r=Promise.resolve(r)),e?r.then(e):r)}const fv=Yg(function(r,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const s=function(u){if(!u||u==="/")return[];let c=u;const i=[];do i.push(c),c=Sh().dirname(c);while(c&&c!=="/");return i}(_l(e));s.sort((u,c)=>u.length>c.length?1:c.length>u.length?-1:0);let a=!1;return function(u,c,i){if(typeof u[id]=="function"){let w=function(b){try{for(;!(o=m.next()).done;)if((b=c(o.value))&&b.then){if(!od(b))return void b.then(w,l||(l=vt.bind(null,n=new uo,2)));b=b.v}n?vt(n,1,b):n=b}catch(d){vt(n||(n=new uo),2,d)}};var o,n,l,m=u[id]();if(w(),m.return){var h=function(b){try{o.done||m.return()}catch(d){}return b};if(n&&n.then)return n.then(h,function(b){throw h(b)});h()}return n}if(!("length"in u))throw new TypeError("Object is not iterable");for(var g=[],p=0;p<u.length;p++)g.push(u[p]);return function(w,b,d){var f,A,C=-1;return function S(v){try{for(;++C<w.length&&(!d||!d());)if((v=b(C))&&v.then){if(!od(v))return void v.then(S,A||(A=vt.bind(null,f=new uo,2)));v=v.v}f?vt(f,1,v):f=v}catch(E){vt(f||(f=new uo),2,E)}}(),f}(g,function(w){return c(g[w])},i)}(s,function(u){return c=function(){return function(o,n){try{var l=Qg(hp(r,u),function(m){if(m.type!=="directory")throw new Error("Path includes a file: ".concat(e))})}catch(m){return n(m)}return l&&l.then?l.then(void 0,n):l}(0,function(o){const n=o;return function(){if(n.status===404)return a=!0,nd(Vf(r,u,ns(nt({},t),{recursive:!1})));throw o}()})},(i=function(){if(a)return nd(Vf(r,u,ns(nt({},t),{recursive:!1})))}())&&i.then?i.then(c):c();var c,i},function(){return!1})});function Yg(r){return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];try{return Promise.resolve(r.apply(this,e))}catch(s){return Promise.reject(s)}}}function pv(){}function nd(r,e){return r&&r.then?r.then(pv):Promise.resolve()}const id=typeof Symbol<"u"?Symbol.iterator||(Symbol.iterator=Symbol("Symbol.iterator")):"@@iterator";function vt(r,e,t){if(!r.s){if(t instanceof uo){if(!t.s)return void(t.o=vt.bind(null,r,e));1&e&&(e=t.s),t=t.v}if(t&&t.then)return void t.then(vt.bind(null,r,e),vt.bind(null,r,2));r.s=e,r.v=t;const s=r.o;s&&s(r)}}const uo=function(){function r(){}return r.prototype.then=function(e,t){const s=new r,a=this.s;if(a){const u=1&a?e:t;if(u){try{vt(s,1,u(this.v))}catch(c){vt(s,2,c)}return s}return this}return this.o=function(u){try{const c=u.v;1&u.s?vt(s,1,e?e(c):c):t?vt(s,1,t(c)):vt(s,2,c)}catch(c){vt(s,2,c)}},s},r}();function od(r){return r instanceof uo&&1&r.s}const Vf=Yg(function(r,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(t.recursive===!0)return fv(r,e,t);const s=ze({url:Ce(r.remoteURL,(a=Ee(e),a.endsWith("/")?a:a+"/")),method:"MKCOL"},r,t);var a;return Qg(Xe(s,r),function(u){Qe(r,u)})});var dv=de(388),ud=de.n(dv);const gv=function(r){return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];try{return Promise.resolve(r.apply(this,e))}catch(s){return Promise.reject(s)}}}(function(r,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const s={};if(typeof t.range=="object"&&typeof t.range.start=="number"){let i="bytes=".concat(t.range.start,"-");typeof t.range.end=="number"&&(i="".concat(i).concat(t.range.end)),s.Range=i}const a=ze({url:Ce(r.remoteURL,Ee(e)),method:"GET",headers:s},r,t);return c=function(i){if(Qe(r,i),s.Range&&i.status!==206){const o=new Error("Invalid response code for partial request: ".concat(i.status));throw o.status=i.status,o}return t.callback&&setTimeout(()=>{t.callback(i)},0),i.body},(u=Xe(a,r))&&u.then||(u=Promise.resolve(u)),c?u.then(c):u;var u,c}),wv=()=>{},yv=function(r){return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];try{return Promise.resolve(r.apply(this,e))}catch(s){return Promise.reject(s)}}}(function(r,e,t){t.url||(t.url=Ce(r.remoteURL,Ee(e)));const s=ze(t,r,{});return u=function(c){return Qe(r,c),c},(a=Xe(s,r))&&a.then||(a=Promise.resolve(a)),u?a.then(u):a;var a,u}),vv=function(r){return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];try{return Promise.resolve(r.apply(this,e))}catch(s){return Promise.reject(s)}}}(function(r,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const s=ze({url:Ce(r.remoteURL,Ee(e)),method:"DELETE"},r,t);return u=function(c){Qe(r,c)},(a=Xe(s,r))&&a.then||(a=Promise.resolve(a)),u?a.then(u):a;var a,u}),bv=function(r){return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];try{return Promise.resolve(r.apply(this,e))}catch(s){return Promise.reject(s)}}}(function(r,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return function(s,a){try{var u=(c=hp(r,e,t),i=function(){return!0},o?i?i(c):c:(c&&c.then||(c=Promise.resolve(c)),i?c.then(i):c))}catch(n){return a(n)}var c,i,o;return u&&u.then?u.then(void 0,a):u}(0,function(s){if(s.status===404)return!1;throw s})});function rm(r,e,t){return t?e?e(r):r:(r&&r.then||(r=Promise.resolve(r)),e?r.then(e):r)}const Sv=function(r){return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];try{return Promise.resolve(r.apply(this,e))}catch(s){return Promise.reject(s)}}}(function(r,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const s=ze({url:Ce(r.remoteURL,Ee(e),"/"),method:"PROPFIND",headers:{Accept:"text/plain,application/xml",Depth:t.deep?"infinity":"1"}},r,t);return rm(Xe(s,r),function(a){return Qe(r,a),rm(a.text(),function(u){if(!u)throw new Error("Failed parsing directory contents: Empty response");return rm(rc(u),function(c){const i=Gp(e);let o=function(n,l,m){let h=arguments.length>3&&arguments[3]!==void 0&&arguments[3],g=arguments.length>4&&arguments[4]!==void 0&&arguments[4];const p=Sh().join(l,"/"),{multistatus:{response:w}}=n,b=w.map(d=>{const f=function(C){try{return C.replace(/^https?:\/\/[^\/]+/,"")}catch(S){throw new St(S,"Failed normalising HREF")}}(d.href),{propstat:{prop:A}}=d;return Fh(A,p==="/"?decodeURIComponent(_l(f)):_l(Sh().relative(decodeURIComponent(p),decodeURIComponent(f))),h)});return g?b:b.filter(d=>d.basename&&(d.type==="file"||d.filename!==m.replace(/\/$/,"")))}(c,Gp(r.remoteBasePath||r.remotePath),i,t.details,t.includeSelf);return t.glob&&(o=function(n,l){return n.filter(m=>mt(m.filename,l,{matchBase:!0}))}(o,t.glob)),Pn(a,o,t.details)})})})});function mp(r){return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];try{return Promise.resolve(r.apply(this,e))}catch(s){return Promise.reject(s)}}}const Av=mp(function(r,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const s=ze({url:Ce(r.remoteURL,Ee(e)),method:"GET",headers:{Accept:"text/plain"},transformResponse:[Ev]},r,t);return Ih(Xe(s,r),function(a){return Qe(r,a),Ih(a.text(),function(u){return Pn(a,u,t.details)})})});function Ih(r,e,t){return t?e?e(r):r:(r&&r.then||(r=Promise.resolve(r)),e?r.then(e):r)}const Nv=mp(function(r,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const s=ze({url:Ce(r.remoteURL,Ee(e)),method:"GET"},r,t);return Ih(Xe(s,r),function(a){let u;return Qe(r,a),function(c,i){var o=c();return o&&o.then?o.then(i):i()}(function(){return Ih(a.arrayBuffer(),function(c){u=c})},function(){return Pn(a,u,t.details)})})}),kv=mp(function(r,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const{format:s="binary"}=t;if(s!=="binary"&&s!=="text")throw new St({info:{code:Ms.InvalidOutputFormat}},"Invalid output format: ".concat(s));return s==="text"?Av(r,e,t):Nv(r,e,t)}),Ev=r=>r;function Cv(r){return new cp.XMLBuilder({attributeNamePrefix:"@_",format:!0,ignoreAttributes:!1,suppressEmptyNode:!0}).build(Zg({lockinfo:{"@_xmlns:d":"DAV:",lockscope:{exclusive:{}},locktype:{write:{}},owner:{href:r}}},"d"))}function Zg(r,e){const t=nt({},r);for(const s in t)t.hasOwnProperty(s)&&(t[s]&&typeof t[s]=="object"&&s.indexOf(":")===-1?(t["".concat(e,":").concat(s)]=Zg(t[s],e),delete t[s]):/^@_/.test(s)===!1&&(t["".concat(e,":").concat(s)]=t[s],delete t[s]));return t}function Pf(r,e,t){return t?e?e(r):r:(r&&r.then||(r=Promise.resolve(r)),e?r.then(e):r)}function ew(r){return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];try{return Promise.resolve(r.apply(this,e))}catch(s){return Promise.reject(s)}}}const xv=ew(function(r,e,t){let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};const a=ze({url:Ce(r.remoteURL,Ee(e)),method:"UNLOCK",headers:{"Lock-Token":t}},r,s);return Pf(Xe(a,r),function(u){if(Qe(r,u),u.status!==204&&u.status!==200)throw lp(u)})}),Iv=ew(function(r,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const{refreshToken:s,timeout:a=Vv}=t,u={Accept:"text/plain,application/xml",Timeout:a};s&&(u.If=s);const c=ze({url:Ce(r.remoteURL,Ee(e)),method:"LOCK",headers:u,data:Cv(r.contactHref)},r,t);return Pf(Xe(c,r),function(i){return Qe(r,i),Pf(i.text(),function(o){const n=(h=o,new cp.XMLParser({removeNSPrefix:!0,parseAttributeValue:!0,parseTagValue:!0}).parse(h)),l=Vs().get(n,"prop.lockdiscovery.activelock.locktoken.href"),m=Vs().get(n,"prop.lockdiscovery.activelock.timeout");var h;if(!l)throw lp(i,"No lock token received: ");return{token:l,serverTimeout:m}})})}),Vv="Infinite, Second-4100000000";function am(r,e,t){return t?e?e(r):r:(r&&r.then||(r=Promise.resolve(r)),e?r.then(e):r)}const Pv=function(r){return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];try{return Promise.resolve(r.apply(this,e))}catch(s){return Promise.reject(s)}}}(function(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const t=e.path||"/",s=ze({url:Ce(r.remoteURL,t),method:"PROPFIND",headers:{Accept:"text/plain,application/xml",Depth:"0"}},r,e);return am(Xe(s,r),function(a){return Qe(r,a),am(a.text(),function(u){return am(rc(u),function(c){const i=function(o){try{const[n]=o.multistatus.response,{propstat:{prop:{"quota-used-bytes":l,"quota-available-bytes":m}}}=n;return l!==void 0&&m!==void 0?{used:parseInt(String(l),10),available:zg(m)}:null}catch(n){}return null}(c);return Pn(a,i,e.details)})})})});function nm(r,e,t){return t?e?e(r):r:(r&&r.then||(r=Promise.resolve(r)),e?r.then(e):r)}const Ov=function(r){return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];try{return Promise.resolve(r.apply(this,e))}catch(s){return Promise.reject(s)}}}(function(r,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const{details:s=!1}=t,a=ze({url:Ce(r.remoteURL,Ee(e)),method:"SEARCH",headers:{Accept:"text/plain,application/xml","Content-Type":r.headers["Content-Type"]||"application/xml; charset=utf-8"}},r,t);return nm(Xe(a,r),function(u){return Qe(r,u),nm(u.text(),function(c){return nm(rc(c),function(i){const o=function(n,l,m){const h={truncated:!1,results:[]};return h.truncated=n.multistatus.response.some(g=>{var p,w;return((w=(g.status||((p=g.propstat)==null?void 0:p.status)).split(" ",3))==null?void 0:w[1])==="507"&&g.href.replace(/\/$/,"").endsWith(Ee(l).replace(/\/$/,""))}),n.multistatus.response.forEach(g=>{if(g.propstat===void 0)return;const p=g.href.split("/").map(decodeURIComponent).join("/");h.results.push(Fh(g.propstat.prop,p,m))}),h}(i,e,s);return Pn(u,o,s)})})})}),Bv=function(r){return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];try{return Promise.resolve(r.apply(this,e))}catch(s){return Promise.reject(s)}}}(function(r,e,t){let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};const a=ze({url:Ce(r.remoteURL,Ee(e)),method:"MOVE",headers:{Destination:Ce(r.remoteURL,Ee(t)),Overwrite:s.overwrite===!1?"F":"T"}},r,s);return c=function(i){Qe(r,i)},(u=Xe(a,r))&&u.then||(u=Promise.resolve(u)),c?u.then(c):u;var u,c});var Dv=de(172);const Tv=function(r){return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];try{return Promise.resolve(r.apply(this,e))}catch(s){return Promise.reject(s)}}}(function(r,e,t){let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};const{contentLength:a=!0,overwrite:u=!0}=s,c={"Content-Type":"application/octet-stream"};a===!1||(c["Content-Length"]=typeof a=="number"?"".concat(a):"".concat(function(l){if(Kg(l))return l.byteLength;if(Hg(l))return l.length;if(typeof l=="string")return(0,Dv.d)(l);throw new St({info:{code:Ms.DataTypeNoLength}},"Cannot calculate data length: Invalid type")}(t))),u||(c["If-None-Match"]="*");const i=ze({url:Ce(r.remoteURL,Ee(e)),method:"PUT",headers:c,data:t},r,s);return n=function(l){try{Qe(r,l)}catch(m){const h=m;if(h.status!==412||u)throw h;return!1}return!0},(o=Xe(i,r))&&o.then||(o=Promise.resolve(o)),n?o.then(n):o;var o,n}),tw=function(r){return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];try{return Promise.resolve(r.apply(this,e))}catch(s){return Promise.reject(s)}}}(function(r,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const s=ze({url:Ce(r.remoteURL,Ee(e)),method:"OPTIONS"},r,t);return u=function(c){var i,o;try{Qe(r,c)}catch(n){throw n}return{compliance:((i=c.headers.get("DAV"))!=null?i:"").split(",").map(n=>n.trim()),server:(o=c.headers.get("Server"))!=null?o:""}},(a=Xe(s,r))&&a.then||(a=Promise.resolve(a)),u?a.then(u):a;var a,u});function Hl(r,e,t){return t?e?e(r):r:(r&&r.then||(r=Promise.resolve(r)),e?r.then(e):r)}const Rv=fp(function(r,e,t,s,a){let u=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{};if(t>s||t<0)throw new St({info:{code:Ms.InvalidUpdateRange}},"Invalid update range ".concat(t," for partial update"));const c={"Content-Type":"application/octet-stream","Content-Length":""+(s-t+1),"Content-Range":"bytes ".concat(t,"-").concat(s,"/*")},i=ze({url:Ce(r.remoteURL,Ee(e)),method:"PUT",headers:c,data:a},r,u);return Hl(Xe(i,r),function(o){Qe(r,o)})});function ld(r,e){var t=r();return t&&t.then?t.then(e):e(t)}const Lv=fp(function(r,e,t,s,a){let u=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{};if(t>s||t<0)throw new St({info:{code:Ms.InvalidUpdateRange}},"Invalid update range ".concat(t," for partial update"));const c={"Content-Type":"application/x-sabredav-partialupdate","Content-Length":""+(s-t+1),"X-Update-Range":"bytes=".concat(t,"-").concat(s)},i=ze({url:Ce(r.remoteURL,Ee(e)),method:"PATCH",headers:c,data:a},r,u);return Hl(Xe(i,r),function(o){Qe(r,o)})});function fp(r){return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];try{return Promise.resolve(r.apply(this,e))}catch(s){return Promise.reject(s)}}}const jv=fp(function(r,e,t,s,a){let u=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{};return Hl(tw(r,e,u),function(c){let i=!1;return ld(function(){if(c.compliance.includes("sabredav-partialupdate"))return Hl(Lv(r,e,t,s,a,u),function(o){return i=!0,o})},function(o){let n=!1;return i?o:ld(function(){if(c.server.includes("Apache")&&c.compliance.includes("<http://apache.org/dav/propset/fs/1>"))return Hl(Rv(r,e,t,s,a,u),function(l){return n=!0,l})},function(l){if(n)return l;throw new St({info:{code:Ms.NotSupported}},"Not supported")})})})}),$v="https://github.com/perry-mitchell/webdav-client/blob/master/LOCK_CONTACT.md";function Uv(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{authType:t=null,remoteBasePath:s,contactHref:a=$v,ha1:u,headers:c={},httpAgent:i,httpsAgent:o,password:n,token:l,username:m,withCredentials:h}=e;let g=t;g||(g=m||n?yt.Password:yt.None);const p={authType:g,remoteBasePath:s,contactHref:a,ha1:u,headers:Object.assign({},c),httpAgent:i,httpsAgent:o,password:n,remotePath:xy(r),remoteURL:r,token:l,username:m,withCredentials:h};return jg(p,m,n,l,u),{copyFile:(w,b,d)=>hv(p,w,b,d),createDirectory:(w,b)=>Vf(p,w,b),createReadStream:(w,b)=>function(d,f){let A=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const C=new(ud()).PassThrough;return gv(d,f,A).then(S=>{S.pipe(C)}).catch(S=>{C.emit("error",S)}),C}(p,w,b),createWriteStream:(w,b,d)=>function(f,A){let C=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},S=arguments.length>3&&arguments[3]!==void 0?arguments[3]:wv;const v=new(ud()).PassThrough,E={};C.overwrite===!1&&(E["If-None-Match"]="*");const k=ze({url:Ce(f.remoteURL,Ee(A)),method:"PUT",headers:E,data:v,maxRedirects:0},f,C);return Xe(k,f).then(x=>Qe(f,x)).then(x=>{setTimeout(()=>{S(x)},0)}).catch(x=>{v.emit("error",x)}),v}(p,w,b,d),customRequest:(w,b)=>yv(p,w,b),deleteFile:(w,b)=>vv(p,w,b),exists:(w,b)=>bv(p,w,b),getDirectoryContents:(w,b)=>Sv(p,w,b),getFileContents:(w,b)=>kv(p,w,b),getFileDownloadLink:w=>function(b,d){let f=Ce(b.remoteURL,Ee(d));const A=/^https:/i.test(f)?"https":"http";switch(b.authType){case yt.None:break;case yt.Password:{const C=Xp(b.headers.Authorization.replace(/^Basic /i,"").trim());f=f.replace(/^https?:\/\//,"".concat(A,"://").concat(C,"@"));break}default:throw new St({info:{code:Ms.LinkUnsupportedAuthType}},"Unsupported auth type for file link: ".concat(b.authType))}return f}(p,w),getFileUploadLink:w=>function(b,d){let f="".concat(Ce(b.remoteURL,Ee(d)),"?Content-Type=application/octet-stream");const A=/^https:/i.test(f)?"https":"http";switch(b.authType){case yt.None:break;case yt.Password:{const C=Xp(b.headers.Authorization.replace(/^Basic /i,"").trim());f=f.replace(/^https?:\/\//,"".concat(A,"://").concat(C,"@"));break}default:throw new St({info:{code:Ms.LinkUnsupportedAuthType}},"Unsupported auth type for file link: ".concat(b.authType))}return f}(p,w),getHeaders:()=>Object.assign({},p.headers),getQuota:w=>Pv(p,w),lock:(w,b)=>Iv(p,w,b),moveFile:(w,b,d)=>Bv(p,w,b,d),putFileContents:(w,b,d)=>Tv(p,w,b,d),partialUpdateFileContents:(w,b,d,f,A)=>jv(p,w,b,d,f,A),getDAVCompliance:w=>tw(p,w),search:(w,b)=>Ov(p,w,b),setHeaders:w=>{p.headers=Object.assign({},w)},stat:(w,b)=>hp(p,w,b),unlock:(w,b,d)=>xv(p,w,b,d)}}Wt.hT,Wt.O4,Wt.Kd,Wt.YK;var Kv=Wt.UU,Hv=Wt.Gu,Mv=Wt.ky,Fv=Wt.h4;Wt.ch,Wt.hq,Wt.i5;function sw(){var r;return(r=rp("files_sharing","isPublic",null))!=null?r:document.querySelector('input#isPublic[type="hidden"][name="isPublic"][value="1"]')!==null}function Jv(){var r,e,t;return(t=(e=rp("files_sharing","sharingToken",null))!=null?e:(r=document.querySelector('input#sharingToken[type="hidden"]'))==null?void 0:r.value)!=null?t:null}const mo=yf().setApp("@nextcloud/files").detectUser().build();var rw=(r=>(r[r.NONE=0]="NONE",r[r.CREATE=4]="CREATE",r[r.READ=1]="READ",r[r.UPDATE=2]="UPDATE",r[r.DELETE=8]="DELETE",r[r.SHARE=16]="SHARE",r[r.ALL=31]="ALL",r))(rw||{}),aw=(r=>(r.Folder="folder",r.File="file",r))(aw||{});const nw=["d:getcontentlength","d:getcontenttype","d:getetag","d:getlastmodified","d:creationdate","d:displayname","d:quota-available-bytes","d:resourcetype","nc:has-preview","nc:is-encrypted","nc:mount-type","oc:comments-unread","oc:favorite","oc:fileid","oc:owner-display-name","oc:owner-id","oc:permissions","oc:size"],iw={d:"DAV:",nc:"http://nextcloud.org/ns",oc:"http://owncloud.org/ns",ocs:"http://open-collaboration-services.org/ns"},im=function(r,e={nc:"http://nextcloud.org/ns"}){typeof window._nc_dav_properties>"u"&&(window._nc_dav_properties=[...nw],window._nc_dav_namespaces=nt({},iw));const t=nt(nt({},window._nc_dav_namespaces),e);if(window._nc_dav_properties.find(a=>a===r))return mo.warn("".concat(r," already registered"),{prop:r}),!1;if(r.startsWith("<")||r.split(":").length!==2)return mo.error("".concat(r," is not valid. See example: 'oc:fileid'"),{prop:r}),!1;const s=r.split(":")[0];return t[s]?(window._nc_dav_properties.push(r),window._nc_dav_namespaces=t,!0):(mo.error("".concat(r," namespace unknown"),{prop:r,namespaces:t}),!1)},qv=function(){return typeof window._nc_dav_properties>"u"&&(window._nc_dav_properties=[...nw]),window._nc_dav_properties.map(r=>"<".concat(r," />")).join(" ")},Wv=function(){return typeof window._nc_dav_namespaces>"u"&&(window._nc_dav_namespaces=nt({},iw)),Object.keys(window._nc_dav_namespaces).map(r=>{var e;return"xmlns:".concat(r,'="').concat((e=window._nc_dav_namespaces)==null?void 0:e[r],'"')}).join(" ")},Gv=function(){return'<?xml version="1.0"?>\n		<d:propfind '.concat(Wv(),">\n			<d:prop>\n				").concat(qv(),"\n			</d:prop>\n		</d:propfind>")};function _v(){var r;return sw()?"/files/".concat(Jv()):"/files/".concat((r=ap())==null?void 0:r.uid)}_v();function Xv(){const r=_w("dav");return sw()?r.replace("remote.php","public.php"):r}const zv=Xv(),Qv=function(r=zv,e={}){const t=Kv(r,{headers:e});function s(a){t.setHeaders(ns(nt({},e),{"X-Requested-With":"XMLHttpRequest",requesttoken:a!=null?a:""}))}return zw(s),s(Xw()),Hv().patch("fetch",(a,u)=>{const c=u.headers;return c!=null&&c.method&&(u.method=c.method,delete c.method),fetch(a,u)}),t};var om={},pp=(r=>(r.DEFAULT="default",r.HIDDEN="hidden",r))(pp||{});class Yv{constructor(e){Ue(this,"_action");this.validateAction(e),this._action=e}get id(){return this._action.id}get displayName(){return this._action.displayName}get title(){return this._action.title}get iconSvgInline(){return this._action.iconSvgInline}get enabled(){return this._action.enabled}get exec(){return this._action.exec}get execBatch(){return this._action.execBatch}get order(){return this._action.order}get parent(){return this._action.parent}get default(){return this._action.default}get destructive(){return this._action.destructive}get inline(){return this._action.inline}get renderInline(){return this._action.renderInline}validateAction(e){if(!e.id||typeof e.id!="string")throw new Error("Invalid id");if(!e.displayName||typeof e.displayName!="function")throw new Error("Invalid displayName function");if("title"in e&&typeof e.title!="function")throw new Error("Invalid title function");if(!e.iconSvgInline||typeof e.iconSvgInline!="function")throw new Error("Invalid iconSvgInline function");if(!e.exec||typeof e.exec!="function")throw new Error("Invalid exec function");if("enabled"in e&&typeof e.enabled!="function")throw new Error("Invalid enabled function");if("execBatch"in e&&typeof e.execBatch!="function")throw new Error("Invalid execBatch function");if("order"in e&&typeof e.order!="number")throw new Error("Invalid order");if(e.destructive!==void 0&&typeof e.destructive!="boolean")throw new Error("Invalid destructive flag");if("parent"in e&&typeof e.parent!="string")throw new Error("Invalid parent");if(e.default&&!Object.values(pp).includes(e.default))throw new Error("Invalid default");if("inline"in e&&typeof e.inline!="function")throw new Error("Invalid inline function");if("renderInline"in e&&typeof e.renderInline!="function")throw new Error("Invalid renderInline function")}}const Zv=function(r){if(typeof window._nc_fileactions>"u"&&(window._nc_fileactions=[],mo.debug("FileActions initialized")),window._nc_fileactions.find(e=>e.id===r.id)){mo.error("FileAction ".concat(r.id," already registered"),{action:r});return}window._nc_fileactions.push(r)},e0=function(){return typeof window._nc_fileactions>"u"&&(window._nc_fileactions=[],mo.debug("FileActions initialized")),window._nc_fileactions};var um={},cd={},hd;function dp(){return hd||(hd=1,function(r){const e=":A-Za-z_\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD",t=e+"\\-.\\d\\u00B7\\u0300-\\u036F\\u203F-\\u2040",s="["+e+"]["+t+"]*",a=new RegExp("^"+s+"$"),u=function(i,o){const n=[];let l=o.exec(i);for(;l;){const m=[];m.startIndex=o.lastIndex-l[0].length;const h=l.length;for(let g=0;g<h;g++)m.push(l[g]);n.push(m),l=o.exec(i)}return n},c=function(i){const o=a.exec(i);return!(o===null||typeof o>"u")};r.isExist=function(i){return typeof i<"u"},r.isEmptyObject=function(i){return Object.keys(i).length===0},r.merge=function(i,o,n){if(o){const l=Object.keys(o),m=l.length;for(let h=0;h<m;h++)n==="strict"?i[l[h]]=[o[l[h]]]:i[l[h]]=o[l[h]]}},r.getValue=function(i){return r.isExist(i)?i:""},r.isName=c,r.getAllMatches=u,r.nameRegexp=s}(cd)),cd}var md;function ow(){if(md)return um;md=1;const r=dp(),e={allowBooleanAttributes:!1,unpairedTags:[]};um.validate=function(d,f){f=Object.assign({},e,f);const A=[];let C=!1,S=!1;d[0]==="\uFEFF"&&(d=d.substr(1));for(let v=0;v<d.length;v++)if(d[v]==="<"&&d[v+1]==="?"){if(v+=2,v=s(d,v),v.err)return v}else if(d[v]==="<"){let E=v;if(v++,d[v]==="!"){v=a(d,v);continue}else{let k=!1;d[v]==="/"&&(k=!0,v++);let x="";for(;v<d.length&&d[v]!==">"&&d[v]!==" "&&d[v]!=="	"&&d[v]!=="\n"&&d[v]!=="\r";v++)x+=d[v];if(x=x.trim(),x[x.length-1]==="/"&&(x=x.substring(0,x.length-1),v--),!p(x)){let P;return x.trim().length===0?P="Invalid space after '<'.":P="Tag '"+x+"' is an invalid name.",h("InvalidTag",P,w(d,v))}const V=i(d,v);if(V===!1)return h("InvalidAttr","Attributes for '"+x+"' have open quote.",w(d,v));let O=V.value;if(v=V.index,O[O.length-1]==="/"){const P=v-O.length;O=O.substring(0,O.length-1);const B=n(O,f);if(B===!0)C=!0;else return h(B.err.code,B.err.msg,w(d,P+B.err.line))}else if(k)if(V.tagClosed){if(O.trim().length>0)return h("InvalidTag","Closing tag '"+x+"' can't have attributes or invalid starting.",w(d,E));if(A.length===0)return h("InvalidTag","Closing tag '"+x+"' has not been opened.",w(d,E));{const P=A.pop();if(x!==P.tagName){let B=w(d,P.tagStartPos);return h("InvalidTag","Expected closing tag '"+P.tagName+"' (opened in line "+B.line+", col "+B.col+") instead of closing tag '"+x+"'.",w(d,E))}A.length==0&&(S=!0)}}else return h("InvalidTag","Closing tag '"+x+"' doesn't have proper closing.",w(d,v));else{const P=n(O,f);if(P!==!0)return h(P.err.code,P.err.msg,w(d,v-O.length+P.err.line));if(S===!0)return h("InvalidXml","Multiple possible root nodes found.",w(d,v));f.unpairedTags.indexOf(x)!==-1||A.push({tagName:x,tagStartPos:E}),C=!0}for(v++;v<d.length;v++)if(d[v]==="<")if(d[v+1]==="!"){v++,v=a(d,v);continue}else if(d[v+1]==="?"){if(v=s(d,++v),v.err)return v}else break;else if(d[v]==="&"){const P=m(d,v);if(P==-1)return h("InvalidChar","char '&' is not expected.",w(d,v));v=P}else if(S===!0&&!t(d[v]))return h("InvalidXml","Extra text at the end",w(d,v));d[v]==="<"&&v--}}else{if(t(d[v]))continue;return h("InvalidChar","char '"+d[v]+"' is not expected.",w(d,v))}if(C){if(A.length==1)return h("InvalidTag","Unclosed tag '"+A[0].tagName+"'.",w(d,A[0].tagStartPos));if(A.length>0)return h("InvalidXml","Invalid '"+JSON.stringify(A.map(v=>v.tagName),null,4).replace(/\r?\n/g,"")+"' found.",{line:1,col:1})}else return h("InvalidXml","Start tag expected.",1);return!0};function t(d){return d===" "||d==="	"||d==="\n"||d==="\r"}function s(d,f){const A=f;for(;f<d.length;f++)if(d[f]=="?"||d[f]==" "){const C=d.substr(A,f-A);if(f>5&&C==="xml")return h("InvalidXml","XML declaration allowed only at the start of the document.",w(d,f));if(d[f]=="?"&&d[f+1]==">"){f++;break}else continue}return f}function a(d,f){if(d.length>f+5&&d[f+1]==="-"&&d[f+2]==="-"){for(f+=3;f<d.length;f++)if(d[f]==="-"&&d[f+1]==="-"&&d[f+2]===">"){f+=2;break}}else if(d.length>f+8&&d[f+1]==="D"&&d[f+2]==="O"&&d[f+3]==="C"&&d[f+4]==="T"&&d[f+5]==="Y"&&d[f+6]==="P"&&d[f+7]==="E"){let A=1;for(f+=8;f<d.length;f++)if(d[f]==="<")A++;else if(d[f]===">"&&(A--,A===0))break}else if(d.length>f+9&&d[f+1]==="["&&d[f+2]==="C"&&d[f+3]==="D"&&d[f+4]==="A"&&d[f+5]==="T"&&d[f+6]==="A"&&d[f+7]==="["){for(f+=8;f<d.length;f++)if(d[f]==="]"&&d[f+1]==="]"&&d[f+2]===">"){f+=2;break}}return f}const u='"',c="'";function i(d,f){let A="",C="",S=!1;for(;f<d.length;f++){if(d[f]===u||d[f]===c)C===""?C=d[f]:C!==d[f]||(C="");else if(d[f]===">"&&C===""){S=!0;break}A+=d[f]}return C!==""?!1:{value:A,index:f,tagClosed:S}}const o=new RegExp("(\\s*)([^\\s=]+)(\\s*=)?(\\s*(['\"])(([\\s\\S])*?)\\5)?","g");function n(d,f){const A=r.getAllMatches(d,o),C={};for(let S=0;S<A.length;S++){if(A[S][1].length===0)return h("InvalidAttr","Attribute '"+A[S][2]+"' has no space in starting.",b(A[S]));if(A[S][3]!==void 0&&A[S][4]===void 0)return h("InvalidAttr","Attribute '"+A[S][2]+"' is without value.",b(A[S]));if(A[S][3]===void 0&&!f.allowBooleanAttributes)return h("InvalidAttr","boolean attribute '"+A[S][2]+"' is not allowed.",b(A[S]));const v=A[S][2];if(!g(v))return h("InvalidAttr","Attribute '"+v+"' is an invalid name.",b(A[S]));if(!C.hasOwnProperty(v))C[v]=1;else return h("InvalidAttr","Attribute '"+v+"' is repeated.",b(A[S]))}return!0}function l(d,f){let A=/\d/;for(d[f]==="x"&&(f++,A=/[\da-fA-F]/);f<d.length;f++){if(d[f]===";")return f;if(!d[f].match(A))break}return-1}function m(d,f){if(f++,d[f]===";")return-1;if(d[f]==="#")return f++,l(d,f);let A=0;for(;f<d.length;f++,A++)if(!(d[f].match(/\w/)&&A<20)){if(d[f]===";")break;return-1}return f}function h(d,f,A){return{err:{code:d,msg:f,line:A.line||A,col:A.col}}}function g(d){return r.isName(d)}function p(d){return r.isName(d)}function w(d,f){const A=d.substring(0,f).split(/\r?\n/);return{line:A.length,col:A[A.length-1].length+1}}function b(d){return d.startIndex+d[1].length}return um}var uc={},fd;function t0(){if(fd)return uc;fd=1;const r={preserveOrder:!1,attributeNamePrefix:"@_",attributesGroupName:!1,textNodeName:"#text",ignoreAttributes:!0,removeNSPrefix:!1,allowBooleanAttributes:!1,parseTagValue:!0,parseAttributeValue:!1,trimValues:!0,cdataPropName:!1,numberParseOptions:{hex:!0,leadingZeros:!0,eNotation:!0},tagValueProcessor:function(t,s){return s},attributeValueProcessor:function(t,s){return s},stopNodes:[],alwaysCreateTextNode:!1,isArray:()=>!1,commentPropName:!1,unpairedTags:[],processEntities:!0,htmlEntities:!1,ignoreDeclaration:!1,ignorePiTags:!1,transformTagName:!1,transformAttributeName:!1,updateTag:function(t,s,a){return t}},e=function(t){return Object.assign({},r,t)};return uc.buildOptions=e,uc.defaultOptions=r,uc}var lm,pd;function s0(){if(pd)return lm;pd=1;class r{constructor(t){this.tagname=t,this.child=[],this[":@"]={}}add(t,s){t==="__proto__"&&(t="#__proto__"),this.child.push({[t]:s})}addChild(t){t.tagname==="__proto__"&&(t.tagname="#__proto__"),t[":@"]&&Object.keys(t[":@"]).length>0?this.child.push({[t.tagname]:t.child,":@":t[":@"]}):this.child.push({[t.tagname]:t.child})}}return lm=r,lm}var cm,dd;function r0(){if(dd)return cm;dd=1;const r=dp();function e(o,n){const l={};if(o[n+3]==="O"&&o[n+4]==="C"&&o[n+5]==="T"&&o[n+6]==="Y"&&o[n+7]==="P"&&o[n+8]==="E"){n=n+9;let m=1,h=!1,g=!1,p="";for(;n<o.length;n++)if(o[n]==="<"&&!g){if(h&&s(o,n)){n+=7;let w,b;[w,b,n]=t(o,n+1),b.indexOf("&")===-1&&(l[i(w)]={regx:RegExp("&".concat(w,";"),"g"),val:b})}else h&&a(o,n)||h&&u(o,n)?n+=8:h&&c(o,n)?n+=9:g=!0;m++,p=""}else if(o[n]===">"){if(g?o[n-1]==="-"&&o[n-2]==="-"&&(g=!1,m--):m--,m===0)break}else o[n]==="["?h=!0:p+=o[n];if(m!==0)throw new Error("Unclosed DOCTYPE")}else throw new Error("Invalid Tag instead of DOCTYPE");return{entities:l,i:n}}function t(o,n){let l="";for(;n<o.length&&o[n]!=="'"&&o[n]!=='"';n++)l+=o[n];if(l=l.trim(),l.indexOf(" ")!==-1)throw new Error("External entites are not supported");const m=o[n++];let h="";for(;n<o.length&&o[n]!==m;n++)h+=o[n];return[l,h,n]}function s(o,n){return o[n+1]==="!"&&o[n+2]==="E"&&o[n+3]==="N"&&o[n+4]==="T"&&o[n+5]==="I"&&o[n+6]==="T"&&o[n+7]==="Y"}function a(o,n){return o[n+1]==="!"&&o[n+2]==="E"&&o[n+3]==="L"&&o[n+4]==="E"&&o[n+5]==="M"&&o[n+6]==="E"&&o[n+7]==="N"&&o[n+8]==="T"}function u(o,n){return o[n+1]==="!"&&o[n+2]==="A"&&o[n+3]==="T"&&o[n+4]==="T"&&o[n+5]==="L"&&o[n+6]==="I"&&o[n+7]==="S"&&o[n+8]==="T"}function c(o,n){return o[n+1]==="!"&&o[n+2]==="N"&&o[n+3]==="O"&&o[n+4]==="T"&&o[n+5]==="A"&&o[n+6]==="T"&&o[n+7]==="I"&&o[n+8]==="O"&&o[n+9]==="N"}function i(o){if(r.isName(o))return o;throw new Error("Invalid entity name ".concat(o))}return cm=e,cm}var hm,gd;function a0(){if(gd)return hm;gd=1;const r=/^[-+]?0x[a-fA-F0-9]+$/,e=/^([\-\+])?(0*)(\.[0-9]+([eE]\-?[0-9]+)?|[0-9]+(\.[0-9]+([eE]\-?[0-9]+)?)?)$/;!Number.parseInt&&window.parseInt&&(Number.parseInt=window.parseInt),!Number.parseFloat&&window.parseFloat&&(Number.parseFloat=window.parseFloat);const t={hex:!0,leadingZeros:!0,decimalPoint:".",eNotation:!0};function s(u,c={}){if(c=Object.assign({},t,c),!u||typeof u!="string")return u;let i=u.trim();if(c.skipLike!==void 0&&c.skipLike.test(i))return u;if(c.hex&&r.test(i))return Number.parseInt(i,16);{const o=e.exec(i);if(o){const n=o[1],l=o[2];let m=a(o[3]);const h=o[4]||o[6];if(!c.leadingZeros&&l.length>0&&n&&i[2]!=="."||!c.leadingZeros&&l.length>0&&!n&&i[1]!==".")return u;{const g=Number(i),p=""+g;return p.search(/[eE]/)!==-1||h?c.eNotation?g:u:i.indexOf(".")!==-1?p==="0"&&m===""||p===m||n&&p==="-"+m?g:u:l?m===p||n+m===p?g:u:i===p||i===n+p?g:u}}else return u}}function a(u){return u&&u.indexOf(".")!==-1&&(u=u.replace(/0+$/,""),u==="."?u="0":u[0]==="."?u="0"+u:u[u.length-1]==="."&&(u=u.substr(0,u.length-1))),u}return hm=s,hm}var mm,wd;function uw(){if(wd)return mm;wd=1;function r(e){return typeof e=="function"?e:Array.isArray(e)?t=>{for(const s of e)if(typeof s=="string"&&t===s||s instanceof RegExp&&s.test(t))return!0}:()=>!1}return mm=r,mm}var fm,yd;function n0(){if(yd)return fm;yd=1;const r=dp(),e=s0(),t=r0(),s=a0(),a=uw();class u{constructor(v){this.options=v,this.currentNode=null,this.tagsNodeStack=[],this.docTypeEntities={},this.lastEntities={apos:{regex:/&(apos|#39|#x27);/g,val:"'"},gt:{regex:/&(gt|#62|#x3E);/g,val:">"},lt:{regex:/&(lt|#60|#x3C);/g,val:"<"},quot:{regex:/&(quot|#34|#x22);/g,val:'"'}},this.ampEntity={regex:/&(amp|#38|#x26);/g,val:"&"},this.htmlEntities={space:{regex:/&(nbsp|#160);/g,val:" "},cent:{regex:/&(cent|#162);/g,val:"¢"},pound:{regex:/&(pound|#163);/g,val:"£"},yen:{regex:/&(yen|#165);/g,val:"¥"},euro:{regex:/&(euro|#8364);/g,val:"€"},copyright:{regex:/&(copy|#169);/g,val:"©"},reg:{regex:/&(reg|#174);/g,val:"®"},inr:{regex:/&(inr|#8377);/g,val:"₹"},num_dec:{regex:/&#([0-9]{1,7});/g,val:(E,k)=>String.fromCharCode(Number.parseInt(k,10))},num_hex:{regex:/&#x([0-9a-fA-F]{1,6});/g,val:(E,k)=>String.fromCharCode(Number.parseInt(k,16))}},this.addExternalEntities=c,this.parseXml=m,this.parseTextData=i,this.resolveNameSpace=o,this.buildAttributesMap=l,this.isItStopNode=w,this.replaceEntitiesValue=g,this.readStopNodeData=A,this.saveTextToParentTag=p,this.addChild=h,this.ignoreAttributesFn=a(this.options.ignoreAttributes)}}function c(S){const v=Object.keys(S);for(let E=0;E<v.length;E++){const k=v[E];this.lastEntities[k]={regex:new RegExp("&"+k+";","g"),val:S[k]}}}function i(S,v,E,k,x,V,O){if(S!==void 0&&(this.options.trimValues&&!k&&(S=S.trim()),S.length>0)){O||(S=this.replaceEntitiesValue(S));const P=this.options.tagValueProcessor(v,S,E,x,V);return P==null?S:typeof P!=typeof S||P!==S?P:this.options.trimValues?C(S,this.options.parseTagValue,this.options.numberParseOptions):S.trim()===S?C(S,this.options.parseTagValue,this.options.numberParseOptions):S}}function o(S){if(this.options.removeNSPrefix){const v=S.split(":"),E=S.charAt(0)==="/"?"/":"";if(v[0]==="xmlns")return"";v.length===2&&(S=E+v[1])}return S}const n=new RegExp("([^\\s=]+)\\s*(=\\s*(['\"])([\\s\\S]*?)\\3)?","gm");function l(S,v,E){if(this.options.ignoreAttributes!==!0&&typeof S=="string"){const k=r.getAllMatches(S,n),x=k.length,V={};for(let O=0;O<x;O++){const P=this.resolveNameSpace(k[O][1]);if(this.ignoreAttributesFn(P,v))continue;let B=k[O][4],L=this.options.attributeNamePrefix+P;if(P.length)if(this.options.transformAttributeName&&(L=this.options.transformAttributeName(L)),L==="__proto__"&&(L="#__proto__"),B!==void 0){this.options.trimValues&&(B=B.trim()),B=this.replaceEntitiesValue(B);const H=this.options.attributeValueProcessor(P,B,v);H==null?V[L]=B:typeof H!=typeof B||H!==B?V[L]=H:V[L]=C(B,this.options.parseAttributeValue,this.options.numberParseOptions)}else this.options.allowBooleanAttributes&&(V[L]=!0)}if(!Object.keys(V).length)return;if(this.options.attributesGroupName){const O={};return O[this.options.attributesGroupName]=V,O}return V}}const m=function(S){S=S.replace(/\r\n?/g,"\n");const v=new e("!xml");let E=v,k="",x="";for(let V=0;V<S.length;V++)if(S[V]==="<")if(S[V+1]==="/"){const O=d(S,">",V,"Closing Tag is not closed.");let P=S.substring(V+2,O).trim();if(this.options.removeNSPrefix){const H=P.indexOf(":");H!==-1&&(P=P.substr(H+1))}this.options.transformTagName&&(P=this.options.transformTagName(P)),E&&(k=this.saveTextToParentTag(k,E,x));const B=x.substring(x.lastIndexOf(".")+1);if(P&&this.options.unpairedTags.indexOf(P)!==-1)throw new Error("Unpaired tag can not be used as closing tag: </".concat(P,">"));let L=0;B&&this.options.unpairedTags.indexOf(B)!==-1?(L=x.lastIndexOf(".",x.lastIndexOf(".")-1),this.tagsNodeStack.pop()):L=x.lastIndexOf("."),x=x.substring(0,L),E=this.tagsNodeStack.pop(),k="",V=O}else if(S[V+1]==="?"){let O=f(S,V,!1,"?>");if(!O)throw new Error("Pi Tag is not closed.");if(k=this.saveTextToParentTag(k,E,x),!(this.options.ignoreDeclaration&&O.tagName==="?xml"||this.options.ignorePiTags)){const P=new e(O.tagName);P.add(this.options.textNodeName,""),O.tagName!==O.tagExp&&O.attrExpPresent&&(P[":@"]=this.buildAttributesMap(O.tagExp,x,O.tagName)),this.addChild(E,P,x)}V=O.closeIndex+1}else if(S.substr(V+1,3)==="!--"){const O=d(S,"-->",V+4,"Comment is not closed.");if(this.options.commentPropName){const P=S.substring(V+4,O-2);k=this.saveTextToParentTag(k,E,x),E.add(this.options.commentPropName,[{[this.options.textNodeName]:P}])}V=O}else if(S.substr(V+1,2)==="!D"){const O=t(S,V);this.docTypeEntities=O.entities,V=O.i}else if(S.substr(V+1,2)==="!["){const O=d(S,"]]>",V,"CDATA is not closed.")-2,P=S.substring(V+9,O);k=this.saveTextToParentTag(k,E,x);let B=this.parseTextData(P,E.tagname,x,!0,!1,!0,!0);B==null&&(B=""),this.options.cdataPropName?E.add(this.options.cdataPropName,[{[this.options.textNodeName]:P}]):E.add(this.options.textNodeName,B),V=O+2}else{let O=f(S,V,this.options.removeNSPrefix),P=O.tagName;const B=O.rawTagName;let L=O.tagExp,H=O.attrExpPresent,z=O.closeIndex;this.options.transformTagName&&(P=this.options.transformTagName(P)),E&&k&&E.tagname!=="!xml"&&(k=this.saveTextToParentTag(k,E,x,!1));const re=E;if(re&&this.options.unpairedTags.indexOf(re.tagname)!==-1&&(E=this.tagsNodeStack.pop(),x=x.substring(0,x.lastIndexOf("."))),P!==v.tagname&&(x+=x?"."+P:P),this.isItStopNode(this.options.stopNodes,x,P)){let _="";if(L.length>0&&L.lastIndexOf("/")===L.length-1)P[P.length-1]==="/"?(P=P.substr(0,P.length-1),x=x.substr(0,x.length-1),L=P):L=L.substr(0,L.length-1),V=O.closeIndex;else if(this.options.unpairedTags.indexOf(P)!==-1)V=O.closeIndex;else{const J=this.readStopNodeData(S,B,z+1);if(!J)throw new Error("Unexpected end of ".concat(B));V=J.i,_=J.tagContent}const X=new e(P);P!==L&&H&&(X[":@"]=this.buildAttributesMap(L,x,P)),_&&(_=this.parseTextData(_,P,x,!0,H,!0,!0)),x=x.substr(0,x.lastIndexOf(".")),X.add(this.options.textNodeName,_),this.addChild(E,X,x)}else{if(L.length>0&&L.lastIndexOf("/")===L.length-1){P[P.length-1]==="/"?(P=P.substr(0,P.length-1),x=x.substr(0,x.length-1),L=P):L=L.substr(0,L.length-1),this.options.transformTagName&&(P=this.options.transformTagName(P));const _=new e(P);P!==L&&H&&(_[":@"]=this.buildAttributesMap(L,x,P)),this.addChild(E,_,x),x=x.substr(0,x.lastIndexOf("."))}else{const _=new e(P);this.tagsNodeStack.push(E),P!==L&&H&&(_[":@"]=this.buildAttributesMap(L,x,P)),this.addChild(E,_,x),E=_}k="",V=z}}else k+=S[V];return v.child};function h(S,v,E){const k=this.options.updateTag(v.tagname,E,v[":@"]);k===!1||(typeof k=="string"&&(v.tagname=k),S.addChild(v))}const g=function(S){if(this.options.processEntities){for(let v in this.docTypeEntities){const E=this.docTypeEntities[v];S=S.replace(E.regx,E.val)}for(let v in this.lastEntities){const E=this.lastEntities[v];S=S.replace(E.regex,E.val)}if(this.options.htmlEntities)for(let v in this.htmlEntities){const E=this.htmlEntities[v];S=S.replace(E.regex,E.val)}S=S.replace(this.ampEntity.regex,this.ampEntity.val)}return S};function p(S,v,E,k){return S&&(k===void 0&&(k=Object.keys(v.child).length===0),S=this.parseTextData(S,v.tagname,E,!1,v[":@"]?Object.keys(v[":@"]).length!==0:!1,k),S!==void 0&&S!==""&&v.add(this.options.textNodeName,S),S=""),S}function w(S,v,E){const k="*."+E;for(const x in S){const V=S[x];if(k===V||v===V)return!0}return!1}function b(S,v,E=">"){let k,x="";for(let V=v;V<S.length;V++){let O=S[V];if(k)O===k&&(k="");else if(O==='"'||O==="'")k=O;else if(O===E[0])if(E[1]){if(S[V+1]===E[1])return{data:x,index:V}}else return{data:x,index:V};else O==="	"&&(O=" ");x+=O}}function d(S,v,E,k){const x=S.indexOf(v,E);if(x===-1)throw new Error(k);return x+v.length-1}function f(S,v,E,k=">"){const x=b(S,v+1,k);if(!x)return;let V=x.data;const O=x.index,P=V.search(/\s/);let B=V,L=!0;P!==-1&&(B=V.substring(0,P),V=V.substring(P+1).trimStart());const H=B;if(E){const z=B.indexOf(":");z!==-1&&(B=B.substr(z+1),L=B!==x.data.substr(z+1))}return{tagName:B,tagExp:V,closeIndex:O,attrExpPresent:L,rawTagName:H}}function A(S,v,E){const k=E;let x=1;for(;E<S.length;E++)if(S[E]==="<")if(S[E+1]==="/"){const V=d(S,">",E,"".concat(v," is not closed"));if(S.substring(E+2,V).trim()===v&&(x--,x===0))return{tagContent:S.substring(k,E),i:V};E=V}else if(S[E+1]==="?")E=d(S,"?>",E+1,"StopNode is not closed.");else if(S.substr(E+1,3)==="!--")E=d(S,"-->",E+3,"StopNode is not closed.");else if(S.substr(E+1,2)==="![")E=d(S,"]]>",E,"StopNode is not closed.")-2;else{const V=f(S,E,">");V&&((V&&V.tagName)===v&&V.tagExp[V.tagExp.length-1]!=="/"&&x++,E=V.closeIndex)}}function C(S,v,E){if(v&&typeof S=="string"){const k=S.trim();return k==="true"?!0:k==="false"?!1:s(S,E)}else return r.isExist(S)?S:""}return fm=u,fm}var pm={},vd;function i0(){if(vd)return pm;vd=1;function r(u,c){return e(u,c)}function e(u,c,i){let o;const n={};for(let l=0;l<u.length;l++){const m=u[l],h=t(m);let g="";if(i===void 0?g=h:g=i+"."+h,h===c.textNodeName)o===void 0?o=m[h]:o+=""+m[h];else{if(h===void 0)continue;if(m[h]){let p=e(m[h],c,g);const w=a(p,c);m[":@"]?s(p,m[":@"],g,c):Object.keys(p).length===1&&p[c.textNodeName]!==void 0&&!c.alwaysCreateTextNode?p=p[c.textNodeName]:Object.keys(p).length===0&&(c.alwaysCreateTextNode?p[c.textNodeName]="":p=""),n[h]!==void 0&&n.hasOwnProperty(h)?(Array.isArray(n[h])||(n[h]=[n[h]]),n[h].push(p)):c.isArray(h,g,w)?n[h]=[p]:n[h]=p}}}return typeof o=="string"?o.length>0&&(n[c.textNodeName]=o):o!==void 0&&(n[c.textNodeName]=o),n}function t(u){const c=Object.keys(u);for(let i=0;i<c.length;i++){const o=c[i];if(o!==":@")return o}}function s(u,c,i,o){if(c){const n=Object.keys(c),l=n.length;for(let m=0;m<l;m++){const h=n[m];o.isArray(h,i+"."+h,!0,!0)?u[h]=[c[h]]:u[h]=c[h]}}}function a(u,c){const{textNodeName:i}=c,o=Object.keys(u).length;return!!(o===0||o===1&&(u[i]||typeof u[i]=="boolean"||u[i]===0))}return pm.prettify=r,pm}var dm,bd;function o0(){if(bd)return dm;bd=1;const{buildOptions:r}=t0(),e=n0(),{prettify:t}=i0(),s=ow();class a{constructor(c){this.externalEntities={},this.options=r(c)}parse(c,i){if(typeof c!="string")if(c.toString)c=c.toString();else throw new Error("XML data is accepted in String or Bytes[] form.");if(i){i===!0&&(i={});const l=s.validate(c,i);if(l!==!0)throw Error("".concat(l.err.msg,":").concat(l.err.line,":").concat(l.err.col))}const o=new e(this.options);o.addExternalEntities(this.externalEntities);const n=o.parseXml(c);return this.options.preserveOrder||n===void 0?n:t(n,this.options)}addEntity(c,i){if(i.indexOf("&")!==-1)throw new Error("Entity value can't have '&'");if(c.indexOf("&")!==-1||c.indexOf(";")!==-1)throw new Error("An entity must be set without '&' and ';'. Eg. use '#xD' for '&#xD;'");if(i==="&")throw new Error("An entity with value '&' is not permitted");this.externalEntities[c]=i}}return dm=a,dm}var gm,Sd;function u0(){if(Sd)return gm;Sd=1;const r="\n";function e(i,o){let n="";return o.format&&o.indentBy.length>0&&(n=r),t(i,o,"",n)}function t(i,o,n,l){let m="",h=!1;for(let g=0;g<i.length;g++){const p=i[g],w=s(p);if(w===void 0)continue;let b="";if(n.length===0?b=w:b="".concat(n,".").concat(w),w===o.textNodeName){let S=p[w];u(b,o)||(S=o.tagValueProcessor(w,S),S=c(S,o)),h&&(m+=l),m+=S,h=!1;continue}else if(w===o.cdataPropName){h&&(m+=l),m+="<![CDATA[".concat(p[w][0][o.textNodeName],"]]>"),h=!1;continue}else if(w===o.commentPropName){m+=l+"<!--".concat(p[w][0][o.textNodeName],"-->"),h=!0;continue}else if(w[0]==="?"){const S=a(p[":@"],o),v=w==="?xml"?"":l;let E=p[w][0][o.textNodeName];E=E.length!==0?" "+E:"",m+=v+"<".concat(w).concat(E).concat(S,"?>"),h=!0;continue}let d=l;d!==""&&(d+=o.indentBy);const f=a(p[":@"],o),A=l+"<".concat(w).concat(f),C=t(p[w],o,b,d);o.unpairedTags.indexOf(w)!==-1?o.suppressUnpairedNode?m+=A+">":m+=A+"/>":(!C||C.length===0)&&o.suppressEmptyNode?m+=A+"/>":C&&C.endsWith(">")?m+=A+">".concat(C).concat(l,"</").concat(w,">"):(m+=A+">",C&&l!==""&&(C.includes("/>")||C.includes("</"))?m+=l+o.indentBy+C+l:m+=C,m+="</".concat(w,">")),h=!0}return m}function s(i){const o=Object.keys(i);for(let n=0;n<o.length;n++){const l=o[n];if(i.hasOwnProperty(l)&&l!==":@")return l}}function a(i,o){let n="";if(i&&!o.ignoreAttributes)for(let l in i){if(!i.hasOwnProperty(l))continue;let m=o.attributeValueProcessor(l,i[l]);m=c(m,o),m===!0&&o.suppressBooleanAttributes?n+=" ".concat(l.substr(o.attributeNamePrefix.length)):n+=" ".concat(l.substr(o.attributeNamePrefix.length),'="').concat(m,'"')}return n}function u(i,o){i=i.substr(0,i.length-o.textNodeName.length-1);let n=i.substr(i.lastIndexOf(".")+1);for(let l in o.stopNodes)if(o.stopNodes[l]===i||o.stopNodes[l]==="*."+n)return!0;return!1}function c(i,o){if(i&&i.length>0&&o.processEntities)for(let n=0;n<o.entities.length;n++){const l=o.entities[n];i=i.replace(l.regex,l.val)}return i}return gm=e,gm}var wm,Ad;function l0(){if(Ad)return wm;Ad=1;const r=u0(),e=uw(),t={attributeNamePrefix:"@_",attributesGroupName:!1,textNodeName:"#text",ignoreAttributes:!0,cdataPropName:!1,format:!1,indentBy:"  ",suppressEmptyNode:!1,suppressUnpairedNode:!0,suppressBooleanAttributes:!0,tagValueProcessor:function(i,o){return o},attributeValueProcessor:function(i,o){return o},preserveOrder:!1,commentPropName:!1,unpairedTags:[],entities:[{regex:new RegExp("&","g"),val:"&amp;"},{regex:new RegExp(">","g"),val:"&gt;"},{regex:new RegExp("<","g"),val:"&lt;"},{regex:new RegExp("'","g"),val:"&apos;"},{regex:new RegExp('"',"g"),val:"&quot;"}],processEntities:!0,stopNodes:[],oneListGroup:!1};function s(i){this.options=Object.assign({},t,i),this.options.ignoreAttributes===!0||this.options.attributesGroupName?this.isAttribute=function(){return!1}:(this.ignoreAttributesFn=e(this.options.ignoreAttributes),this.attrPrefixLen=this.options.attributeNamePrefix.length,this.isAttribute=c),this.processTextOrObjNode=a,this.options.format?(this.indentate=u,this.tagEndChar=">\n",this.newLine="\n"):(this.indentate=function(){return""},this.tagEndChar=">",this.newLine="")}s.prototype.build=function(i){return this.options.preserveOrder?r(i,this.options):(Array.isArray(i)&&this.options.arrayNodeName&&this.options.arrayNodeName.length>1&&(i={[this.options.arrayNodeName]:i}),this.j2x(i,0,[]).val)},s.prototype.j2x=function(i,o,n){let l="",m="";const h=n.join(".");for(let g in i)if(Object.prototype.hasOwnProperty.call(i,g))if(typeof i[g]>"u")this.isAttribute(g)&&(m+="");else if(i[g]===null)this.isAttribute(g)?m+="":g[0]==="?"?m+=this.indentate(o)+"<"+g+"?"+this.tagEndChar:m+=this.indentate(o)+"<"+g+"/"+this.tagEndChar;else if(i[g]instanceof Date)m+=this.buildTextValNode(i[g],g,"",o);else if(typeof i[g]!="object"){const p=this.isAttribute(g);if(p&&!this.ignoreAttributesFn(p,h))l+=this.buildAttrPairStr(p,""+i[g]);else if(!p)if(g===this.options.textNodeName){let w=this.options.tagValueProcessor(g,""+i[g]);m+=this.replaceEntitiesValue(w)}else m+=this.buildTextValNode(i[g],g,"",o)}else if(Array.isArray(i[g])){const p=i[g].length;let w="",b="";for(let d=0;d<p;d++){const f=i[g][d];if(!(typeof f>"u"))if(f===null)g[0]==="?"?m+=this.indentate(o)+"<"+g+"?"+this.tagEndChar:m+=this.indentate(o)+"<"+g+"/"+this.tagEndChar;else if(typeof f=="object")if(this.options.oneListGroup){const A=this.j2x(f,o+1,n.concat(g));w+=A.val,this.options.attributesGroupName&&f.hasOwnProperty(this.options.attributesGroupName)&&(b+=A.attrStr)}else w+=this.processTextOrObjNode(f,g,o,n);else if(this.options.oneListGroup){let A=this.options.tagValueProcessor(g,f);A=this.replaceEntitiesValue(A),w+=A}else w+=this.buildTextValNode(f,g,"",o)}this.options.oneListGroup&&(w=this.buildObjectNode(w,g,b,o)),m+=w}else if(this.options.attributesGroupName&&g===this.options.attributesGroupName){const p=Object.keys(i[g]),w=p.length;for(let b=0;b<w;b++)l+=this.buildAttrPairStr(p[b],""+i[g][p[b]])}else m+=this.processTextOrObjNode(i[g],g,o,n);return{attrStr:l,val:m}},s.prototype.buildAttrPairStr=function(i,o){return o=this.options.attributeValueProcessor(i,""+o),o=this.replaceEntitiesValue(o),this.options.suppressBooleanAttributes&&o==="true"?" "+i:" "+i+'="'+o+'"'};function a(i,o,n,l){const m=this.j2x(i,n+1,l.concat(o));return i[this.options.textNodeName]!==void 0&&Object.keys(i).length===1?this.buildTextValNode(i[this.options.textNodeName],o,m.attrStr,n):this.buildObjectNode(m.val,o,m.attrStr,n)}s.prototype.buildObjectNode=function(i,o,n,l){if(i==="")return o[0]==="?"?this.indentate(l)+"<"+o+n+"?"+this.tagEndChar:this.indentate(l)+"<"+o+n+this.closeTag(o)+this.tagEndChar;{let m="</"+o+this.tagEndChar,h="";return o[0]==="?"&&(h="?",m=""),(n||n==="")&&i.indexOf("<")===-1?this.indentate(l)+"<"+o+n+h+">"+i+m:this.options.commentPropName!==!1&&o===this.options.commentPropName&&h.length===0?this.indentate(l)+"<!--".concat(i,"-->")+this.newLine:this.indentate(l)+"<"+o+n+h+this.tagEndChar+i+this.indentate(l)+m}},s.prototype.closeTag=function(i){let o="";return this.options.unpairedTags.indexOf(i)!==-1?this.options.suppressUnpairedNode||(o="/"):this.options.suppressEmptyNode?o="/":o="></".concat(i),o},s.prototype.buildTextValNode=function(i,o,n,l){if(this.options.cdataPropName!==!1&&o===this.options.cdataPropName)return this.indentate(l)+"<![CDATA[".concat(i,"]]>")+this.newLine;if(this.options.commentPropName!==!1&&o===this.options.commentPropName)return this.indentate(l)+"<!--".concat(i,"-->")+this.newLine;if(o[0]==="?")return this.indentate(l)+"<"+o+n+"?"+this.tagEndChar;{let m=this.options.tagValueProcessor(o,i);return m=this.replaceEntitiesValue(m),m===""?this.indentate(l)+"<"+o+n+this.closeTag(o)+this.tagEndChar:this.indentate(l)+"<"+o+n+">"+m+"</"+o+this.tagEndChar}},s.prototype.replaceEntitiesValue=function(i){if(i&&i.length>0&&this.options.processEntities)for(let o=0;o<this.options.entities.length;o++){const n=this.options.entities[o];i=i.replace(n.regex,n.val)}return i};function u(i){return this.options.indentBy.repeat(i)}function c(i){return i.startsWith(this.options.attributeNamePrefix)&&i!==this.options.textNodeName?i.substr(this.attrPrefixLen):!1}return wm=s,wm}var ym,Nd;function c0(){if(Nd)return ym;Nd=1;const r=ow(),e=o0(),t=l0();return ym={XMLParser:e,XMLValidator:r,XMLBuilder:t},ym}c0();var kd,Ed;function lw(){return Ed||(Ed=1,kd=typeof We=="object"&&om&&om.NODE_DEBUG&&/\bsemver\b/i.test(om.NODE_DEBUG)?(...r)=>console.error("SEMVER",...r):()=>{}),kd}var vm,Cd;function cw(){if(Cd)return vm;Cd=1;const r="2.0.0",e=256,t=Number.MAX_SAFE_INTEGER||9007199254740991,s=16,a=e-6;return vm={MAX_LENGTH:e,MAX_SAFE_COMPONENT_LENGTH:s,MAX_SAFE_BUILD_LENGTH:a,MAX_SAFE_INTEGER:t,RELEASE_TYPES:["major","premajor","minor","preminor","patch","prepatch","prerelease"],SEMVER_SPEC_VERSION:r,FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2},vm}var bm={exports:{}},xd;function h0(){return xd||(xd=1,function(r,e){const{MAX_SAFE_COMPONENT_LENGTH:t,MAX_SAFE_BUILD_LENGTH:s,MAX_LENGTH:a}=cw(),u=lw();e=r.exports={};const c=e.re=[],i=e.safeRe=[],o=e.src=[],n=e.t={};let l=0;const m="[a-zA-Z0-9-]",h=[["\\s",1],["\\d",a],[m,s]],g=w=>{for(const[b,d]of h)w=w.split("".concat(b,"*")).join("".concat(b,"{0,").concat(d,"}")).split("".concat(b,"+")).join("".concat(b,"{1,").concat(d,"}"));return w},p=(w,b,d)=>{const f=g(b),A=l++;u(w,A,b),n[w]=A,o[A]=b,c[A]=new RegExp(b,d?"g":void 0),i[A]=new RegExp(f,d?"g":void 0)};p("NUMERICIDENTIFIER","0|[1-9]\\d*"),p("NUMERICIDENTIFIERLOOSE","\\d+"),p("NONNUMERICIDENTIFIER","\\d*[a-zA-Z-]".concat(m,"*")),p("MAINVERSION","(".concat(o[n.NUMERICIDENTIFIER],")\\.(").concat(o[n.NUMERICIDENTIFIER],")\\.(").concat(o[n.NUMERICIDENTIFIER],")")),p("MAINVERSIONLOOSE","(".concat(o[n.NUMERICIDENTIFIERLOOSE],")\\.(").concat(o[n.NUMERICIDENTIFIERLOOSE],")\\.(").concat(o[n.NUMERICIDENTIFIERLOOSE],")")),p("PRERELEASEIDENTIFIER","(?:".concat(o[n.NUMERICIDENTIFIER],"|").concat(o[n.NONNUMERICIDENTIFIER],")")),p("PRERELEASEIDENTIFIERLOOSE","(?:".concat(o[n.NUMERICIDENTIFIERLOOSE],"|").concat(o[n.NONNUMERICIDENTIFIER],")")),p("PRERELEASE","(?:-(".concat(o[n.PRERELEASEIDENTIFIER],"(?:\\.").concat(o[n.PRERELEASEIDENTIFIER],")*))")),p("PRERELEASELOOSE","(?:-?(".concat(o[n.PRERELEASEIDENTIFIERLOOSE],"(?:\\.").concat(o[n.PRERELEASEIDENTIFIERLOOSE],")*))")),p("BUILDIDENTIFIER","".concat(m,"+")),p("BUILD","(?:\\+(".concat(o[n.BUILDIDENTIFIER],"(?:\\.").concat(o[n.BUILDIDENTIFIER],")*))")),p("FULLPLAIN","v?".concat(o[n.MAINVERSION]).concat(o[n.PRERELEASE],"?").concat(o[n.BUILD],"?")),p("FULL","^".concat(o[n.FULLPLAIN],"$")),p("LOOSEPLAIN","[v=\\s]*".concat(o[n.MAINVERSIONLOOSE]).concat(o[n.PRERELEASELOOSE],"?").concat(o[n.BUILD],"?")),p("LOOSE","^".concat(o[n.LOOSEPLAIN],"$")),p("GTLT","((?:<|>)?=?)"),p("XRANGEIDENTIFIERLOOSE","".concat(o[n.NUMERICIDENTIFIERLOOSE],"|x|X|\\*")),p("XRANGEIDENTIFIER","".concat(o[n.NUMERICIDENTIFIER],"|x|X|\\*")),p("XRANGEPLAIN","[v=\\s]*(".concat(o[n.XRANGEIDENTIFIER],")(?:\\.(").concat(o[n.XRANGEIDENTIFIER],")(?:\\.(").concat(o[n.XRANGEIDENTIFIER],")(?:").concat(o[n.PRERELEASE],")?").concat(o[n.BUILD],"?)?)?")),p("XRANGEPLAINLOOSE","[v=\\s]*(".concat(o[n.XRANGEIDENTIFIERLOOSE],")(?:\\.(").concat(o[n.XRANGEIDENTIFIERLOOSE],")(?:\\.(").concat(o[n.XRANGEIDENTIFIERLOOSE],")(?:").concat(o[n.PRERELEASELOOSE],")?").concat(o[n.BUILD],"?)?)?")),p("XRANGE","^".concat(o[n.GTLT],"\\s*").concat(o[n.XRANGEPLAIN],"$")),p("XRANGELOOSE","^".concat(o[n.GTLT],"\\s*").concat(o[n.XRANGEPLAINLOOSE],"$")),p("COERCEPLAIN","(^|[^\\d])(\\d{1,".concat(t,"})(?:\\.(\\d{1,").concat(t,"}))?(?:\\.(\\d{1,").concat(t,"}))?")),p("COERCE","".concat(o[n.COERCEPLAIN],"(?:$|[^\\d])")),p("COERCEFULL",o[n.COERCEPLAIN]+"(?:".concat(o[n.PRERELEASE],")?(?:").concat(o[n.BUILD],")?(?:$|[^\\d])")),p("COERCERTL",o[n.COERCE],!0),p("COERCERTLFULL",o[n.COERCEFULL],!0),p("LONETILDE","(?:~>?)"),p("TILDETRIM","(\\s*)".concat(o[n.LONETILDE],"\\s+"),!0),e.tildeTrimReplace="$1~",p("TILDE","^".concat(o[n.LONETILDE]).concat(o[n.XRANGEPLAIN],"$")),p("TILDELOOSE","^".concat(o[n.LONETILDE]).concat(o[n.XRANGEPLAINLOOSE],"$")),p("LONECARET","(?:\\^)"),p("CARETTRIM","(\\s*)".concat(o[n.LONECARET],"\\s+"),!0),e.caretTrimReplace="$1^",p("CARET","^".concat(o[n.LONECARET]).concat(o[n.XRANGEPLAIN],"$")),p("CARETLOOSE","^".concat(o[n.LONECARET]).concat(o[n.XRANGEPLAINLOOSE],"$")),p("COMPARATORLOOSE","^".concat(o[n.GTLT],"\\s*(").concat(o[n.LOOSEPLAIN],")$|^$")),p("COMPARATOR","^".concat(o[n.GTLT],"\\s*(").concat(o[n.FULLPLAIN],")$|^$")),p("COMPARATORTRIM","(\\s*)".concat(o[n.GTLT],"\\s*(").concat(o[n.LOOSEPLAIN],"|").concat(o[n.XRANGEPLAIN],")"),!0),e.comparatorTrimReplace="$1$2$3",p("HYPHENRANGE","^\\s*(".concat(o[n.XRANGEPLAIN],")\\s+-\\s+(").concat(o[n.XRANGEPLAIN],")\\s*$")),p("HYPHENRANGELOOSE","^\\s*(".concat(o[n.XRANGEPLAINLOOSE],")\\s+-\\s+(").concat(o[n.XRANGEPLAINLOOSE],")\\s*$")),p("STAR","(<|>)?=?\\s*\\*"),p("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),p("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")}(bm,bm.exports)),bm.exports}var Sm,Id;function m0(){if(Id)return Sm;Id=1;const r=Object.freeze({loose:!0}),e=Object.freeze({});return Sm=t=>t?typeof t!="object"?r:t:e,Sm}var Am,Vd;function f0(){if(Vd)return Am;Vd=1;const r=/^[0-9]+$/,e=(t,s)=>{const a=r.test(t),u=r.test(s);return a&&u&&(t=+t,s=+s),t===s?0:a&&!u?-1:u&&!a?1:t<s?-1:1};return Am={compareIdentifiers:e,rcompareIdentifiers:(t,s)=>e(s,t)},Am}var Nm,Pd;function hw(){if(Pd)return Nm;Pd=1;const r=lw(),{MAX_LENGTH:e,MAX_SAFE_INTEGER:t}=cw(),{safeRe:s,t:a}=h0(),u=m0(),{compareIdentifiers:c}=f0();class i{constructor(n,l){if(l=u(l),n instanceof i){if(n.loose===!!l.loose&&n.includePrerelease===!!l.includePrerelease)return n;n=n.version}else if(typeof n!="string")throw new TypeError('Invalid version. Must be a string. Got type "'.concat(typeof n,'".'));if(n.length>e)throw new TypeError("version is longer than ".concat(e," characters"));r("SemVer",n,l),this.options=l,this.loose=!!l.loose,this.includePrerelease=!!l.includePrerelease;const m=n.trim().match(l.loose?s[a.LOOSE]:s[a.FULL]);if(!m)throw new TypeError("Invalid Version: ".concat(n));if(this.raw=n,this.major=+m[1],this.minor=+m[2],this.patch=+m[3],this.major>t||this.major<0)throw new TypeError("Invalid major version");if(this.minor>t||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>t||this.patch<0)throw new TypeError("Invalid patch version");m[4]?this.prerelease=m[4].split(".").map(h=>{if(/^[0-9]+$/.test(h)){const g=+h;if(g>=0&&g<t)return g}return h}):this.prerelease=[],this.build=m[5]?m[5].split("."):[],this.format()}format(){return this.version="".concat(this.major,".").concat(this.minor,".").concat(this.patch),this.prerelease.length&&(this.version+="-".concat(this.prerelease.join("."))),this.version}toString(){return this.version}compare(n){if(r("SemVer.compare",this.version,this.options,n),!(n instanceof i)){if(typeof n=="string"&&n===this.version)return 0;n=new i(n,this.options)}return n.version===this.version?0:this.compareMain(n)||this.comparePre(n)}compareMain(n){return n instanceof i||(n=new i(n,this.options)),c(this.major,n.major)||c(this.minor,n.minor)||c(this.patch,n.patch)}comparePre(n){if(n instanceof i||(n=new i(n,this.options)),this.prerelease.length&&!n.prerelease.length)return-1;if(!this.prerelease.length&&n.prerelease.length)return 1;if(!this.prerelease.length&&!n.prerelease.length)return 0;let l=0;do{const m=this.prerelease[l],h=n.prerelease[l];if(r("prerelease compare",l,m,h),m===void 0&&h===void 0)return 0;if(h===void 0)return 1;if(m===void 0)return-1;if(m!==h)return c(m,h)}while(++l)}compareBuild(n){n instanceof i||(n=new i(n,this.options));let l=0;do{const m=this.build[l],h=n.build[l];if(r("build compare",l,m,h),m===void 0&&h===void 0)return 0;if(h===void 0)return 1;if(m===void 0)return-1;if(m!==h)return c(m,h)}while(++l)}inc(n,l,m){switch(n){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",l,m);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",l,m);break;case"prepatch":this.prerelease.length=0,this.inc("patch",l,m),this.inc("pre",l,m);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",l,m),this.inc("pre",l,m);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":{const h=Number(m)?1:0;if(!l&&m===!1)throw new Error("invalid increment argument: identifier is empty");if(this.prerelease.length===0)this.prerelease=[h];else{let g=this.prerelease.length;for(;--g>=0;)typeof this.prerelease[g]=="number"&&(this.prerelease[g]++,g=-2);if(g===-1){if(l===this.prerelease.join(".")&&m===!1)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(h)}}if(l){let g=[l,h];m===!1&&(g=[l]),c(this.prerelease[0],l)===0?isNaN(this.prerelease[1])&&(this.prerelease=g):this.prerelease=g}break}default:throw new Error("invalid increment argument: ".concat(n))}return this.raw=this.format(),this.build.length&&(this.raw+="+".concat(this.build.join("."))),this}}return Nm=i,Nm}var km,Od;function p0(){if(Od)return km;Od=1;const r=hw();return km=(e,t,s=!1)=>{if(e instanceof r)return e;try{return new r(e,t)}catch(a){if(!s)return null;throw a}},km}var Em,Bd;function d0(){if(Bd)return Em;Bd=1;const r=p0();return Em=(e,t)=>{const s=r(e,t);return s?s.version:null},Em}d0();var Cm,Dd;function g0(){if(Dd)return Cm;Dd=1;const r=hw();return Cm=(e,t)=>new r(e,t).major,Cm}g0();var xm={},Td={},Rd;function gp(){return Rd||(Rd=1,function(r){const e=":A-Za-z_\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD",t=e+"\\-.\\d\\u00B7\\u0300-\\u036F\\u203F-\\u2040",s="["+e+"]["+t+"]*",a=new RegExp("^"+s+"$"),u=function(i,o){const n=[];let l=o.exec(i);for(;l;){const m=[];m.startIndex=o.lastIndex-l[0].length;const h=l.length;for(let g=0;g<h;g++)m.push(l[g]);n.push(m),l=o.exec(i)}return n},c=function(i){const o=a.exec(i);return!(o===null||typeof o>"u")};r.isExist=function(i){return typeof i<"u"},r.isEmptyObject=function(i){return Object.keys(i).length===0},r.merge=function(i,o,n){if(o){const l=Object.keys(o),m=l.length;for(let h=0;h<m;h++)n==="strict"?i[l[h]]=[o[l[h]]]:i[l[h]]=o[l[h]]}},r.getValue=function(i){return r.isExist(i)?i:""},r.isName=c,r.getAllMatches=u,r.nameRegexp=s}(Td)),Td}var Ld;function mw(){if(Ld)return xm;Ld=1;const r=gp(),e={allowBooleanAttributes:!1,unpairedTags:[]};xm.validate=function(d,f){f=Object.assign({},e,f);const A=[];let C=!1,S=!1;d[0]==="\uFEFF"&&(d=d.substr(1));for(let v=0;v<d.length;v++)if(d[v]==="<"&&d[v+1]==="?"){if(v+=2,v=s(d,v),v.err)return v}else if(d[v]==="<"){let E=v;if(v++,d[v]==="!"){v=a(d,v);continue}else{let k=!1;d[v]==="/"&&(k=!0,v++);let x="";for(;v<d.length&&d[v]!==">"&&d[v]!==" "&&d[v]!=="	"&&d[v]!=="\n"&&d[v]!=="\r";v++)x+=d[v];if(x=x.trim(),x[x.length-1]==="/"&&(x=x.substring(0,x.length-1),v--),!p(x)){let P;return x.trim().length===0?P="Invalid space after '<'.":P="Tag '"+x+"' is an invalid name.",h("InvalidTag",P,w(d,v))}const V=i(d,v);if(V===!1)return h("InvalidAttr","Attributes for '"+x+"' have open quote.",w(d,v));let O=V.value;if(v=V.index,O[O.length-1]==="/"){const P=v-O.length;O=O.substring(0,O.length-1);const B=n(O,f);if(B===!0)C=!0;else return h(B.err.code,B.err.msg,w(d,P+B.err.line))}else if(k)if(V.tagClosed){if(O.trim().length>0)return h("InvalidTag","Closing tag '"+x+"' can't have attributes or invalid starting.",w(d,E));if(A.length===0)return h("InvalidTag","Closing tag '"+x+"' has not been opened.",w(d,E));{const P=A.pop();if(x!==P.tagName){let B=w(d,P.tagStartPos);return h("InvalidTag","Expected closing tag '"+P.tagName+"' (opened in line "+B.line+", col "+B.col+") instead of closing tag '"+x+"'.",w(d,E))}A.length==0&&(S=!0)}}else return h("InvalidTag","Closing tag '"+x+"' doesn't have proper closing.",w(d,v));else{const P=n(O,f);if(P!==!0)return h(P.err.code,P.err.msg,w(d,v-O.length+P.err.line));if(S===!0)return h("InvalidXml","Multiple possible root nodes found.",w(d,v));f.unpairedTags.indexOf(x)!==-1||A.push({tagName:x,tagStartPos:E}),C=!0}for(v++;v<d.length;v++)if(d[v]==="<")if(d[v+1]==="!"){v++,v=a(d,v);continue}else if(d[v+1]==="?"){if(v=s(d,++v),v.err)return v}else break;else if(d[v]==="&"){const P=m(d,v);if(P==-1)return h("InvalidChar","char '&' is not expected.",w(d,v));v=P}else if(S===!0&&!t(d[v]))return h("InvalidXml","Extra text at the end",w(d,v));d[v]==="<"&&v--}}else{if(t(d[v]))continue;return h("InvalidChar","char '"+d[v]+"' is not expected.",w(d,v))}if(C){if(A.length==1)return h("InvalidTag","Unclosed tag '"+A[0].tagName+"'.",w(d,A[0].tagStartPos));if(A.length>0)return h("InvalidXml","Invalid '"+JSON.stringify(A.map(v=>v.tagName),null,4).replace(/\r?\n/g,"")+"' found.",{line:1,col:1})}else return h("InvalidXml","Start tag expected.",1);return!0};function t(d){return d===" "||d==="	"||d==="\n"||d==="\r"}function s(d,f){const A=f;for(;f<d.length;f++)if(d[f]=="?"||d[f]==" "){const C=d.substr(A,f-A);if(f>5&&C==="xml")return h("InvalidXml","XML declaration allowed only at the start of the document.",w(d,f));if(d[f]=="?"&&d[f+1]==">"){f++;break}else continue}return f}function a(d,f){if(d.length>f+5&&d[f+1]==="-"&&d[f+2]==="-"){for(f+=3;f<d.length;f++)if(d[f]==="-"&&d[f+1]==="-"&&d[f+2]===">"){f+=2;break}}else if(d.length>f+8&&d[f+1]==="D"&&d[f+2]==="O"&&d[f+3]==="C"&&d[f+4]==="T"&&d[f+5]==="Y"&&d[f+6]==="P"&&d[f+7]==="E"){let A=1;for(f+=8;f<d.length;f++)if(d[f]==="<")A++;else if(d[f]===">"&&(A--,A===0))break}else if(d.length>f+9&&d[f+1]==="["&&d[f+2]==="C"&&d[f+3]==="D"&&d[f+4]==="A"&&d[f+5]==="T"&&d[f+6]==="A"&&d[f+7]==="["){for(f+=8;f<d.length;f++)if(d[f]==="]"&&d[f+1]==="]"&&d[f+2]===">"){f+=2;break}}return f}const u='"',c="'";function i(d,f){let A="",C="",S=!1;for(;f<d.length;f++){if(d[f]===u||d[f]===c)C===""?C=d[f]:C!==d[f]||(C="");else if(d[f]===">"&&C===""){S=!0;break}A+=d[f]}return C!==""?!1:{value:A,index:f,tagClosed:S}}const o=new RegExp("(\\s*)([^\\s=]+)(\\s*=)?(\\s*(['\"])(([\\s\\S])*?)\\5)?","g");function n(d,f){const A=r.getAllMatches(d,o),C={};for(let S=0;S<A.length;S++){if(A[S][1].length===0)return h("InvalidAttr","Attribute '"+A[S][2]+"' has no space in starting.",b(A[S]));if(A[S][3]!==void 0&&A[S][4]===void 0)return h("InvalidAttr","Attribute '"+A[S][2]+"' is without value.",b(A[S]));if(A[S][3]===void 0&&!f.allowBooleanAttributes)return h("InvalidAttr","boolean attribute '"+A[S][2]+"' is not allowed.",b(A[S]));const v=A[S][2];if(!g(v))return h("InvalidAttr","Attribute '"+v+"' is an invalid name.",b(A[S]));if(!C.hasOwnProperty(v))C[v]=1;else return h("InvalidAttr","Attribute '"+v+"' is repeated.",b(A[S]))}return!0}function l(d,f){let A=/\d/;for(d[f]==="x"&&(f++,A=/[\da-fA-F]/);f<d.length;f++){if(d[f]===";")return f;if(!d[f].match(A))break}return-1}function m(d,f){if(f++,d[f]===";")return-1;if(d[f]==="#")return f++,l(d,f);let A=0;for(;f<d.length;f++,A++)if(!(d[f].match(/\w/)&&A<20)){if(d[f]===";")break;return-1}return f}function h(d,f,A){return{err:{code:d,msg:f,line:A.line||A,col:A.col}}}function g(d){return r.isName(d)}function p(d){return r.isName(d)}function w(d,f){const A=d.substring(0,f).split(/\r?\n/);return{line:A.length,col:A[A.length-1].length+1}}function b(d){return d.startIndex+d[1].length}return xm}var lc={},jd;function w0(){if(jd)return lc;jd=1;const r={preserveOrder:!1,attributeNamePrefix:"@_",attributesGroupName:!1,textNodeName:"#text",ignoreAttributes:!0,removeNSPrefix:!1,allowBooleanAttributes:!1,parseTagValue:!0,parseAttributeValue:!1,trimValues:!0,cdataPropName:!1,numberParseOptions:{hex:!0,leadingZeros:!0,eNotation:!0},tagValueProcessor:function(t,s){return s},attributeValueProcessor:function(t,s){return s},stopNodes:[],alwaysCreateTextNode:!1,isArray:()=>!1,commentPropName:!1,unpairedTags:[],processEntities:!0,htmlEntities:!1,ignoreDeclaration:!1,ignorePiTags:!1,transformTagName:!1,transformAttributeName:!1,updateTag:function(t,s,a){return t}},e=function(t){return Object.assign({},r,t)};return lc.buildOptions=e,lc.defaultOptions=r,lc}var Im,$d;function y0(){if($d)return Im;$d=1;class r{constructor(t){this.tagname=t,this.child=[],this[":@"]={}}add(t,s){t==="__proto__"&&(t="#__proto__"),this.child.push({[t]:s})}addChild(t){t.tagname==="__proto__"&&(t.tagname="#__proto__"),t[":@"]&&Object.keys(t[":@"]).length>0?this.child.push({[t.tagname]:t.child,":@":t[":@"]}):this.child.push({[t.tagname]:t.child})}}return Im=r,Im}var Vm,Ud;function v0(){if(Ud)return Vm;Ud=1;const r=gp();function e(n,l){const m={};if(n[l+3]==="O"&&n[l+4]==="C"&&n[l+5]==="T"&&n[l+6]==="Y"&&n[l+7]==="P"&&n[l+8]==="E"){l=l+9;let h=1,g=!1,p=!1,w="";for(;l<n.length;l++)if(n[l]==="<"&&!p){if(g&&a(n,l)){l+=7;let b,d;[b,d,l]=t(n,l+1),d.indexOf("&")===-1&&(m[o(b)]={regx:RegExp("&".concat(b,";"),"g"),val:d})}else if(g&&u(n,l))l+=8;else if(g&&c(n,l))l+=8;else if(g&&i(n,l))l+=9;else if(s)p=!0;else throw new Error("Invalid DOCTYPE");h++,w=""}else if(n[l]===">"){if(p?n[l-1]==="-"&&n[l-2]==="-"&&(p=!1,h--):h--,h===0)break}else n[l]==="["?g=!0:w+=n[l];if(h!==0)throw new Error("Unclosed DOCTYPE")}else throw new Error("Invalid Tag instead of DOCTYPE");return{entities:m,i:l}}function t(n,l){let m="";for(;l<n.length&&n[l]!=="'"&&n[l]!=='"';l++)m+=n[l];if(m=m.trim(),m.indexOf(" ")!==-1)throw new Error("External entites are not supported");const h=n[l++];let g="";for(;l<n.length&&n[l]!==h;l++)g+=n[l];return[m,g,l]}function s(n,l){return n[l+1]==="!"&&n[l+2]==="-"&&n[l+3]==="-"}function a(n,l){return n[l+1]==="!"&&n[l+2]==="E"&&n[l+3]==="N"&&n[l+4]==="T"&&n[l+5]==="I"&&n[l+6]==="T"&&n[l+7]==="Y"}function u(n,l){return n[l+1]==="!"&&n[l+2]==="E"&&n[l+3]==="L"&&n[l+4]==="E"&&n[l+5]==="M"&&n[l+6]==="E"&&n[l+7]==="N"&&n[l+8]==="T"}function c(n,l){return n[l+1]==="!"&&n[l+2]==="A"&&n[l+3]==="T"&&n[l+4]==="T"&&n[l+5]==="L"&&n[l+6]==="I"&&n[l+7]==="S"&&n[l+8]==="T"}function i(n,l){return n[l+1]==="!"&&n[l+2]==="N"&&n[l+3]==="O"&&n[l+4]==="T"&&n[l+5]==="A"&&n[l+6]==="T"&&n[l+7]==="I"&&n[l+8]==="O"&&n[l+9]==="N"}function o(n){if(r.isName(n))return n;throw new Error("Invalid entity name ".concat(n))}return Vm=e,Vm}var Pm,Kd;function b0(){if(Kd)return Pm;Kd=1;const r=/^[-+]?0x[a-fA-F0-9]+$/,e=/^([\-\+])?(0*)(\.[0-9]+([eE]\-?[0-9]+)?|[0-9]+(\.[0-9]+([eE]\-?[0-9]+)?)?)$/;!Number.parseInt&&window.parseInt&&(Number.parseInt=window.parseInt),!Number.parseFloat&&window.parseFloat&&(Number.parseFloat=window.parseFloat);const t={hex:!0,leadingZeros:!0,decimalPoint:".",eNotation:!0};function s(u,c={}){if(c=Object.assign({},t,c),!u||typeof u!="string")return u;let i=u.trim();if(c.skipLike!==void 0&&c.skipLike.test(i))return u;if(c.hex&&r.test(i))return Number.parseInt(i,16);{const o=e.exec(i);if(o){const n=o[1],l=o[2];let m=a(o[3]);const h=o[4]||o[6];if(!c.leadingZeros&&l.length>0&&n&&i[2]!=="."||!c.leadingZeros&&l.length>0&&!n&&i[1]!==".")return u;{const g=Number(i),p=""+g;return p.search(/[eE]/)!==-1||h?c.eNotation?g:u:i.indexOf(".")!==-1?p==="0"&&m===""||p===m||n&&p==="-"+m?g:u:l?m===p||n+m===p?g:u:i===p||i===n+p?g:u}}else return u}}function a(u){return u&&u.indexOf(".")!==-1&&(u=u.replace(/0+$/,""),u==="."?u="0":u[0]==="."?u="0"+u:u[u.length-1]==="."&&(u=u.substr(0,u.length-1))),u}return Pm=s,Pm}var Om,Hd;function fw(){if(Hd)return Om;Hd=1;function r(e){return typeof e=="function"?e:Array.isArray(e)?t=>{for(const s of e)if(typeof s=="string"&&t===s||s instanceof RegExp&&s.test(t))return!0}:()=>!1}return Om=r,Om}var Bm,Md;function S0(){if(Md)return Bm;Md=1;const r=gp(),e=y0(),t=v0(),s=b0(),a=fw();class u{constructor(v){this.options=v,this.currentNode=null,this.tagsNodeStack=[],this.docTypeEntities={},this.lastEntities={apos:{regex:/&(apos|#39|#x27);/g,val:"'"},gt:{regex:/&(gt|#62|#x3E);/g,val:">"},lt:{regex:/&(lt|#60|#x3C);/g,val:"<"},quot:{regex:/&(quot|#34|#x22);/g,val:'"'}},this.ampEntity={regex:/&(amp|#38|#x26);/g,val:"&"},this.htmlEntities={space:{regex:/&(nbsp|#160);/g,val:" "},cent:{regex:/&(cent|#162);/g,val:"¢"},pound:{regex:/&(pound|#163);/g,val:"£"},yen:{regex:/&(yen|#165);/g,val:"¥"},euro:{regex:/&(euro|#8364);/g,val:"€"},copyright:{regex:/&(copy|#169);/g,val:"©"},reg:{regex:/&(reg|#174);/g,val:"®"},inr:{regex:/&(inr|#8377);/g,val:"₹"},num_dec:{regex:/&#([0-9]{1,7});/g,val:(E,k)=>String.fromCharCode(Number.parseInt(k,10))},num_hex:{regex:/&#x([0-9a-fA-F]{1,6});/g,val:(E,k)=>String.fromCharCode(Number.parseInt(k,16))}},this.addExternalEntities=c,this.parseXml=m,this.parseTextData=i,this.resolveNameSpace=o,this.buildAttributesMap=l,this.isItStopNode=w,this.replaceEntitiesValue=g,this.readStopNodeData=A,this.saveTextToParentTag=p,this.addChild=h,this.ignoreAttributesFn=a(this.options.ignoreAttributes)}}function c(S){const v=Object.keys(S);for(let E=0;E<v.length;E++){const k=v[E];this.lastEntities[k]={regex:new RegExp("&"+k+";","g"),val:S[k]}}}function i(S,v,E,k,x,V,O){if(S!==void 0&&(this.options.trimValues&&!k&&(S=S.trim()),S.length>0)){O||(S=this.replaceEntitiesValue(S));const P=this.options.tagValueProcessor(v,S,E,x,V);return P==null?S:typeof P!=typeof S||P!==S?P:this.options.trimValues?C(S,this.options.parseTagValue,this.options.numberParseOptions):S.trim()===S?C(S,this.options.parseTagValue,this.options.numberParseOptions):S}}function o(S){if(this.options.removeNSPrefix){const v=S.split(":"),E=S.charAt(0)==="/"?"/":"";if(v[0]==="xmlns")return"";v.length===2&&(S=E+v[1])}return S}const n=new RegExp("([^\\s=]+)\\s*(=\\s*(['\"])([\\s\\S]*?)\\3)?","gm");function l(S,v,E){if(this.options.ignoreAttributes!==!0&&typeof S=="string"){const k=r.getAllMatches(S,n),x=k.length,V={};for(let O=0;O<x;O++){const P=this.resolveNameSpace(k[O][1]);if(this.ignoreAttributesFn(P,v))continue;let B=k[O][4],L=this.options.attributeNamePrefix+P;if(P.length)if(this.options.transformAttributeName&&(L=this.options.transformAttributeName(L)),L==="__proto__"&&(L="#__proto__"),B!==void 0){this.options.trimValues&&(B=B.trim()),B=this.replaceEntitiesValue(B);const H=this.options.attributeValueProcessor(P,B,v);H==null?V[L]=B:typeof H!=typeof B||H!==B?V[L]=H:V[L]=C(B,this.options.parseAttributeValue,this.options.numberParseOptions)}else this.options.allowBooleanAttributes&&(V[L]=!0)}if(!Object.keys(V).length)return;if(this.options.attributesGroupName){const O={};return O[this.options.attributesGroupName]=V,O}return V}}const m=function(S){S=S.replace(/\r\n?/g,"\n");const v=new e("!xml");let E=v,k="",x="";for(let V=0;V<S.length;V++)if(S[V]==="<")if(S[V+1]==="/"){const O=d(S,">",V,"Closing Tag is not closed.");let P=S.substring(V+2,O).trim();if(this.options.removeNSPrefix){const H=P.indexOf(":");H!==-1&&(P=P.substr(H+1))}this.options.transformTagName&&(P=this.options.transformTagName(P)),E&&(k=this.saveTextToParentTag(k,E,x));const B=x.substring(x.lastIndexOf(".")+1);if(P&&this.options.unpairedTags.indexOf(P)!==-1)throw new Error("Unpaired tag can not be used as closing tag: </".concat(P,">"));let L=0;B&&this.options.unpairedTags.indexOf(B)!==-1?(L=x.lastIndexOf(".",x.lastIndexOf(".")-1),this.tagsNodeStack.pop()):L=x.lastIndexOf("."),x=x.substring(0,L),E=this.tagsNodeStack.pop(),k="",V=O}else if(S[V+1]==="?"){let O=f(S,V,!1,"?>");if(!O)throw new Error("Pi Tag is not closed.");if(k=this.saveTextToParentTag(k,E,x),!(this.options.ignoreDeclaration&&O.tagName==="?xml"||this.options.ignorePiTags)){const P=new e(O.tagName);P.add(this.options.textNodeName,""),O.tagName!==O.tagExp&&O.attrExpPresent&&(P[":@"]=this.buildAttributesMap(O.tagExp,x,O.tagName)),this.addChild(E,P,x)}V=O.closeIndex+1}else if(S.substr(V+1,3)==="!--"){const O=d(S,"-->",V+4,"Comment is not closed.");if(this.options.commentPropName){const P=S.substring(V+4,O-2);k=this.saveTextToParentTag(k,E,x),E.add(this.options.commentPropName,[{[this.options.textNodeName]:P}])}V=O}else if(S.substr(V+1,2)==="!D"){const O=t(S,V);this.docTypeEntities=O.entities,V=O.i}else if(S.substr(V+1,2)==="!["){const O=d(S,"]]>",V,"CDATA is not closed.")-2,P=S.substring(V+9,O);k=this.saveTextToParentTag(k,E,x);let B=this.parseTextData(P,E.tagname,x,!0,!1,!0,!0);B==null&&(B=""),this.options.cdataPropName?E.add(this.options.cdataPropName,[{[this.options.textNodeName]:P}]):E.add(this.options.textNodeName,B),V=O+2}else{let O=f(S,V,this.options.removeNSPrefix),P=O.tagName;const B=O.rawTagName;let L=O.tagExp,H=O.attrExpPresent,z=O.closeIndex;this.options.transformTagName&&(P=this.options.transformTagName(P)),E&&k&&E.tagname!=="!xml"&&(k=this.saveTextToParentTag(k,E,x,!1));const re=E;if(re&&this.options.unpairedTags.indexOf(re.tagname)!==-1&&(E=this.tagsNodeStack.pop(),x=x.substring(0,x.lastIndexOf("."))),P!==v.tagname&&(x+=x?"."+P:P),this.isItStopNode(this.options.stopNodes,x,P)){let _="";if(L.length>0&&L.lastIndexOf("/")===L.length-1)P[P.length-1]==="/"?(P=P.substr(0,P.length-1),x=x.substr(0,x.length-1),L=P):L=L.substr(0,L.length-1),V=O.closeIndex;else if(this.options.unpairedTags.indexOf(P)!==-1)V=O.closeIndex;else{const J=this.readStopNodeData(S,B,z+1);if(!J)throw new Error("Unexpected end of ".concat(B));V=J.i,_=J.tagContent}const X=new e(P);P!==L&&H&&(X[":@"]=this.buildAttributesMap(L,x,P)),_&&(_=this.parseTextData(_,P,x,!0,H,!0,!0)),x=x.substr(0,x.lastIndexOf(".")),X.add(this.options.textNodeName,_),this.addChild(E,X,x)}else{if(L.length>0&&L.lastIndexOf("/")===L.length-1){P[P.length-1]==="/"?(P=P.substr(0,P.length-1),x=x.substr(0,x.length-1),L=P):L=L.substr(0,L.length-1),this.options.transformTagName&&(P=this.options.transformTagName(P));const _=new e(P);P!==L&&H&&(_[":@"]=this.buildAttributesMap(L,x,P)),this.addChild(E,_,x),x=x.substr(0,x.lastIndexOf("."))}else{const _=new e(P);this.tagsNodeStack.push(E),P!==L&&H&&(_[":@"]=this.buildAttributesMap(L,x,P)),this.addChild(E,_,x),E=_}k="",V=z}}else k+=S[V];return v.child};function h(S,v,E){const k=this.options.updateTag(v.tagname,E,v[":@"]);k===!1||(typeof k=="string"&&(v.tagname=k),S.addChild(v))}const g=function(S){if(this.options.processEntities){for(let v in this.docTypeEntities){const E=this.docTypeEntities[v];S=S.replace(E.regx,E.val)}for(let v in this.lastEntities){const E=this.lastEntities[v];S=S.replace(E.regex,E.val)}if(this.options.htmlEntities)for(let v in this.htmlEntities){const E=this.htmlEntities[v];S=S.replace(E.regex,E.val)}S=S.replace(this.ampEntity.regex,this.ampEntity.val)}return S};function p(S,v,E,k){return S&&(k===void 0&&(k=Object.keys(v.child).length===0),S=this.parseTextData(S,v.tagname,E,!1,v[":@"]?Object.keys(v[":@"]).length!==0:!1,k),S!==void 0&&S!==""&&v.add(this.options.textNodeName,S),S=""),S}function w(S,v,E){const k="*."+E;for(const x in S){const V=S[x];if(k===V||v===V)return!0}return!1}function b(S,v,E=">"){let k,x="";for(let V=v;V<S.length;V++){let O=S[V];if(k)O===k&&(k="");else if(O==='"'||O==="'")k=O;else if(O===E[0])if(E[1]){if(S[V+1]===E[1])return{data:x,index:V}}else return{data:x,index:V};else O==="	"&&(O=" ");x+=O}}function d(S,v,E,k){const x=S.indexOf(v,E);if(x===-1)throw new Error(k);return x+v.length-1}function f(S,v,E,k=">"){const x=b(S,v+1,k);if(!x)return;let V=x.data;const O=x.index,P=V.search(/\s/);let B=V,L=!0;P!==-1&&(B=V.substring(0,P),V=V.substring(P+1).trimStart());const H=B;if(E){const z=B.indexOf(":");z!==-1&&(B=B.substr(z+1),L=B!==x.data.substr(z+1))}return{tagName:B,tagExp:V,closeIndex:O,attrExpPresent:L,rawTagName:H}}function A(S,v,E){const k=E;let x=1;for(;E<S.length;E++)if(S[E]==="<")if(S[E+1]==="/"){const V=d(S,">",E,"".concat(v," is not closed"));if(S.substring(E+2,V).trim()===v&&(x--,x===0))return{tagContent:S.substring(k,E),i:V};E=V}else if(S[E+1]==="?")E=d(S,"?>",E+1,"StopNode is not closed.");else if(S.substr(E+1,3)==="!--")E=d(S,"-->",E+3,"StopNode is not closed.");else if(S.substr(E+1,2)==="![")E=d(S,"]]>",E,"StopNode is not closed.")-2;else{const V=f(S,E,">");V&&((V&&V.tagName)===v&&V.tagExp[V.tagExp.length-1]!=="/"&&x++,E=V.closeIndex)}}function C(S,v,E){if(v&&typeof S=="string"){const k=S.trim();return k==="true"?!0:k==="false"?!1:s(S,E)}else return r.isExist(S)?S:""}return Bm=u,Bm}var Dm={},Fd;function A0(){if(Fd)return Dm;Fd=1;function r(u,c){return e(u,c)}function e(u,c,i){let o;const n={};for(let l=0;l<u.length;l++){const m=u[l],h=t(m);let g="";if(i===void 0?g=h:g=i+"."+h,h===c.textNodeName)o===void 0?o=m[h]:o+=""+m[h];else{if(h===void 0)continue;if(m[h]){let p=e(m[h],c,g);const w=a(p,c);m[":@"]?s(p,m[":@"],g,c):Object.keys(p).length===1&&p[c.textNodeName]!==void 0&&!c.alwaysCreateTextNode?p=p[c.textNodeName]:Object.keys(p).length===0&&(c.alwaysCreateTextNode?p[c.textNodeName]="":p=""),n[h]!==void 0&&n.hasOwnProperty(h)?(Array.isArray(n[h])||(n[h]=[n[h]]),n[h].push(p)):c.isArray(h,g,w)?n[h]=[p]:n[h]=p}}}return typeof o=="string"?o.length>0&&(n[c.textNodeName]=o):o!==void 0&&(n[c.textNodeName]=o),n}function t(u){const c=Object.keys(u);for(let i=0;i<c.length;i++){const o=c[i];if(o!==":@")return o}}function s(u,c,i,o){if(c){const n=Object.keys(c),l=n.length;for(let m=0;m<l;m++){const h=n[m];o.isArray(h,i+"."+h,!0,!0)?u[h]=[c[h]]:u[h]=c[h]}}}function a(u,c){const{textNodeName:i}=c,o=Object.keys(u).length;return!!(o===0||o===1&&(u[i]||typeof u[i]=="boolean"||u[i]===0))}return Dm.prettify=r,Dm}var Tm,Jd;function N0(){if(Jd)return Tm;Jd=1;const{buildOptions:r}=w0(),e=S0(),{prettify:t}=A0(),s=mw();class a{constructor(c){this.externalEntities={},this.options=r(c)}parse(c,i){if(typeof c!="string")if(c.toString)c=c.toString();else throw new Error("XML data is accepted in String or Bytes[] form.");if(i){i===!0&&(i={});const l=s.validate(c,i);if(l!==!0)throw Error("".concat(l.err.msg,":").concat(l.err.line,":").concat(l.err.col))}const o=new e(this.options);o.addExternalEntities(this.externalEntities);const n=o.parseXml(c);return this.options.preserveOrder||n===void 0?n:t(n,this.options)}addEntity(c,i){if(i.indexOf("&")!==-1)throw new Error("Entity value can't have '&'");if(c.indexOf("&")!==-1||c.indexOf(";")!==-1)throw new Error("An entity must be set without '&' and ';'. Eg. use '#xD' for '&#xD;'");if(i==="&")throw new Error("An entity with value '&' is not permitted");this.externalEntities[c]=i}}return Tm=a,Tm}var Rm,qd;function k0(){if(qd)return Rm;qd=1;const r="\n";function e(i,o){let n="";return o.format&&o.indentBy.length>0&&(n=r),t(i,o,"",n)}function t(i,o,n,l){let m="",h=!1;for(let g=0;g<i.length;g++){const p=i[g],w=s(p);if(w===void 0)continue;let b="";if(n.length===0?b=w:b="".concat(n,".").concat(w),w===o.textNodeName){let S=p[w];u(b,o)||(S=o.tagValueProcessor(w,S),S=c(S,o)),h&&(m+=l),m+=S,h=!1;continue}else if(w===o.cdataPropName){h&&(m+=l),m+="<![CDATA[".concat(p[w][0][o.textNodeName],"]]>"),h=!1;continue}else if(w===o.commentPropName){m+=l+"<!--".concat(p[w][0][o.textNodeName],"-->"),h=!0;continue}else if(w[0]==="?"){const S=a(p[":@"],o),v=w==="?xml"?"":l;let E=p[w][0][o.textNodeName];E=E.length!==0?" "+E:"",m+=v+"<".concat(w).concat(E).concat(S,"?>"),h=!0;continue}let d=l;d!==""&&(d+=o.indentBy);const f=a(p[":@"],o),A=l+"<".concat(w).concat(f),C=t(p[w],o,b,d);o.unpairedTags.indexOf(w)!==-1?o.suppressUnpairedNode?m+=A+">":m+=A+"/>":(!C||C.length===0)&&o.suppressEmptyNode?m+=A+"/>":C&&C.endsWith(">")?m+=A+">".concat(C).concat(l,"</").concat(w,">"):(m+=A+">",C&&l!==""&&(C.includes("/>")||C.includes("</"))?m+=l+o.indentBy+C+l:m+=C,m+="</".concat(w,">")),h=!0}return m}function s(i){const o=Object.keys(i);for(let n=0;n<o.length;n++){const l=o[n];if(i.hasOwnProperty(l)&&l!==":@")return l}}function a(i,o){let n="";if(i&&!o.ignoreAttributes)for(let l in i){if(!i.hasOwnProperty(l))continue;let m=o.attributeValueProcessor(l,i[l]);m=c(m,o),m===!0&&o.suppressBooleanAttributes?n+=" ".concat(l.substr(o.attributeNamePrefix.length)):n+=" ".concat(l.substr(o.attributeNamePrefix.length),'="').concat(m,'"')}return n}function u(i,o){i=i.substr(0,i.length-o.textNodeName.length-1);let n=i.substr(i.lastIndexOf(".")+1);for(let l in o.stopNodes)if(o.stopNodes[l]===i||o.stopNodes[l]==="*."+n)return!0;return!1}function c(i,o){if(i&&i.length>0&&o.processEntities)for(let n=0;n<o.entities.length;n++){const l=o.entities[n];i=i.replace(l.regex,l.val)}return i}return Rm=e,Rm}var Lm,Wd;function E0(){if(Wd)return Lm;Wd=1;const r=k0(),e=fw(),t={attributeNamePrefix:"@_",attributesGroupName:!1,textNodeName:"#text",ignoreAttributes:!0,cdataPropName:!1,format:!1,indentBy:"  ",suppressEmptyNode:!1,suppressUnpairedNode:!0,suppressBooleanAttributes:!0,tagValueProcessor:function(i,o){return o},attributeValueProcessor:function(i,o){return o},preserveOrder:!1,commentPropName:!1,unpairedTags:[],entities:[{regex:new RegExp("&","g"),val:"&amp;"},{regex:new RegExp(">","g"),val:"&gt;"},{regex:new RegExp("<","g"),val:"&lt;"},{regex:new RegExp("'","g"),val:"&apos;"},{regex:new RegExp('"',"g"),val:"&quot;"}],processEntities:!0,stopNodes:[],oneListGroup:!1};function s(i){this.options=Object.assign({},t,i),this.options.ignoreAttributes===!0||this.options.attributesGroupName?this.isAttribute=function(){return!1}:(this.ignoreAttributesFn=e(this.options.ignoreAttributes),this.attrPrefixLen=this.options.attributeNamePrefix.length,this.isAttribute=c),this.processTextOrObjNode=a,this.options.format?(this.indentate=u,this.tagEndChar=">\n",this.newLine="\n"):(this.indentate=function(){return""},this.tagEndChar=">",this.newLine="")}s.prototype.build=function(i){return this.options.preserveOrder?r(i,this.options):(Array.isArray(i)&&this.options.arrayNodeName&&this.options.arrayNodeName.length>1&&(i={[this.options.arrayNodeName]:i}),this.j2x(i,0,[]).val)},s.prototype.j2x=function(i,o,n){let l="",m="";const h=n.join(".");for(let g in i)if(Object.prototype.hasOwnProperty.call(i,g))if(typeof i[g]>"u")this.isAttribute(g)&&(m+="");else if(i[g]===null)this.isAttribute(g)?m+="":g[0]==="?"?m+=this.indentate(o)+"<"+g+"?"+this.tagEndChar:m+=this.indentate(o)+"<"+g+"/"+this.tagEndChar;else if(i[g]instanceof Date)m+=this.buildTextValNode(i[g],g,"",o);else if(typeof i[g]!="object"){const p=this.isAttribute(g);if(p&&!this.ignoreAttributesFn(p,h))l+=this.buildAttrPairStr(p,""+i[g]);else if(!p)if(g===this.options.textNodeName){let w=this.options.tagValueProcessor(g,""+i[g]);m+=this.replaceEntitiesValue(w)}else m+=this.buildTextValNode(i[g],g,"",o)}else if(Array.isArray(i[g])){const p=i[g].length;let w="",b="";for(let d=0;d<p;d++){const f=i[g][d];if(!(typeof f>"u"))if(f===null)g[0]==="?"?m+=this.indentate(o)+"<"+g+"?"+this.tagEndChar:m+=this.indentate(o)+"<"+g+"/"+this.tagEndChar;else if(typeof f=="object")if(this.options.oneListGroup){const A=this.j2x(f,o+1,n.concat(g));w+=A.val,this.options.attributesGroupName&&f.hasOwnProperty(this.options.attributesGroupName)&&(b+=A.attrStr)}else w+=this.processTextOrObjNode(f,g,o,n);else if(this.options.oneListGroup){let A=this.options.tagValueProcessor(g,f);A=this.replaceEntitiesValue(A),w+=A}else w+=this.buildTextValNode(f,g,"",o)}this.options.oneListGroup&&(w=this.buildObjectNode(w,g,b,o)),m+=w}else if(this.options.attributesGroupName&&g===this.options.attributesGroupName){const p=Object.keys(i[g]),w=p.length;for(let b=0;b<w;b++)l+=this.buildAttrPairStr(p[b],""+i[g][p[b]])}else m+=this.processTextOrObjNode(i[g],g,o,n);return{attrStr:l,val:m}},s.prototype.buildAttrPairStr=function(i,o){return o=this.options.attributeValueProcessor(i,""+o),o=this.replaceEntitiesValue(o),this.options.suppressBooleanAttributes&&o==="true"?" "+i:" "+i+'="'+o+'"'};function a(i,o,n,l){const m=this.j2x(i,n+1,l.concat(o));return i[this.options.textNodeName]!==void 0&&Object.keys(i).length===1?this.buildTextValNode(i[this.options.textNodeName],o,m.attrStr,n):this.buildObjectNode(m.val,o,m.attrStr,n)}s.prototype.buildObjectNode=function(i,o,n,l){if(i==="")return o[0]==="?"?this.indentate(l)+"<"+o+n+"?"+this.tagEndChar:this.indentate(l)+"<"+o+n+this.closeTag(o)+this.tagEndChar;{let m="</"+o+this.tagEndChar,h="";return o[0]==="?"&&(h="?",m=""),(n||n==="")&&i.indexOf("<")===-1?this.indentate(l)+"<"+o+n+h+">"+i+m:this.options.commentPropName!==!1&&o===this.options.commentPropName&&h.length===0?this.indentate(l)+"<!--".concat(i,"-->")+this.newLine:this.indentate(l)+"<"+o+n+h+this.tagEndChar+i+this.indentate(l)+m}},s.prototype.closeTag=function(i){let o="";return this.options.unpairedTags.indexOf(i)!==-1?this.options.suppressUnpairedNode||(o="/"):this.options.suppressEmptyNode?o="/":o="></".concat(i),o},s.prototype.buildTextValNode=function(i,o,n,l){if(this.options.cdataPropName!==!1&&o===this.options.cdataPropName)return this.indentate(l)+"<![CDATA[".concat(i,"]]>")+this.newLine;if(this.options.commentPropName!==!1&&o===this.options.commentPropName)return this.indentate(l)+"<!--".concat(i,"-->")+this.newLine;if(o[0]==="?")return this.indentate(l)+"<"+o+n+"?"+this.tagEndChar;{let m=this.options.tagValueProcessor(o,i);return m=this.replaceEntitiesValue(m),m===""?this.indentate(l)+"<"+o+n+this.closeTag(o)+this.tagEndChar:this.indentate(l)+"<"+o+n+">"+m+"</"+o+this.tagEndChar}},s.prototype.replaceEntitiesValue=function(i){if(i&&i.length>0&&this.options.processEntities)for(let o=0;o<this.options.entities.length;o++){const n=this.options.entities[o];i=i.replace(n.regex,n.val)}return i};function u(i){return this.options.indentBy.repeat(i)}function c(i){return i.startsWith(this.options.attributeNamePrefix)&&i!==this.options.textNodeName?i.substr(this.attrPrefixLen):!1}return Lm=s,Lm}var jm,Gd;function C0(){if(Gd)return jm;Gd=1;const r=mw(),e=N0(),t=E0();return jm={XMLParser:e,XMLValidator:r,XMLBuilder:t},jm}var x0=C0();function Kc(r){return r.users!==void 0}const I0=r=>r===null?yf().setApp("end_to_end_encryption").build():yf().setApp("end_to_end_encryption").setUid(r.uid).build(),_e=I0(ap());class Ae{constructor(e={}){if("view"in e)this.fromUint8Array(e.view);else if("buffer"in e)this.fromArrayBuffer(e.buffer);else if("string"in e)this.fromString(e.string);else if("hexstring"in e)this.fromHexString(e.hexstring);else if("length"in e&&e.length>0){if(this.length=e.length,e.stub)for(let t=0;t<this._view.length;t++)this._view[t]=e.stub}else this.length=0}set buffer(e){this._buffer=e,this._view=new Uint8Array(this._buffer)}get buffer(){return this._buffer}set view(e){this._buffer=new ArrayBuffer(e.length),this._view=new Uint8Array(this._buffer),this._view.set(e)}get view(){return this._view}get length(){return this.view.byteLength}set length(e){this._buffer=new ArrayBuffer(e),this._view=new Uint8Array(this._buffer)}clear(){this._buffer=new ArrayBuffer(0),this._view=new Uint8Array(this._buffer)}fromArrayBuffer(e){this._buffer=e,this._view=new Uint8Array(this._buffer)}fromUint8Array(e){this.fromArrayBuffer(new Uint8Array(e).buffer)}fromString(e){const t=e.length;this.length=t;for(let s=0;s<t;s++)this.view[s]=e.charCodeAt(s)}toString(e=0,t=this.view.length-e){let s="";(e>=this.view.length||e<0)&&(e=0),(t>=this.view.length||t<0)&&(t=this.view.length-e);for(let a=e;a<e+t;a++)s+=String.fromCharCode(this.view[a]);return s}fromHexString(e){const t=e.length;this.buffer=new ArrayBuffer(t>>1),this.view=new Uint8Array(this.buffer);const s=new Map;s.set("0",0),s.set("1",1),s.set("2",2),s.set("3",3),s.set("4",4),s.set("5",5),s.set("6",6),s.set("7",7),s.set("8",8),s.set("9",9),s.set("A",10),s.set("a",10),s.set("B",11),s.set("b",11),s.set("C",12),s.set("c",12),s.set("D",13),s.set("d",13),s.set("E",14),s.set("e",14),s.set("F",15),s.set("f",15);let a=0,u=0;for(let c=0;c<t;c++)c%2?(u|=s.get(e.charAt(c)),this.view[a]=u,a++):u=s.get(e.charAt(c))<<4}toHexString(e=0,t=this.view.length-e){let s="";(e>=this.view.length||e<0)&&(e=0),(t>=this.view.length||t<0)&&(t=this.view.length-e);for(let a=e;a<e+t;a++){const u=this.view[a].toString(16).toUpperCase();s=s+(u.length==1?"0":"")+u}return s}copy(e=0,t=this.length-e){if(!e&&!this.length)return new Ae;if(e<0||e>this.length-1)throw new Error("Wrong start position: ".concat(e));return new Ae({buffer:this._buffer.slice(e,e+t)})}slice(e=0,t=this.length){if(!e&&!this.length)return new Ae;if(e<0||e>this.length-1)throw new Error("Wrong start position: ".concat(e));return new Ae({buffer:this._buffer.slice(e,t)})}realloc(e){const t=new ArrayBuffer(e),s=new Uint8Array(t);e>this._view.length?s.set(this._view):s.set(new Uint8Array(this._buffer,0,e)),this._buffer=t,this._view=new Uint8Array(this._buffer)}append(e){const t=this.length,s=e.length,a=e._view.subarray();this.realloc(t+s),this._view.set(a,t)}insert(e,t=0,s=this.length-t){return t>this.length-1?!1:(s>this.length-t&&(s=this.length-t),s>e.length&&(s=e.length),s==e.length?this._view.set(e._view,t):this._view.set(e._view.subarray(0,s),t),!0)}isEqual(e){if(this.length!=e.length)return!1;for(let t=0;t<e.length;t++)if(this.view[t]!=e.view[t])return!1;return!0}isEqualView(e){if(e.length!=this.view.length)return!1;for(let t=0;t<e.length;t++)if(this.view[t]!=e[t])return!1;return!0}findPattern(e,t,s,a){const{start:u,length:c,backward:i}=this.prepareFindParameters(t,s,a),o=e.length;if(o>c)return-1;const n=[];for(let l=0;l<o;l++)n.push(e.view[l]);for(let l=0;l<=c-o;l++){let m=!0;const h=i?u-o-l:u+l;for(let g=0;g<o;g++)if(this.view[g+h]!=n[g]){m=!1;break}if(m)return i?u-o-l:u+o+l}return-1}findFirstIn(e,t,s,a){const{start:u,length:c,backward:i}=this.prepareFindParameters(t,s,a),o={id:-1,position:i?0:u+c,length:0};for(let n=0;n<e.length;n++){const l=this.findPattern(e[n],u,c,i);if(l!=-1){let m=!1;const h=e[n].length;i?l-h>=o.position-o.length&&(m=!0):l-h<=o.position-o.length&&(m=!0),m&&(o.position=l,o.id=n,o.length=h)}}return o}findAllIn(e,t,s){let{start:a,length:u}=this.prepareFindParameters(t,s);const c=[];let i={id:-1,position:a};do{const o=i.position;if(i=this.findFirstIn(e,i.position,u),i.id==-1)break;u-=i.position-o,c.push({id:i.id,position:i.position})}while(!0);return c}findAllPatternIn(e,t,s){const{start:a,length:u}=this.prepareFindParameters(t,s),c=[],i=e.length;if(i>u)return-1;const o=Array.from(e.view);for(let n=0;n<=u-i;n++){let l=!0;const m=a+n;for(let h=0;h<i;h++)if(this.view[h+m]!=o[h]){l=!1;break}l&&(c.push(a+i+n),n+=i-1)}return c}findFirstNotIn(e,t,s,a){let{start:u,length:c,backward:i}=this.prepareFindParameters(t,s,a);const o={left:{id:-1,position:u},right:{id:-1,position:0},value:new Ae};let n=c;for(;n>0;){if(o.right=this.findFirstIn(e,i?u-c+n:u+c-n,n,i),o.right.id==-1){c=n,i?u-=c:u=o.left.position,o.value=new Ae({buffer:this._buffer.slice(u,u+c)});break}if(o.right.position!=(i?o.left.position-e[o.right.id].length:o.left.position+e[o.right.id].length)){i?(u=o.right.position+e[o.right.id].length,c=o.left.position-o.right.position-e[o.right.id].length):(u=o.left.position,c=o.right.position-o.left.position-e[o.right.id].length),o.value=new Ae({buffer:this._buffer.slice(u,u+c)});break}o.left=o.right,n-=e[o.right.id].length}if(i){const l=o.right;o.right=o.left,o.left=l}return o}findAllNotIn(e,t,s){let{start:a,length:u}=this.prepareFindParameters(t,s);const c=[];let i={left:{id:-1,position:a},right:{id:-1,position:a},value:new Ae};do{const o=i.right.position;i=this.findFirstNotIn(e,i.right.position,u),u-=i.right.position-o,c.push({left:{id:i.left.id,position:i.left.position},right:{id:i.right.id,position:i.right.position},value:i.value})}while(i.right.id!=-1);return c}findFirstSequence(e,t,s,a){let{start:u,length:c,backward:i}=this.prepareFindParameters(t,s,a);const o=this.skipNotPatterns(e,u,c,i);if(o==-1)return{position:-1,value:new Ae};const n=this.skipPatterns(e,o,c-(i?u-o:o-u),i);i?(u=n,c=o-n):(u=o,c=n-o);const l=new Ae({buffer:this._buffer.slice(u,u+c)});return{position:n,value:l}}findAllSequences(e,t,s){let{start:a,length:u}=this.prepareFindParameters(t,s);const c=[];let i={position:a,value:new Ae};do{const o=i.position;i=this.findFirstSequence(e,i.position,u),i.position!=-1&&(u-=i.position-o,c.push({position:i.position,value:i.value}))}while(i.position!=-1);return c}findPairedPatterns(e,t,s,a){const u=[];if(e.isEqual(t))return u;const{start:c,length:i}=this.prepareFindParameters(s,a);let o=0;const n=this.findAllPatternIn(e,c,i);if(!Array.isArray(n)||n.length==0)return u;const l=this.findAllPatternIn(t,c,i);if(!Array.isArray(l)||l.length==0)return u;for(;o<n.length&&l.length!=0;){if(n[0]==l[0]){u.push({left:n[0],right:l[0]}),n.splice(0,1),l.splice(0,1);continue}if(n[o]>l[0])break;for(;n[o]<l[0]&&(o++,!(o>=n.length)););u.push({left:n[o-1],right:l[0]}),n.splice(o-1,1),l.splice(0,1),o=0}return u.sort((m,h)=>m.left-h.left),u}findPairedArrays(e,t,s,a){const{start:u,length:c}=this.prepareFindParameters(s,a),i=[];let o=0;const n=this.findAllIn(e,u,c);if(n.length==0)return i;const l=this.findAllIn(t,u,c);if(l.length==0)return i;for(;o<n.length&&l.length!=0;){if(n[0].position==l[0].position){i.push({left:n[0],right:l[0]}),n.splice(0,1),l.splice(0,1);continue}if(n[o].position>l[0].position)break;for(;n[o].position<l[0].position&&(o++,!(o>=n.length)););i.push({left:n[o-1],right:l[0]}),n.splice(o-1,1),l.splice(0,1),o=0}return i.sort((m,h)=>m.left.position-h.left.position),i}replacePattern(e,t,s,a,u=null){let c=[],i;const o={status:-1,searchPatternPositions:[],replacePatternPositions:[]},{start:n,length:l}=this.prepareFindParameters(s,a);if(u==null){if(c=this.findAllIn([e],n,l),c.length==0)return o}else c=u;o.searchPatternPositions.push(...Array.from(c,p=>p.position));const m=e.length-t.length,h=new ArrayBuffer(this.view.length-c.length*m),g=new Uint8Array(h);for(g.set(new Uint8Array(this.buffer,0,n)),i=0;i<c.length;i++){const p=i==0?n:c[i-1].position;g.set(new Uint8Array(this.buffer,p,c[i].position-e.length-p),p-i*m),g.set(t.view,c[i].position-e.length-i*m),o.replacePatternPositions.push(c[i].position-e.length-i*m)}return i--,g.set(new Uint8Array(this.buffer,c[i].position,this.length-c[i].position),c[i].position-e.length+t.length-i*m),this.buffer=h,this.view=new Uint8Array(this.buffer),o.status=1,o}skipPatterns(e,t,s,a){const{start:u,length:c,backward:i}=this.prepareFindParameters(t,s,a);let o=u;for(let n=0;n<e.length;n++){const l=e[n].length,m=i?o-l:o;let h=!0;for(let g=0;g<l;g++)if(this.view[g+m]!=e[n].view[g]){h=!1;break}if(h){if(n=-1,i){if(o-=l,o<=0)return o}else if(o+=l,o>=u+c)return o}}return o}skipNotPatterns(e,t,s,a){const{start:u,length:c,backward:i}=this.prepareFindParameters(t,s,a);let o=-1;for(let n=0;n<c;n++){for(let l=0;l<e.length;l++){const m=e[l].length,h=i?u-n-m:u+n;let g=!0;for(let p=0;p<m;p++)if(this.view[p+h]!=e[l].view[p]){g=!1;break}if(g){o=i?u-n:u+n;break}}if(o!=-1)break}return o}prepareFindParameters(e=null,t=null,s=!1){return e===null&&(e=s?this.length:0),e>this.length&&(e=this.length),s?(t===null&&(t=e),t>e&&(t=e)):(t===null&&(t=this.length-e),t>this.length-e&&(t=this.length-e)),{start:e,length:t,backward:s}}}const V0=16777216;class Yr{constructor(e={}){this._stream=new Ae,this._length=0,this._start=0,this.backward=!1,this.appendBlock=0,this.prevLength=0,this.prevStart=0,"view"in e?this.stream=new Ae({view:e.view}):"buffer"in e?this.stream=new Ae({buffer:e.buffer}):"string"in e?this.stream=new Ae({string:e.string}):"hexstring"in e?this.stream=new Ae({hexstring:e.hexstring}):"stream"in e?this.stream=e.stream.slice():this.stream=new Ae,"backward"in e&&e.backward&&(this.backward=e.backward,this._start=this.stream.length),"length"in e&&e.length>0&&(this._length=e.length),"start"in e&&e.start&&e.start>0&&(this._start=e.start),"appendBlock"in e&&e.appendBlock&&e.appendBlock>0&&(this.appendBlock=e.appendBlock)}set stream(e){this._stream=e,this.prevLength=this._length,this._length=e.length,this.prevStart=this._start,this._start=0}get stream(){return this._stream}set length(e){this.prevLength=this._length,this._length=e}get length(){return this.appendBlock?this.start:this._length}set start(e){e>this.stream.length||(this.prevStart=this._start,this.prevLength=this._length,this._length-=this.backward?this._start-e:e-this._start,this._start=e)}get start(){return this._start}get buffer(){return this._stream.buffer.slice(0,this._length)}resetPosition(){this._start=this.prevStart,this._length=this.prevLength}findPattern(e,t=null){(t==null||t>this.length)&&(t=this.length);const s=this.stream.findPattern(e,this.start,this.length,this.backward);if(s==-1)return s;if(this.backward){if(s<this.start-e.length-t)return-1}else if(s>this.start+e.length+t)return-1;return this.start=s,s}findFirstIn(e,t=null){(t==null||t>this.length)&&(t=this.length);const s=this.stream.findFirstIn(e,this.start,this.length,this.backward);if(s.id==-1)return s;if(this.backward){if(s.position<this.start-e[s.id].length-t)return{id:-1,position:this.backward?0:this.start+this.length}}else if(s.position>this.start+e[s.id].length+t)return{id:-1,position:this.backward?0:this.start+this.length};return this.start=s.position,s}findAllIn(e){const t=this.backward?this.start-this.length:this.start;return this.stream.findAllIn(e,t,this.length)}findFirstNotIn(e,t=null){(t==null||t>this._length)&&(t=this._length);const s=this._stream.findFirstNotIn(e,this._start,this._length,this.backward);if(s.left.id==-1&&s.right.id==-1)return s;if(this.backward){if(s.right.id!=-1&&s.right.position<this._start-e[s.right.id].length-t)return{left:{id:-1,position:this._start},right:{id:-1,position:0},value:new Ae}}else if(s.left.id!=-1&&s.left.position>this._start+e[s.left.id].length+t)return{left:{id:-1,position:this._start},right:{id:-1,position:0},value:new Ae};return this.backward?s.left.id==-1?this.start=0:this.start=s.left.position:s.right.id==-1?this.start=this._start+this._length:this.start=s.right.position,s}findAllNotIn(e){const t=this.backward?this._start-this._length:this._start;return this._stream.findAllNotIn(e,t,this._length)}findFirstSequence(e,t=null,s=null){(t==null||t>this._length)&&(t=this._length),(s==null||s>t)&&(s=t);const a=this._stream.findFirstSequence(e,this._start,t,this.backward);if(a.value.length==0)return a;if(this.backward){if(a.position<this._start-a.value.length-s)return{position:-1,value:new Ae}}else if(a.position>this._start+a.value.length+s)return{position:-1,value:new Ae};return this.start=a.position,a}findAllSequences(e){const t=this.backward?this.start-this.length:this.start;return this.stream.findAllSequences(e,t,this.length)}findPairedPatterns(e,t,s=null){(s==null||s>this.length)&&(s=this.length);const a=this.backward?this.start-this.length:this.start,u=this.stream.findPairedPatterns(e,t,a,this.length);if(u.length){if(this.backward){if(u[0].right<this.start-t.length-s)return[]}else if(u[0].left>this.start+e.length+s)return[]}return u}findPairedArrays(e,t,s=null){(s==null||s>this.length)&&(s=this.length);const a=this.backward?this.start-this.length:this.start,u=this.stream.findPairedArrays(e,t,a,this.length);if(u.length){if(this.backward){if(u[0].right.position<this.start-t[u[0].right.id].length-s)return[]}else if(u[0].left.position>this.start+e[u[0].left.id].length+s)return[]}return u}replacePattern(e,t){const s=this.backward?this.start-this.length:this.start;return this.stream.replacePattern(e,t,s,this.length)}skipPatterns(e){const t=this.stream.skipPatterns(e,this.start,this.length,this.backward);return this.start=t,t}skipNotPatterns(e){const t=this.stream.skipNotPatterns(e,this.start,this.length,this.backward);return t==-1?-1:(this.start=t,t)}append(e){this.beforeAppend(e.length),this._stream.view.set(e.view,this._start),this._length+=e.length*2,this.start=this._start+e.length,this.prevLength-=e.length*2}appendView(e){this.beforeAppend(e.length),this._stream.view.set(e,this._start),this._length+=e.length*2,this.start=this._start+e.length,this.prevLength-=e.length*2}appendChar(e){this.beforeAppend(1),this._stream.view[this._start]=e,this._length+=2,this.start=this._start+1,this.prevLength-=2}appendUint16(e){this.beforeAppend(2);const t=new Uint16Array([e]),s=new Uint8Array(t.buffer);this.stream.view[this._start]=s[1],this._stream.view[this._start+1]=s[0],this._length+=4,this.start=this._start+2,this.prevLength-=4}appendUint24(e){this.beforeAppend(3);const t=new Uint32Array([e]),s=new Uint8Array(t.buffer);this._stream.view[this._start]=s[2],this._stream.view[this._start+1]=s[1],this._stream.view[this._start+2]=s[0],this._length+=6,this.start=this._start+3,this.prevLength-=6}appendUint32(e){this.beforeAppend(4);const t=new Uint32Array([e]),s=new Uint8Array(t.buffer);this._stream.view[this._start]=s[3],this._stream.view[this._start+1]=s[2],this._stream.view[this._start+2]=s[1],this._stream.view[this._start+3]=s[0],this._length+=8,this.start=this._start+4,this.prevLength-=8}appendInt16(e){this.beforeAppend(2);const t=new Int16Array([e]),s=new Uint8Array(t.buffer);this._stream.view[this._start]=s[1],this._stream.view[this._start+1]=s[0],this._length+=4,this.start=this._start+2,this.prevLength-=4}appendInt32(e){this.beforeAppend(4);const t=new Int32Array([e]),s=new Uint8Array(t.buffer);this._stream.view[this._start]=s[3],this._stream.view[this._start+1]=s[2],this._stream.view[this._start+2]=s[1],this._stream.view[this._start+3]=s[0],this._length+=8,this.start=this._start+4,this.prevLength-=8}getBlock(e,t=!0){if(this._length<=0)return new Uint8Array(0);this._length<e&&(e=this._length);let s;if(this.backward){const a=this._stream.view.subarray(this._length-e,this._length);s=new Uint8Array(e);for(let u=0;u<e;u++)s[e-1-u]=a[u]}else s=this._stream.view.subarray(this._start,this._start+e);return t&&(this.start+=this.backward?-1*e:e),s}getUint16(e=!0){const t=this.getBlock(2,e);return t.length<2?0:t[0]<<8|t[1]}getInt16(e=!0){const t=this.getUint16(e),s=32768;return t&s?-(s-(t^s)):t}getUint24(e=!0){const t=this.getBlock(4,e);return t.length<3?0:t[0]<<16|t[1]<<8|t[2]}getUint32(e=!0){const t=this.getBlock(4,e);return t.length<4?0:t[0]*V0+(t[1]<<16)+(t[2]<<8)+t[3]}getInt32(e=!0){const t=this.getUint32(e),s=2147483648;return t&s?-(s-(t^s)):t}beforeAppend(e){this._start+e>this._stream.length&&(e>this.appendBlock&&(this.appendBlock=e+Yr.APPEND_BLOCK),this._stream.realloc(this._stream.length+this.appendBlock))}}Yr.APPEND_BLOCK=1e3;function P0(r){return r instanceof Uint8Array||ArrayBuffer.isView(r)&&r.constructor.name==="Uint8Array"}function pw(r,...e){if(!P0(r))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(r.length))throw new Error("Uint8Array expected of length "+e+", got length="+r.length)}function _d(r,e=!0){if(r.destroyed)throw new Error("Hash instance has been destroyed");if(e&&r.finished)throw new Error("Hash#digest() has already been called")}function O0(r,e){pw(r);const t=e.outputLen;if(r.length<t)throw new Error("digestInto() expects output buffer of length at least "+t)}const $m=r=>new DataView(r.buffer,r.byteOffset,r.byteLength),is=(r,e)=>r<<32-e|r>>>e,Um=(r,e)=>r<<e|r>>>32-e>>>0;function B0(r){if(typeof r!="string")throw new Error("utf8ToBytes expected string, got "+typeof r);return new Uint8Array(new TextEncoder().encode(r))}function dw(r){return typeof r=="string"&&(r=B0(r)),pw(r),r}class D0{clone(){return this._cloneInto()}}function Jh(r){const e=s=>r().update(dw(s)).digest(),t=r();return e.outputLen=t.outputLen,e.blockLen=t.blockLen,e.create=()=>r(),e}function T0(r,e,t,s){if(typeof r.setBigUint64=="function")return r.setBigUint64(e,t,s);const a=BigInt(32),u=BigInt(4294967295),c=Number(t>>a&u),i=Number(t&u),o=s?4:0,n=s?0:4;r.setUint32(e+o,c,s),r.setUint32(e+n,i,s)}const gw=(r,e,t)=>r&e^~r&t,ww=(r,e,t)=>r&e^r&t^e&t;class wp extends D0{constructor(e,t,s,a){super(),this.blockLen=e,this.outputLen=t,this.padOffset=s,this.isLE=a,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=$m(this.buffer)}update(e){_d(this);const{view:t,buffer:s,blockLen:a}=this;e=dw(e);const u=e.length;for(let c=0;c<u;){const i=Math.min(a-this.pos,u-c);if(i===a){const o=$m(e);for(;a<=u-c;c+=a)this.process(o,c);continue}s.set(e.subarray(c,c+i),this.pos),this.pos+=i,c+=i,this.pos===a&&(this.process(t,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){_d(this),O0(e,this),this.finished=!0;const{buffer:t,view:s,blockLen:a,isLE:u}=this;let{pos:c}=this;t[c++]=128,this.buffer.subarray(c).fill(0),this.padOffset>a-c&&(this.process(s,0),c=0);for(let m=c;m<a;m++)t[m]=0;T0(s,a-8,BigInt(this.length*8),u),this.process(s,0);const i=$m(e),o=this.outputLen;if(o%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const n=o/4,l=this.get();if(n>l.length)throw new Error("_sha2: outputLen bigger than state");for(let m=0;m<n;m++)i.setUint32(4*m,l[m],u)}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const s=e.slice(0,t);return this.destroy(),s}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:t,buffer:s,length:a,finished:u,destroyed:c,pos:i}=this;return e.length=a,e.pos=i,e.finished=u,e.destroyed=c,a%t&&e.buffer.set(s),e}}const Po=new Uint32Array([1732584193,4023233417,2562383102,271733878,3285377520]),Gs=new Uint32Array(80);let R0=class extends wp{constructor(){super(64,20,8,!1),this.A=Po[0]|0,this.B=Po[1]|0,this.C=Po[2]|0,this.D=Po[3]|0,this.E=Po[4]|0}get(){const{A:r,B:e,C:t,D:s,E:a}=this;return[r,e,t,s,a]}set(r,e,t,s,a){this.A=r|0,this.B=e|0,this.C=t|0,this.D=s|0,this.E=a|0}process(r,e){for(let i=0;i<16;i++,e+=4)Gs[i]=r.getUint32(e,!1);for(let i=16;i<80;i++)Gs[i]=Um(Gs[i-3]^Gs[i-8]^Gs[i-14]^Gs[i-16],1);let{A:t,B:s,C:a,D:u,E:c}=this;for(let i=0;i<80;i++){let o,n;i<20?(o=gw(s,a,u),n=1518500249):i<40?(o=s^a^u,n=1859775393):i<60?(o=ww(s,a,u),n=2400959708):(o=s^a^u,n=3395469782);const l=Um(t,5)+o+c+n+Gs[i]|0;c=u,u=a,a=Um(s,30),s=t,t=l}t=t+this.A|0,s=s+this.B|0,a=a+this.C|0,u=u+this.D|0,c=c+this.E|0,this.set(t,s,a,u,c)}roundClean(){Gs.fill(0)}destroy(){this.set(0,0,0,0,0),this.buffer.fill(0)}};const L0=Jh(()=>new R0),j0=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),_s=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Xs=new Uint32Array(64);let $0=class extends wp{constructor(){super(64,32,8,!1),this.A=_s[0]|0,this.B=_s[1]|0,this.C=_s[2]|0,this.D=_s[3]|0,this.E=_s[4]|0,this.F=_s[5]|0,this.G=_s[6]|0,this.H=_s[7]|0}get(){const{A:r,B:e,C:t,D:s,E:a,F:u,G:c,H:i}=this;return[r,e,t,s,a,u,c,i]}set(r,e,t,s,a,u,c,i){this.A=r|0,this.B=e|0,this.C=t|0,this.D=s|0,this.E=a|0,this.F=u|0,this.G=c|0,this.H=i|0}process(r,e){for(let l=0;l<16;l++,e+=4)Xs[l]=r.getUint32(e,!1);for(let l=16;l<64;l++){const m=Xs[l-15],h=Xs[l-2],g=is(m,7)^is(m,18)^m>>>3,p=is(h,17)^is(h,19)^h>>>10;Xs[l]=p+Xs[l-7]+g+Xs[l-16]|0}let{A:t,B:s,C:a,D:u,E:c,F:i,G:o,H:n}=this;for(let l=0;l<64;l++){const m=is(c,6)^is(c,11)^is(c,25),h=n+m+gw(c,i,o)+j0[l]+Xs[l]|0,g=(is(t,2)^is(t,13)^is(t,22))+ww(t,s,a)|0;n=o,o=i,i=c,c=u+h|0,u=a,a=s,s=t,t=h+g|0}t=t+this.A|0,s=s+this.B|0,a=a+this.C|0,u=u+this.D|0,c=c+this.E|0,i=i+this.F|0,o=o+this.G|0,n=n+this.H|0,this.set(t,s,a,u,c,i,o,n)}roundClean(){Xs.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}};const U0=Jh(()=>new $0),cc=BigInt(2**32-1),Of=BigInt(32);function yw(r,e=!1){return e?{h:Number(r&cc),l:Number(r>>Of&cc)}:{h:Number(r>>Of&cc)|0,l:Number(r&cc)|0}}function K0(r,e=!1){let t=new Uint32Array(r.length),s=new Uint32Array(r.length);for(let a=0;a<r.length;a++){const{h:u,l:c}=yw(r[a],e);[t[a],s[a]]=[u,c]}return[t,s]}const H0=(r,e)=>BigInt(r>>>0)<<Of|BigInt(e>>>0),M0=(r,e,t)=>r>>>t,F0=(r,e,t)=>r<<32-t|e>>>t,J0=(r,e,t)=>r>>>t|e<<32-t,q0=(r,e,t)=>r<<32-t|e>>>t,W0=(r,e,t)=>r<<64-t|e>>>t-32,G0=(r,e,t)=>r>>>t-32|e<<64-t,_0=(r,e)=>e,X0=(r,e)=>r,z0=(r,e,t)=>r<<t|e>>>32-t,Q0=(r,e,t)=>e<<t|r>>>32-t,Y0=(r,e,t)=>e<<t-32|r>>>64-t,Z0=(r,e,t)=>r<<t-32|e>>>64-t;function e1(r,e,t,s){const a=(e>>>0)+(s>>>0);return{h:r+t+(a/2**32|0)|0,l:a|0}}const t1=(r,e,t)=>(r>>>0)+(e>>>0)+(t>>>0),s1=(r,e,t,s)=>e+t+s+(r/2**32|0)|0,r1=(r,e,t,s)=>(r>>>0)+(e>>>0)+(t>>>0)+(s>>>0),a1=(r,e,t,s,a)=>e+t+s+a+(r/2**32|0)|0,n1=(r,e,t,s,a)=>(r>>>0)+(e>>>0)+(t>>>0)+(s>>>0)+(a>>>0),i1=(r,e,t,s,a,u)=>e+t+s+a+u+(r/2**32|0)|0,ae={fromBig:yw,split:K0,toBig:H0,shrSH:M0,shrSL:F0,rotrSH:J0,rotrSL:q0,rotrBH:W0,rotrBL:G0,rotr32H:_0,rotr32L:X0,rotlSH:z0,rotlSL:Q0,rotlBH:Y0,rotlBL:Z0,add:e1,add3L:t1,add3H:s1,add4L:r1,add4H:a1,add5H:i1,add5L:n1},[o1,u1]=ae.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(r=>BigInt(r))),zs=new Uint32Array(80),Qs=new Uint32Array(80);let vw=class extends wp{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:r,Al:e,Bh:t,Bl:s,Ch:a,Cl:u,Dh:c,Dl:i,Eh:o,El:n,Fh:l,Fl:m,Gh:h,Gl:g,Hh:p,Hl:w}=this;return[r,e,t,s,a,u,c,i,o,n,l,m,h,g,p,w]}set(r,e,t,s,a,u,c,i,o,n,l,m,h,g,p,w){this.Ah=r|0,this.Al=e|0,this.Bh=t|0,this.Bl=s|0,this.Ch=a|0,this.Cl=u|0,this.Dh=c|0,this.Dl=i|0,this.Eh=o|0,this.El=n|0,this.Fh=l|0,this.Fl=m|0,this.Gh=h|0,this.Gl=g|0,this.Hh=p|0,this.Hl=w|0}process(r,e){for(let f=0;f<16;f++,e+=4)zs[f]=r.getUint32(e),Qs[f]=r.getUint32(e+=4);for(let f=16;f<80;f++){const A=zs[f-15]|0,C=Qs[f-15]|0,S=ae.rotrSH(A,C,1)^ae.rotrSH(A,C,8)^ae.shrSH(A,C,7),v=ae.rotrSL(A,C,1)^ae.rotrSL(A,C,8)^ae.shrSL(A,C,7),E=zs[f-2]|0,k=Qs[f-2]|0,x=ae.rotrSH(E,k,19)^ae.rotrBH(E,k,61)^ae.shrSH(E,k,6),V=ae.rotrSL(E,k,19)^ae.rotrBL(E,k,61)^ae.shrSL(E,k,6),O=ae.add4L(v,V,Qs[f-7],Qs[f-16]),P=ae.add4H(O,S,x,zs[f-7],zs[f-16]);zs[f]=P|0,Qs[f]=O|0}let{Ah:t,Al:s,Bh:a,Bl:u,Ch:c,Cl:i,Dh:o,Dl:n,Eh:l,El:m,Fh:h,Fl:g,Gh:p,Gl:w,Hh:b,Hl:d}=this;for(let f=0;f<80;f++){const A=ae.rotrSH(l,m,14)^ae.rotrSH(l,m,18)^ae.rotrBH(l,m,41),C=ae.rotrSL(l,m,14)^ae.rotrSL(l,m,18)^ae.rotrBL(l,m,41),S=l&h^~l&p,v=m&g^~m&w,E=ae.add5L(d,C,v,u1[f],Qs[f]),k=ae.add5H(E,b,A,S,o1[f],zs[f]),x=E|0,V=ae.rotrSH(t,s,28)^ae.rotrBH(t,s,34)^ae.rotrBH(t,s,39),O=ae.rotrSL(t,s,28)^ae.rotrBL(t,s,34)^ae.rotrBL(t,s,39),P=t&a^t&c^a&c,B=s&u^s&i^u&i;b=p|0,d=w|0,p=h|0,w=g|0,h=l|0,g=m|0,{h:l,l:m}=ae.add(o|0,n|0,k|0,x|0),o=c|0,n=i|0,c=a|0,i=u|0,a=t|0,u=s|0;const L=ae.add3L(x,O,B);t=ae.add3H(L,k,V,P),s=L|0}({h:t,l:s}=ae.add(this.Ah|0,this.Al|0,t|0,s|0)),{h:a,l:u}=ae.add(this.Bh|0,this.Bl|0,a|0,u|0),{h:c,l:i}=ae.add(this.Ch|0,this.Cl|0,c|0,i|0),{h:o,l:n}=ae.add(this.Dh|0,this.Dl|0,o|0,n|0),{h:l,l:m}=ae.add(this.Eh|0,this.El|0,l|0,m|0),{h,l:g}=ae.add(this.Fh|0,this.Fl|0,h|0,g|0),{h:p,l:w}=ae.add(this.Gh|0,this.Gl|0,p|0,w|0),{h:b,l:d}=ae.add(this.Hh|0,this.Hl|0,b|0,d|0),this.set(t,s,a,u,c,i,o,n,l,m,h,g,p,w,b,d)}roundClean(){zs.fill(0),Qs.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}},l1=class extends vw{constructor(){super(),this.Ah=-876896931,this.Al=-1056596264,this.Bh=1654270250,this.Bl=914150663,this.Ch=-1856437926,this.Cl=812702999,this.Dh=355462360,this.Dl=-150054599,this.Eh=1731405415,this.El=-4191439,this.Fh=-1900787065,this.Fl=1750603025,this.Gh=-619958771,this.Gl=1694076839,this.Hh=1203062813,this.Hl=-1090891868,this.outputLen=48}};const c1=Jh(()=>new vw),h1=Jh(()=>new l1),Le=new ArrayBuffer(0),N="";class me extends TypeError{constructor(){super(...arguments),this.name=me.NAME}static isType(e,t){if(typeof t=="string"){if(t==="Array"&&Array.isArray(e)||t==="ArrayBuffer"&&e instanceof ArrayBuffer||t==="ArrayBufferView"&&ArrayBuffer.isView(e)||typeof e===t)return!0}else if(e instanceof t)return!0;return!1}static assert(e,t,...s){for(const u of s)if(this.isType(e,u))return;const a=s.map(u=>u instanceof Function&&"name"in u?u.name:"".concat(u));throw new me("Parameter '".concat(t,"' is not of type ").concat(a.length>1?"(".concat(a.join(" or "),")"):a[0]))}}me.NAME="ArgumentError";class ie extends TypeError{static assert(...e){let t=null,s,a;typeof e[0]=="string"?(t=e[0],s=e[1],a=e.slice(2)):(s=e[0],a=e.slice(1)),me.assert(s,"parameters","object");for(const u of a)if(s[u]==null)throw new ie(u,t)}static assertEmpty(e,t,s){if(e==null)throw new ie(t,s)}constructor(e,t=null,s){super(),this.name=ie.NAME,this.field=e,t&&(this.target=t),s?this.message=s:this.message="Absent mandatory parameter '".concat(e,"' ").concat(t?" in '".concat(t,"'"):N)}}ie.NAME="ParameterError";class j extends Error{static assertSchema(e,t){if(!e.verified)throw new Error("Object's schema was not verified against input data for ".concat(t))}static assert(e,t){if(e.offset===-1)throw new j("Error during parsing of ASN.1 data. Data is not correct for '".concat(t,"'."))}constructor(e){super(e),this.name="AsnError"}}class ${static blockName(){return this.CLASS_NAME}static fromBER(e){const t=Re(e);j.assert(t,this.name);try{return new this({schema:t.result})}catch(s){throw new j("Cannot create '".concat(this.CLASS_NAME,"' from ASN.1 object"))}}static defaultValues(e){throw new Error("Invalid member name for ".concat(this.CLASS_NAME," class: ").concat(e))}static schema(e={}){throw new Error("Method '".concat(this.CLASS_NAME,".schema' should be overridden"))}get className(){return this.constructor.CLASS_NAME}toString(e="hex"){let t;try{t=this.toSchema()}catch(s){t=this.toSchema(!0)}return he.ToString(t.toBER(),e)}}$.CLASS_NAME="PkiObject";function Ur(r){let e=!1,t=N;const s=r.trim();for(let a=0;a<s.length;a++)s.charCodeAt(a)===32?e===!1&&(e=!0):(e&&(t+=" ",e=!1),t+=s[a]);return t.toLowerCase()}const Oo="type",Km="value";class Wr extends ${constructor(e={}){super(),this.type=y(e,Oo,Wr.defaultValues(Oo)),this.value=y(e,Km,Wr.defaultValues(Km)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Oo:return N;case Km:return{};default:return super.defaultValues(e)}}static schema(e={}){const t=y(e,"names",{});return new I({name:t.blockName||N,value:[new W({name:t.type||N}),new Z({name:t.value||N})]})}fromSchema(e){U(e,[Oo,"typeValue"]);const t=K(e,e,Wr.schema({names:{type:Oo,value:"typeValue"}}));j.assertSchema(t,this.className),this.type=t.result.type.valueBlock.toString(),this.value=t.result.typeValue}toSchema(){return new I({value:[new W({value:this.type}),this.value]})}toJSON(){const e={type:this.type};return Object.keys(this.value).length!==0?e.value=this.value.toJSON():e.value=this.value,e}isEqual(e){const t=[bh.blockName(),kf.blockName(),Nf.blockName(),jc.blockName(),Bs.blockName(),Af.blockName(),iy.blockName(),Bg.blockName(),oy.blockName(),uy.blockName(),ly.blockName(),cy.blockName()];if(e instanceof ArrayBuffer)return ge.isEqual(this.value.valueBeforeDecodeView,e);if(e.constructor.blockName()===Wr.blockName()){if(this.type!==e.type)return!1;const s=[!1,!1],a=this.value.constructor.blockName();for(const u of t)a===u&&(s[0]=!0),e.value.constructor.blockName()===u&&(s[1]=!0);if(s[0]!==s[1])return!1;if(s[0]&&s[1]){const u=Ur(this.value.valueBlock.value),c=Ur(e.value.valueBlock.value);if(u.localeCompare(c)!==0)return!1}else if(!ge.isEqual(this.value.valueBeforeDecodeView,e.value.valueBeforeDecodeView))return!1;return!0}return!1}}Wr.CLASS_NAME="AttributeTypeAndValue";const ia="typesAndValues",hc="valueBeforeDecode",Xd="RDN";class fe extends ${constructor(e={}){super(),this.typesAndValues=y(e,ia,fe.defaultValues(ia)),this.valueBeforeDecode=y(e,hc,fe.defaultValues(hc)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case ia:return[];case hc:return Le;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case ia:return t.length===0;case hc:return t.byteLength===0;default:return super.defaultValues(e)}}static schema(e={}){const t=y(e,"names",{});return new I({name:t.blockName||N,value:[new ee({name:t.repeatedSequence||N,value:new Fe({value:[new ee({name:t.repeatedSet||N,value:Wr.schema(t.typeAndValue||{})})]})})]})}fromSchema(e){U(e,[Xd,ia]);const t=K(e,e,fe.schema({names:{blockName:Xd,repeatedSet:ia}}));j.assertSchema(t,this.className),ia in t.result&&(this.typesAndValues=Array.from(t.result.typesAndValues,s=>new Wr({schema:s}))),this.valueBeforeDecode=t.result.RDN.valueBeforeDecodeView.slice().buffer}toSchema(){if(this.valueBeforeDecode.byteLength===0)return new I({value:[new Fe({value:Array.from(this.typesAndValues,t=>t.toSchema())})]});const e=Re(this.valueBeforeDecode);if(j.assert(e,"RelativeDistinguishedNames"),!(e.result instanceof I))throw new Error("ASN.1 result should be SEQUENCE");return e.result}toJSON(){return{typesAndValues:Array.from(this.typesAndValues,e=>e.toJSON())}}isEqual(e){if(e instanceof fe){if(this.typesAndValues.length!==e.typesAndValues.length)return!1;for(const[t,s]of this.typesAndValues.entries())if(s.isEqual(e.typesAndValues[t])===!1)return!1;return!0}return e instanceof ArrayBuffer?Wl(this.valueBeforeDecode,e):!1}}fe.CLASS_NAME="RelativeDistinguishedNames";const qo="type",Wo="value";function m1(r={},e=!1){const t=y(r,"names",{});return new I({optional:e,value:[new D({optional:!0,idBlock:{tagClass:2,tagNumber:1},name:t.country_name||N,value:[new Ne({value:[new jc,new Bs]})]}),new D({optional:!0,idBlock:{tagClass:2,tagNumber:2},name:t.administration_domain_name||N,value:[new Ne({value:[new jc,new Bs]})]}),new Y({optional:!0,idBlock:{tagClass:3,tagNumber:0},name:t.network_address||N,isHexOnly:!0}),new Y({optional:!0,idBlock:{tagClass:3,tagNumber:1},name:t.terminal_identifier||N,isHexOnly:!0}),new D({optional:!0,idBlock:{tagClass:3,tagNumber:2},name:t.private_domain_name||N,value:[new Ne({value:[new jc,new Bs]})]}),new Y({optional:!0,idBlock:{tagClass:3,tagNumber:3},name:t.organization_name||N,isHexOnly:!0}),new Y({optional:!0,name:t.numeric_user_identifier||N,idBlock:{tagClass:3,tagNumber:4},isHexOnly:!0}),new D({optional:!0,name:t.personal_name||N,idBlock:{tagClass:3,tagNumber:5},value:[new Y({idBlock:{tagClass:3,tagNumber:0},isHexOnly:!0}),new Y({optional:!0,idBlock:{tagClass:3,tagNumber:1},isHexOnly:!0}),new Y({optional:!0,idBlock:{tagClass:3,tagNumber:2},isHexOnly:!0}),new Y({optional:!0,idBlock:{tagClass:3,tagNumber:3},isHexOnly:!0})]}),new D({optional:!0,name:t.organizational_unit_names||N,idBlock:{tagClass:3,tagNumber:6},value:[new ee({value:new Bs})]})]})}function f1(r=!1){return new I({optional:r,value:[new Bs,new Bs]})}function p1(r=!1){return new Fe({optional:r,value:[new Y({optional:!0,idBlock:{tagClass:3,tagNumber:0},isHexOnly:!0}),new D({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[new Z]})]})}class le extends ${constructor(e={}){super(),this.type=y(e,qo,le.defaultValues(qo)),this.value=y(e,Wo,le.defaultValues(Wo)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case qo:return 9;case Wo:return{};default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case qo:return t===le.defaultValues(e);case Wo:return Object.keys(t).length===0;default:return super.defaultValues(e)}}static schema(e={}){const t=y(e,"names",{});return new Ne({value:[new D({idBlock:{tagClass:3,tagNumber:0},name:t.blockName||N,value:[new W,new D({idBlock:{tagClass:3,tagNumber:0},value:[new Z]})]}),new Y({name:t.blockName||N,idBlock:{tagClass:3,tagNumber:1}}),new Y({name:t.blockName||N,idBlock:{tagClass:3,tagNumber:2}}),new D({idBlock:{tagClass:3,tagNumber:3},name:t.blockName||N,value:[m1(t.builtInStandardAttributes||{},!1),f1(!0),p1(!0)]}),new D({idBlock:{tagClass:3,tagNumber:4},name:t.blockName||N,value:[fe.schema(t.directoryName||{})]}),new D({idBlock:{tagClass:3,tagNumber:5},name:t.blockName||N,value:[new D({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new Ne({value:[new Af,new Bs,new Nf,new bh,new kf]})]}),new D({idBlock:{tagClass:3,tagNumber:1},value:[new Ne({value:[new Af,new Bs,new Nf,new bh,new kf]})]})]}),new Y({name:t.blockName||N,idBlock:{tagClass:3,tagNumber:6}}),new Y({name:t.blockName||N,idBlock:{tagClass:3,tagNumber:7}}),new Y({name:t.blockName||N,idBlock:{tagClass:3,tagNumber:8}})]})}fromSchema(e){U(e,["blockName","otherName","rfc822Name","dNSName","x400Address","directoryName","ediPartyName","uniformResourceIdentifier","iPAddress","registeredID"]);const t=K(e,e,le.schema({names:{blockName:"blockName",otherName:"otherName",rfc822Name:"rfc822Name",dNSName:"dNSName",x400Address:"x400Address",directoryName:{names:{blockName:"directoryName"}},ediPartyName:"ediPartyName",uniformResourceIdentifier:"uniformResourceIdentifier",iPAddress:"iPAddress",registeredID:"registeredID"}}));switch(j.assertSchema(t,this.className),this.type=t.result.blockName.idBlock.tagNumber,this.type){case 0:this.value=t.result.blockName;break;case 1:case 2:case 6:{const s=t.result.blockName;s.idBlock.tagClass=1,s.idBlock.tagNumber=22;const a=s.toBER(!1),u=Re(a);j.assert(u,"GeneralName value"),this.value=u.result.valueBlock.value}break;case 3:this.value=t.result.blockName;break;case 4:this.value=new fe({schema:t.result.directoryName});break;case 5:this.value=t.result.ediPartyName;break;case 7:this.value=new M({valueHex:t.result.blockName.valueBlock.valueHex});break;case 8:{const s=t.result.blockName;s.idBlock.tagClass=1,s.idBlock.tagNumber=6;const a=s.toBER(!1),u=Re(a);j.assert(u,"GeneralName registeredID"),this.value=u.result.valueBlock.toString()}break}}toSchema(){switch(this.type){case 0:case 3:case 5:return new D({idBlock:{tagClass:3,tagNumber:this.type},value:[this.value]});case 1:case 2:case 6:{const e=new Bg({value:this.value});return e.idBlock.tagClass=3,e.idBlock.tagNumber=this.type,e}case 4:return new D({idBlock:{tagClass:3,tagNumber:4},value:[this.value.toSchema()]});case 7:{const e=this.value;return e.idBlock.tagClass=3,e.idBlock.tagNumber=this.type,e}case 8:{const e=new W({value:this.value});return e.idBlock.tagClass=3,e.idBlock.tagNumber=this.type,e}default:return le.schema()}}toJSON(){const e={type:this.type,value:N};if(typeof this.value=="string")e.value=this.value;else try{e.value=this.value.toJSON()}catch(t){}return e}}le.CLASS_NAME="GeneralName";const Go="accessMethod",_o="accessLocation",d1=[Go,_o];class vn extends ${constructor(e={}){super(),this.accessMethod=y(e,Go,vn.defaultValues(Go)),this.accessLocation=y(e,_o,vn.defaultValues(_o)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Go:return N;case _o:return new le;default:return super.defaultValues(e)}}static schema(e={}){const t=y(e,"names",{});return new I({name:t.blockName||N,value:[new W({name:t.accessMethod||N}),le.schema(t.accessLocation||{})]})}fromSchema(e){U(e,d1);const t=K(e,e,vn.schema({names:{accessMethod:Go,accessLocation:{names:{blockName:_o}}}}));j.assertSchema(t,this.className),this.accessMethod=t.result.accessMethod.valueBlock.toString(),this.accessLocation=new le({schema:t.result.accessLocation})}toSchema(){return new I({value:[new W({value:this.accessMethod}),this.accessLocation.toSchema()]})}toJSON(){return{accessMethod:this.accessMethod,accessLocation:this.accessLocation.toJSON()}}}vn.CLASS_NAME="AccessDescription";const tr="seconds",sr="millis",rr="micros";class Ot extends ${constructor(e={}){super(),tr in e&&(this.seconds=y(e,tr,Ot.defaultValues(tr))),sr in e&&(this.millis=y(e,sr,Ot.defaultValues(sr))),rr in e&&(this.micros=y(e,rr,Ot.defaultValues(rr))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case tr:case sr:case rr:return 0;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case tr:case sr:case rr:return t===Ot.defaultValues(e);default:return super.defaultValues(e)}}static schema(e={}){const t=y(e,"names",{});return new I({name:t.blockName||N,optional:!0,value:[new R({optional:!0,name:t.seconds||N}),new Y({name:t.millis||N,optional:!0,idBlock:{tagClass:3,tagNumber:0}}),new Y({name:t.micros||N,optional:!0,idBlock:{tagClass:3,tagNumber:1}})]})}fromSchema(e){U(e,[tr,sr,rr]);const t=K(e,e,Ot.schema({names:{seconds:tr,millis:sr,micros:rr}}));if(j.assertSchema(t,this.className),"seconds"in t.result&&(this.seconds=t.result.seconds.valueBlock.valueDec),"millis"in t.result){const s=new R({valueHex:t.result.millis.valueBlock.valueHex});this.millis=s.valueBlock.valueDec}if("micros"in t.result){const s=new R({valueHex:t.result.micros.valueBlock.valueHex});this.micros=s.valueBlock.valueDec}}toSchema(){const e=[];if(this.seconds!==void 0&&e.push(new R({value:this.seconds})),this.millis!==void 0){const t=new R({value:this.millis});e.push(new Y({idBlock:{tagClass:3,tagNumber:0},valueHex:t.valueBlock.valueHexView}))}if(this.micros!==void 0){const t=new R({value:this.micros});e.push(new Y({idBlock:{tagClass:3,tagNumber:1},valueHex:t.valueBlock.valueHexView}))}return new I({value:e})}toJSON(){const e={};return this.seconds!==void 0&&(e.seconds=this.seconds),this.millis!==void 0&&(e.millis=this.millis),this.micros!==void 0&&(e.micros=this.micros),e}}Ot.CLASS_NAME="Accuracy";const mc="algorithmId",Bo="algorithmParams",bw="algorithm",Bf="params",g1=[bw,Bf];class T extends ${constructor(e={}){super(),this.algorithmId=y(e,mc,T.defaultValues(mc)),Bo in e&&(this.algorithmParams=y(e,Bo,T.defaultValues(Bo))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case mc:return N;case Bo:return new Z;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case mc:return t===N;case Bo:return t instanceof Z;default:return super.defaultValues(e)}}static schema(e={}){const t=y(e,"names",{});return new I({name:t.blockName||N,optional:t.optional||!1,value:[new W({name:t.algorithmIdentifier||N}),new Z({name:t.algorithmParams||N,optional:!0})]})}fromSchema(e){U(e,g1);const t=K(e,e,T.schema({names:{algorithmIdentifier:bw,algorithmParams:Bf}}));j.assertSchema(t,this.className),this.algorithmId=t.result.algorithm.valueBlock.toString(),Bf in t.result&&(this.algorithmParams=t.result.params)}toSchema(){const e=[];return e.push(new W({value:this.algorithmId})),this.algorithmParams&&!(this.algorithmParams instanceof Z)&&e.push(this.algorithmParams),new I({value:e})}toJSON(){const e={algorithmId:this.algorithmId};return this.algorithmParams&&!(this.algorithmParams instanceof Z)&&(e.algorithmParams=this.algorithmParams.toJSON()),e}isEqual(e){return!(e instanceof T)||this.algorithmId!==e.algorithmId?!1:this.algorithmParams?e.algorithmParams?JSON.stringify(this.algorithmParams)===JSON.stringify(e.algorithmParams):!1:!e.algorithmParams}}T.CLASS_NAME="AlgorithmIdentifier";const Hn="altNames",w1=[Hn];class So extends ${constructor(e={}){super(),this.altNames=y(e,Hn,So.defaultValues(Hn)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Hn:return[];default:return super.defaultValues(e)}}static schema(e={}){const t=y(e,"names",{});return new I({name:t.blockName||N,value:[new ee({name:t.altNames||N,value:le.schema()})]})}fromSchema(e){U(e,w1);const t=K(e,e,So.schema({names:{altNames:Hn}}));j.assertSchema(t,this.className),Hn in t.result&&(this.altNames=Array.from(t.result.altNames,s=>new le({schema:s})))}toSchema(){return new I({value:Array.from(this.altNames,e=>e.toSchema())})}toJSON(){return{altNames:Array.from(this.altNames,e=>e.toJSON())}}}So.CLASS_NAME="AltName";const Mn="type",Fn="values",y1=[Mn,Fn];class we extends ${constructor(e={}){super(),this.type=y(e,Mn,we.defaultValues(Mn)),this.values=y(e,Fn,we.defaultValues(Fn)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Mn:return N;case Fn:return[];default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Mn:return t===N;case Fn:return t.length===0;default:return super.defaultValues(e)}}static schema(e={}){const t=y(e,"names",{});return new I({name:t.blockName||N,value:[new W({name:t.type||N}),new Fe({name:t.setName||N,value:[new ee({name:t.values||N,value:new Z})]})]})}fromSchema(e){U(e,y1);const t=K(e,e,we.schema({names:{type:Mn,values:Fn}}));j.assertSchema(t,this.className),this.type=t.result.type.valueBlock.toString(),this.values=t.result.values}toSchema(){return new I({value:[new W({value:this.type}),new Fe({value:this.values})]})}toJSON(){return{type:this.type,values:Array.from(this.values,e=>e.toJSON())}}}we.CLASS_NAME="Attribute";const Xo="notBeforeTime",zo="notAfterTime",v1=[Xo,zo];class ss extends ${constructor(e={}){super(),this.notBeforeTime=y(e,Xo,ss.defaultValues(Xo)),this.notAfterTime=y(e,zo,ss.defaultValues(zo)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Xo:case zo:return new Date(0,0,0);default:return super.defaultValues(e)}}static schema(e={}){const t=y(e,"names",{});return new I({name:t.blockName||N,value:[new ke({name:t.notBeforeTime||N}),new ke({name:t.notAfterTime||N})]})}fromSchema(e){U(e,v1);const t=K(e,e,ss.schema({names:{notBeforeTime:Xo,notAfterTime:zo}}));j.assertSchema(t,this.className),this.notBeforeTime=t.result.notBeforeTime.toDate(),this.notAfterTime=t.result.notAfterTime.toDate()}toSchema(){return new I({value:[new ke({valueDate:this.notBeforeTime}),new ke({valueDate:this.notAfterTime})]})}toJSON(){return{notBeforeTime:this.notBeforeTime,notAfterTime:this.notAfterTime}}}ss.CLASS_NAME="AttCertValidityPeriod";const Do="names",zd="generalNames";class Je extends ${constructor(e={}){super(),this.names=y(e,Do,Je.defaultValues(Do)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"names":return[];default:return super.defaultValues(e)}}static schema(e={},t=!1){const s=y(e,Do,{});return new I({optional:t,name:s.blockName||N,value:[new ee({name:s.generalNames||N,value:le.schema()})]})}fromSchema(e){U(e,[Do,zd]);const t=K(e,e,Je.schema({names:{blockName:Do,generalNames:zd}}));j.assertSchema(t,this.className),this.names=Array.from(t.result.generalNames,s=>new le({schema:s}))}toSchema(){return new I({value:Array.from(this.names,e=>e.toSchema())})}toJSON(){return{names:Array.from(this.names,e=>e.toJSON())}}}Je.CLASS_NAME="GeneralNames";const b1="2.5.29.9",S1="2.5.29.14",A1="2.5.29.15",N1="2.5.29.16",Sw="2.5.29.17",Aw="2.5.29.18",yp="2.5.29.19",k1="2.5.29.20",E1="2.5.29.27",C1="2.5.29.21",x1="2.5.29.24",Nw="2.5.29.28",kw="2.5.29.29",Ew="2.5.29.30",Cw="2.5.29.31",vp="2.5.29.46",xw="2.5.29.32",jt="2.5.29.32.0",I1="1.3.6.1.4.1.311.21.10",Iw="2.5.29.33",bp="2.5.29.35",Vw="2.5.29.36",V1="2.5.29.37",P1="2.5.29.54",Sp="1.3.6.1.5.5.7.1.1",O1="1.3.6.1.5.5.7.1.11",B1="1.3.6.1.4.1.11129.2.4.2",D1="1.3.6.1.4.1.311.21.7",T1="1.3.6.1.4.1.311.21.1",R1="1.3.6.1.5.5.7.1.3",Ap="1.2.840.113549.1.7.1",Pw="1.2.840.113549.1.7.2",Ow="1.2.840.113549.1.7.3",Bw="1.2.840.113549.1.7.6",L1="1.2.840.113549.1.9.16.1.4",Qd="1.2.840.113549.1.9.22.1",j1="1.2.840.113549.1.9.22.2",Yd="1.2.840.113549.1.9.22.3",Zd="1.2.840.113549.1.9.23.1",$1="1.3.6.1.5.5.7",U1="".concat($1,".48"),Hc="".concat(U1,".1.1"),ha="keyIdentifier",ma="authorityCertIssuer",fa="authorityCertSerialNumber",K1=[ha,ma,fa];class Gr extends ${constructor(e={}){super(),ha in e&&(this.keyIdentifier=y(e,ha,Gr.defaultValues(ha))),ma in e&&(this.authorityCertIssuer=y(e,ma,Gr.defaultValues(ma))),fa in e&&(this.authorityCertSerialNumber=y(e,fa,Gr.defaultValues(fa))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case ha:return new M;case ma:return[];case fa:return new R;default:return super.defaultValues(e)}}static schema(e={}){const t=y(e,"names",{});return new I({name:t.blockName||N,value:[new Y({name:t.keyIdentifier||N,optional:!0,idBlock:{tagClass:3,tagNumber:0}}),new D({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[new ee({name:t.authorityCertIssuer||N,value:le.schema()})]}),new Y({name:t.authorityCertSerialNumber||N,optional:!0,idBlock:{tagClass:3,tagNumber:2}})]})}fromSchema(e){U(e,K1);const t=K(e,e,Gr.schema({names:{keyIdentifier:ha,authorityCertIssuer:ma,authorityCertSerialNumber:fa}}));j.assertSchema(t,this.className),ha in t.result&&(this.keyIdentifier=new M({valueHex:t.result.keyIdentifier.valueBlock.valueHex})),ma in t.result&&(this.authorityCertIssuer=Array.from(t.result.authorityCertIssuer,s=>new le({schema:s}))),fa in t.result&&(this.authorityCertSerialNumber=new R({valueHex:t.result.authorityCertSerialNumber.valueBlock.valueHex}))}toSchema(){const e=[];return this.keyIdentifier&&e.push(new Y({idBlock:{tagClass:3,tagNumber:0},valueHex:this.keyIdentifier.valueBlock.valueHexView})),this.authorityCertIssuer&&e.push(new D({idBlock:{tagClass:3,tagNumber:1},value:Array.from(this.authorityCertIssuer,t=>t.toSchema())})),this.authorityCertSerialNumber&&e.push(new Y({idBlock:{tagClass:3,tagNumber:2},valueHex:this.authorityCertSerialNumber.valueBlock.valueHexView})),new I({value:e})}toJSON(){const e={};return this.keyIdentifier&&(e.keyIdentifier=this.keyIdentifier.toJSON()),this.authorityCertIssuer&&(e.authorityCertIssuer=Array.from(this.authorityCertIssuer,t=>t.toJSON())),this.authorityCertSerialNumber&&(e.authorityCertSerialNumber=this.authorityCertSerialNumber.toJSON()),e}}Gr.CLASS_NAME="AuthorityKeyIdentifier";const oa="pathLenConstraint",ua="cA";class bn extends ${constructor(e={}){super(),this.cA=y(e,ua,!1),oa in e&&(this.pathLenConstraint=y(e,oa,0)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case ua:return!1;default:return super.defaultValues(e)}}static schema(e={}){const t=y(e,"names",{});return new I({name:t.blockName||N,value:[new ra({optional:!0,name:t.cA||N}),new R({optional:!0,name:t.pathLenConstraint||N})]})}fromSchema(e){U(e,[ua,oa]);const t=K(e,e,bn.schema({names:{cA:ua,pathLenConstraint:oa}}));j.assertSchema(t,this.className),ua in t.result&&(this.cA=t.result.cA.valueBlock.value),oa in t.result&&(t.result.pathLenConstraint.valueBlock.isHexOnly?this.pathLenConstraint=t.result.pathLenConstraint:this.pathLenConstraint=t.result.pathLenConstraint.valueBlock.valueDec)}toSchema(){const e=[];return this.cA!==bn.defaultValues(ua)&&e.push(new ra({value:this.cA})),oa in this&&(this.pathLenConstraint instanceof R?e.push(this.pathLenConstraint):e.push(new R({value:this.pathLenConstraint}))),new I({value:e})}toJSON(){const e={};return this.cA!==bn.defaultValues(ua)&&(e.cA=this.cA),oa in this&&(this.pathLenConstraint instanceof R?e.pathLenConstraint=this.pathLenConstraint.toJSON():e.pathLenConstraint=this.pathLenConstraint),e}}bn.CLASS_NAME="BasicConstraints";const Hm="certificateIndex",Mm="keyIndex";class Xl extends ${constructor(e={}){super(),this.certificateIndex=y(e,Hm,Xl.defaultValues(Hm)),this.keyIndex=y(e,Mm,Xl.defaultValues(Mm)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Hm:case Mm:return 0;default:return super.defaultValues(e)}}static schema(){return new R}fromSchema(e){if(e.constructor.blockName()!==R.blockName())throw new Error("Object's schema was not verified against input data for CAVersion");let t=e.valueBlock.valueHex.slice(0);const s=new Uint8Array(t);switch(!0){case t.byteLength<4:{const m=new ArrayBuffer(4);new Uint8Array(m).set(s,4-t.byteLength),t=m.slice(0)}break;case t.byteLength>4:{const m=new ArrayBuffer(4);new Uint8Array(m).set(s.slice(0,4)),t=m.slice(0)}break}const a=t.slice(0,2),u=new Uint8Array(a);let c=u[0];u[0]=u[1],u[1]=c;const i=new Uint16Array(a);this.keyIndex=i[0];const o=t.slice(2),n=new Uint8Array(o);c=n[0],n[0]=n[1],n[1]=c;const l=new Uint16Array(o);this.certificateIndex=l[0]}toSchema(){const e=new ArrayBuffer(2),t=new Uint16Array(e);t[0]=this.certificateIndex;const s=new Uint8Array(e);let a=s[0];s[0]=s[1],s[1]=a;const u=new ArrayBuffer(2),c=new Uint16Array(u);c[0]=this.keyIndex;const i=new Uint8Array(u);return a=i[0],i[0]=i[1],i[1]=a,new R({valueHex:ho(u,e)})}toJSON(){return{certificateIndex:this.certificateIndex,keyIndex:this.keyIndex}}}Xl.CLASS_NAME="CAVersion";const Qo="policyQualifierId",Yo="qualifier",H1=[Qo,Yo];class Sn extends ${constructor(e={}){super(),this.policyQualifierId=y(e,Qo,Sn.defaultValues(Qo)),this.qualifier=y(e,Yo,Sn.defaultValues(Yo)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Qo:return N;case Yo:return new Z;default:return super.defaultValues(e)}}static schema(e={}){const t=y(e,"names",{});return new I({name:t.blockName||N,value:[new W({name:t.policyQualifierId||N}),new Z({name:t.qualifier||N})]})}fromSchema(e){U(e,H1);const t=K(e,e,Sn.schema({names:{policyQualifierId:Qo,qualifier:Yo}}));j.assertSchema(t,this.className),this.policyQualifierId=t.result.policyQualifierId.valueBlock.toString(),this.qualifier=t.result.qualifier}toSchema(){return new I({value:[new W({value:this.policyQualifierId}),this.qualifier]})}toJSON(){return{policyQualifierId:this.policyQualifierId,qualifier:this.qualifier.toJSON()}}}Sn.CLASS_NAME="PolicyQualifierInfo";const Zo="policyIdentifier",pa="policyQualifiers",M1=[Zo,pa];class An extends ${constructor(e={}){super(),this.policyIdentifier=y(e,Zo,An.defaultValues(Zo)),pa in e&&(this.policyQualifiers=y(e,pa,An.defaultValues(pa))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Zo:return N;case pa:return[];default:return super.defaultValues(e)}}static schema(e={}){const t=y(e,"names",{});return new I({name:t.blockName||N,value:[new W({name:t.policyIdentifier||N}),new I({optional:!0,value:[new ee({name:t.policyQualifiers||N,value:Sn.schema()})]})]})}fromSchema(e){U(e,M1);const t=K(e,e,An.schema({names:{policyIdentifier:Zo,policyQualifiers:pa}}));j.assertSchema(t,this.className),this.policyIdentifier=t.result.policyIdentifier.valueBlock.toString(),pa in t.result&&(this.policyQualifiers=Array.from(t.result.policyQualifiers,s=>new Sn({schema:s})))}toSchema(){const e=[];return e.push(new W({value:this.policyIdentifier})),this.policyQualifiers&&e.push(new I({value:Array.from(this.policyQualifiers,t=>t.toSchema())})),new I({value:e})}toJSON(){const e={policyIdentifier:this.policyIdentifier};return this.policyQualifiers&&(e.policyQualifiers=Array.from(this.policyQualifiers,t=>t.toJSON())),e}}An.CLASS_NAME="PolicyInformation";const eu="certificatePolicies",F1=[eu];class Ao extends ${constructor(e={}){super(),this.certificatePolicies=y(e,eu,Ao.defaultValues(eu)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case eu:return[];default:return super.defaultValues(e)}}static schema(e={}){const t=y(e,"names",{});return new I({name:t.blockName||N,value:[new ee({name:t.certificatePolicies||N,value:An.schema()})]})}fromSchema(e){U(e,F1);const t=K(e,e,Ao.schema({names:{certificatePolicies:eu}}));j.assertSchema(t,this.className),this.certificatePolicies=Array.from(t.result.certificatePolicies,s=>new An({schema:s}))}toSchema(){return new I({value:Array.from(this.certificatePolicies,e=>e.toSchema())})}toJSON(){return{certificatePolicies:Array.from(this.certificatePolicies,e=>e.toJSON())}}}Ao.CLASS_NAME="CertificatePolicies";const tu="templateID",ws="templateMajorVersion",ys="templateMinorVersion",J1=[tu,ws,ys];class lo extends ${constructor(e={}){super(),this.templateID=y(e,tu,lo.defaultValues(tu)),ws in e&&(this.templateMajorVersion=y(e,ws,lo.defaultValues(ws))),ys in e&&(this.templateMinorVersion=y(e,ys,lo.defaultValues(ys))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case tu:return N;case ws:case ys:return 0;default:return super.defaultValues(e)}}static schema(e={}){const t=y(e,"names",{});return new I({name:t.blockName||N,value:[new W({name:t.templateID||N}),new R({name:t.templateMajorVersion||N,optional:!0}),new R({name:t.templateMinorVersion||N,optional:!0})]})}fromSchema(e){U(e,J1);const t=K(e,e,lo.schema({names:{templateID:tu,templateMajorVersion:ws,templateMinorVersion:ys}}));j.assertSchema(t,this.className),this.templateID=t.result.templateID.valueBlock.toString(),ws in t.result&&(this.templateMajorVersion=t.result.templateMajorVersion.valueBlock.valueDec),ys in t.result&&(this.templateMinorVersion=t.result.templateMinorVersion.valueBlock.valueDec)}toSchema(){const e=[];return e.push(new W({value:this.templateID})),ws in this&&e.push(new R({value:this.templateMajorVersion})),ys in this&&e.push(new R({value:this.templateMinorVersion})),new I({value:e})}toJSON(){const e={templateID:this.templateID};return ws in this&&(e.templateMajorVersion=this.templateMajorVersion),ys in this&&(e.templateMinorVersion=this.templateMinorVersion),e}}const da="distributionPoint",Dw="distributionPointNames",ga="reasons",wa="cRLIssuer",Tw="cRLIssuerNames",q1=[da,Dw,ga,wa,Tw];class _r extends ${constructor(e={}){super(),da in e&&(this.distributionPoint=y(e,da,_r.defaultValues(da))),ga in e&&(this.reasons=y(e,ga,_r.defaultValues(ga))),wa in e&&(this.cRLIssuer=y(e,wa,_r.defaultValues(wa))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case da:return[];case ga:return new ne;case wa:return[];default:return super.defaultValues(e)}}static schema(e={}){const t=y(e,"names",{});return new I({name:t.blockName||N,value:[new D({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new Ne({value:[new D({name:t.distributionPoint||N,optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new ee({name:t.distributionPointNames||N,value:le.schema()})]}),new D({name:t.distributionPoint||N,optional:!0,idBlock:{tagClass:3,tagNumber:1},value:fe.schema().valueBlock.value})]})]}),new Y({name:t.reasons||N,optional:!0,idBlock:{tagClass:3,tagNumber:1}}),new D({name:t.cRLIssuer||N,optional:!0,idBlock:{tagClass:3,tagNumber:2},value:[new ee({name:t.cRLIssuerNames||N,value:le.schema()})]})]})}fromSchema(e){U(e,q1);const t=K(e,e,_r.schema({names:{distributionPoint:da,distributionPointNames:Dw,reasons:ga,cRLIssuer:wa,cRLIssuerNames:Tw}}));j.assertSchema(t,this.className),da in t.result&&(t.result.distributionPoint.idBlock.tagNumber===0&&(this.distributionPoint=Array.from(t.result.distributionPointNames,s=>new le({schema:s}))),t.result.distributionPoint.idBlock.tagNumber===1&&(this.distributionPoint=new fe({schema:new I({value:t.result.distributionPoint.valueBlock.value})}))),ga in t.result&&(this.reasons=new ne({valueHex:t.result.reasons.valueBlock.valueHex})),wa in t.result&&(this.cRLIssuer=Array.from(t.result.cRLIssuerNames,s=>new le({schema:s})))}toSchema(){const e=[];if(this.distributionPoint){let t;this.distributionPoint instanceof Array?t=new D({idBlock:{tagClass:3,tagNumber:0},value:Array.from(this.distributionPoint,s=>s.toSchema())}):t=new D({idBlock:{tagClass:3,tagNumber:1},value:[this.distributionPoint.toSchema()]}),e.push(new D({idBlock:{tagClass:3,tagNumber:0},value:[t]}))}return this.reasons&&e.push(new Y({idBlock:{tagClass:3,tagNumber:1},valueHex:this.reasons.valueBlock.valueHexView})),this.cRLIssuer&&e.push(new D({idBlock:{tagClass:3,tagNumber:2},value:Array.from(this.cRLIssuer,t=>t.toSchema())})),new I({value:e})}toJSON(){const e={};return this.distributionPoint&&(this.distributionPoint instanceof Array?e.distributionPoint=Array.from(this.distributionPoint,t=>t.toJSON()):e.distributionPoint=this.distributionPoint.toJSON()),this.reasons&&(e.reasons=this.reasons.toJSON()),this.cRLIssuer&&(e.cRLIssuer=Array.from(this.cRLIssuer,t=>t.toJSON())),e}}_r.CLASS_NAME="DistributionPoint";const su="distributionPoints",W1=[su];class No extends ${constructor(e={}){super(),this.distributionPoints=y(e,su,No.defaultValues(su)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case su:return[];default:return super.defaultValues(e)}}static schema(e={}){const t=y(e,"names",{});return new I({name:t.blockName||N,value:[new ee({name:t.distributionPoints||N,value:_r.schema()})]})}fromSchema(e){U(e,W1);const t=K(e,e,No.schema({names:{distributionPoints:su}}));j.assertSchema(t,this.className),this.distributionPoints=Array.from(t.result.distributionPoints,s=>new _r({schema:s}))}toSchema(){return new I({value:Array.from(this.distributionPoints,e=>e.toSchema())})}toJSON(){return{distributionPoints:Array.from(this.distributionPoints,e=>e.toJSON())}}}No.CLASS_NAME="CRLDistributionPoints";const ru="keyPurposes",G1=[ru];class zl extends ${constructor(e={}){super(),this.keyPurposes=y(e,ru,zl.defaultValues(ru)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case ru:return[];default:return super.defaultValues(e)}}static schema(e={}){const t=y(e,"names",{});return new I({name:t.blockName||N,value:[new ee({name:t.keyPurposes||N,value:new W})]})}fromSchema(e){U(e,G1);const t=K(e,e,zl.schema({names:{keyPurposes:ru}}));j.assertSchema(t,this.className),this.keyPurposes=Array.from(t.result.keyPurposes,s=>s.valueBlock.toString())}toSchema(){return new I({value:Array.from(this.keyPurposes,e=>new W({value:e}))})}toJSON(){return{keyPurposes:Array.from(this.keyPurposes)}}}zl.CLASS_NAME="ExtKeyUsage";const To="accessDescriptions";class ko extends ${constructor(e={}){super(),this.accessDescriptions=y(e,To,ko.defaultValues(To)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case To:return[];default:return super.defaultValues(e)}}static schema(e={}){const t=y(e,"names",{});return new I({name:t.blockName||N,value:[new ee({name:t.accessDescriptions||N,value:vn.schema()})]})}fromSchema(e){U(e,[To]);const t=K(e,e,ko.schema({names:{accessDescriptions:To}}));j.assertSchema(t,this.className),this.accessDescriptions=Array.from(t.result.accessDescriptions,s=>new vn({schema:s}))}toSchema(){return new I({value:Array.from(this.accessDescriptions,e=>e.toSchema())})}toJSON(){return{accessDescriptions:Array.from(this.accessDescriptions,e=>e.toJSON())}}}ko.CLASS_NAME="InfoAccess";const ya="distributionPoint",Rw="distributionPointNames",ar="onlyContainsUserCerts",nr="onlyContainsCACerts",ir="onlySomeReasons",or="indirectCRL",ur="onlyContainsAttributeCerts",_1=[ya,Rw,ar,nr,ir,or,ur];class Ye extends ${constructor(e={}){super(),ya in e&&(this.distributionPoint=y(e,ya,Ye.defaultValues(ya))),this.onlyContainsUserCerts=y(e,ar,Ye.defaultValues(ar)),this.onlyContainsCACerts=y(e,nr,Ye.defaultValues(nr)),ir in e&&(this.onlySomeReasons=y(e,ir,Ye.defaultValues(ir))),this.indirectCRL=y(e,or,Ye.defaultValues(or)),this.onlyContainsAttributeCerts=y(e,ur,Ye.defaultValues(ur)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case ya:return[];case ar:return!1;case nr:return!1;case ir:return 0;case or:return!1;case ur:return!1;default:return super.defaultValues(e)}}static schema(e={}){const t=y(e,"names",{});return new I({name:t.blockName||N,value:[new D({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new Ne({value:[new D({name:t.distributionPoint||N,idBlock:{tagClass:3,tagNumber:0},value:[new ee({name:t.distributionPointNames||N,value:le.schema()})]}),new D({name:t.distributionPoint||N,idBlock:{tagClass:3,tagNumber:1},value:fe.schema().valueBlock.value})]})]}),new Y({name:t.onlyContainsUserCerts||N,optional:!0,idBlock:{tagClass:3,tagNumber:1}}),new Y({name:t.onlyContainsCACerts||N,optional:!0,idBlock:{tagClass:3,tagNumber:2}}),new Y({name:t.onlySomeReasons||N,optional:!0,idBlock:{tagClass:3,tagNumber:3}}),new Y({name:t.indirectCRL||N,optional:!0,idBlock:{tagClass:3,tagNumber:4}}),new Y({name:t.onlyContainsAttributeCerts||N,optional:!0,idBlock:{tagClass:3,tagNumber:5}})]})}fromSchema(e){U(e,_1);const t=K(e,e,Ye.schema({names:{distributionPoint:ya,distributionPointNames:Rw,onlyContainsUserCerts:ar,onlyContainsCACerts:nr,onlySomeReasons:ir,indirectCRL:or,onlyContainsAttributeCerts:ur}}));if(j.assertSchema(t,this.className),ya in t.result)switch(!0){case t.result.distributionPoint.idBlock.tagNumber===0:this.distributionPoint=Array.from(t.result.distributionPointNames,s=>new le({schema:s}));break;case t.result.distributionPoint.idBlock.tagNumber===1:this.distributionPoint=new fe({schema:new I({value:t.result.distributionPoint.valueBlock.value})});break;default:throw new Error("Unknown tagNumber for distributionPoint: {$asn1.result.distributionPoint.idBlock.tagNumber}")}if(ar in t.result){const s=new Uint8Array(t.result.onlyContainsUserCerts.valueBlock.valueHex);this.onlyContainsUserCerts=s[0]!==0}if(nr in t.result){const s=new Uint8Array(t.result.onlyContainsCACerts.valueBlock.valueHex);this.onlyContainsCACerts=s[0]!==0}if(ir in t.result){const s=new Uint8Array(t.result.onlySomeReasons.valueBlock.valueHex);this.onlySomeReasons=s[0]}if(or in t.result){const s=new Uint8Array(t.result.indirectCRL.valueBlock.valueHex);this.indirectCRL=s[0]!==0}if(ur in t.result){const s=new Uint8Array(t.result.onlyContainsAttributeCerts.valueBlock.valueHex);this.onlyContainsAttributeCerts=s[0]!==0}}toSchema(){const e=[];if(this.distributionPoint){let t;this.distributionPoint instanceof Array?t=new D({idBlock:{tagClass:3,tagNumber:0},value:Array.from(this.distributionPoint,s=>s.toSchema())}):(t=this.distributionPoint.toSchema(),t.idBlock.tagClass=3,t.idBlock.tagNumber=1),e.push(new D({idBlock:{tagClass:3,tagNumber:0},value:[t]}))}if(this.onlyContainsUserCerts!==Ye.defaultValues(ar)&&e.push(new Y({idBlock:{tagClass:3,tagNumber:1},valueHex:new Uint8Array([255]).buffer})),this.onlyContainsCACerts!==Ye.defaultValues(nr)&&e.push(new Y({idBlock:{tagClass:3,tagNumber:2},valueHex:new Uint8Array([255]).buffer})),this.onlySomeReasons!==void 0){const t=new ArrayBuffer(1),s=new Uint8Array(t);s[0]=this.onlySomeReasons,e.push(new Y({idBlock:{tagClass:3,tagNumber:3},valueHex:t}))}return this.indirectCRL!==Ye.defaultValues(or)&&e.push(new Y({idBlock:{tagClass:3,tagNumber:4},valueHex:new Uint8Array([255]).buffer})),this.onlyContainsAttributeCerts!==Ye.defaultValues(ur)&&e.push(new Y({idBlock:{tagClass:3,tagNumber:5},valueHex:new Uint8Array([255]).buffer})),new I({value:e})}toJSON(){const e={};return this.distributionPoint&&(this.distributionPoint instanceof Array?e.distributionPoint=Array.from(this.distributionPoint,t=>t.toJSON()):e.distributionPoint=this.distributionPoint.toJSON()),this.onlyContainsUserCerts!==Ye.defaultValues(ar)&&(e.onlyContainsUserCerts=this.onlyContainsUserCerts),this.onlyContainsCACerts!==Ye.defaultValues(nr)&&(e.onlyContainsCACerts=this.onlyContainsCACerts),ir in this&&(e.onlySomeReasons=this.onlySomeReasons),this.indirectCRL!==Ye.defaultValues(or)&&(e.indirectCRL=this.indirectCRL),this.onlyContainsAttributeCerts!==Ye.defaultValues(ur)&&(e.onlyContainsAttributeCerts=this.onlyContainsAttributeCerts),e}}Ye.CLASS_NAME="IssuingDistributionPoint";const au="base",Jn="minimum",lr="maximum",X1=[au,Jn,lr];class hs extends ${constructor(e={}){super(),this.base=y(e,au,hs.defaultValues(au)),this.minimum=y(e,Jn,hs.defaultValues(Jn)),lr in e&&(this.maximum=y(e,lr,hs.defaultValues(lr))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case au:return new le;case Jn:return 0;case lr:return 0;default:return super.defaultValues(e)}}static schema(e={}){const t=y(e,"names",{});return new I({name:t.blockName||N,value:[le.schema(t.base||{}),new D({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new R({name:t.minimum||N})]}),new D({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[new R({name:t.maximum||N})]})]})}fromSchema(e){U(e,X1);const t=K(e,e,hs.schema({names:{base:{names:{blockName:au}},minimum:Jn,maximum:lr}}));j.assertSchema(t,this.className),this.base=new le({schema:t.result.base}),Jn in t.result&&(t.result.minimum.valueBlock.isHexOnly?this.minimum=t.result.minimum:this.minimum=t.result.minimum.valueBlock.valueDec),lr in t.result&&(t.result.maximum.valueBlock.isHexOnly?this.maximum=t.result.maximum:this.maximum=t.result.maximum.valueBlock.valueDec)}toSchema(){const e=[];if(e.push(this.base.toSchema()),this.minimum!==0){let t=0;this.minimum instanceof R?t=this.minimum:t=new R({value:this.minimum}),e.push(new D({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[t]}))}if(lr in this){let t=0;this.maximum instanceof R?t=this.maximum:t=new R({value:this.maximum}),e.push(new D({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[t]}))}return new I({value:e})}toJSON(){const e={base:this.base.toJSON()};return this.minimum!==0&&(typeof this.minimum=="number"?e.minimum=this.minimum:e.minimum=this.minimum.toJSON()),this.maximum!==void 0&&(typeof this.maximum=="number"?e.maximum=this.maximum:e.maximum=this.maximum.toJSON()),e}}hs.CLASS_NAME="GeneralSubtree";const va="permittedSubtrees",ba="excludedSubtrees",z1=[va,ba];class fo extends ${constructor(e={}){super(),va in e&&(this.permittedSubtrees=y(e,va,fo.defaultValues(va))),ba in e&&(this.excludedSubtrees=y(e,ba,fo.defaultValues(ba))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case va:case ba:return[];default:return super.defaultValues(e)}}static schema(e={}){const t=y(e,"names",{});return new I({name:t.blockName||N,value:[new D({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new ee({name:t.permittedSubtrees||N,value:hs.schema()})]}),new D({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[new ee({name:t.excludedSubtrees||N,value:hs.schema()})]})]})}fromSchema(e){U(e,z1);const t=K(e,e,fo.schema({names:{permittedSubtrees:va,excludedSubtrees:ba}}));j.assertSchema(t,this.className),va in t.result&&(this.permittedSubtrees=Array.from(t.result.permittedSubtrees,s=>new hs({schema:s}))),ba in t.result&&(this.excludedSubtrees=Array.from(t.result.excludedSubtrees,s=>new hs({schema:s})))}toSchema(){const e=[];return this.permittedSubtrees&&e.push(new D({idBlock:{tagClass:3,tagNumber:0},value:Array.from(this.permittedSubtrees,t=>t.toSchema())})),this.excludedSubtrees&&e.push(new D({idBlock:{tagClass:3,tagNumber:1},value:Array.from(this.excludedSubtrees,t=>t.toSchema())})),new I({value:e})}toJSON(){const e={};return this.permittedSubtrees&&(e.permittedSubtrees=Array.from(this.permittedSubtrees,t=>t.toJSON())),this.excludedSubtrees&&(e.excludedSubtrees=Array.from(this.excludedSubtrees,t=>t.toJSON())),e}}fo.CLASS_NAME="NameConstraints";const vs="requireExplicitPolicy",bs="inhibitPolicyMapping",Q1=[vs,bs];class po extends ${constructor(e={}){super(),vs in e&&(this.requireExplicitPolicy=y(e,vs,po.defaultValues(vs))),bs in e&&(this.inhibitPolicyMapping=y(e,bs,po.defaultValues(bs))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case vs:return 0;case bs:return 0;default:return super.defaultValues(e)}}static schema(e={}){const t=y(e,"names",{});return new I({name:t.blockName||N,value:[new Y({name:t.requireExplicitPolicy||N,optional:!0,idBlock:{tagClass:3,tagNumber:0}}),new Y({name:t.inhibitPolicyMapping||N,optional:!0,idBlock:{tagClass:3,tagNumber:1}})]})}fromSchema(e){U(e,Q1);const t=K(e,e,po.schema({names:{requireExplicitPolicy:vs,inhibitPolicyMapping:bs}}));if(j.assertSchema(t,this.className),vs in t.result){const s=t.result.requireExplicitPolicy;s.idBlock.tagClass=1,s.idBlock.tagNumber=2;const a=s.toBER(!1),u=Re(a);j.assert(u,"Integer"),this.requireExplicitPolicy=u.result.valueBlock.valueDec}if(bs in t.result){const s=t.result.inhibitPolicyMapping;s.idBlock.tagClass=1,s.idBlock.tagNumber=2;const a=s.toBER(!1),u=Re(a);j.assert(u,"Integer"),this.inhibitPolicyMapping=u.result.valueBlock.valueDec}}toSchema(){const e=[];if(vs in this){const t=new R({value:this.requireExplicitPolicy});t.idBlock.tagClass=3,t.idBlock.tagNumber=0,e.push(t)}if(bs in this){const t=new R({value:this.inhibitPolicyMapping});t.idBlock.tagClass=3,t.idBlock.tagNumber=1,e.push(t)}return new I({value:e})}toJSON(){const e={};return vs in this&&(e.requireExplicitPolicy=this.requireExplicitPolicy),bs in this&&(e.inhibitPolicyMapping=this.inhibitPolicyMapping),e}}po.CLASS_NAME="PolicyConstraints";const nu="issuerDomainPolicy",iu="subjectDomainPolicy",Y1=[nu,iu];class Nn extends ${constructor(e={}){super(),this.issuerDomainPolicy=y(e,nu,Nn.defaultValues(nu)),this.subjectDomainPolicy=y(e,iu,Nn.defaultValues(iu)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case nu:return N;case iu:return N;default:return super.defaultValues(e)}}static schema(e={}){const t=y(e,"names",{});return new I({name:t.blockName||N,value:[new W({name:t.issuerDomainPolicy||N}),new W({name:t.subjectDomainPolicy||N})]})}fromSchema(e){U(e,Y1);const t=K(e,e,Nn.schema({names:{issuerDomainPolicy:nu,subjectDomainPolicy:iu}}));j.assertSchema(t,this.className),this.issuerDomainPolicy=t.result.issuerDomainPolicy.valueBlock.toString(),this.subjectDomainPolicy=t.result.subjectDomainPolicy.valueBlock.toString()}toSchema(){return new I({value:[new W({value:this.issuerDomainPolicy}),new W({value:this.subjectDomainPolicy})]})}toJSON(){return{issuerDomainPolicy:this.issuerDomainPolicy,subjectDomainPolicy:this.subjectDomainPolicy}}}Nn.CLASS_NAME="PolicyMapping";const ou="mappings",Z1=[ou];class Ql extends ${constructor(e={}){super(),this.mappings=y(e,ou,Ql.defaultValues(ou)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case ou:return[];default:return super.defaultValues(e)}}static schema(e={}){const t=y(e,"names",{});return new I({name:t.blockName||N,value:[new ee({name:t.mappings||N,value:Nn.schema()})]})}fromSchema(e){U(e,Z1);const t=K(e,e,Ql.schema({names:{mappings:ou}}));j.assertSchema(t,this.className),this.mappings=Array.from(t.result.mappings,s=>new Nn({schema:s}))}toSchema(){return new I({value:Array.from(this.mappings,e=>e.toSchema())})}toJSON(){return{mappings:Array.from(this.mappings,e=>e.toJSON())}}}Ql.CLASS_NAME="PolicyMappings";const cr="notBefore",hr="notAfter",eb=[cr,hr];class go extends ${constructor(e={}){super(),cr in e&&(this.notBefore=y(e,cr,go.defaultValues(cr))),hr in e&&(this.notAfter=y(e,hr,go.defaultValues(hr))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case cr:return new Date;case hr:return new Date;default:return super.defaultValues(e)}}static schema(e={}){const t=y(e,"names",{});return new I({name:t.blockName||N,value:[new Y({name:t.notBefore||N,optional:!0,idBlock:{tagClass:3,tagNumber:0}}),new Y({name:t.notAfter||N,optional:!0,idBlock:{tagClass:3,tagNumber:1}})]})}fromSchema(e){U(e,eb);const t=K(e,e,go.schema({names:{notBefore:cr,notAfter:hr}}));if(j.assertSchema(t,this.className),cr in t.result){const s=new ke;s.fromBuffer(t.result.notBefore.valueBlock.valueHex),this.notBefore=s.toDate()}if(hr in t.result){const s=new ke({valueHex:t.result.notAfter.valueBlock.valueHex});s.fromBuffer(t.result.notAfter.valueBlock.valueHex),this.notAfter=s.toDate()}}toSchema(){const e=[];return cr in this&&e.push(new Y({idBlock:{tagClass:3,tagNumber:0},valueHex:new ke({valueDate:this.notBefore}).valueBlock.valueHexView})),hr in this&&e.push(new Y({idBlock:{tagClass:3,tagNumber:1},valueHex:new ke({valueDate:this.notAfter}).valueBlock.valueHexView})),new I({value:e})}toJSON(){const e={};return this.notBefore&&(e.notBefore=this.notBefore),this.notAfter&&(e.notAfter=this.notAfter),e}}go.CLASS_NAME="PrivateKeyUsagePeriod";const qn="id",Ss="type",Wn="values",tb=[qn,Ss],sb=[Wn];class kn extends ${constructor(e={}){super(),this.id=y(e,qn,kn.defaultValues(qn)),Ss in e&&(this.type=y(e,Ss,kn.defaultValues(Ss))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case qn:return N;case Ss:return new Me;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case qn:return t===N;case Ss:return t instanceof Me;default:return super.defaultValues(e)}}static schema(e={}){const t=y(e,"names",{});return new I({name:t.blockName||N,value:[new W({name:t.id||N}),new Z({name:t.type||N,optional:!0})]})}fromSchema(e){U(e,tb);const t=K(e,e,kn.schema({names:{id:qn,type:Ss}}));j.assertSchema(t,this.className),this.id=t.result.id.valueBlock.toString(),Ss in t.result&&(this.type=t.result.type)}toSchema(){const e=[new W({value:this.id})];return Ss in this&&e.push(this.type),new I({value:e})}toJSON(){const e={id:this.id};return this.type&&(e.type=this.type.toJSON()),e}}kn.CLASS_NAME="QCStatement";class Yl extends ${constructor(e={}){super(),this.values=y(e,Wn,Yl.defaultValues(Wn)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Wn:return[];default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Wn:return t.length===0;default:return super.defaultValues(e)}}static schema(e={}){const t=y(e,"names",{});return new I({name:t.blockName||N,value:[new ee({name:t.values||N,value:kn.schema(t.value||{})})]})}fromSchema(e){U(e,sb);const t=K(e,e,Yl.schema({names:{values:Wn}}));j.assertSchema(t,this.className),this.values=Array.from(t.result.values,s=>new kn({schema:s}))}toSchema(){return new I({value:Array.from(this.values,e=>e.toSchema())})}toJSON(){return{values:Array.from(this.values,e=>e.toJSON())}}}Yl.CLASS_NAME="QCStatements";var la;class Zr{static register(e,t,s){this.namedCurves[e.toLowerCase()]=this.namedCurves[t]={name:e,id:t,size:s}}static find(e){return this.namedCurves[e.toLowerCase()]||null}}la=Zr,Zr.namedCurves={},la.register("P-256","1.2.840.10045.3.1.7",32),la.register("P-384","1.3.132.0.34",48),la.register("P-521","1.3.132.0.35",66),la.register("brainpoolP256r1","1.3.36.3.3.2.8.1.1.7",32),la.register("brainpoolP384r1","1.3.36.3.3.2.8.1.1.11",48),la.register("brainpoolP512r1","1.3.36.3.3.2.8.1.1.13",64);const fc="x",pc="y",dc="namedCurve";class bt extends ${constructor(e={}){super(),this.x=y(e,fc,bt.defaultValues(fc)),this.y=y(e,pc,bt.defaultValues(pc)),this.namedCurve=y(e,dc,bt.defaultValues(dc)),e.json&&this.fromJSON(e.json),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case fc:case pc:return Le;case dc:return N;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case fc:case pc:return t instanceof ArrayBuffer&&Wl(t,bt.defaultValues(e));case dc:return typeof t=="string"&&t===bt.defaultValues(e);default:return super.defaultValues(e)}}static schema(){return new vh}fromSchema(e){const t=ge.toUint8Array(e);if(t[0]!==4)throw new Error("Object's schema was not verified against input data for ECPublicKey");const s=Zr.find(this.namedCurve);if(!s)throw new Error("Incorrect curve OID: ".concat(this.namedCurve));const a=s.size;if(t.byteLength!==a*2+1)throw new Error("Object's schema was not verified against input data for ECPublicKey");this.namedCurve=s.name,this.x=t.slice(1,a+1).buffer,this.y=t.slice(1+a,a*2+1).buffer}toSchema(){return new vh({data:ho(new Uint8Array([4]).buffer,this.x,this.y)})}toJSON(){const e=Zr.find(this.namedCurve);return{crv:e?e.name:this.namedCurve,x:bf(yh(this.x),!0,!0,!1),y:bf(yh(this.y),!0,!0,!1)}}fromJSON(e){ie.assert("json",e,"crv","x","y");let t=0;const s=Zr.find(e.crv);s&&(this.namedCurve=s.id,t=s.size);const a=bo(ql(e.x,!0));if(a.byteLength<t){this.x=new ArrayBuffer(t);const c=new Uint8Array(this.x),i=new Uint8Array(a);c.set(i,1)}else this.x=a.slice(0,t);const u=bo(ql(e.y,!0));if(u.byteLength<t){this.y=new ArrayBuffer(t);const c=new Uint8Array(this.y),i=new Uint8Array(u);c.set(i,1)}else this.y=u.slice(0,t)}}bt.CLASS_NAME="ECPublicKey";const uu="modulus",lu="publicExponent",rb=[uu,lu];class En extends ${constructor(e={}){super(),this.modulus=y(e,uu,En.defaultValues(uu)),this.publicExponent=y(e,lu,En.defaultValues(lu)),e.json&&this.fromJSON(e.json),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case uu:return new R;case lu:return new R;default:return super.defaultValues(e)}}static schema(e={}){const t=y(e,"names",{});return new I({name:t.blockName||N,value:[new R({name:t.modulus||N}),new R({name:t.publicExponent||N})]})}fromSchema(e){U(e,rb);const t=K(e,e,En.schema({names:{modulus:uu,publicExponent:lu}}));j.assertSchema(t,this.className),this.modulus=t.result.modulus.convertFromDER(256),this.publicExponent=t.result.publicExponent}toSchema(){return new I({value:[this.modulus.convertToDER(),this.publicExponent]})}toJSON(){return{n:he.ToBase64Url(this.modulus.valueBlock.valueHexView),e:he.ToBase64Url(this.publicExponent.valueBlock.valueHexView)}}fromJSON(e){ie.assert("json",e,"n","e");const t=bo(ql(e.n,!0));this.modulus=new R({valueHex:t.slice(0,Math.pow(2,ny(t.byteLength)))}),this.publicExponent=new R({valueHex:bo(ql(e.e,!0)).slice(0,3)})}}En.CLASS_NAME="RSAPublicKey";const cu="algorithm",hu="subjectPublicKey",ab=[cu,hu];class Nt extends ${get parsedKey(){if(this._parsedKey===void 0){switch(this.algorithm.algorithmId){case"1.2.840.10045.2.1":if("algorithmParams"in this.algorithm&&this.algorithm.algorithmParams.constructor.blockName()===W.blockName())try{this._parsedKey=new bt({namedCurve:this.algorithm.algorithmParams.valueBlock.toString(),schema:this.subjectPublicKey.valueBlock.valueHexView})}catch(e){}break;case"1.2.840.113549.1.1.1":{const e=Re(this.subjectPublicKey.valueBlock.valueHexView);if(e.offset!==-1)try{this._parsedKey=new En({schema:e.result})}catch(t){}}break}this._parsedKey||(this._parsedKey=null)}return this._parsedKey||void 0}set parsedKey(e){this._parsedKey=e}constructor(e={}){super(),this.algorithm=y(e,cu,Nt.defaultValues(cu)),this.subjectPublicKey=y(e,hu,Nt.defaultValues(hu));const t=y(e,"parsedKey",null);t&&(this.parsedKey=t),e.json&&this.fromJSON(e.json),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case cu:return new T;case hu:return new ne;default:return super.defaultValues(e)}}static schema(e={}){const t=y(e,"names",{});return new I({name:t.blockName||N,value:[T.schema(t.algorithm||{}),new ne({name:t.subjectPublicKey||N})]})}fromSchema(e){U(e,ab);const t=K(e,e,Nt.schema({names:{algorithm:{names:{blockName:cu}},subjectPublicKey:hu}}));j.assertSchema(t,this.className),this.algorithm=new T({schema:t.result.algorithm}),this.subjectPublicKey=t.result.subjectPublicKey}toSchema(){return new I({value:[this.algorithm.toSchema(),this.subjectPublicKey]})}toJSON(){if(!this.parsedKey)return{algorithm:this.algorithm.toJSON(),subjectPublicKey:this.subjectPublicKey.toJSON()};const e={};switch(this.algorithm.algorithmId){case"1.2.840.10045.2.1":e.kty="EC";break;case"1.2.840.113549.1.1.1":e.kty="RSA";break}const t=this.parsedKey.toJSON();return Object.assign(e,t),e}fromJSON(e){if("kty"in e){switch(e.kty.toUpperCase()){case"EC":this.parsedKey=new bt({json:e}),this.algorithm=new T({algorithmId:"1.2.840.10045.2.1",algorithmParams:new W({value:this.parsedKey.namedCurve})});break;case"RSA":this.parsedKey=new En({json:e}),this.algorithm=new T({algorithmId:"1.2.840.113549.1.1.1",algorithmParams:new Me});break;default:throw new Error('Invalid value for "kty" parameter: '.concat(e.kty))}this.subjectPublicKey=new ne({valueHex:this.parsedKey.toSchema().toBER(!1)})}}async importKey(e,t=te(!0)){try{if(!e)throw new Error("Need to provide publicKey input parameter");const s=await t.exportKey("spki",e),a=Re(s);try{this.fromSchema(a.result)}catch(u){throw new Error("Error during initializing object from schema")}}catch(s){const a=s instanceof Error?s.message:"".concat(s);throw new Error("Error during exporting public key: ".concat(a))}}}Nt.CLASS_NAME="PublicKeyInfo";const Gn="version",_n="privateKey",_t="namedCurve",mr="publicKey",nb=[Gn,_n,_t,mr];class Ut extends ${constructor(e={}){super(),this.version=y(e,Gn,Ut.defaultValues(Gn)),this.privateKey=y(e,_n,Ut.defaultValues(_n)),_t in e&&(this.namedCurve=y(e,_t,Ut.defaultValues(_t))),mr in e&&(this.publicKey=y(e,mr,Ut.defaultValues(mr))),e.json&&this.fromJSON(e.json),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Gn:return 1;case _n:return new M;case _t:return N;case mr:return new bt;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Gn:return t===Ut.defaultValues(e);case _n:return t.isEqual(Ut.defaultValues(e));case _t:return t===N;case mr:return bt.compareWithDefault(_t,t.namedCurve)&&bt.compareWithDefault("x",t.x)&&bt.compareWithDefault("y",t.y);default:return super.defaultValues(e)}}static schema(e={}){const t=y(e,"names",{});return new I({name:t.blockName||N,value:[new R({name:t.version||N}),new M({name:t.privateKey||N}),new D({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new W({name:t.namedCurve||N})]}),new D({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[new ne({name:t.publicKey||N})]})]})}fromSchema(e){U(e,nb);const t=K(e,e,Ut.schema({names:{version:Gn,privateKey:_n,namedCurve:_t,publicKey:mr}}));if(j.assertSchema(t,this.className),this.version=t.result.version.valueBlock.valueDec,this.privateKey=t.result.privateKey,_t in t.result&&(this.namedCurve=t.result.namedCurve.valueBlock.toString()),mr in t.result){const s={schema:t.result.publicKey.valueBlock.valueHex};_t in this&&(s.namedCurve=this.namedCurve),this.publicKey=new bt(s)}}toSchema(){const e=[new R({value:this.version}),this.privateKey];return this.namedCurve&&e.push(new D({idBlock:{tagClass:3,tagNumber:0},value:[new W({value:this.namedCurve})]})),this.publicKey&&e.push(new D({idBlock:{tagClass:3,tagNumber:1},value:[new ne({valueHex:this.publicKey.toSchema().toBER(!1)})]})),new I({value:e})}toJSON(){if(!this.namedCurve||Ut.compareWithDefault(_t,this.namedCurve))throw new Error('Not enough information for making JSON: absent "namedCurve" value');const e=Zr.find(this.namedCurve),t={crv:e?e.name:this.namedCurve,d:he.ToBase64Url(this.privateKey.valueBlock.valueHexView)};if(this.publicKey){const s=this.publicKey.toJSON();t.x=s.x,t.y=s.y}return t}fromJSON(e){ie.assert("json",e,"crv","d");let t=0;const s=Zr.find(e.crv);s&&(this.namedCurve=s.id,t=s.size);const a=he.FromBase64Url(e.d);if(a.byteLength<t){const u=new ArrayBuffer(t),c=new Uint8Array(u),i=new Uint8Array(a);c.set(i,1),this.privateKey=new M({valueHex:u})}else this.privateKey=new M({valueHex:a.slice(0,t)});e.x&&e.y&&(this.publicKey=new bt({json:e}))}}Ut.CLASS_NAME="ECPrivateKey";const mu="prime",fu="exponent",pu="coefficient",ib=[mu,fu,pu];class Ds extends ${constructor(e={}){super(),this.prime=y(e,mu,Ds.defaultValues(mu)),this.exponent=y(e,fu,Ds.defaultValues(fu)),this.coefficient=y(e,pu,Ds.defaultValues(pu)),e.json&&this.fromJSON(e.json),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case mu:return new R;case fu:return new R;case pu:return new R;default:return super.defaultValues(e)}}static schema(e={}){const t=y(e,"names",{});return new I({name:t.blockName||N,value:[new R({name:t.prime||N}),new R({name:t.exponent||N}),new R({name:t.coefficient||N})]})}fromSchema(e){U(e,ib);const t=K(e,e,Ds.schema({names:{prime:mu,exponent:fu,coefficient:pu}}));j.assertSchema(t,this.className),this.prime=t.result.prime.convertFromDER(),this.exponent=t.result.exponent.convertFromDER(),this.coefficient=t.result.coefficient.convertFromDER()}toSchema(){return new I({value:[this.prime.convertToDER(),this.exponent.convertToDER(),this.coefficient.convertToDER()]})}toJSON(){return{r:he.ToBase64Url(this.prime.valueBlock.valueHexView),d:he.ToBase64Url(this.exponent.valueBlock.valueHexView),t:he.ToBase64Url(this.coefficient.valueBlock.valueHexView)}}fromJSON(e){ie.assert("json",e,"r","d","r"),this.prime=new R({valueHex:he.FromBase64Url(e.r)}),this.exponent=new R({valueHex:he.FromBase64Url(e.d)}),this.coefficient=new R({valueHex:he.FromBase64Url(e.t)})}}Ds.CLASS_NAME="OtherPrimeInfo";const du="version",gu="modulus",wu="publicExponent",yu="privateExponent",vu="prime1",bu="prime2",Su="exponent1",Au="exponent2",Nu="coefficient",Sa="otherPrimeInfos",ob=[du,gu,wu,yu,vu,bu,Su,Au,Nu,Sa];class pt extends ${constructor(e={}){super(),this.version=y(e,du,pt.defaultValues(du)),this.modulus=y(e,gu,pt.defaultValues(gu)),this.publicExponent=y(e,wu,pt.defaultValues(wu)),this.privateExponent=y(e,yu,pt.defaultValues(yu)),this.prime1=y(e,vu,pt.defaultValues(vu)),this.prime2=y(e,bu,pt.defaultValues(bu)),this.exponent1=y(e,Su,pt.defaultValues(Su)),this.exponent2=y(e,Au,pt.defaultValues(Au)),this.coefficient=y(e,Nu,pt.defaultValues(Nu)),Sa in e&&(this.otherPrimeInfos=y(e,Sa,pt.defaultValues(Sa))),e.json&&this.fromJSON(e.json),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case du:return 0;case gu:return new R;case wu:return new R;case yu:return new R;case vu:return new R;case bu:return new R;case Su:return new R;case Au:return new R;case Nu:return new R;case Sa:return[];default:return super.defaultValues(e)}}static schema(e={}){const t=y(e,"names",{});return new I({name:t.blockName||N,value:[new R({name:t.version||N}),new R({name:t.modulus||N}),new R({name:t.publicExponent||N}),new R({name:t.privateExponent||N}),new R({name:t.prime1||N}),new R({name:t.prime2||N}),new R({name:t.exponent1||N}),new R({name:t.exponent2||N}),new R({name:t.coefficient||N}),new I({optional:!0,value:[new ee({name:t.otherPrimeInfosName||N,value:Ds.schema(t.otherPrimeInfo||{})})]})]})}fromSchema(e){U(e,ob);const t=K(e,e,pt.schema({names:{version:du,modulus:gu,publicExponent:wu,privateExponent:yu,prime1:vu,prime2:bu,exponent1:Su,exponent2:Au,coefficient:Nu,otherPrimeInfo:{names:{blockName:Sa}}}}));j.assertSchema(t,this.className),this.version=t.result.version.valueBlock.valueDec,this.modulus=t.result.modulus.convertFromDER(256),this.publicExponent=t.result.publicExponent,this.privateExponent=t.result.privateExponent.convertFromDER(256),this.prime1=t.result.prime1.convertFromDER(128),this.prime2=t.result.prime2.convertFromDER(128),this.exponent1=t.result.exponent1.convertFromDER(128),this.exponent2=t.result.exponent2.convertFromDER(128),this.coefficient=t.result.coefficient.convertFromDER(128),Sa in t.result&&(this.otherPrimeInfos=Array.from(t.result.otherPrimeInfos,s=>new Ds({schema:s})))}toSchema(){const e=[];return e.push(new R({value:this.version})),e.push(this.modulus.convertToDER()),e.push(this.publicExponent),e.push(this.privateExponent.convertToDER()),e.push(this.prime1.convertToDER()),e.push(this.prime2.convertToDER()),e.push(this.exponent1.convertToDER()),e.push(this.exponent2.convertToDER()),e.push(this.coefficient.convertToDER()),this.otherPrimeInfos&&e.push(new I({value:Array.from(this.otherPrimeInfos,t=>t.toSchema())})),new I({value:e})}toJSON(){const e={n:he.ToBase64Url(this.modulus.valueBlock.valueHexView),e:he.ToBase64Url(this.publicExponent.valueBlock.valueHexView),d:he.ToBase64Url(this.privateExponent.valueBlock.valueHexView),p:he.ToBase64Url(this.prime1.valueBlock.valueHexView),q:he.ToBase64Url(this.prime2.valueBlock.valueHexView),dp:he.ToBase64Url(this.exponent1.valueBlock.valueHexView),dq:he.ToBase64Url(this.exponent2.valueBlock.valueHexView),qi:he.ToBase64Url(this.coefficient.valueBlock.valueHexView)};return this.otherPrimeInfos&&(e.oth=Array.from(this.otherPrimeInfos,t=>t.toJSON())),e}fromJSON(e){ie.assert("json",e,"n","e","d","p","q","dp","dq","qi"),this.modulus=new R({valueHex:he.FromBase64Url(e.n)}),this.publicExponent=new R({valueHex:he.FromBase64Url(e.e)}),this.privateExponent=new R({valueHex:he.FromBase64Url(e.d)}),this.prime1=new R({valueHex:he.FromBase64Url(e.p)}),this.prime2=new R({valueHex:he.FromBase64Url(e.q)}),this.exponent1=new R({valueHex:he.FromBase64Url(e.dp)}),this.exponent2=new R({valueHex:he.FromBase64Url(e.dq)}),this.coefficient=new R({valueHex:he.FromBase64Url(e.qi)}),e.oth&&(this.otherPrimeInfos=Array.from(e.oth,t=>new Ds({json:t})))}}pt.CLASS_NAME="RSAPrivateKey";const ku="version",Eu="privateKeyAlgorithm",Cu="privateKey",Aa="attributes",gc="parsedKey",ub=[ku,Eu,Cu,Aa];class Ht extends ${constructor(e={}){super(),this.version=y(e,ku,Ht.defaultValues(ku)),this.privateKeyAlgorithm=y(e,Eu,Ht.defaultValues(Eu)),this.privateKey=y(e,Cu,Ht.defaultValues(Cu)),Aa in e&&(this.attributes=y(e,Aa,Ht.defaultValues(Aa))),gc in e&&(this.parsedKey=y(e,gc,Ht.defaultValues(gc))),e.json&&this.fromJSON(e.json),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case ku:return 0;case Eu:return new T;case Cu:return new M;case Aa:return[];case gc:return{};default:return super.defaultValues(e)}}static schema(e={}){const t=y(e,"names",{});return new I({name:t.blockName||N,value:[new R({name:t.version||N}),T.schema(t.privateKeyAlgorithm||{}),new M({name:t.privateKey||N}),new D({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new ee({name:t.attributes||N,value:we.schema()})]})]})}fromSchema(e){U(e,ub);const t=K(e,e,Ht.schema({names:{version:ku,privateKeyAlgorithm:{names:{blockName:Eu}},privateKey:Cu,attributes:Aa}}));switch(j.assertSchema(t,this.className),this.version=t.result.version.valueBlock.valueDec,this.privateKeyAlgorithm=new T({schema:t.result.privateKeyAlgorithm}),this.privateKey=t.result.privateKey,Aa in t.result&&(this.attributes=Array.from(t.result.attributes,s=>new we({schema:s}))),this.privateKeyAlgorithm.algorithmId){case"1.2.840.113549.1.1.1":{const s=Re(this.privateKey.valueBlock.valueHexView);s.offset!==-1&&(this.parsedKey=new pt({schema:s.result}))}break;case"1.2.840.10045.2.1":if("algorithmParams"in this.privateKeyAlgorithm&&this.privateKeyAlgorithm.algorithmParams instanceof W){const s=Re(this.privateKey.valueBlock.valueHexView);s.offset!==-1&&(this.parsedKey=new Ut({namedCurve:this.privateKeyAlgorithm.algorithmParams.valueBlock.toString(),schema:s.result}))}break}}toSchema(){const e=[new R({value:this.version}),this.privateKeyAlgorithm.toSchema(),this.privateKey];return this.attributes&&e.push(new D({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:Array.from(this.attributes,t=>t.toSchema())})),new I({value:e})}toJSON(){if(!this.parsedKey){const s={version:this.version,privateKeyAlgorithm:this.privateKeyAlgorithm.toJSON(),privateKey:this.privateKey.toJSON()};return this.attributes&&(s.attributes=Array.from(this.attributes,a=>a.toJSON())),s}const e={};switch(this.privateKeyAlgorithm.algorithmId){case"1.2.840.10045.2.1":e.kty="EC";break;case"1.2.840.113549.1.1.1":e.kty="RSA";break}const t=this.parsedKey.toJSON();return Object.assign(e,t),e}fromJSON(e){if("kty"in e){switch(e.kty.toUpperCase()){case"EC":this.parsedKey=new Ut({json:e}),this.privateKeyAlgorithm=new T({algorithmId:"1.2.840.10045.2.1",algorithmParams:new W({value:this.parsedKey.namedCurve})});break;case"RSA":this.parsedKey=new pt({json:e}),this.privateKeyAlgorithm=new T({algorithmId:"1.2.840.113549.1.1.1",algorithmParams:new Me});break;default:throw new Error('Invalid value for "kty" parameter: '.concat(e.kty))}this.privateKey=new M({valueHex:this.parsedKey.toSchema().toBER(!1)})}}}Ht.CLASS_NAME="PrivateKeyInfo";const Xn="contentType",zn="contentEncryptionAlgorithm",Na="encryptedContent",lb=[Xn,zn,Na],eg=1024;class Oe extends ${constructor(e={}){if(super(),this.contentType=y(e,Xn,Oe.defaultValues(Xn)),this.contentEncryptionAlgorithm=y(e,zn,Oe.defaultValues(zn)),Na in e&&e.encryptedContent&&(this.encryptedContent=e.encryptedContent,this.encryptedContent.idBlock.tagClass===1&&this.encryptedContent.idBlock.tagNumber===4&&this.encryptedContent.idBlock.isConstructed===!1&&!e.disableSplit)){const t=new M({idBlock:{isConstructed:!0},isConstructed:!0});let s=0;const a=this.encryptedContent.valueBlock.valueHexView.slice().buffer;let u=a.byteLength;for(;u>0;){const c=new Uint8Array(a,s,s+eg>a.byteLength?a.byteLength-s:eg),i=new ArrayBuffer(c.length),o=new Uint8Array(i);for(let n=0;n<o.length;n++)o[n]=c[n];t.valueBlock.value.push(new M({valueHex:i})),u-=c.length,s+=c.length}this.encryptedContent=t}e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Xn:return N;case zn:return new T;case Na:return new M;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Xn:return t===N;case zn:return t.algorithmId===N&&!("algorithmParams"in t);case Na:return t.isEqual(Oe.defaultValues(Na));default:return super.defaultValues(e)}}static schema(e={}){const t=y(e,"names",{});return new I({name:t.blockName||N,value:[new W({name:t.contentType||N}),T.schema(t.contentEncryptionAlgorithm||{}),new Ne({value:[new D({name:t.encryptedContent||N,idBlock:{tagClass:3,tagNumber:0},value:[new ee({value:new M})]}),new Y({name:t.encryptedContent||N,idBlock:{tagClass:3,tagNumber:0}})]})]})}fromSchema(e){U(e,lb);const t=K(e,e,Oe.schema({names:{contentType:Xn,contentEncryptionAlgorithm:{names:{blockName:zn}},encryptedContent:Na}}));j.assertSchema(t,this.className),this.contentType=t.result.contentType.valueBlock.toString(),this.contentEncryptionAlgorithm=new T({schema:t.result.contentEncryptionAlgorithm}),Na in t.result&&(this.encryptedContent=t.result.encryptedContent,this.encryptedContent.idBlock.tagClass=1,this.encryptedContent.idBlock.tagNumber=4)}toSchema(){const e={isIndefiniteForm:!1},t=[];if(t.push(new W({value:this.contentType})),t.push(this.contentEncryptionAlgorithm.toSchema()),this.encryptedContent){e.isIndefiniteForm=this.encryptedContent.idBlock.isConstructed;const s=this.encryptedContent;s.idBlock.tagClass=3,s.idBlock.tagNumber=0,s.lenBlock.isIndefiniteForm=this.encryptedContent.idBlock.isConstructed,t.push(s)}return new I({lenBlock:e,value:t})}toJSON(){const e={contentType:this.contentType,contentEncryptionAlgorithm:this.contentEncryptionAlgorithm.toJSON()};return this.encryptedContent&&(e.encryptedContent=this.encryptedContent.toJSON()),e}getEncryptedContent(){if(!this.encryptedContent)throw new Error("Parameter 'encryptedContent' is undefined");return M.prototype.getValue.call(this.encryptedContent)}}Oe.CLASS_NAME="EncryptedContentInfo";const fr="hashAlgorithm",pr="maskGenAlgorithm",dr="saltLength",gr="trailerField",cb=[fr,pr,dr,gr];class et extends ${constructor(e={}){super(),this.hashAlgorithm=y(e,fr,et.defaultValues(fr)),this.maskGenAlgorithm=y(e,pr,et.defaultValues(pr)),this.saltLength=y(e,dr,et.defaultValues(dr)),this.trailerField=y(e,gr,et.defaultValues(gr)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case fr:return new T({algorithmId:"1.3.14.3.2.26",algorithmParams:new Me});case pr:return new T({algorithmId:"1.2.840.113549.1.1.8",algorithmParams:new T({algorithmId:"1.3.14.3.2.26",algorithmParams:new Me}).toSchema()});case dr:return 20;case gr:return 1;default:return super.defaultValues(e)}}static schema(e={}){const t=y(e,"names",{});return new I({name:t.blockName||N,value:[new D({idBlock:{tagClass:3,tagNumber:0},optional:!0,value:[T.schema(t.hashAlgorithm||{})]}),new D({idBlock:{tagClass:3,tagNumber:1},optional:!0,value:[T.schema(t.maskGenAlgorithm||{})]}),new D({idBlock:{tagClass:3,tagNumber:2},optional:!0,value:[new R({name:t.saltLength||N})]}),new D({idBlock:{tagClass:3,tagNumber:3},optional:!0,value:[new R({name:t.trailerField||N})]})]})}fromSchema(e){U(e,cb);const t=K(e,e,et.schema({names:{hashAlgorithm:{names:{blockName:fr}},maskGenAlgorithm:{names:{blockName:pr}},saltLength:dr,trailerField:gr}}));j.assertSchema(t,this.className),fr in t.result&&(this.hashAlgorithm=new T({schema:t.result.hashAlgorithm})),pr in t.result&&(this.maskGenAlgorithm=new T({schema:t.result.maskGenAlgorithm})),dr in t.result&&(this.saltLength=t.result.saltLength.valueBlock.valueDec),gr in t.result&&(this.trailerField=t.result.trailerField.valueBlock.valueDec)}toSchema(){const e=[];return this.hashAlgorithm.isEqual(et.defaultValues(fr))||e.push(new D({idBlock:{tagClass:3,tagNumber:0},value:[this.hashAlgorithm.toSchema()]})),this.maskGenAlgorithm.isEqual(et.defaultValues(pr))||e.push(new D({idBlock:{tagClass:3,tagNumber:1},value:[this.maskGenAlgorithm.toSchema()]})),this.saltLength!==et.defaultValues(dr)&&e.push(new D({idBlock:{tagClass:3,tagNumber:2},value:[new R({value:this.saltLength})]})),this.trailerField!==et.defaultValues(gr)&&e.push(new D({idBlock:{tagClass:3,tagNumber:3},value:[new R({value:this.trailerField})]})),new I({value:e})}toJSON(){const e={};return this.hashAlgorithm.isEqual(et.defaultValues(fr))||(e.hashAlgorithm=this.hashAlgorithm.toJSON()),this.maskGenAlgorithm.isEqual(et.defaultValues(pr))||(e.maskGenAlgorithm=this.maskGenAlgorithm.toJSON()),this.saltLength!==et.defaultValues(dr)&&(e.saltLength=this.saltLength),this.trailerField!==et.defaultValues(gr)&&(e.trailerField=this.trailerField),e}}et.CLASS_NAME="RSASSAPSSParams";const Qn="salt",xu="iterationCount",Xt="keyLength",As="prf",hb=[Qn,xu,Xt,As];class ht extends ${constructor(e={}){super(),this.salt=y(e,Qn,ht.defaultValues(Qn)),this.iterationCount=y(e,xu,ht.defaultValues(xu)),Xt in e&&(this.keyLength=y(e,Xt,ht.defaultValues(Xt))),As in e&&(this.prf=y(e,As,ht.defaultValues(As))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Qn:return{};case xu:return-1;case Xt:return 0;case As:return new T({algorithmId:"1.3.14.3.2.26",algorithmParams:new Me});default:return super.defaultValues(e)}}static schema(e={}){const t=y(e,"names",{});return new I({name:t.blockName||N,value:[new Ne({value:[new M({name:t.saltPrimitive||N}),T.schema(t.saltConstructed||{})]}),new R({name:t.iterationCount||N}),new R({name:t.keyLength||N,optional:!0}),T.schema(t.prf||{names:{optional:!0}})]})}fromSchema(e){U(e,hb);const t=K(e,e,ht.schema({names:{saltPrimitive:Qn,saltConstructed:{names:{blockName:Qn}},iterationCount:xu,keyLength:Xt,prf:{names:{blockName:As,optional:!0}}}}));j.assertSchema(t,this.className),this.salt=t.result.salt,this.iterationCount=t.result.iterationCount.valueBlock.valueDec,Xt in t.result&&(this.keyLength=t.result.keyLength.valueBlock.valueDec),As in t.result&&(this.prf=new T({schema:t.result.prf}))}toSchema(){const e=[];return e.push(this.salt),e.push(new R({value:this.iterationCount})),Xt in this&&ht.defaultValues(Xt)!==this.keyLength&&e.push(new R({value:this.keyLength})),this.prf&&ht.defaultValues(As).isEqual(this.prf)===!1&&e.push(this.prf.toSchema()),new I({value:e})}toJSON(){const e={salt:this.salt.toJSON(),iterationCount:this.iterationCount};return Xt in this&&ht.defaultValues(Xt)!==this.keyLength&&(e.keyLength=this.keyLength),this.prf&&ht.defaultValues(As).isEqual(this.prf)===!1&&(e.prf=this.prf.toJSON()),e}}ht.CLASS_NAME="PBKDF2Params";const Iu="keyDerivationFunc",Vu="encryptionScheme",mb=[Iu,Vu];class Cn extends ${constructor(e={}){super(),this.keyDerivationFunc=y(e,Iu,Cn.defaultValues(Iu)),this.encryptionScheme=y(e,Vu,Cn.defaultValues(Vu)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Iu:return new T;case Vu:return new T;default:return super.defaultValues(e)}}static schema(e={}){const t=y(e,"names",{});return new I({name:t.blockName||N,value:[T.schema(t.keyDerivationFunc||{}),T.schema(t.encryptionScheme||{})]})}fromSchema(e){U(e,mb);const t=K(e,e,Cn.schema({names:{keyDerivationFunc:{names:{blockName:Iu}},encryptionScheme:{names:{blockName:Vu}}}}));j.assertSchema(t,this.className),this.keyDerivationFunc=new T({schema:t.result.keyDerivationFunc}),this.encryptionScheme=new T({schema:t.result.encryptionScheme})}toSchema(){return new I({value:[this.keyDerivationFunc.toSchema(),this.encryptionScheme.toSchema()]})}toJSON(){return{keyDerivationFunc:this.keyDerivationFunc.toJSON(),encryptionScheme:this.encryptionScheme.toJSON()}}}Cn.CLASS_NAME="PBES2Params";class fb{constructor(e){this.crypto=e.crypto,this.subtle="webkitSubtle"in e.crypto?e.crypto.webkitSubtle:e.crypto.subtle,this.name=y(e,"name",N)}async encrypt(...e){return this.subtle.encrypt(...e)}async decrypt(...e){return this.subtle.decrypt(...e)}sign(...e){return this.subtle.sign(...e)}async verify(...e){return this.subtle.verify(...e)}async digest(...e){return this.subtle.digest(...e)}async generateKey(...e){return this.subtle.generateKey(...e)}async deriveKey(...e){return this.subtle.deriveKey(...e)}async deriveBits(...e){return this.subtle.deriveBits(...e)}async wrapKey(...e){return this.subtle.wrapKey(...e)}async unwrapKey(...e){return this.subtle.unwrapKey(...e)}exportKey(...e){return this.subtle.exportKey(...e)}importKey(...e){return this.subtle.importKey(...e)}getRandomValues(e){return this.crypto.getRandomValues(e)}}async function tg(r,e,t,s,a){let u,c,i;switch(r.toUpperCase()){case"SHA-1":u=20,c=64,i=L0;break;case"SHA-256":u=32,c=64,i=U0;break;case"SHA-384":u=48,c=128,i=h1;break;case"SHA-512":u=64,c=128,i=c1;break;default:throw new Error("Unsupported hashing algorithm")}const o=new Uint8Array(t);let n=new TextDecoder().decode(t);new TextEncoder().encode(n).some((A,C)=>A!==o[C])&&(n=String.fromCharCode(...o));const l=new Uint8Array(n.length*2+2),m=new DataView(l.buffer);for(let A=0;A<n.length;A++)m.setUint16(A*2,n.charCodeAt(A),!1);m.setUint16(n.length*2,0,!1);const h=new Uint8Array(c).fill(3),g=new Uint8Array(s),p=new Uint8Array(c*Math.ceil(g.length/c)).map((A,C)=>g[C%g.length]),w=new Uint8Array(c*Math.ceil(l.length/c)).map((A,C)=>l[C%l.length]);let b=new Uint8Array(p.length+w.length);b.set(p),b.set(w,p.length);const d=Math.ceil((e>>3)/u),f=[];for(let A=0;A<d;A++){let C=new Uint8Array(h.length+b.length);C.set(h),C.set(b,h.length);for(let k=0;k<a;k++)C=i(C);const S=new Uint8Array(c).map((k,x)=>C[x%C.length]),v=Math.ceil(g.length/c)+Math.ceil(l.length/c),E=[];for(let k=0;k<v;k++){const x=Array.from(b.slice(k*c,(k+1)*c));let V=511;for(let O=S.length-1;O>=0;O--)V>>=8,V+=S[O]+(x[O]||0),x[O]=V&255;E.push(...x)}b=new Uint8Array(E),f.push(...C)}return new Uint8Array(f.slice(0,e>>3)).buffer}function Lw(r){const e=typeof r=="string"?{name:r}:r;return"hash"in e?ns(nt({},e),{hash:Lw(e.hash)}):e}class Zl extends fb{async importKey(e,t,s,a,u){var c,i,o,n,l,m;let h={};const g=Lw(s);switch(e.toLowerCase()){case"raw":return this.subtle.importKey("raw",t,s,a,u);case"spki":{const p=Re(ge.toArrayBuffer(t));j.assert(p,"keyData");const w=new Nt;try{w.fromSchema(p.result)}catch(b){throw new me("Incorrect keyData")}switch(g.name.toUpperCase()){case"RSA-PSS":{if(!g.hash)throw new ie("hash","algorithm.hash","Incorrect hash algorithm: Hash algorithm is missed");switch(g.hash.name.toUpperCase()){case"SHA-1":h.alg="PS1";break;case"SHA-256":h.alg="PS256";break;case"SHA-384":h.alg="PS384";break;case"SHA-512":h.alg="PS512";break;default:throw new Error("Incorrect hash algorithm: ".concat(g.hash.name.toUpperCase()))}}case"RSASSA-PKCS1-V1_5":{if(u=["verify"],h.kty="RSA",h.ext=a,h.key_ops=u,w.algorithm.algorithmId!=="1.2.840.113549.1.1.1")throw new Error("Incorrect public key algorithm: ".concat(w.algorithm.algorithmId));if(!h.alg){if(!g.hash)throw new ie("hash","algorithm.hash","Incorrect hash algorithm: Hash algorithm is missed");switch(g.hash.name.toUpperCase()){case"SHA-1":h.alg="RS1";break;case"SHA-256":h.alg="RS256";break;case"SHA-384":h.alg="RS384";break;case"SHA-512":h.alg="RS512";break;default:throw new Error("Incorrect hash algorithm: ".concat(g.hash.name.toUpperCase()))}}const b=w.toJSON();Object.assign(h,b)}break;case"ECDSA":u=["verify"];case"ECDH":{if(h={kty:"EC",ext:a,key_ops:u},w.algorithm.algorithmId!=="1.2.840.10045.2.1")throw new Error("Incorrect public key algorithm: ".concat(w.algorithm.algorithmId));const b=w.toJSON();Object.assign(h,b)}break;case"RSA-OAEP":{if(h.kty="RSA",h.ext=a,h.key_ops=u,this.name.toLowerCase()==="safari")h.alg="RSA-OAEP";else{if(!g.hash)throw new ie("hash","algorithm.hash","Incorrect hash algorithm: Hash algorithm is missed");switch(g.hash.name.toUpperCase()){case"SHA-1":h.alg="RSA-OAEP";break;case"SHA-256":h.alg="RSA-OAEP-256";break;case"SHA-384":h.alg="RSA-OAEP-384";break;case"SHA-512":h.alg="RSA-OAEP-512";break;default:throw new Error("Incorrect hash algorithm: ".concat(g.hash.name.toUpperCase()))}}const b=w.toJSON();Object.assign(h,b)}break;case"RSAES-PKCS1-V1_5":{h.kty="RSA",h.ext=a,h.key_ops=u,h.alg="PS1";const b=w.toJSON();Object.assign(h,b)}break;default:throw new Error("Incorrect algorithm name: ".concat(g.name.toUpperCase()))}}break;case"pkcs8":{const p=new Ht,w=Re(ge.toArrayBuffer(t));j.assert(w,"keyData");try{p.fromSchema(w.result)}catch(b){throw new Error("Incorrect keyData")}if(!p.parsedKey)throw new Error("Incorrect keyData");switch(g.name.toUpperCase()){case"RSA-PSS":switch((c=g.hash)===null||c===void 0?void 0:c.name.toUpperCase()){case"SHA-1":h.alg="PS1";break;case"SHA-256":h.alg="PS256";break;case"SHA-384":h.alg="PS384";break;case"SHA-512":h.alg="PS512";break;default:throw new Error("Incorrect hash algorithm: ".concat((i=g.hash)===null||i===void 0?void 0:i.name.toUpperCase()))}case"RSASSA-PKCS1-V1_5":{if(u=["sign"],h.kty="RSA",h.ext=a,h.key_ops=u,p.privateKeyAlgorithm.algorithmId!=="1.2.840.113549.1.1.1")throw new Error("Incorrect private key algorithm: ".concat(p.privateKeyAlgorithm.algorithmId));if(!("alg"in h))switch((o=g.hash)===null||o===void 0?void 0:o.name.toUpperCase()){case"SHA-1":h.alg="RS1";break;case"SHA-256":h.alg="RS256";break;case"SHA-384":h.alg="RS384";break;case"SHA-512":h.alg="RS512";break;default:throw new Error("Incorrect hash algorithm: ".concat((n=g.hash)===null||n===void 0?void 0:n.name.toUpperCase()))}const b=p.toJSON();Object.assign(h,b)}break;case"ECDSA":u=["sign"];case"ECDH":{if(h={kty:"EC",ext:a,key_ops:u},p.privateKeyAlgorithm.algorithmId!=="1.2.840.10045.2.1")throw new Error("Incorrect algorithm: ".concat(p.privateKeyAlgorithm.algorithmId));const b=p.toJSON();Object.assign(h,b)}break;case"RSA-OAEP":{if(h.kty="RSA",h.ext=a,h.key_ops=u,this.name.toLowerCase()==="safari")h.alg="RSA-OAEP";else switch((l=g.hash)===null||l===void 0?void 0:l.name.toUpperCase()){case"SHA-1":h.alg="RSA-OAEP";break;case"SHA-256":h.alg="RSA-OAEP-256";break;case"SHA-384":h.alg="RSA-OAEP-384";break;case"SHA-512":h.alg="RSA-OAEP-512";break;default:throw new Error("Incorrect hash algorithm: ".concat((m=g.hash)===null||m===void 0?void 0:m.name.toUpperCase()))}const b=p.toJSON();Object.assign(h,b)}break;case"RSAES-PKCS1-V1_5":{u=["decrypt"],h.kty="RSA",h.ext=a,h.key_ops=u,h.alg="PS1";const b=p.toJSON();Object.assign(h,b)}break;default:throw new Error("Incorrect algorithm name: ".concat(g.name.toUpperCase()))}}break;case"jwk":h=t;break;default:throw new Error("Incorrect format: ".concat(e))}if(this.name.toLowerCase()==="safari")try{return this.subtle.importKey("jwk",bo(JSON.stringify(h)),s,a,u)}catch(p){return this.subtle.importKey("jwk",h,s,a,u)}return this.subtle.importKey("jwk",h,s,a,u)}async exportKey(e,t){let s=await this.subtle.exportKey("jwk",t);switch(this.name.toLowerCase()==="safari"&&s instanceof ArrayBuffer&&(s=JSON.parse(yh(s))),e.toLowerCase()){case"raw":return this.subtle.exportKey("raw",t);case"spki":{const a=new Nt;try{a.fromJSON(s)}catch(u){throw new Error("Incorrect key data")}return a.toSchema().toBER(!1)}case"pkcs8":{const a=new Ht;try{a.fromJSON(s)}catch(u){throw new Error("Incorrect key data")}return a.toSchema().toBER(!1)}case"jwk":return s;default:throw new Error("Incorrect format: ".concat(e))}}async convert(e,t,s,a,u,c){if(e.toLowerCase()===t.toLowerCase())return s;const i=await this.importKey(e,s,a,u,c);return this.exportKey(t,i)}getAlgorithmByOID(e,t=!1,s){switch(e){case"1.2.840.113549.1.1.1":return{name:"RSAES-PKCS1-v1_5"};case"1.2.840.113549.1.1.5":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-1"}};case"1.2.840.113549.1.1.11":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"1.2.840.113549.1.1.12":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-384"}};case"1.2.840.113549.1.1.13":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-512"}};case"1.2.840.113549.1.1.10":return{name:"RSA-PSS"};case"1.2.840.113549.1.1.7":return{name:"RSA-OAEP"};case"1.2.840.10045.2.1":case"1.2.840.10045.4.1":return{name:"ECDSA",hash:{name:"SHA-1"}};case"1.2.840.10045.4.3.2":return{name:"ECDSA",hash:{name:"SHA-256"}};case"1.2.840.10045.4.3.3":return{name:"ECDSA",hash:{name:"SHA-384"}};case"1.2.840.10045.4.3.4":return{name:"ECDSA",hash:{name:"SHA-512"}};case"1.3.133.16.840.63.0.2":return{name:"ECDH",kdf:"SHA-1"};case"1.3.132.1.11.1":return{name:"ECDH",kdf:"SHA-256"};case"1.3.132.1.11.2":return{name:"ECDH",kdf:"SHA-384"};case"1.3.132.1.11.3":return{name:"ECDH",kdf:"SHA-512"};case"2.16.840.1.101.3.4.1.2":return{name:"AES-CBC",length:128};case"2.16.840.1.101.3.4.1.22":return{name:"AES-CBC",length:192};case"2.16.840.1.101.3.4.1.42":return{name:"AES-CBC",length:256};case"2.16.840.1.101.3.4.1.6":return{name:"AES-GCM",length:128};case"2.16.840.1.101.3.4.1.26":return{name:"AES-GCM",length:192};case"2.16.840.1.101.3.4.1.46":return{name:"AES-GCM",length:256};case"2.16.840.1.101.3.4.1.4":return{name:"AES-CFB",length:128};case"2.16.840.1.101.3.4.1.24":return{name:"AES-CFB",length:192};case"2.16.840.1.101.3.4.1.44":return{name:"AES-CFB",length:256};case"2.16.840.1.101.3.4.1.5":return{name:"AES-KW",length:128};case"2.16.840.1.101.3.4.1.25":return{name:"AES-KW",length:192};case"2.16.840.1.101.3.4.1.45":return{name:"AES-KW",length:256};case"1.2.840.113549.2.7":return{name:"HMAC",hash:{name:"SHA-1"}};case"1.2.840.113549.2.9":return{name:"HMAC",hash:{name:"SHA-256"}};case"1.2.840.113549.2.10":return{name:"HMAC",hash:{name:"SHA-384"}};case"1.2.840.113549.2.11":return{name:"HMAC",hash:{name:"SHA-512"}};case"1.2.840.113549.1.9.16.3.5":return{name:"DH"};case"1.3.14.3.2.26":return{name:"SHA-1"};case"2.16.840.1.101.3.4.2.1":return{name:"SHA-256"};case"2.16.840.1.101.3.4.2.2":return{name:"SHA-384"};case"2.16.840.1.101.3.4.2.3":return{name:"SHA-512"};case"1.2.840.113549.1.5.12":return{name:"PBKDF2"};case"1.2.840.10045.3.1.7":return{name:"P-256"};case"1.3.132.0.34":return{name:"P-384"};case"1.3.132.0.35":return{name:"P-521"}}if(t)throw new Error("Unsupported algorithm identifier ".concat(s?"for ".concat(s," "):N,": ").concat(e));return{}}getOIDByAlgorithm(e,t=!1,s){let a=N;switch(e.name.toUpperCase()){case"RSAES-PKCS1-V1_5":a="1.2.840.113549.1.1.1";break;case"RSASSA-PKCS1-V1_5":switch(e.hash.name.toUpperCase()){case"SHA-1":a="1.2.840.113549.1.1.5";break;case"SHA-256":a="1.2.840.113549.1.1.11";break;case"SHA-384":a="1.2.840.113549.1.1.12";break;case"SHA-512":a="1.2.840.113549.1.1.13";break}break;case"RSA-PSS":a="1.2.840.113549.1.1.10";break;case"RSA-OAEP":a="1.2.840.113549.1.1.7";break;case"ECDSA":switch(e.hash.name.toUpperCase()){case"SHA-1":a="1.2.840.10045.4.1";break;case"SHA-256":a="1.2.840.10045.4.3.2";break;case"SHA-384":a="1.2.840.10045.4.3.3";break;case"SHA-512":a="1.2.840.10045.4.3.4";break}break;case"ECDH":switch(e.kdf.toUpperCase()){case"SHA-1":a="1.3.133.16.840.63.0.2";break;case"SHA-256":a="1.3.132.1.11.1";break;case"SHA-384":a="1.3.132.1.11.2";break;case"SHA-512":a="1.3.132.1.11.3";break}break;case"AES-CTR":break;case"AES-CBC":switch(e.length){case 128:a="2.16.840.1.101.3.4.1.2";break;case 192:a="2.16.840.1.101.3.4.1.22";break;case 256:a="2.16.840.1.101.3.4.1.42";break}break;case"AES-CMAC":break;case"AES-GCM":switch(e.length){case 128:a="2.16.840.1.101.3.4.1.6";break;case 192:a="2.16.840.1.101.3.4.1.26";break;case 256:a="2.16.840.1.101.3.4.1.46";break}break;case"AES-CFB":switch(e.length){case 128:a="2.16.840.1.101.3.4.1.4";break;case 192:a="2.16.840.1.101.3.4.1.24";break;case 256:a="2.16.840.1.101.3.4.1.44";break}break;case"AES-KW":switch(e.length){case 128:a="2.16.840.1.101.3.4.1.5";break;case 192:a="2.16.840.1.101.3.4.1.25";break;case 256:a="2.16.840.1.101.3.4.1.45";break}break;case"HMAC":switch(e.hash.name.toUpperCase()){case"SHA-1":a="1.2.840.113549.2.7";break;case"SHA-256":a="1.2.840.113549.2.9";break;case"SHA-384":a="1.2.840.113549.2.10";break;case"SHA-512":a="1.2.840.113549.2.11";break}break;case"DH":a="1.2.840.113549.1.9.16.3.5";break;case"SHA-1":a="1.3.14.3.2.26";break;case"SHA-256":a="2.16.840.1.101.3.4.2.1";break;case"SHA-384":a="2.16.840.1.101.3.4.2.2";break;case"SHA-512":a="2.16.840.1.101.3.4.2.3";break;case"CONCAT":break;case"HKDF":break;case"PBKDF2":a="1.2.840.113549.1.5.12";break;case"P-256":a="1.2.840.10045.3.1.7";break;case"P-384":a="1.3.132.0.34";break;case"P-521":a="1.3.132.0.35";break}if(!a&&t)throw new Error("Unsupported algorithm ".concat(s?"for ".concat(s," "):N,": ").concat(e.name));return a}getAlgorithmParameters(e,t){let s={algorithm:{},usages:[]};switch(e.toUpperCase()){case"RSAES-PKCS1-V1_5":case"RSASSA-PKCS1-V1_5":switch(t.toLowerCase()){case"generatekey":s={algorithm:{name:"RSASSA-PKCS1-v1_5",modulusLength:2048,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},usages:["sign","verify"]};break;case"verify":case"sign":case"importkey":s={algorithm:{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},usages:["verify"]};break;case"exportkey":default:return{algorithm:{name:"RSASSA-PKCS1-v1_5"},usages:[]}}break;case"RSA-PSS":switch(t.toLowerCase()){case"sign":case"verify":s={algorithm:{name:"RSA-PSS",hash:{name:"SHA-1"},saltLength:20},usages:["sign","verify"]};break;case"generatekey":s={algorithm:{name:"RSA-PSS",modulusLength:2048,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-1"}},usages:["sign","verify"]};break;case"importkey":s={algorithm:{name:"RSA-PSS",hash:{name:"SHA-1"}},usages:["verify"]};break;case"exportkey":default:return{algorithm:{name:"RSA-PSS"},usages:[]}}break;case"RSA-OAEP":switch(t.toLowerCase()){case"encrypt":case"decrypt":s={algorithm:{name:"RSA-OAEP"},usages:["encrypt","decrypt"]};break;case"generatekey":s={algorithm:{name:"RSA-OAEP",modulusLength:2048,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},usages:["encrypt","decrypt","wrapKey","unwrapKey"]};break;case"importkey":s={algorithm:{name:"RSA-OAEP",hash:{name:"SHA-256"}},usages:["encrypt"]};break;case"exportkey":default:return{algorithm:{name:"RSA-OAEP"},usages:[]}}break;case"ECDSA":switch(t.toLowerCase()){case"generatekey":s={algorithm:{name:"ECDSA",namedCurve:"P-256"},usages:["sign","verify"]};break;case"importkey":s={algorithm:{name:"ECDSA",namedCurve:"P-256"},usages:["verify"]};break;case"verify":case"sign":s={algorithm:{name:"ECDSA",hash:{name:"SHA-256"}},usages:["sign"]};break;default:return{algorithm:{name:"ECDSA"},usages:[]}}break;case"ECDH":switch(t.toLowerCase()){case"exportkey":case"importkey":case"generatekey":s={algorithm:{name:"ECDH",namedCurve:"P-256"},usages:["deriveKey","deriveBits"]};break;case"derivekey":case"derivebits":s={algorithm:{name:"ECDH",namedCurve:"P-256",public:[]},usages:["encrypt","decrypt"]};break;default:return{algorithm:{name:"ECDH"},usages:[]}}break;case"AES-CTR":switch(t.toLowerCase()){case"importkey":case"exportkey":case"generatekey":s={algorithm:{name:"AES-CTR",length:256},usages:["encrypt","decrypt","wrapKey","unwrapKey"]};break;case"decrypt":case"encrypt":s={algorithm:{name:"AES-CTR",counter:new Uint8Array(16),length:10},usages:["encrypt","decrypt","wrapKey","unwrapKey"]};break;default:return{algorithm:{name:"AES-CTR"},usages:[]}}break;case"AES-CBC":switch(t.toLowerCase()){case"importkey":case"exportkey":case"generatekey":s={algorithm:{name:"AES-CBC",length:256},usages:["encrypt","decrypt","wrapKey","unwrapKey"]};break;case"decrypt":case"encrypt":s={algorithm:{name:"AES-CBC",iv:this.getRandomValues(new Uint8Array(16))},usages:["encrypt","decrypt","wrapKey","unwrapKey"]};break;default:return{algorithm:{name:"AES-CBC"},usages:[]}}break;case"AES-GCM":switch(t.toLowerCase()){case"importkey":case"exportkey":case"generatekey":s={algorithm:{name:"AES-GCM",length:256},usages:["encrypt","decrypt","wrapKey","unwrapKey"]};break;case"decrypt":case"encrypt":s={algorithm:{name:"AES-GCM",iv:this.getRandomValues(new Uint8Array(16))},usages:["encrypt","decrypt","wrapKey","unwrapKey"]};break;default:return{algorithm:{name:"AES-GCM"},usages:[]}}break;case"AES-KW":switch(t.toLowerCase()){case"importkey":case"exportkey":case"generatekey":case"wrapkey":case"unwrapkey":s={algorithm:{name:"AES-KW",length:256},usages:["wrapKey","unwrapKey"]};break;default:return{algorithm:{name:"AES-KW"},usages:[]}}break;case"HMAC":switch(t.toLowerCase()){case"sign":case"verify":s={algorithm:{name:"HMAC"},usages:["sign","verify"]};break;case"importkey":case"exportkey":case"generatekey":s={algorithm:{name:"HMAC",length:32,hash:{name:"SHA-256"}},usages:["sign","verify"]};break;default:return{algorithm:{name:"HMAC"},usages:[]}}break;case"HKDF":switch(t.toLowerCase()){case"derivekey":s={algorithm:{name:"HKDF",hash:"SHA-256",salt:new Uint8Array([]),info:new Uint8Array([])},usages:["encrypt","decrypt"]};break;default:return{algorithm:{name:"HKDF"},usages:[]}}break;case"PBKDF2":switch(t.toLowerCase()){case"derivekey":s={algorithm:{name:"PBKDF2",hash:{name:"SHA-256"},salt:new Uint8Array([]),iterations:1e4},usages:["encrypt","decrypt"]};break;default:return{algorithm:{name:"PBKDF2"},usages:[]}}break}return s}getHashAlgorithm(e){let t=N;switch(e.algorithmId){case"1.2.840.10045.4.1":case"1.2.840.113549.1.1.5":t="SHA-1";break;case"1.2.840.10045.4.3.2":case"1.2.840.113549.1.1.11":t="SHA-256";break;case"1.2.840.10045.4.3.3":case"1.2.840.113549.1.1.12":t="SHA-384";break;case"1.2.840.10045.4.3.4":case"1.2.840.113549.1.1.13":t="SHA-512";break;case"1.2.840.113549.1.1.10":try{const s=new et({schema:e.algorithmParams});if(s.hashAlgorithm){const a=this.getAlgorithmByOID(s.hashAlgorithm.algorithmId);if("name"in a)t=a.name;else return N}else t="SHA-1"}catch(s){}break}return t}async encryptEncryptedContentInfo(e){ie.assert(e,"password","contentEncryptionAlgorithm","hmacHashAlgorithm","iterationCount","contentToEncrypt","contentToEncrypt","contentType");const t=this.getOIDByAlgorithm(e.contentEncryptionAlgorithm,!0,"contentEncryptionAlgorithm"),s=this.getOIDByAlgorithm({name:"PBKDF2"},!0,"PBKDF2"),a=this.getOIDByAlgorithm({name:"HMAC",hash:{name:e.hmacHashAlgorithm}},!0,"hmacHashAlgorithm"),u=new ArrayBuffer(16),c=new Uint8Array(u);this.getRandomValues(c);const i=new ArrayBuffer(64),o=new Uint8Array(i);this.getRandomValues(o);const n=new Uint8Array(e.contentToEncrypt),l=new ht({salt:new M({valueHex:i}),iterationCount:e.iterationCount,prf:new T({algorithmId:a,algorithmParams:new Me})}),m=new Uint8Array(e.password),h=await this.importKey("raw",m,"PBKDF2",!1,["deriveKey"]),g=await this.deriveKey({name:"PBKDF2",hash:{name:e.hmacHashAlgorithm},salt:o,iterations:e.iterationCount},h,e.contentEncryptionAlgorithm,!1,["encrypt"]),p=await this.encrypt({name:e.contentEncryptionAlgorithm.name,iv:c},g,n),w=new Cn({keyDerivationFunc:new T({algorithmId:s,algorithmParams:l.toSchema()}),encryptionScheme:new T({algorithmId:t,algorithmParams:new M({valueHex:u})})});return new Oe({contentType:e.contentType,contentEncryptionAlgorithm:new T({algorithmId:"1.2.840.113549.1.5.13",algorithmParams:w.toSchema()}),encryptedContent:new M({valueHex:p})})}async decryptEncryptedContentInfo(e){if(ie.assert(e,"password","encryptedContentInfo"),e.encryptedContentInfo.contentEncryptionAlgorithm.algorithmId!=="1.2.840.113549.1.5.13")throw new Error('Unknown "contentEncryptionAlgorithm": '.concat(e.encryptedContentInfo.contentEncryptionAlgorithm.algorithmId));let t;try{t=new Cn({schema:e.encryptedContentInfo.contentEncryptionAlgorithm.algorithmParams})}catch(p){throw new Error('Incorrectly encoded "pbes2Parameters"')}let s;try{s=new ht({schema:t.keyDerivationFunc.algorithmParams})}catch(p){throw new Error('Incorrectly encoded "pbkdf2Params"')}const a=this.getAlgorithmByOID(t.encryptionScheme.algorithmId,!0),u=t.encryptionScheme.algorithmParams.valueBlock.valueHex,c=new Uint8Array(u),i=s.salt.valueBlock.valueHex,o=new Uint8Array(i),n=s.iterationCount;let l="SHA-1";s.prf&&(l=this.getAlgorithmByOID(s.prf.algorithmId,!0).hash.name);const m=await this.importKey("raw",e.password,"PBKDF2",!1,["deriveKey"]),h=await this.deriveKey({name:"PBKDF2",hash:{name:l},salt:o,iterations:n},m,a,!1,["decrypt"]),g=e.encryptedContentInfo.getEncryptedContent();return this.decrypt({name:a.name,iv:c},h,g)}async stampDataWithPassword(e){if(!(e instanceof Object))throw new Error('Parameters must have type "Object"');ie.assert(e,"password","hashAlgorithm","iterationCount","salt","contentToStamp");let t;switch(e.hashAlgorithm.toLowerCase()){case"sha-1":t=160;break;case"sha-256":t=256;break;case"sha-384":t=384;break;case"sha-512":t=512;break;default:throw new Error('Incorrect "parameters.hashAlgorithm" parameter: '.concat(e.hashAlgorithm))}const s={name:"HMAC",length:t,hash:{name:e.hashAlgorithm}},a=await tg(e.hashAlgorithm,t,e.password,e.salt,e.iterationCount),u=await this.importKey("raw",new Uint8Array(a),s,!1,["sign"]);return this.sign(s,u,new Uint8Array(e.contentToStamp))}async verifyDataStampedWithPassword(e){ie.assert(e,"password","hashAlgorithm","salt","iterationCount","contentToVerify","signatureToVerify");let t=0;switch(e.hashAlgorithm.toLowerCase()){case"sha-1":t=160;break;case"sha-256":t=256;break;case"sha-384":t=384;break;case"sha-512":t=512;break;default:throw new Error('Incorrect "parameters.hashAlgorithm" parameter: '.concat(e.hashAlgorithm))}const s={name:"HMAC",length:t,hash:{name:e.hashAlgorithm}},a=await tg(e.hashAlgorithm,t,e.password,e.salt,e.iterationCount),u=await this.importKey("raw",new Uint8Array(a),s,!1,["verify"]);return this.verify(s,u,new Uint8Array(e.signatureToVerify),new Uint8Array(e.contentToVerify))}async getSignatureParameters(e,t="SHA-1"){this.getOIDByAlgorithm({name:t},!0,"hashAlgorithm");const s=new T,a=this.getAlgorithmParameters(e.algorithm.name,"sign");if(!Object.keys(a.algorithm).length)throw new Error("Parameter 'algorithm' is empty");const u=a.algorithm;switch("hash"in e.algorithm&&e.algorithm.hash&&e.algorithm.hash.name?u.hash.name=e.algorithm.hash.name:u.hash.name=t,e.algorithm.name.toUpperCase()){case"RSASSA-PKCS1-V1_5":case"ECDSA":s.algorithmId=this.getOIDByAlgorithm(u,!0);break;case"RSA-PSS":{switch(u.hash.name.toUpperCase()){case"SHA-256":u.saltLength=32;break;case"SHA-384":u.saltLength=48;break;case"SHA-512":u.saltLength=64;break}const c={};if(u.hash.name.toUpperCase()!=="SHA-1"){const o=this.getOIDByAlgorithm({name:u.hash.name},!0,"hashAlgorithm");c.hashAlgorithm=new T({algorithmId:o,algorithmParams:new Me}),c.maskGenAlgorithm=new T({algorithmId:"1.2.840.113549.1.1.8",algorithmParams:c.hashAlgorithm.toSchema()})}u.saltLength!==20&&(c.saltLength=u.saltLength);const i=new et(c);s.algorithmId="1.2.840.113549.1.1.10",s.algorithmParams=i.toSchema()}break;default:throw new Error("Unsupported signature algorithm: ".concat(e.algorithm.name))}return{signatureAlgorithm:s,parameters:a}}async signWithPrivateKey(e,t,s){const a=await this.sign(s.algorithm,t,e);return s.algorithm.name==="ECDSA"?db(a):a}fillPublicKeyParameters(e,t){const s={},a=this.getHashAlgorithm(t);if(a===N)throw new Error("Unsupported signature algorithm: ".concat(t.algorithmId));let u;t.algorithmId==="1.2.840.113549.1.1.10"?u=t.algorithmId:u=e.algorithm.algorithmId;const c=this.getAlgorithmByOID(u,!0);if(s.algorithm=this.getAlgorithmParameters(c.name,"importKey"),"hash"in s.algorithm.algorithm&&(s.algorithm.algorithm.hash.name=a),c.name==="ECDSA"){const i=e.algorithm;if(!i.algorithmParams)throw new Error("Algorithm parameters for ECDSA public key are missed");const o=i.algorithmParams;if("idBlock"in i.algorithmParams&&!(o.idBlock.tagClass===1&&o.idBlock.tagNumber===6))throw new Error("Incorrect type for ECDSA public key parameters");const n=this.getAlgorithmByOID(o.valueBlock.toString(),!0);s.algorithm.algorithm.namedCurve=n.name}return s}async getPublicKey(e,t,s){s||(s=this.fillPublicKeyParameters(e,t));const a=e.toSchema().toBER(!1);return this.importKey("spki",a,s.algorithm.algorithm,!0,s.algorithm.usages)}async verifyWithPublicKey(e,t,s,a,u){let c;if(u){const n={};let l;a.algorithmId==="1.2.840.113549.1.1.10"?l=a.algorithmId:l=s.algorithm.algorithmId;const m=this.getAlgorithmByOID(l,!0);if(n.algorithm=this.getAlgorithmParameters(m.name,"importKey"),"hash"in n.algorithm.algorithm&&(n.algorithm.algorithm.hash.name=u),m.name==="ECDSA"){let h=!1;if("algorithmParams"in s.algorithm&&"idBlock"in s.algorithm.algorithmParams&&s.algorithm.algorithmParams.idBlock.tagClass===1&&s.algorithm.algorithmParams.idBlock.tagNumber===6&&(h=!0),h===!1)throw new Error("Incorrect type for ECDSA public key parameters");const g=this.getAlgorithmByOID(s.algorithm.algorithmParams.valueBlock.toString(),!0);n.algorithm.algorithm.namedCurve=g.name}c=await this.getPublicKey(s,null,n)}else{if(u=this.getHashAlgorithm(a),!u)throw new Error("Unsupported signature algorithm: ".concat(a.algorithmId));c=await this.getPublicKey(s,a)}const i=this.getAlgorithmParameters(c.algorithm.name,"verify");"hash"in i.algorithm&&(i.algorithm.hash.name=u);let o=t.valueBlock.valueHexView;if(c.algorithm.name==="ECDSA"){const n=Zr.find(c.algorithm.namedCurve);if(!n)throw new Error("Unsupported named curve in use");const l=Re(o);j.assert(l,"Signature value"),o=gb(l.result,n.size)}if(c.algorithm.name==="RSA-PSS"){const n=new et({schema:a.algorithmParams});"saltLength"in n?i.algorithm.saltLength=n.saltLength:i.algorithm.saltLength=20;let l="SHA-1";"hashAlgorithm"in n&&(l=this.getAlgorithmByOID(n.hashAlgorithm.algorithmId,!0).name),i.algorithm.hash.name=l}return this.verify(i.algorithm,c,o,e)}}let jw={name:"none",crypto:null};function sg(r){return!!(r&&typeof r=="object"&&"crypto"in r)}function rg(r,...e){let t=null;if(e.length<2)e.length?t=e[0]:t=typeof self<"u"&&self.crypto?new Zl({name:"browser",crypto:self.crypto}):null;else{const s=e[0],a=e[1];sg(a)?t=a:sg(s)?t=s:"subtle"in s&&"getRandomValues"in s&&(t=new Zl({crypto:s}))}if(typeof We<"u"&&"pid"in We&&typeof Ct<"u"&&typeof window>"u"){if(typeof Ct[We.pid]>"u")Ct[We.pid]={};else if(typeof Ct[We.pid]!="object")throw new Error("Name global.".concat(We.pid," already exists and it is not an object"));if(typeof Ct[We.pid].pkijs>"u")Ct[We.pid].pkijs={};else if(typeof Ct[We.pid].pkijs!="object")throw new Error("Name global.".concat(We.pid,".pkijs already exists and it is not an object"));Ct[We.pid].pkijs.engine={name:r,crypto:t}}else jw={name:r,crypto:t}}function pb(){if(typeof We<"u"&&"pid"in We&&typeof Ct<"u"&&typeof window>"u"){let r;try{r=Ct[We.pid].pkijs.engine}catch(e){throw new Error("Please call 'setEngine' before call to 'getEngine'")}return r}return jw}function te(r=!1){const e=pb();if(!e.crypto&&r)throw new Error("Unable to create WebCrypto object");return e.crypto}function db(r){if(r.byteLength%2!==0)return Le;const e=r.byteLength/2,t=new ArrayBuffer(e);new Uint8Array(t).set(new Uint8Array(r,0,e));const s=new R({valueHex:t}),a=new ArrayBuffer(e);new Uint8Array(a).set(new Uint8Array(r,e,e));const u=new R({valueHex:a});return new I({value:[s.convertToDER(),u.convertToDER()]}).toBER(!1)}function gb(r,e){if(!(r instanceof I&&r.valueBlock.value.length===2&&r.valueBlock.value[0]instanceof R&&r.valueBlock.value[1]instanceof R))return Le;const t=r.valueBlock.value[0].convertFromDER().valueBlock.valueHexView,s=r.valueBlock.value[1].convertFromDER().valueBlock.valueHexView,a=new Uint8Array(e*2);return a.set(t,e-t.byteLength),a.set(s,2*e-s.byteLength),a.buffer}async function wb(r,e,t,s,a){switch(r.toUpperCase()){case"SHA-1":case"SHA-256":case"SHA-384":case"SHA-512":break;default:throw new me("Unknown hash function: ".concat(r))}if(me.assert(e,"zBuffer","ArrayBuffer"),e.byteLength===0)throw new me("'zBuffer' has zero length, error");if(me.assert(s,"SharedInfo","ArrayBuffer"),t>255)throw new me("Please set 'Counter' argument to value less or equal to 255");const u=new ArrayBuffer(4),c=new Uint8Array(u);c[0]=0,c[1]=0,c[2]=0,c[3]=t;let i=Le;i=ho(i,e),i=ho(i,u),i=ho(i,s);const o=await a.digest({name:r},i);return{counter:t,result:o}}async function ag(r,e,t,s,a=te(!0)){let u=0,c=1;switch(r.toUpperCase()){case"SHA-1":u=160;break;case"SHA-256":u=256;break;case"SHA-384":u=384;break;case"SHA-512":u=512;break;default:throw new me("Unknown hash function: ".concat(r))}if(me.assert(e,"Zbuffer","ArrayBuffer"),e.byteLength===0)throw new me("'Zbuffer' has zero length, error");me.assert(s,"SharedInfo","ArrayBuffer");const i=t/u;Math.floor(i)>0&&(c=Math.floor(i),i-c>0&&c++);const o=[];for(let h=1;h<=c;h++)o.push(await wb(r,e,h,s,a));let n=Le,l=1,m=!0;for(;m;){m=!1;for(const h of o)if(h.counter===l){n=ho(n,h.result),m=!0;break}l++}if(t>>=3,n.byteLength>t){const h=new ArrayBuffer(t),g=new Uint8Array(h),p=new Uint8Array(n);for(let w=0;w<t;w++)g[w]=p[w];return h}return n}const Fm="version",Jm="logID",qm="extensions",Wm="timestamp",Gm="hashAlgorithm",_m="signatureAlgorithm",Xm="signature",ng="none",ig="md5",og="sha1",ug="sha224",lg="sha256",cg="sha384",hg="sha512",mg="anonymous",fg="rsa",pg="dsa",dg="ecdsa";class us extends ${constructor(e={}){super(),this.version=y(e,Fm,us.defaultValues(Fm)),this.logID=y(e,Jm,us.defaultValues(Jm)),this.timestamp=y(e,Wm,us.defaultValues(Wm)),this.extensions=y(e,qm,us.defaultValues(qm)),this.hashAlgorithm=y(e,Gm,us.defaultValues(Gm)),this.signatureAlgorithm=y(e,_m,us.defaultValues(_m)),this.signature=y(e,Xm,us.defaultValues(Xm)),"stream"in e&&e.stream&&this.fromStream(e.stream),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Fm:return 0;case Jm:case qm:return Le;case Wm:return new Date(0);case Gm:case _m:return N;case Xm:return new Z;default:return super.defaultValues(e)}}fromSchema(e){if(!(e instanceof vh))throw new Error("Object's schema was not verified against input data for SignedCertificateTimestamp");const t=new Yr({stream:new Ae({buffer:e.data})});this.fromStream(t)}fromStream(e){const t=e.getUint16();if(this.version=e.getBlock(1)[0],this.version===0){this.logID=new Uint8Array(e.getBlock(32)).buffer.slice(0),this.timestamp=new Date(hy(new Uint8Array(e.getBlock(8)),8));const s=e.getUint16();switch(this.extensions=new Uint8Array(e.getBlock(s)).buffer.slice(0),e.getBlock(1)[0]){case 0:this.hashAlgorithm=ng;break;case 1:this.hashAlgorithm=ig;break;case 2:this.hashAlgorithm=og;break;case 3:this.hashAlgorithm=ug;break;case 4:this.hashAlgorithm=lg;break;case 5:this.hashAlgorithm=cg;break;case 6:this.hashAlgorithm=hg;break;default:throw new Error("Object's stream was not correct for SignedCertificateTimestamp")}switch(e.getBlock(1)[0]){case 0:this.signatureAlgorithm=mg;break;case 1:this.signatureAlgorithm=fg;break;case 2:this.signatureAlgorithm=pg;break;case 3:this.signatureAlgorithm=dg;break;default:throw new Error("Object's stream was not correct for SignedCertificateTimestamp")}const a=e.getUint16(),u=new Uint8Array(e.getBlock(a)).buffer.slice(0),c=Re(u);if(j.assert(c,"SignedCertificateTimestamp"),this.signature=c.result,t!==47+s+a)throw new Error("Object's stream was not correct for SignedCertificateTimestamp")}}toSchema(){const e=this.toStream();return new vh({data:e.stream.buffer})}toStream(){const e=new Yr;e.appendUint16(47+this.extensions.byteLength+this.signature.valueBeforeDecodeView.byteLength),e.appendChar(this.version),e.appendView(new Uint8Array(this.logID));const t=new ArrayBuffer(8),s=new Uint8Array(t),a=Up(this.timestamp.valueOf(),8);s.set(new Uint8Array(a),8-a.byteLength),e.appendView(s),e.appendUint16(this.extensions.byteLength),this.extensions.byteLength&&e.appendView(new Uint8Array(this.extensions));let u;switch(this.hashAlgorithm.toLowerCase()){case ng:u=0;break;case ig:u=1;break;case og:u=2;break;case ug:u=3;break;case lg:u=4;break;case cg:u=5;break;case hg:u=6;break;default:throw new Error("Incorrect data for hashAlgorithm: ".concat(this.hashAlgorithm))}e.appendChar(u);let c;switch(this.signatureAlgorithm.toLowerCase()){case mg:c=0;break;case fg:c=1;break;case pg:c=2;break;case dg:c=3;break;default:throw new Error("Incorrect data for signatureAlgorithm: ".concat(this.signatureAlgorithm))}e.appendChar(c);const i=this.signature.toBER(!1);return e.appendUint16(i.byteLength),e.appendView(new Uint8Array(i)),e}toJSON(){return{version:this.version,logID:Kp(this.logID),timestamp:this.timestamp,extensions:Kp(this.extensions),hashAlgorithm:this.hashAlgorithm,signatureAlgorithm:this.signatureAlgorithm,signature:this.signature.toJSON()}}async verify(e,t,s=0,a=te(!0)){const u=bf(yh(this.logID));let c=null;const i=new Yr;for(const g of e)if(g.log_id===u){c=g.key;break}if(!c)throw new Error("Public key not found for CT with logId: ".concat(u));const o=bo(ql(c)),n=Nt.fromBER(o);i.appendChar(0),i.appendChar(0);const l=new ArrayBuffer(8),m=new Uint8Array(l),h=Up(this.timestamp.valueOf(),8);return m.set(new Uint8Array(h),8-h.byteLength),i.appendView(m),i.appendUint16(s),s===0&&i.appendUint24(t.byteLength),i.appendView(new Uint8Array(t)),i.appendUint16(this.extensions.byteLength),this.extensions.byteLength!==0&&i.appendView(new Uint8Array(this.extensions)),a.verifyWithPublicKey(i.buffer.slice(0,i.length),new M({valueHex:this.signature.toBER(!1)}),n,{algorithmId:N},"SHA-256")}}us.CLASS_NAME="SignedCertificateTimestamp";const wc="timestamps";class qh extends ${constructor(e={}){super(),this.timestamps=y(e,wc,qh.defaultValues(wc)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case wc:return[];default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case wc:return t.length===0;default:return super.defaultValues(e)}}static schema(e={}){var t;const s=y(e,"names",{});return(t=s.optional)!==null&&t!==void 0||(s.optional=!1),new M({name:s.blockName||"SignedCertificateTimestampList",optional:s.optional})}fromSchema(e){if(!(e instanceof M))throw new Error("Object's schema was not verified against input data for SignedCertificateTimestampList");const t=new Yr({stream:new Ae({buffer:e.valueBlock.valueHex})});if(t.getUint16()!==t.length)throw new Error("Object's schema was not verified against input data for SignedCertificateTimestampList");for(;t.length;)this.timestamps.push(new us({stream:t}))}toSchema(){const e=new Yr;let t=0;const s=[];for(const a of this.timestamps){const u=a.toStream();s.push(u),t+=u.stream.buffer.byteLength}e.appendUint16(t);for(const a of s)e.appendView(a.stream.view);return new M({valueHex:e.stream.buffer.slice(0)})}toJSON(){return{timestamps:Array.from(this.timestamps,e=>e.toJSON())}}}qh.CLASS_NAME="SignedCertificateTimestampList";const Pu="attributes",yb=[Pu];class ec extends ${constructor(e={}){super(),this.attributes=y(e,Pu,ec.defaultValues(Pu)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Pu:return[];default:return super.defaultValues(e)}}static schema(e={}){const t=y(e,"names",{});return new I({name:t.blockName||N,value:[new ee({name:t.attributes||N,value:we.schema()})]})}fromSchema(e){U(e,yb);const t=K(e,e,ec.schema({names:{attributes:Pu}}));j.assertSchema(t,this.className),this.attributes=Array.from(t.result.attributes,s=>new we({schema:s}))}toSchema(){return new I({value:Array.from(this.attributes,e=>e.toSchema())})}toJSON(){return{attributes:Array.from(this.attributes,e=>e.toJSON())}}}ec.CLASS_NAME="SubjectDirectoryAttributes";class ve{static getItems(){return this.types||(this.types={},ve.register(Sw,"SubjectAltName",So),ve.register(Aw,"IssuerAltName",So),ve.register(bp,"AuthorityKeyIdentifier",Gr),ve.register(yp,"BasicConstraints",bn),ve.register(T1,"MicrosoftCaVersion",Xl),ve.register(xw,"CertificatePolicies",Ao),ve.register(I1,"CertificatePoliciesMicrosoft",Ao),ve.register(D1,"MicrosoftCertTemplateV2",lo),ve.register(Cw,"CRLDistributionPoints",No),ve.register(vp,"FreshestCRL",No),ve.register(V1,"ExtKeyUsage",zl),ve.register(kw,"CertificateIssuer",Je),ve.register(Sp,"AuthorityInfoAccess",ko),ve.register(O1,"SubjectInfoAccess",ko),ve.register(Nw,"IssuingDistributionPoint",Ye),ve.register(Ew,"NameConstraints",fo),ve.register(Vw,"PolicyConstraints",po),ve.register(Iw,"PolicyMappings",Ql),ve.register(N1,"PrivateKeyUsagePeriod",go),ve.register(R1,"QCStatements",Yl),ve.register(B1,"SignedCertificateTimestampList",qh),ve.register(b1,"SubjectDirectoryAttributes",ec)),this.types}static fromBER(e,t){const s=Re(t);if(s.offset===-1)return null;const a=this.find(e);if(a)try{return new a.type({schema:s.result})}catch(u){const c=new a.type;return c.parsingError="Incorrectly formatted value of extension ".concat(a.name," (").concat(e,")"),c}return s.result}static find(e){return this.getItems()[e]||null}static register(e,t,s){this.getItems()[e]={name:t,type:s}}}const Ou="extnID",wr="critical",Bu="extnValue",yc="parsedValue",vb=[Ou,wr,Bu];class Be extends ${get parsedValue(){if(this._parsedValue===void 0){const e=ve.fromBER(this.extnID,this.extnValue.valueBlock.valueHexView);this._parsedValue=e}return this._parsedValue||void 0}set parsedValue(e){this._parsedValue=e}constructor(e={}){super(),this.extnID=y(e,Ou,Be.defaultValues(Ou)),this.critical=y(e,wr,Be.defaultValues(wr)),Bu in e?this.extnValue=new M({valueHex:e.extnValue}):this.extnValue=Be.defaultValues(Bu),yc in e&&(this.parsedValue=y(e,yc,Be.defaultValues(yc))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Ou:return N;case wr:return!1;case Bu:return new M;case yc:return{};default:return super.defaultValues(e)}}static schema(e={}){const t=y(e,"names",{});return new I({name:t.blockName||N,value:[new W({name:t.extnID||N}),new ra({name:t.critical||N,optional:!0}),new M({name:t.extnValue||N})]})}fromSchema(e){U(e,vb);const t=K(e,e,Be.schema({names:{extnID:Ou,critical:wr,extnValue:Bu}}));j.assertSchema(t,this.className),this.extnID=t.result.extnID.valueBlock.toString(),wr in t.result&&(this.critical=t.result.critical.valueBlock.value),this.extnValue=t.result.extnValue}toSchema(){const e=[];return e.push(new W({value:this.extnID})),this.critical!==Be.defaultValues(wr)&&e.push(new ra({value:this.critical})),e.push(this.extnValue),new I({value:e})}toJSON(){const e={extnID:this.extnID,extnValue:this.extnValue.toJSON()};return this.critical!==Be.defaultValues(wr)&&(e.critical=this.critical),this.parsedValue&&this.parsedValue.toJSON&&(e.parsedValue=this.parsedValue.toJSON()),e}}Be.CLASS_NAME="Extension";const Du="extensions",bb=[Du];class je extends ${constructor(e={}){super(),this.extensions=y(e,Du,je.defaultValues(Du)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Du:return[];default:return super.defaultValues(e)}}static schema(e={},t=!1){const s=y(e,"names",{});return new I({optional:t,name:s.blockName||N,value:[new ee({name:s.extensions||N,value:Be.schema(s.extension||{})})]})}fromSchema(e){U(e,bb);const t=K(e,e,je.schema({names:{extensions:Du}}));j.assertSchema(t,this.className),this.extensions=Array.from(t.result.extensions,s=>new Be({schema:s}))}toSchema(){return new I({value:Array.from(this.extensions,e=>e.toSchema())})}toJSON(){return{extensions:this.extensions.map(e=>e.toJSON())}}}je.CLASS_NAME="Extensions";const Tu="issuer",Ru="serialNumber",ka="issuerUID",Sb=[Tu,Ru,ka];class At extends ${constructor(e={}){super(),this.issuer=y(e,Tu,At.defaultValues(Tu)),this.serialNumber=y(e,Ru,At.defaultValues(Ru)),ka in e&&(this.issuerUID=y(e,ka,At.defaultValues(ka))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Tu:return new Je;case Ru:return new R;case ka:return new ne;default:return super.defaultValues(e)}}static schema(e={}){const t=y(e,"names",{});return new I({name:t.blockName||N,value:[Je.schema(t.issuer||{}),new R({name:t.serialNumber||N}),new ne({optional:!0,name:t.issuerUID||N})]})}fromSchema(e){U(e,Sb);const t=K(e,e,At.schema({names:{issuer:{names:{blockName:Tu}},serialNumber:Ru,issuerUID:ka}}));j.assertSchema(t,this.className),this.issuer=new Je({schema:t.result.issuer}),this.serialNumber=t.result.serialNumber,ka in t.result&&(this.issuerUID=t.result.issuerUID)}toSchema(){const e=new I({value:[this.issuer.toSchema(),this.serialNumber]});return this.issuerUID&&e.valueBlock.value.push(this.issuerUID),e}toJSON(){const e={issuer:this.issuer.toJSON(),serialNumber:this.serialNumber.toJSON()};return this.issuerUID&&(e.issuerUID=this.issuerUID.toJSON()),e}}At.CLASS_NAME="IssuerSerial";const Lu="version",Ea="baseCertificateID",Ca="subjectName",ju="issuer",$u="signature",Uu="serialNumber",Ku="attrCertValidityPeriod",Hu="attributes",xa="issuerUniqueID",Ia="extensions",Ab=[Lu,Ea,Ca,ju,$u,Uu,Ku,Hu,xa,Ia];class lt extends ${constructor(e={}){super(),this.version=y(e,Lu,lt.defaultValues(Lu)),Ea in e&&(this.baseCertificateID=y(e,Ea,lt.defaultValues(Ea))),Ca in e&&(this.subjectName=y(e,Ca,lt.defaultValues(Ca))),this.issuer=y(e,ju,lt.defaultValues(ju)),this.signature=y(e,$u,lt.defaultValues($u)),this.serialNumber=y(e,Uu,lt.defaultValues(Uu)),this.attrCertValidityPeriod=y(e,Ku,lt.defaultValues(Ku)),this.attributes=y(e,Hu,lt.defaultValues(Hu)),xa in e&&(this.issuerUniqueID=y(e,xa,lt.defaultValues(xa))),Ia in e&&(this.extensions=y(e,Ia,lt.defaultValues(Ia))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Lu:return 0;case Ea:return new At;case Ca:return new Je;case ju:return new Je;case $u:return new T;case Uu:return new R;case Ku:return new ss;case Hu:return[];case xa:return new ne;case Ia:return new je;default:return super.defaultValues(e)}}static schema(e={}){const t=y(e,"names",{});return new I({name:t.blockName||N,value:[new R({name:t.version||N}),new Ne({value:[new D({name:t.baseCertificateID||N,idBlock:{tagClass:3,tagNumber:0},value:At.schema().valueBlock.value}),new D({name:t.subjectName||N,idBlock:{tagClass:3,tagNumber:1},value:Je.schema().valueBlock.value})]}),Je.schema({names:{blockName:t.issuer||N}}),T.schema(t.signature||{}),new R({name:t.serialNumber||N}),ss.schema(t.attrCertValidityPeriod||{}),new I({name:t.attributes||N,value:[new ee({value:we.schema()})]}),new ne({optional:!0,name:t.issuerUniqueID||N}),je.schema(t.extensions||{},!0)]})}fromSchema(e){U(e,Ab);const t=K(e,e,lt.schema({names:{version:Lu,baseCertificateID:Ea,subjectName:Ca,issuer:ju,signature:{names:{blockName:$u}},serialNumber:Uu,attrCertValidityPeriod:{names:{blockName:Ku}},attributes:Hu,issuerUniqueID:xa,extensions:{names:{blockName:Ia}}}}));j.assertSchema(t,this.className),this.version=t.result.version.valueBlock.valueDec,Ea in t.result&&(this.baseCertificateID=new At({schema:new I({value:t.result.baseCertificateID.valueBlock.value})})),Ca in t.result&&(this.subjectName=new Je({schema:new I({value:t.result.subjectName.valueBlock.value})})),this.issuer=t.result.issuer,this.signature=new T({schema:t.result.signature}),this.serialNumber=t.result.serialNumber,this.attrCertValidityPeriod=new ss({schema:t.result.attrCertValidityPeriod}),this.attributes=Array.from(t.result.attributes.valueBlock.value,s=>new we({schema:s})),xa in t.result&&(this.issuerUniqueID=t.result.issuerUniqueID),Ia in t.result&&(this.extensions=new je({schema:t.result.extensions}))}toSchema(){const e=new I({value:[new R({value:this.version})]});return this.baseCertificateID&&e.valueBlock.value.push(new D({idBlock:{tagClass:3,tagNumber:0},value:this.baseCertificateID.toSchema().valueBlock.value})),this.subjectName&&e.valueBlock.value.push(new D({idBlock:{tagClass:3,tagNumber:1},value:this.subjectName.toSchema().valueBlock.value})),e.valueBlock.value.push(this.issuer.toSchema()),e.valueBlock.value.push(this.signature.toSchema()),e.valueBlock.value.push(this.serialNumber),e.valueBlock.value.push(this.attrCertValidityPeriod.toSchema()),e.valueBlock.value.push(new I({value:Array.from(this.attributes,t=>t.toSchema())})),this.issuerUniqueID&&e.valueBlock.value.push(this.issuerUniqueID),this.extensions&&e.valueBlock.value.push(this.extensions.toSchema()),e}toJSON(){const e={version:this.version};return this.baseCertificateID&&(e.baseCertificateID=this.baseCertificateID.toJSON()),this.subjectName&&(e.subjectName=this.subjectName.toJSON()),e.issuer=this.issuer.toJSON(),e.signature=this.signature.toJSON(),e.serialNumber=this.serialNumber.toJSON(),e.attrCertValidityPeriod=this.attrCertValidityPeriod.toJSON(),e.attributes=Array.from(this.attributes,t=>t.toJSON()),this.issuerUniqueID&&(e.issuerUniqueID=this.issuerUniqueID.toJSON()),this.extensions&&(e.extensions=this.extensions.toJSON()),e}}lt.CLASS_NAME="AttributeCertificateInfoV1";const Mu="acinfo",Fu="signatureAlgorithm",Ju="signatureValue",Nb=[Mu,Ju,Fu];class Ts extends ${constructor(e={}){super(),this.acinfo=y(e,Mu,Ts.defaultValues(Mu)),this.signatureAlgorithm=y(e,Fu,Ts.defaultValues(Fu)),this.signatureValue=y(e,Ju,Ts.defaultValues(Ju)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Mu:return new lt;case Fu:return new T;case Ju:return new ne;default:return super.defaultValues(e)}}static schema(e={}){const t=y(e,"names",{});return new I({name:t.blockName||N,value:[lt.schema(t.acinfo||{}),T.schema(t.signatureAlgorithm||{}),new ne({name:t.signatureValue||N})]})}fromSchema(e){U(e,Nb);const t=K(e,e,Ts.schema({names:{acinfo:{names:{blockName:Mu}},signatureAlgorithm:{names:{blockName:Fu}},signatureValue:Ju}}));j.assertSchema(t,this.className),this.acinfo=new lt({schema:t.result.acinfo}),this.signatureAlgorithm=new T({schema:t.result.signatureAlgorithm}),this.signatureValue=t.result.signatureValue}toSchema(){return new I({value:[this.acinfo.toSchema(),this.signatureAlgorithm.toSchema(),this.signatureValue]})}toJSON(){return{acinfo:this.acinfo.toJSON(),signatureAlgorithm:this.signatureAlgorithm.toJSON(),signatureValue:this.signatureValue.toJSON()}}}Ts.CLASS_NAME="AttributeCertificateV1";const qu="digestedObjectType",Va="otherObjectTypeID",Wu="digestAlgorithm",Gu="objectDigest",kb=[qu,Va,Wu,Gu];class Dt extends ${constructor(e={}){super(),this.digestedObjectType=y(e,qu,Dt.defaultValues(qu)),Va in e&&(this.otherObjectTypeID=y(e,Va,Dt.defaultValues(Va))),this.digestAlgorithm=y(e,Wu,Dt.defaultValues(Wu)),this.objectDigest=y(e,Gu,Dt.defaultValues(Gu)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case qu:return new Gl;case Va:return new W;case Wu:return new T;case Gu:return new ne;default:return super.defaultValues(e)}}static schema(e={}){const t=y(e,"names",{});return new I({name:t.blockName||N,value:[new Gl({name:t.digestedObjectType||N}),new W({optional:!0,name:t.otherObjectTypeID||N}),T.schema(t.digestAlgorithm||{}),new ne({name:t.objectDigest||N})]})}fromSchema(e){U(e,kb);const t=K(e,e,Dt.schema({names:{digestedObjectType:qu,otherObjectTypeID:Va,digestAlgorithm:{names:{blockName:Wu}},objectDigest:Gu}}));j.assertSchema(t,this.className),this.digestedObjectType=t.result.digestedObjectType,Va in t.result&&(this.otherObjectTypeID=t.result.otherObjectTypeID),this.digestAlgorithm=new T({schema:t.result.digestAlgorithm}),this.objectDigest=t.result.objectDigest}toSchema(){const e=new I({value:[this.digestedObjectType]});return this.otherObjectTypeID&&e.valueBlock.value.push(this.otherObjectTypeID),e.valueBlock.value.push(this.digestAlgorithm.toSchema()),e.valueBlock.value.push(this.objectDigest),e}toJSON(){const e={digestedObjectType:this.digestedObjectType.toJSON(),digestAlgorithm:this.digestAlgorithm.toJSON(),objectDigest:this.objectDigest.toJSON()};return this.otherObjectTypeID&&(e.otherObjectTypeID=this.otherObjectTypeID.toJSON()),e}}Dt.CLASS_NAME="ObjectDigestInfo";const Pa="issuerName",Oa="baseCertificateID",Ba="objectDigestInfo",Eb=[Pa,Oa,Ba];class Xr extends ${constructor(e={}){super(),Pa in e&&(this.issuerName=y(e,Pa,Xr.defaultValues(Pa))),Oa in e&&(this.baseCertificateID=y(e,Oa,Xr.defaultValues(Oa))),Ba in e&&(this.objectDigestInfo=y(e,Ba,Xr.defaultValues(Ba))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Pa:return new Je;case Oa:return new At;case Ba:return new Dt;default:return super.defaultValues(e)}}static schema(e={}){const t=y(e,"names",{});return new I({name:t.blockName||N,value:[Je.schema({names:{blockName:t.issuerName}},!0),new D({optional:!0,name:t.baseCertificateID||N,idBlock:{tagClass:3,tagNumber:0},value:At.schema().valueBlock.value}),new D({optional:!0,name:t.objectDigestInfo||N,idBlock:{tagClass:3,tagNumber:1},value:Dt.schema().valueBlock.value})]})}fromSchema(e){U(e,Eb);const t=K(e,e,Xr.schema({names:{issuerName:Pa,baseCertificateID:Oa,objectDigestInfo:Ba}}));j.assertSchema(t,this.className),Pa in t.result&&(this.issuerName=new Je({schema:t.result.issuerName})),Oa in t.result&&(this.baseCertificateID=new At({schema:new I({value:t.result.baseCertificateID.valueBlock.value})})),Ba in t.result&&(this.objectDigestInfo=new Dt({schema:new I({value:t.result.objectDigestInfo.valueBlock.value})}))}toSchema(){const e=new I;return this.issuerName&&e.valueBlock.value.push(this.issuerName.toSchema()),this.baseCertificateID&&e.valueBlock.value.push(new D({idBlock:{tagClass:3,tagNumber:0},value:this.baseCertificateID.toSchema().valueBlock.value})),this.objectDigestInfo&&e.valueBlock.value.push(new D({idBlock:{tagClass:3,tagNumber:1},value:this.objectDigestInfo.toSchema().valueBlock.value})),e}toJSON(){const e={};return this.issuerName&&(e.issuerName=this.issuerName.toJSON()),this.baseCertificateID&&(e.baseCertificateID=this.baseCertificateID.toJSON()),this.objectDigestInfo&&(e.objectDigestInfo=this.objectDigestInfo.toJSON()),e}}Xr.CLASS_NAME="V2Form";const Da="baseCertificateID",Ta="entityName",Ra="objectDigestInfo",Cb=[Da,Ta,Ra];class Rs extends ${constructor(e={}){super(),Da in e&&(this.baseCertificateID=y(e,Da,Rs.defaultValues(Da))),Ta in e&&(this.entityName=y(e,Ta,Rs.defaultValues(Ta))),Ra in e&&(this.objectDigestInfo=y(e,Ra,Rs.defaultValues(Ra))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Da:return new At;case Ta:return new Je;case Ra:return new Dt;default:return super.defaultValues(e)}}static schema(e={}){const t=y(e,"names",{});return new I({name:t.blockName||N,value:[new D({optional:!0,name:t.baseCertificateID||N,idBlock:{tagClass:3,tagNumber:0},value:At.schema().valueBlock.value}),new D({optional:!0,name:t.entityName||N,idBlock:{tagClass:3,tagNumber:1},value:Je.schema().valueBlock.value}),new D({optional:!0,name:t.objectDigestInfo||N,idBlock:{tagClass:3,tagNumber:2},value:Dt.schema().valueBlock.value})]})}fromSchema(e){U(e,Cb);const t=K(e,e,Rs.schema({names:{baseCertificateID:Da,entityName:Ta,objectDigestInfo:Ra}}));j.assertSchema(t,this.className),Da in t.result&&(this.baseCertificateID=new At({schema:new I({value:t.result.baseCertificateID.valueBlock.value})})),Ta in t.result&&(this.entityName=new Je({schema:new I({value:t.result.entityName.valueBlock.value})})),Ra in t.result&&(this.objectDigestInfo=new Dt({schema:new I({value:t.result.objectDigestInfo.valueBlock.value})}))}toSchema(){const e=new I;return this.baseCertificateID&&e.valueBlock.value.push(new D({idBlock:{tagClass:3,tagNumber:0},value:this.baseCertificateID.toSchema().valueBlock.value})),this.entityName&&e.valueBlock.value.push(new D({idBlock:{tagClass:3,tagNumber:1},value:this.entityName.toSchema().valueBlock.value})),this.objectDigestInfo&&e.valueBlock.value.push(new D({idBlock:{tagClass:3,tagNumber:2},value:this.objectDigestInfo.toSchema().valueBlock.value})),e}toJSON(){const e={};return this.baseCertificateID&&(e.baseCertificateID=this.baseCertificateID.toJSON()),this.entityName&&(e.entityName=this.entityName.toJSON()),this.objectDigestInfo&&(e.objectDigestInfo=this.objectDigestInfo.toJSON()),e}}Rs.CLASS_NAME="Holder";const _u="version",Xu="holder",zu="issuer",Qu="signature",Yu="serialNumber",Zu="attrCertValidityPeriod",el="attributes",La="issuerUniqueID",ja="extensions",xb=[_u,Xu,zu,Qu,Yu,Zu,el,La,ja];class dt extends ${constructor(e={}){super(),this.version=y(e,_u,dt.defaultValues(_u)),this.holder=y(e,Xu,dt.defaultValues(Xu)),this.issuer=y(e,zu,dt.defaultValues(zu)),this.signature=y(e,Qu,dt.defaultValues(Qu)),this.serialNumber=y(e,Yu,dt.defaultValues(Yu)),this.attrCertValidityPeriod=y(e,Zu,dt.defaultValues(Zu)),this.attributes=y(e,el,dt.defaultValues(el)),La in e&&(this.issuerUniqueID=y(e,La,dt.defaultValues(La))),ja in e&&(this.extensions=y(e,ja,dt.defaultValues(ja))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case _u:return 1;case Xu:return new Rs;case zu:return{};case Qu:return new T;case Yu:return new R;case Zu:return new ss;case el:return[];case La:return new ne;case ja:return new je;default:return super.defaultValues(e)}}static schema(e={}){const t=y(e,"names",{});return new I({name:t.blockName||N,value:[new R({name:t.version||N}),Rs.schema(t.holder||{}),new Ne({value:[Je.schema({names:{blockName:t.issuer||N}}),new D({name:t.issuer||N,idBlock:{tagClass:3,tagNumber:0},value:Xr.schema().valueBlock.value})]}),T.schema(t.signature||{}),new R({name:t.serialNumber||N}),ss.schema(t.attrCertValidityPeriod||{}),new I({name:t.attributes||N,value:[new ee({value:we.schema()})]}),new ne({optional:!0,name:t.issuerUniqueID||N}),je.schema(t.extensions||{},!0)]})}fromSchema(e){U(e,xb);const t=K(e,e,dt.schema({names:{version:_u,holder:{names:{blockName:Xu}},issuer:zu,signature:{names:{blockName:Qu}},serialNumber:Yu,attrCertValidityPeriod:{names:{blockName:Zu}},attributes:el,issuerUniqueID:La,extensions:{names:{blockName:ja}}}}));switch(j.assertSchema(t,this.className),this.version=t.result.version.valueBlock.valueDec,this.holder=new Rs({schema:t.result.holder}),t.result.issuer.idBlock.tagClass){case 3:this.issuer=new Xr({schema:new I({value:t.result.issuer.valueBlock.value})});break;case 1:default:throw new Error("Incorrect value for 'issuer' in AttributeCertificateInfoV2")}this.signature=new T({schema:t.result.signature}),this.serialNumber=t.result.serialNumber,this.attrCertValidityPeriod=new ss({schema:t.result.attrCertValidityPeriod}),this.attributes=Array.from(t.result.attributes.valueBlock.value,s=>new we({schema:s})),La in t.result&&(this.issuerUniqueID=t.result.issuerUniqueID),ja in t.result&&(this.extensions=new je({schema:t.result.extensions}))}toSchema(){const e=new I({value:[new R({value:this.version}),this.holder.toSchema(),new D({idBlock:{tagClass:3,tagNumber:0},value:this.issuer.toSchema().valueBlock.value}),this.signature.toSchema(),this.serialNumber,this.attrCertValidityPeriod.toSchema(),new I({value:Array.from(this.attributes,t=>t.toSchema())})]});return this.issuerUniqueID&&e.valueBlock.value.push(this.issuerUniqueID),this.extensions&&e.valueBlock.value.push(this.extensions.toSchema()),e}toJSON(){const e={version:this.version,holder:this.holder.toJSON(),issuer:this.issuer.toJSON(),signature:this.signature.toJSON(),serialNumber:this.serialNumber.toJSON(),attrCertValidityPeriod:this.attrCertValidityPeriod.toJSON(),attributes:Array.from(this.attributes,t=>t.toJSON())};return this.issuerUniqueID&&(e.issuerUniqueID=this.issuerUniqueID.toJSON()),this.extensions&&(e.extensions=this.extensions.toJSON()),e}}dt.CLASS_NAME="AttributeCertificateInfoV2";const tl="acinfo",sl="signatureAlgorithm",rl="signatureValue",Ib=[tl,sl,rl];class Tt extends ${constructor(e={}){super(),this.acinfo=y(e,tl,Tt.defaultValues(tl)),this.signatureAlgorithm=y(e,sl,Tt.defaultValues(sl)),this.signatureValue=y(e,rl,Tt.defaultValues(rl)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case tl:return new dt;case sl:return new T;case rl:return new ne;default:return super.defaultValues(e)}}static schema(e={}){const t=y(e,"names",{});return new I({name:t.blockName||N,value:[dt.schema(t.acinfo||{}),T.schema(t.signatureAlgorithm||{}),new ne({name:t.signatureValue||N})]})}fromSchema(e){U(e,Ib);const t=K(e,e,Tt.schema({names:{acinfo:{names:{blockName:tl}},signatureAlgorithm:{names:{blockName:sl}},signatureValue:rl}}));j.assertSchema(t,this.className),this.acinfo=new dt({schema:t.result.acinfo}),this.signatureAlgorithm=new T({schema:t.result.signatureAlgorithm}),this.signatureValue=t.result.signatureValue}toSchema(){return new I({value:[this.acinfo.toSchema(),this.signatureAlgorithm.toSchema(),this.signatureValue]})}toJSON(){return{acinfo:this.acinfo.toJSON(),signatureAlgorithm:this.signatureAlgorithm.toJSON(),signatureValue:this.signatureValue.toJSON()}}}Tt.CLASS_NAME="AttributeCertificateV2";const $a="contentType",Yn="content",Vb=[$a,Yn];class pe extends ${constructor(e={}){super(),this.contentType=y(e,$a,pe.defaultValues($a)),this.content=y(e,Yn,pe.defaultValues(Yn)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case $a:return N;case Yn:return new Z;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case $a:return typeof t=="string"&&t===this.defaultValues($a);case Yn:return t instanceof Z;default:return super.defaultValues(e)}}static schema(e={}){const t=y(e,"names",{});return"optional"in t||(t.optional=!1),new I({name:t.blockName||"ContentInfo",optional:t.optional,value:[new W({name:t.contentType||$a}),new D({idBlock:{tagClass:3,tagNumber:0},value:[new Z({name:t.content||Yn})]})]})}fromSchema(e){U(e,Vb);const t=K(e,e,pe.schema());j.assertSchema(t,this.className),this.contentType=t.result.contentType.valueBlock.toString(),this.content=t.result.content}toSchema(){return new I({value:[new W({value:this.contentType}),new D({idBlock:{tagClass:3,tagNumber:0},value:[this.content]})]})}toJSON(){const e={contentType:this.contentType};return this.content instanceof Z||(e.content=this.content.toJSON()),e}}pe.CLASS_NAME="ContentInfo",pe.DATA=Ap,pe.SIGNED_DATA=Pw,pe.ENVELOPED_DATA=Ow,pe.ENCRYPTED_DATA=Bw;const zm="type",Qm="value",Df="utcTimeName",Tf="generalTimeName",Pb=[Df,Tf];var gg;(function(r){r[r.UTCTime=0]="UTCTime",r[r.GeneralizedTime=1]="GeneralizedTime",r[r.empty=2]="empty"})(gg||(gg={}));class Te extends ${constructor(e={}){super(),this.type=y(e,zm,Te.defaultValues(zm)),this.value=y(e,Qm,Te.defaultValues(Qm)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case zm:return 0;case Qm:return new Date(0,0,0);default:return super.defaultValues(e)}}static schema(e={},t=!1){const s=y(e,"names",{});return new Ne({optional:t,value:[new Sf({name:s.utcTimeName||N}),new ke({name:s.generalTimeName||N})]})}fromSchema(e){U(e,Pb);const t=K(e,e,Te.schema({names:{utcTimeName:Df,generalTimeName:Tf}}));j.assertSchema(t,this.className),Df in t.result&&(this.type=0,this.value=t.result.utcTimeName.toDate()),Tf in t.result&&(this.type=1,this.value=t.result.generalTimeName.toDate())}toSchema(){return this.type===0?new Sf({valueDate:this.value}):this.type===1?new ke({valueDate:this.value}):{}}toJSON(){return{type:this.type,value:this.value}}}Te.CLASS_NAME="Time";const Ym="tbs",yr="version",Mc="serialNumber",Fc="signature",Jc="issuer",qc="notBefore",Wc="notAfter",Gc="subject",_c="subjectPublicKeyInfo",al="issuerUniqueID",nl="subjectUniqueID",il="extensions",ol="signatureAlgorithm",ul="signatureValue",Rt="tbsCertificate",Vh="".concat(Rt,".").concat(yr),Np="".concat(Rt,".").concat(Mc),kp="".concat(Rt,".").concat(Fc),Ep="".concat(Rt,".").concat(Jc),Ph="".concat(Rt,".").concat(qc),Oh="".concat(Rt,".").concat(Wc),Cp="".concat(Rt,".").concat(Gc),xp="".concat(Rt,".").concat(_c),Bh="".concat(Rt,".").concat(al),Dh="".concat(Rt,".").concat(nl),Ml="".concat(Rt,".").concat(il),Ob=[Rt,Vh,Np,kp,Ep,Ph,Oh,Cp,xp,Bh,Dh,Ml,ol,ul];function Bb(r={}){const e=y(r,"names",{});return new I({name:e.blockName||Rt,value:[new D({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new R({name:e.tbsCertificateVersion||Vh})]}),new R({name:e.tbsCertificateSerialNumber||Np}),T.schema(e.signature||{names:{blockName:kp}}),fe.schema(e.issuer||{names:{blockName:Ep}}),new I({name:e.tbsCertificateValidity||"tbsCertificate.validity",value:[Te.schema(e.notBefore||{names:{utcTimeName:Ph,generalTimeName:Ph}}),Te.schema(e.notAfter||{names:{utcTimeName:Oh,generalTimeName:Oh}})]}),fe.schema(e.subject||{names:{blockName:Cp}}),Nt.schema(e.subjectPublicKeyInfo||{names:{blockName:xp}}),new Y({name:e.tbsCertificateIssuerUniqueID||Bh,optional:!0,idBlock:{tagClass:3,tagNumber:1}}),new Y({name:e.tbsCertificateSubjectUniqueID||Dh,optional:!0,idBlock:{tagClass:3,tagNumber:2}}),new D({optional:!0,idBlock:{tagClass:3,tagNumber:3},value:[je.schema(e.extensions||{names:{blockName:Ml}})]})]})}class ue extends ${get tbs(){return ge.toArrayBuffer(this.tbsView)}set tbs(e){this.tbsView=new Uint8Array(e)}constructor(e={}){super(),this.tbsView=new Uint8Array(y(e,Ym,ue.defaultValues(Ym))),this.version=y(e,yr,ue.defaultValues(yr)),this.serialNumber=y(e,Mc,ue.defaultValues(Mc)),this.signature=y(e,Fc,ue.defaultValues(Fc)),this.issuer=y(e,Jc,ue.defaultValues(Jc)),this.notBefore=y(e,qc,ue.defaultValues(qc)),this.notAfter=y(e,Wc,ue.defaultValues(Wc)),this.subject=y(e,Gc,ue.defaultValues(Gc)),this.subjectPublicKeyInfo=y(e,_c,ue.defaultValues(_c)),al in e&&(this.issuerUniqueID=y(e,al,ue.defaultValues(al))),nl in e&&(this.subjectUniqueID=y(e,nl,ue.defaultValues(nl))),il in e&&(this.extensions=y(e,il,ue.defaultValues(il))),this.signatureAlgorithm=y(e,ol,ue.defaultValues(ol)),this.signatureValue=y(e,ul,ue.defaultValues(ul)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Ym:return Le;case yr:return 0;case Mc:return new R;case Fc:return new T;case Jc:return new fe;case qc:return new Te;case Wc:return new Te;case Gc:return new fe;case _c:return new Nt;case al:return Le;case nl:return Le;case il:return[];case ol:return new T;case ul:return new ne;default:return super.defaultValues(e)}}static schema(e={}){const t=y(e,"names",{});return new I({name:t.blockName||N,value:[Bb(t.tbsCertificate),T.schema(t.signatureAlgorithm||{names:{blockName:ol}}),new ne({name:t.signatureValue||ul})]})}fromSchema(e){U(e,Ob);const t=K(e,e,ue.schema({names:{tbsCertificate:{names:{extensions:{names:{extensions:Ml}}}}}}));j.assertSchema(t,this.className),this.tbsView=t.result.tbsCertificate.valueBeforeDecodeView,Vh in t.result&&(this.version=t.result[Vh].valueBlock.valueDec),this.serialNumber=t.result[Np],this.signature=new T({schema:t.result[kp]}),this.issuer=new fe({schema:t.result[Ep]}),this.notBefore=new Te({schema:t.result[Ph]}),this.notAfter=new Te({schema:t.result[Oh]}),this.subject=new fe({schema:t.result[Cp]}),this.subjectPublicKeyInfo=new Nt({schema:t.result[xp]}),Bh in t.result&&(this.issuerUniqueID=t.result[Bh].valueBlock.valueHex),Dh in t.result&&(this.subjectUniqueID=t.result[Dh].valueBlock.valueHex),Ml in t.result&&(this.extensions=Array.from(t.result[Ml],s=>new Be({schema:s}))),this.signatureAlgorithm=new T({schema:t.result.signatureAlgorithm}),this.signatureValue=t.result.signatureValue}encodeTBS(){const e=[];return yr in this&&this.version!==ue.defaultValues(yr)&&e.push(new D({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new R({value:this.version})]})),e.push(this.serialNumber),e.push(this.signature.toSchema()),e.push(this.issuer.toSchema()),e.push(new I({value:[this.notBefore.toSchema(),this.notAfter.toSchema()]})),e.push(this.subject.toSchema()),e.push(this.subjectPublicKeyInfo.toSchema()),this.issuerUniqueID&&e.push(new Y({optional:!0,idBlock:{tagClass:3,tagNumber:1},valueHex:this.issuerUniqueID})),this.subjectUniqueID&&e.push(new Y({optional:!0,idBlock:{tagClass:3,tagNumber:2},valueHex:this.subjectUniqueID})),this.extensions&&e.push(new D({optional:!0,idBlock:{tagClass:3,tagNumber:3},value:[new I({value:Array.from(this.extensions,t=>t.toSchema())})]})),new I({value:e})}toSchema(e=!1){let t;if(e===!1){if(!this.tbsView.byteLength)return ue.schema().value[0];const s=Re(this.tbsView);j.assert(s,"TBS Certificate"),t=s.result}else t=this.encodeTBS();return new I({value:[t,this.signatureAlgorithm.toSchema(),this.signatureValue]})}toJSON(){const e={tbs:he.ToHex(this.tbsView),version:this.version,serialNumber:this.serialNumber.toJSON(),signature:this.signature.toJSON(),issuer:this.issuer.toJSON(),notBefore:this.notBefore.toJSON(),notAfter:this.notAfter.toJSON(),subject:this.subject.toJSON(),subjectPublicKeyInfo:this.subjectPublicKeyInfo.toJSON(),signatureAlgorithm:this.signatureAlgorithm.toJSON(),signatureValue:this.signatureValue.toJSON()};return yr in this&&this.version!==ue.defaultValues(yr)&&(e.version=this.version),this.issuerUniqueID&&(e.issuerUniqueID=he.ToHex(this.issuerUniqueID)),this.subjectUniqueID&&(e.subjectUniqueID=he.ToHex(this.subjectUniqueID)),this.extensions&&(e.extensions=Array.from(this.extensions,t=>t.toJSON())),e}async getPublicKey(e,t=te(!0)){return t.getPublicKey(this.subjectPublicKeyInfo,this.signatureAlgorithm,e)}async getKeyHash(e="SHA-1",t=te(!0)){return t.digest({name:e},this.subjectPublicKeyInfo.subjectPublicKey.valueBlock.valueHexView)}async sign(e,t="SHA-1",s=te(!0)){if(!e)throw new Error("Need to provide a private key for signing");const a=await s.getSignatureParameters(e,t),u=a.parameters;this.signature=a.signatureAlgorithm,this.signatureAlgorithm=a.signatureAlgorithm,this.tbsView=new Uint8Array(this.encodeTBS().toBER());const c=await s.signWithPrivateKey(this.tbsView,e,u);this.signatureValue=new ne({valueHex:c})}async verify(e,t=te(!0)){let s;if(e?s=e.subjectPublicKeyInfo:this.issuer.isEqual(this.subject)&&(s=this.subjectPublicKeyInfo),!(s instanceof Nt))throw new Error("Please provide issuer certificate as a parameter");return t.verifyWithPublicKey(this.tbsView,this.signatureValue,s,this.signatureAlgorithm)}}ue.CLASS_NAME="Certificate";function $w(r,e=null){if(e&&r.issuer.isEqual(e.issuer)&&r.serialNumber.isEqual(e.serialNumber))return null;let t=!1;if(r.extensions){for(const s of r.extensions)if(s.extnID===yp&&s.parsedValue instanceof bn&&s.parsedValue.cA){t=!0;break}}return t?r:null}const Zn="certId",ei="certValue",Tn="parsedValue",Db=[Zn,ei];class pn extends ${constructor(e={}){super(),this.certId=y(e,Zn,pn.defaultValues(Zn)),this.certValue=y(e,ei,pn.defaultValues(ei)),Tn in e&&(this.parsedValue=y(e,Tn,pn.defaultValues(Tn))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Zn:return N;case ei:return new Z;case Tn:return{};default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Zn:return t===N;case ei:return t instanceof Z;case Tn:return t instanceof Object&&Object.keys(t).length===0;default:return super.defaultValues(e)}}static schema(e={}){const t=y(e,"names",{});return new I({name:t.blockName||N,value:[new W({name:t.id||"id"}),new D({idBlock:{tagClass:3,tagNumber:0},value:[new Z({name:t.value||"value"})]})]})}fromSchema(e){U(e,Db);const t=K(e,e,pn.schema({names:{id:Zn,value:ei}}));j.assertSchema(t,this.className),this.certId=t.result.certId.valueBlock.toString(),this.certValue=t.result.certValue;const s=this.certValue.valueBlock.valueHexView;switch(this.certId){case Qd:try{this.parsedValue=ue.fromBER(s)}catch(a){Tt.fromBER(s)}break;case Yd:this.parsedValue=Tt.fromBER(s);break;case j1:default:throw new Error("Incorrect CERT_ID value in CertBag: ".concat(this.certId))}}toSchema(){return Tn in this&&("acinfo"in this.parsedValue?this.certId=Yd:this.certId=Qd,this.certValue=new M({valueHex:this.parsedValue.toSchema().toBER(!1)})),new I({value:[new W({value:this.certId}),new D({idBlock:{tagClass:3,tagNumber:0},value:["toSchema"in this.certValue?this.certValue.toSchema():this.certValue]})]})}toJSON(){return{certId:this.certId,certValue:this.certValue.toJSON()}}}pn.CLASS_NAME="CertBag";const ll="userCertificate",ti="revocationDate",Ua="crlEntryExtensions",Tb=[ll,ti,Ua];class dn extends ${constructor(e={}){super(),this.userCertificate=y(e,ll,dn.defaultValues(ll)),this.revocationDate=y(e,ti,dn.defaultValues(ti)),Ua in e&&(this.crlEntryExtensions=y(e,Ua,dn.defaultValues(Ua))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case ll:return new R;case ti:return new Te;case Ua:return new je;default:return super.defaultValues(e)}}static schema(e={}){const t=y(e,"names",{});return new I({name:t.blockName||N,value:[new R({name:t.userCertificate||ll}),Te.schema({names:{utcTimeName:t.revocationDate||ti,generalTimeName:t.revocationDate||ti}}),je.schema({names:{blockName:t.crlEntryExtensions||Ua}},!0)]})}fromSchema(e){U(e,Tb);const t=K(e,e,dn.schema());j.assertSchema(t,this.className),this.userCertificate=t.result.userCertificate,this.revocationDate=new Te({schema:t.result.revocationDate}),Ua in t.result&&(this.crlEntryExtensions=new je({schema:t.result.crlEntryExtensions}))}toSchema(){const e=[this.userCertificate,this.revocationDate.toSchema()];return this.crlEntryExtensions&&e.push(this.crlEntryExtensions.toSchema()),new I({value:e})}toJSON(){const e={userCertificate:this.userCertificate.toJSON(),revocationDate:this.revocationDate.toJSON()};return this.crlEntryExtensions&&(e.crlEntryExtensions=this.crlEntryExtensions.toJSON()),e}}dn.CLASS_NAME="RevokedCertificate";const Zm="tbs",Ro="version",ef="signature",tf="issuer",sf="thisUpdate",vc="nextUpdate",bc="revokedCertificates",Sc="crlExtensions",cl="signatureAlgorithm",hl="signatureValue",Fs="tbsCertList",Th="".concat(Fs,".version"),Ip="".concat(Fs,".signature"),Vp="".concat(Fs,".issuer"),Rh="".concat(Fs,".thisUpdate"),tc="".concat(Fs,".nextUpdate"),Lh="".concat(Fs,".revokedCertificates"),jh="".concat(Fs,".extensions"),Rb=[Fs,Th,Ip,Vp,Rh,tc,Lh,jh,cl,hl];function Lb(r={}){const e=y(r,"names",{});return new I({name:e.blockName||Fs,value:[new R({optional:!0,name:e.tbsCertListVersion||Th,value:2}),T.schema(e.signature||{names:{blockName:Ip}}),fe.schema(e.issuer||{names:{blockName:Vp}}),Te.schema(e.tbsCertListThisUpdate||{names:{utcTimeName:Rh,generalTimeName:Rh}}),Te.schema(e.tbsCertListNextUpdate||{names:{utcTimeName:tc,generalTimeName:tc}},!0),new I({optional:!0,value:[new ee({name:e.tbsCertListRevokedCertificates||Lh,value:new I({value:[new R,Te.schema(),je.schema({},!0)]})})]}),new D({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[je.schema(e.crlExtensions||{names:{blockName:jh}})]})]})}const jb=[bp,Aw,k1,E1,Nw,vp,Sp,C1,x1,kw];class He extends ${get tbs(){return ge.toArrayBuffer(this.tbsView)}set tbs(e){this.tbsView=new Uint8Array(e)}constructor(e={}){super(),this.tbsView=new Uint8Array(y(e,Zm,He.defaultValues(Zm))),this.version=y(e,Ro,He.defaultValues(Ro)),this.signature=y(e,ef,He.defaultValues(ef)),this.issuer=y(e,tf,He.defaultValues(tf)),this.thisUpdate=y(e,sf,He.defaultValues(sf)),vc in e&&(this.nextUpdate=y(e,vc,He.defaultValues(vc))),bc in e&&(this.revokedCertificates=y(e,bc,He.defaultValues(bc))),Sc in e&&(this.crlExtensions=y(e,Sc,He.defaultValues(Sc))),this.signatureAlgorithm=y(e,cl,He.defaultValues(cl)),this.signatureValue=y(e,hl,He.defaultValues(hl)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Zm:return Le;case Ro:return 0;case ef:return new T;case tf:return new fe;case sf:return new Te;case vc:return new Te;case bc:return[];case Sc:return new je;case cl:return new T;case hl:return new ne;default:return super.defaultValues(e)}}static schema(e={}){const t=y(e,"names",{});return new I({name:t.blockName||"CertificateList",value:[Lb(e),T.schema(t.signatureAlgorithm||{names:{blockName:cl}}),new ne({name:t.signatureValue||hl})]})}fromSchema(e){U(e,Rb);const t=K(e,e,He.schema());j.assertSchema(t,this.className),this.tbsView=t.result.tbsCertList.valueBeforeDecodeView,Th in t.result&&(this.version=t.result[Th].valueBlock.valueDec),this.signature=new T({schema:t.result[Ip]}),this.issuer=new fe({schema:t.result[Vp]}),this.thisUpdate=new Te({schema:t.result[Rh]}),tc in t.result&&(this.nextUpdate=new Te({schema:t.result[tc]})),Lh in t.result&&(this.revokedCertificates=Array.from(t.result[Lh],s=>new dn({schema:s}))),jh in t.result&&(this.crlExtensions=new je({schema:t.result[jh]})),this.signatureAlgorithm=new T({schema:t.result.signatureAlgorithm}),this.signatureValue=t.result.signatureValue}encodeTBS(){const e=[];return this.version!==He.defaultValues(Ro)&&e.push(new R({value:this.version})),e.push(this.signature.toSchema()),e.push(this.issuer.toSchema()),e.push(this.thisUpdate.toSchema()),this.nextUpdate&&e.push(this.nextUpdate.toSchema()),this.revokedCertificates&&e.push(new I({value:Array.from(this.revokedCertificates,t=>t.toSchema())})),this.crlExtensions&&e.push(new D({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[this.crlExtensions.toSchema()]})),new I({value:e})}toSchema(e=!1){let t;if(e)t=this.encodeTBS();else{if(!this.tbsView.byteLength)return He.schema();const s=Re(this.tbsView);j.assert(s,"TBS Certificate Revocation List"),t=s.result}return new I({value:[t,this.signatureAlgorithm.toSchema(),this.signatureValue]})}toJSON(){const e={tbs:he.ToHex(this.tbsView),version:this.version,signature:this.signature.toJSON(),issuer:this.issuer.toJSON(),thisUpdate:this.thisUpdate.toJSON(),signatureAlgorithm:this.signatureAlgorithm.toJSON(),signatureValue:this.signatureValue.toJSON()};return this.version!==He.defaultValues(Ro)&&(e.version=this.version),this.nextUpdate&&(e.nextUpdate=this.nextUpdate.toJSON()),this.revokedCertificates&&(e.revokedCertificates=Array.from(this.revokedCertificates,t=>t.toJSON())),this.crlExtensions&&(e.crlExtensions=this.crlExtensions.toJSON()),e}isCertificateRevoked(e){if(!this.issuer.isEqual(e.issuer)||!this.revokedCertificates)return!1;for(const t of this.revokedCertificates)if(t.userCertificate.isEqual(e.serialNumber))return!0;return!1}async sign(e,t="SHA-1",s=te(!0)){if(!e)throw new Error("Need to provide a private key for signing");const a=await s.getSignatureParameters(e,t),{parameters:u}=a;this.signature=a.signatureAlgorithm,this.signatureAlgorithm=a.signatureAlgorithm,this.tbsView=new Uint8Array(this.encodeTBS().toBER());const c=await s.signWithPrivateKey(this.tbsView,e,u);this.signatureValue=new ne({valueHex:c})}async verify(e={},t=te(!0)){let s;if(e.issuerCertificate&&(s=e.issuerCertificate.subjectPublicKeyInfo,!this.issuer.isEqual(e.issuerCertificate.subject)))return!1;if(e.publicKeyInfo&&(s=e.publicKeyInfo),!s)throw new Error("Issuer's certificate must be provided as an input parameter");if(this.crlExtensions){for(const a of this.crlExtensions.extensions)if(a.critical&&!jb.includes(a.extnID))return!1}return t.verifyWithPublicKey(this.tbsView,this.signatureValue,s,this.signatureAlgorithm)}}He.CLASS_NAME="CertificateRevocationList";const si="crlId",ri="crlValue",Lo="parsedValue",$b=[si,ri];class gn extends ${constructor(e={}){super(),this.crlId=y(e,si,gn.defaultValues(si)),this.crlValue=y(e,ri,gn.defaultValues(ri)),Lo in e&&(this.parsedValue=y(e,Lo,gn.defaultValues(Lo))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case si:return N;case ri:return new Z;case Lo:return{};default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case si:return t===N;case ri:return t instanceof Z;case Lo:return t instanceof Object&&Object.keys(t).length===0;default:return super.defaultValues(e)}}static schema(e={}){const t=y(e,"names",{});return new I({name:t.blockName||N,value:[new W({name:t.id||"id"}),new D({idBlock:{tagClass:3,tagNumber:0},value:[new Z({name:t.value||"value"})]})]})}fromSchema(e){U(e,$b);const t=K(e,e,gn.schema({names:{id:si,value:ri}}));switch(j.assertSchema(t,this.className),this.crlId=t.result.crlId.valueBlock.toString(),this.crlValue=t.result.crlValue,this.crlId){case Zd:this.parsedValue=He.fromBER(this.certValue.valueBlock.valueHex);break;default:throw new Error("Incorrect CRL_ID value in CRLBag: ".concat(this.crlId))}}toSchema(){return this.parsedValue&&(this.crlId=Zd,this.crlValue=new M({valueHex:this.parsedValue.toSchema().toBER(!1)})),new I({value:[new W({value:this.crlId}),new D({idBlock:{tagClass:3,tagNumber:0},value:[this.crlValue.toSchema()]})]})}toJSON(){return{crlId:this.crlId,crlValue:this.crlValue.toJSON()}}}gn.CLASS_NAME="CRLBag";const ai="version",ni="encryptedContentInfo",vr="unprotectedAttrs",Ub=[ai,ni,vr];class ms extends ${constructor(e={}){super(),this.version=y(e,ai,ms.defaultValues(ai)),this.encryptedContentInfo=y(e,ni,ms.defaultValues(ni)),vr in e&&(this.unprotectedAttrs=y(e,vr,ms.defaultValues(vr))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case ai:return 0;case ni:return new Oe;case vr:return[];default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case ai:return t===0;case ni:return Oe.compareWithDefault("contentType",t.contentType)&&Oe.compareWithDefault("contentEncryptionAlgorithm",t.contentEncryptionAlgorithm)&&Oe.compareWithDefault("encryptedContent",t.encryptedContent);case vr:return t.length===0;default:return super.defaultValues(e)}}static schema(e={}){const t=y(e,"names",{});return new I({name:t.blockName||N,value:[new R({name:t.version||N}),Oe.schema(t.encryptedContentInfo||{}),new D({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[new ee({name:t.unprotectedAttrs||N,value:we.schema()})]})]})}fromSchema(e){U(e,Ub);const t=K(e,e,ms.schema({names:{version:ai,encryptedContentInfo:{names:{blockName:ni}},unprotectedAttrs:vr}}));j.assertSchema(t,this.className),this.version=t.result.version.valueBlock.valueDec,this.encryptedContentInfo=new Oe({schema:t.result.encryptedContentInfo}),vr in t.result&&(this.unprotectedAttrs=Array.from(t.result.unprotectedAttrs,s=>new we({schema:s})))}toSchema(){const e=[];return e.push(new R({value:this.version})),e.push(this.encryptedContentInfo.toSchema()),this.unprotectedAttrs&&e.push(new D({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:Array.from(this.unprotectedAttrs,t=>t.toSchema())})),new I({value:e})}toJSON(){const e={version:this.version,encryptedContentInfo:this.encryptedContentInfo.toJSON()};return this.unprotectedAttrs&&(e.unprotectedAttrs=Array.from(this.unprotectedAttrs,t=>t.toJSON())),e}async encrypt(e,t=te(!0)){me.assert(e,"parameters","object");const s=ns(nt({},e),{contentType:"1.2.840.113549.1.7.1"});this.encryptedContentInfo=await t.encryptEncryptedContentInfo(s)}async decrypt(e,t=te(!0)){me.assert(e,"parameters","object");const s=ns(nt({},e),{encryptedContentInfo:this.encryptedContentInfo});return t.decryptEncryptedContentInfo(s)}}ms.CLASS_NAME="EncryptedData";const Ka="encryptionAlgorithm",br="encryptedData",jo="parsedValue",Kb=[Ka,br];class Mr extends ${constructor(e={}){super(),this.encryptionAlgorithm=y(e,Ka,Mr.defaultValues(Ka)),this.encryptedData=y(e,br,Mr.defaultValues(br)),jo in e&&(this.parsedValue=y(e,jo,Mr.defaultValues(jo))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Ka:return new T;case br:return new M;case jo:return{};default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Ka:return T.compareWithDefault("algorithmId",t.algorithmId)&&!("algorithmParams"in t);case br:return t.isEqual(Mr.defaultValues(e));case jo:return t instanceof Object&&Object.keys(t).length===0;default:return super.defaultValues(e)}}static schema(e={}){const t=y(e,"names",{});return new I({name:t.blockName||N,value:[T.schema(t.encryptionAlgorithm||{names:{blockName:Ka}}),new Ne({value:[new M({name:t.encryptedData||br}),new M({idBlock:{isConstructed:!0},name:t.encryptedData||br})]})]})}fromSchema(e){U(e,Kb);const t=K(e,e,Mr.schema({names:{encryptionAlgorithm:{names:{blockName:Ka}},encryptedData:br}}));j.assertSchema(t,this.className),this.encryptionAlgorithm=new T({schema:t.result.encryptionAlgorithm}),this.encryptedData=t.result.encryptedData}toSchema(){return new I({value:[this.encryptionAlgorithm.toSchema(),this.encryptedData]})}toJSON(){return{encryptionAlgorithm:this.encryptionAlgorithm.toJSON(),encryptedData:this.encryptedData.toJSON()}}async parseInternalValues(e,t=te(!0)){const s=await new ms({encryptedContentInfo:new Oe({contentEncryptionAlgorithm:this.encryptionAlgorithm,encryptedContent:this.encryptedData})}).decrypt(e,t);this.parsedValue=Ht.fromBER(s)}async makeInternalValues(e,t=te(!0)){if(!this.parsedValue)throw new Error('Please initialize "parsedValue" first');const s=new ms,a=ns(nt({},e),{contentToEncrypt:this.parsedValue.toSchema().toBER(!1)});if(await s.encrypt(a,t),!s.encryptedContentInfo.encryptedContent)throw new Error("The filed `encryptedContent` in EncryptedContentInfo is empty");this.encryptionAlgorithm=s.encryptedContentInfo.contentEncryptionAlgorithm,this.encryptedData=s.encryptedContentInfo.encryptedContent}}Mr.CLASS_NAME="PKCS8ShroudedKeyBag";const ii="secretTypeId",oi="secretValue",Hb=[ii,oi];class wo extends ${constructor(e={}){super(),this.secretTypeId=y(e,ii,wo.defaultValues(ii)),this.secretValue=y(e,oi,wo.defaultValues(oi)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case ii:return N;case oi:return new Z;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case ii:return t===N;case oi:return t instanceof Z;default:return super.defaultValues(e)}}static schema(e={}){const t=y(e,"names",{});return new I({name:t.blockName||N,value:[new W({name:t.id||"id"}),new D({idBlock:{tagClass:3,tagNumber:0},value:[new Z({name:t.value||"value"})]})]})}fromSchema(e){U(e,Hb);const t=K(e,e,wo.schema({names:{id:ii,value:oi}}));j.assertSchema(t,this.className),this.secretTypeId=t.result.secretTypeId.valueBlock.toString(),this.secretValue=t.result.secretValue}toSchema(){return new I({value:[new W({value:this.secretTypeId}),new D({idBlock:{tagClass:3,tagNumber:0},value:[this.secretValue.toSchema()]})]})}toJSON(){return{secretTypeId:this.secretTypeId,secretValue:this.secretValue.toJSON()}}}wo.CLASS_NAME="SecretBag";class Kr{static getItems(){return this.items||(this.items={},Kr.register("1.2.840.113549.1.12.10.1.1",Ht),Kr.register("1.2.840.113549.1.12.10.1.2",Mr),Kr.register("1.2.840.113549.1.12.10.1.3",pn),Kr.register("1.2.840.113549.1.12.10.1.4",gn),Kr.register("1.2.840.113549.1.12.10.1.5",wo),Kr.register("1.2.840.113549.1.12.10.1.6",Ls)),this.items}static register(e,t){this.getItems()[e]=t}static find(e){return this.getItems()[e]||null}}const Ha="bagId",Ma="bagValue",Ns="bagAttributes",Mb=[Ha,Ma,Ns];class zr extends ${constructor(e={}){super(),this.bagId=y(e,Ha,zr.defaultValues(Ha)),this.bagValue=y(e,Ma,zr.defaultValues(Ma)),Ns in e&&(this.bagAttributes=y(e,Ns,zr.defaultValues(Ns))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Ha:return N;case Ma:return new Z;case Ns:return[];default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Ha:return t===N;case Ma:return t instanceof Z;case Ns:return t.length===0;default:return super.defaultValues(e)}}static schema(e={}){const t=y(e,"names",{});return new I({name:t.blockName||N,value:[new W({name:t.bagId||Ha}),new D({idBlock:{tagClass:3,tagNumber:0},value:[new Z({name:t.bagValue||Ma})]}),new Fe({optional:!0,value:[new ee({name:t.bagAttributes||Ns,value:we.schema()})]})]})}fromSchema(e){U(e,Mb);const t=K(e,e,zr.schema({names:{bagId:Ha,bagValue:Ma,bagAttributes:Ns}}));j.assertSchema(t,this.className),this.bagId=t.result.bagId.valueBlock.toString();const s=Kr.find(this.bagId);if(!s)throw new Error("Invalid BAG_ID for SafeBag: ".concat(this.bagId));this.bagValue=new s({schema:t.result.bagValue}),Ns in t.result&&(this.bagAttributes=Array.from(t.result.bagAttributes,a=>new we({schema:a})))}toSchema(){const e=[new W({value:this.bagId}),new D({idBlock:{tagClass:3,tagNumber:0},value:[this.bagValue.toSchema()]})];return this.bagAttributes&&e.push(new Fe({value:Array.from(this.bagAttributes,t=>t.toSchema())})),new I({value:e})}toJSON(){const e={bagId:this.bagId,bagValue:this.bagValue.toJSON()};return this.bagAttributes&&(e.bagAttributes=Array.from(this.bagAttributes,t=>t.toJSON())),e}}zr.CLASS_NAME="SafeBag";const Rn="safeBags";class Ls extends ${constructor(e={}){super(),this.safeBags=y(e,Rn,Ls.defaultValues(Rn)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Rn:return[];default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Rn:return t.length===0;default:return super.defaultValues(e)}}static schema(e={}){const t=y(e,"names",{});return new I({name:t.blockName||N,value:[new ee({name:t.safeBags||N,value:zr.schema()})]})}fromSchema(e){U(e,[Rn]);const t=K(e,e,Ls.schema({names:{safeBags:Rn}}));j.assertSchema(t,this.className),this.safeBags=Array.from(t.result.safeBags,s=>new zr({schema:s}))}toSchema(){return new I({value:Array.from(this.safeBags,e=>e.toSchema())})}toJSON(){return{safeBags:Array.from(this.safeBags,e=>e.toJSON())}}}Ls.CLASS_NAME="SafeContents";const ml="otherCertFormat",fl="otherCert",Fb=[ml,fl];class ea extends ${constructor(e={}){super(),this.otherCertFormat=y(e,ml,ea.defaultValues(ml)),this.otherCert=y(e,fl,ea.defaultValues(fl)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case ml:return N;case fl:return new Z;default:return super.defaultValues(e)}}static schema(e={}){const t=y(e,"names",{});return new I({name:t.blockName||N,value:[new W({name:t.otherCertFormat||ml}),new Z({name:t.otherCert||fl})]})}fromSchema(e){U(e,Fb);const t=K(e,e,ea.schema());j.assertSchema(t,this.className),this.otherCertFormat=t.result.otherCertFormat.valueBlock.toString(),this.otherCert=t.result.otherCert}toSchema(){return new I({value:[new W({value:this.otherCertFormat}),this.otherCert]})}toJSON(){const e={otherCertFormat:this.otherCertFormat};return this.otherCert instanceof Z||(e.otherCert=this.otherCert.toJSON()),e}}const pl="certificates",Jb=[pl];class fs extends ${constructor(e={}){super(),this.certificates=y(e,pl,fs.defaultValues(pl)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case pl:return[];default:return super.defaultValues(e)}}static schema(e={}){const t=y(e,"names",{});return new Fe({name:t.blockName||N,value:[new ee({name:t.certificates||pl,value:new Ne({value:[ue.schema(),new D({idBlock:{tagClass:3,tagNumber:0},value:[new Z]}),new D({idBlock:{tagClass:3,tagNumber:1},value:[new I]}),new D({idBlock:{tagClass:3,tagNumber:2},value:Tt.schema().valueBlock.value}),new D({idBlock:{tagClass:3,tagNumber:3},value:ea.schema().valueBlock.value})]})})]})}fromSchema(e){U(e,Jb);const t=K(e,e,fs.schema());j.assertSchema(t,this.className),this.certificates=Array.from(t.result.certificates||[],s=>{const a=s.idBlock.tagNumber;if(s.idBlock.tagClass===1)return new ue({schema:s});const u=new I({value:s.valueBlock.value});switch(a){case 1:return u.valueBlock.value[0].valueBlock.value[0].valueBlock.valueDec===1?new Tt({schema:u}):new Ts({schema:u});case 2:return new Tt({schema:u});case 3:return new ea({schema:u})}return s})}toSchema(){return new Fe({value:Array.from(this.certificates,e=>{switch(!0){case e instanceof ue:return e.toSchema();case e instanceof Ts:return new D({idBlock:{tagClass:3,tagNumber:1},value:e.toSchema().valueBlock.value});case e instanceof Tt:return new D({idBlock:{tagClass:3,tagNumber:2},value:e.toSchema().valueBlock.value});case e instanceof ea:return new D({idBlock:{tagClass:3,tagNumber:3},value:e.toSchema().valueBlock.value})}return e.toSchema()})})}toJSON(){return{certificates:Array.from(this.certificates,e=>e.toJSON())}}}fs.CLASS_NAME="CertificateSet";const dl="otherRevInfoFormat",gl="otherRevInfo",qb=[dl,gl];class Us extends ${constructor(e={}){super(),this.otherRevInfoFormat=y(e,dl,Us.defaultValues(dl)),this.otherRevInfo=y(e,gl,Us.defaultValues(gl)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case dl:return N;case gl:return new Z;default:return super.defaultValues(e)}}static schema(e={}){const t=y(e,"names",{});return new I({name:t.blockName||N,value:[new W({name:t.otherRevInfoFormat||dl}),new Z({name:t.otherRevInfo||gl})]})}fromSchema(e){U(e,qb);const t=K(e,e,Us.schema());j.assertSchema(t,this.className),this.otherRevInfoFormat=t.result.otherRevInfoFormat.valueBlock.toString(),this.otherRevInfo=t.result.otherRevInfo}toSchema(){return new I({value:[new W({value:this.otherRevInfoFormat}),this.otherRevInfo]})}toJSON(){const e={otherRevInfoFormat:this.otherRevInfoFormat};return this.otherRevInfo instanceof Z||(e.otherRevInfo=this.otherRevInfo.toJSON()),e}}Us.CLASS_NAME="OtherRevocationInfoFormat";const wl="crls",rf="otherRevocationInfos",Wb=[wl];class Ks extends ${constructor(e={}){super(),this.crls=y(e,wl,Ks.defaultValues(wl)),this.otherRevocationInfos=y(e,rf,Ks.defaultValues(rf)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case wl:return[];case rf:return[];default:return super.defaultValues(e)}}static schema(e={}){const t=y(e,"names",{});return new Fe({name:t.blockName||N,value:[new ee({name:t.crls||N,value:new Ne({value:[He.schema(),new D({idBlock:{tagClass:3,tagNumber:1},value:[new W,new Z]})]})})]})}fromSchema(e){U(e,Wb);const t=K(e,e,Ks.schema({names:{crls:wl}}));if(j.assertSchema(t,this.className),t.result.crls)for(const s of t.result.crls)s.idBlock.tagClass===1?this.crls.push(new He({schema:s})):this.otherRevocationInfos.push(new Us({schema:s}))}toSchema(){const e=[];return e.push(...Array.from(this.crls,t=>t.toSchema())),e.push(...Array.from(this.otherRevocationInfos,t=>{const s=t.toSchema();return s.idBlock.tagClass=3,s.idBlock.tagNumber=1,s})),new Fe({value:e})}toJSON(){return{crls:Array.from(this.crls,e=>e.toJSON()),otherRevocationInfos:Array.from(this.otherRevocationInfos,e=>e.toJSON())}}}Ks.CLASS_NAME="RevocationInfoChoices";const yl="certs",Fa="crls",Gb=[yl,Fa];class xn extends ${constructor(e={}){super(),this.crls=y(e,Fa,xn.defaultValues(Fa)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case yl:return new fs;case Fa:return new Ks;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case yl:return t.certificates.length===0;case Fa:return t.crls.length===0&&t.otherRevocationInfos.length===0;default:return super.defaultValues(e)}}static schema(e={}){const t=y(e,"names",{});return new I({name:t.blockName||N,value:[new D({name:t.certs||N,optional:!0,idBlock:{tagClass:3,tagNumber:0},value:fs.schema().valueBlock.value}),new D({name:t.crls||N,optional:!0,idBlock:{tagClass:3,tagNumber:1},value:Ks.schema().valueBlock.value})]})}fromSchema(e){U(e,Gb);const t=K(e,e,xn.schema({names:{certs:yl,crls:Fa}}));j.assertSchema(t,this.className),yl in t.result&&(this.certs=new fs({schema:new Fe({value:t.result.certs.valueBlock.value})})),Fa in t.result&&(this.crls=new Ks({schema:new Fe({value:t.result.crls.valueBlock.value})}))}toSchema(){const e=[];return this.certs&&e.push(new D({idBlock:{tagClass:3,tagNumber:0},value:this.certs.toSchema().valueBlock.value})),this.crls&&e.push(new D({idBlock:{tagClass:3,tagNumber:1},value:this.crls.toSchema().valueBlock.value})),new I({value:e})}toJSON(){const e={};return this.certs&&(e.certs=this.certs.toJSON()),this.crls&&(e.crls=this.crls.toJSON()),e}}xn.CLASS_NAME="OriginatorInfo";const vl="issuer",bl="serialNumber",_b=[vl,bl];class $e extends ${constructor(e={}){super(),this.issuer=y(e,vl,$e.defaultValues(vl)),this.serialNumber=y(e,bl,$e.defaultValues(bl)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case vl:return new fe;case bl:return new R;default:return super.defaultValues(e)}}static schema(e={}){const t=y(e,"names",{});return new I({name:t.blockName||N,value:[fe.schema(t.issuer||{}),new R({name:t.serialNumber||N})]})}fromSchema(e){U(e,_b);const t=K(e,e,$e.schema({names:{issuer:{names:{blockName:vl}},serialNumber:bl}}));j.assertSchema(t,this.className),this.issuer=new fe({schema:t.result.issuer}),this.serialNumber=t.result.serialNumber}toSchema(){return new I({value:[this.issuer.toSchema(),this.serialNumber]})}toJSON(){return{issuer:this.issuer.toJSON(),serialNumber:this.serialNumber.toJSON()}}}$e.CLASS_NAME="IssuerAndSerialNumber";const Ac="variant",$o="value",Xb=["blockName"];class yo extends ${constructor(e={}){super(),this.variant=y(e,Ac,yo.defaultValues(Ac)),$o in e&&(this.value=y(e,$o,yo.defaultValues($o))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Ac:return-1;case $o:return{};default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Ac:return t===-1;case $o:return Object.keys(t).length===0;default:return super.defaultValues(e)}}static schema(e={}){const t=y(e,"names",{});return new Ne({value:[$e.schema({names:{blockName:t.blockName||N}}),new Y({name:t.blockName||N,idBlock:{tagClass:3,tagNumber:0}})]})}fromSchema(e){U(e,Xb);const t=K(e,e,yo.schema({names:{blockName:"blockName"}}));j.assertSchema(t,this.className),t.result.blockName.idBlock.tagClass===1?(this.variant=1,this.value=new $e({schema:t.result.blockName})):(this.variant=2,this.value=new M({valueHex:t.result.blockName.valueBlock.valueHex}))}toSchema(){switch(this.variant){case 1:if(!(this.value instanceof $e))throw new Error("Incorrect type of RecipientIdentifier.value. It should be IssuerAndSerialNumber.");return this.value.toSchema();case 2:if(!(this.value instanceof M))throw new Error("Incorrect type of RecipientIdentifier.value. It should be ASN.1 OctetString.");return new Y({idBlock:{tagClass:3,tagNumber:0},valueHex:this.value.valueBlock.valueHexView});default:return new Z}}toJSON(){const e={variant:this.variant};return(this.variant===1||this.variant===2)&&this.value&&(e.value=this.value.toJSON()),e}}yo.CLASS_NAME="RecipientIdentifier";const Ja="version",ui="rid",li="keyEncryptionAlgorithm",ci="encryptedKey",Nc="recipientCertificate",zb=[Ja,ui,li,ci];class Vt extends ${constructor(e={}){super(),this.version=y(e,Ja,Vt.defaultValues(Ja)),this.rid=y(e,ui,Vt.defaultValues(ui)),this.keyEncryptionAlgorithm=y(e,li,Vt.defaultValues(li)),this.encryptedKey=y(e,ci,Vt.defaultValues(ci)),this.recipientCertificate=y(e,Nc,Vt.defaultValues(Nc)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Ja:return-1;case ui:return{};case li:return new T;case ci:return new M;case Nc:return new ue;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Ja:return t===Vt.defaultValues(Ja);case ui:return Object.keys(t).length===0;case li:case ci:return t.isEqual(Vt.defaultValues(e));case Nc:return!1;default:return super.defaultValues(e)}}static schema(e={}){const t=y(e,"names",{});return new I({name:t.blockName||N,value:[new R({name:t.version||N}),yo.schema(t.rid||{}),T.schema(t.keyEncryptionAlgorithm||{}),new M({name:t.encryptedKey||N})]})}fromSchema(e){U(e,zb);const t=K(e,e,Vt.schema({names:{version:Ja,rid:{names:{blockName:ui}},keyEncryptionAlgorithm:{names:{blockName:li}},encryptedKey:ci}}));j.assertSchema(t,this.className),this.version=t.result.version.valueBlock.valueDec,t.result.rid.idBlock.tagClass===3?this.rid=new M({valueHex:t.result.rid.valueBlock.valueHex}):this.rid=new $e({schema:t.result.rid}),this.keyEncryptionAlgorithm=new T({schema:t.result.keyEncryptionAlgorithm}),this.encryptedKey=t.result.encryptedKey}toSchema(){const e=[];return this.rid instanceof $e?(this.version=0,e.push(new R({value:this.version})),e.push(this.rid.toSchema())):(this.version=2,e.push(new R({value:this.version})),e.push(new Y({idBlock:{tagClass:3,tagNumber:0},valueHex:this.rid.valueBlock.valueHexView}))),e.push(this.keyEncryptionAlgorithm.toSchema()),e.push(this.encryptedKey),new I({value:e})}toJSON(){return{version:this.version,rid:this.rid.toJSON(),keyEncryptionAlgorithm:this.keyEncryptionAlgorithm.toJSON(),encryptedKey:this.encryptedKey.toJSON()}}}Vt.CLASS_NAME="KeyTransRecipientInfo";const hi="algorithm",mi="publicKey",Qb=[hi,mi];class js extends ${constructor(e={}){super(),this.algorithm=y(e,hi,js.defaultValues(hi)),this.publicKey=y(e,mi,js.defaultValues(mi)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case hi:return new T;case mi:return new ne;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case hi:case mi:return t.isEqual(js.defaultValues(e));default:return super.defaultValues(e)}}static schema(e={}){const t=y(e,"names",{});return new I({name:t.blockName||N,value:[T.schema(t.algorithm||{}),new ne({name:t.publicKey||N})]})}fromSchema(e){U(e,Qb);const t=K(e,e,js.schema({names:{algorithm:{names:{blockName:hi}},publicKey:mi}}));j.assertSchema(t,this.className),this.algorithm=new T({schema:t.result.algorithm}),this.publicKey=t.result.publicKey}toSchema(){return new I({value:[this.algorithm.toSchema(),this.publicKey]})}toJSON(){return{algorithm:this.algorithm.toJSON(),publicKey:this.publicKey.toJSON()}}}js.CLASS_NAME="OriginatorPublicKey";const kc="variant",Uo="value",Yb=["blockName"];class Hs extends ${constructor(e={}){super(),this.variant=y(e,kc,Hs.defaultValues(kc)),Uo in e&&(this.value=y(e,Uo,Hs.defaultValues(Uo))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case kc:return-1;case Uo:return{};default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case kc:return t===-1;case Uo:return Object.keys(t).length===0;default:return super.defaultValues(e)}}static schema(e={}){const t=y(e,"names",{});return new Ne({value:[$e.schema({names:{blockName:t.blockName||N}}),new Y({idBlock:{tagClass:3,tagNumber:0},name:t.blockName||N}),new D({idBlock:{tagClass:3,tagNumber:1},name:t.blockName||N,value:js.schema().valueBlock.value})]})}fromSchema(e){U(e,Yb);const t=K(e,e,Hs.schema({names:{blockName:"blockName"}}));j.assertSchema(t,this.className),t.result.blockName.idBlock.tagClass===1?(this.variant=1,this.value=new $e({schema:t.result.blockName})):t.result.blockName.idBlock.tagNumber===0?(t.result.blockName.idBlock.tagClass=1,t.result.blockName.idBlock.tagNumber=4,this.variant=2,this.value=t.result.blockName):(this.variant=3,this.value=new js({schema:new I({value:t.result.blockName.valueBlock.value})}))}toSchema(){switch(this.variant){case 1:return this.value.toSchema();case 2:return this.value.idBlock.tagClass=3,this.value.idBlock.tagNumber=0,this.value;case 3:{const e=this.value.toSchema();return e.idBlock.tagClass=3,e.idBlock.tagNumber=1,e}default:return new Z}}toJSON(){const e={variant:this.variant};return(this.variant===1||this.variant===2||this.variant===3)&&(e.value=this.value.toJSON()),e}}Hs.CLASS_NAME="OriginatorIdentifierOrKey";const fi="keyAttrId",os="keyAttr",Zb=[fi,os];class rs extends ${constructor(e={}){super(),this.keyAttrId=y(e,fi,rs.defaultValues(fi)),os in e&&(this.keyAttr=y(e,os,rs.defaultValues(os))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case fi:return N;case os:return{};default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case fi:return typeof t=="string"&&t===N;case os:return Object.keys(t).length===0;default:return super.defaultValues(e)}}static schema(e={}){const t=y(e,"names",{});return new I({optional:t.optional||!0,name:t.blockName||N,value:[new W({name:t.keyAttrId||N}),new Z({optional:!0,name:t.keyAttr||N})]})}fromSchema(e){U(e,Zb);const t=K(e,e,rs.schema({names:{keyAttrId:fi,keyAttr:os}}));j.assertSchema(t,this.className),this.keyAttrId=t.result.keyAttrId.valueBlock.toString(),os in t.result&&(this.keyAttr=t.result.keyAttr)}toSchema(){const e=[];return e.push(new W({value:this.keyAttrId})),os in this&&e.push(this.keyAttr),new I({value:e})}toJSON(){const e={keyAttrId:this.keyAttrId};return os in this&&(e.keyAttr=this.keyAttr.toJSON()),e}}rs.CLASS_NAME="OtherKeyAttribute";const qa="subjectKeyIdentifier",Sr="date",Ar="other",eS=[qa,Sr,Ar];class cs extends ${constructor(e={}){super(),this.subjectKeyIdentifier=y(e,qa,cs.defaultValues(qa)),Sr in e&&(this.date=y(e,Sr,cs.defaultValues(Sr))),Ar in e&&(this.other=y(e,Ar,cs.defaultValues(Ar))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case qa:return new M;case Sr:return new ke;case Ar:return new rs;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case qa:return t.isEqual(cs.defaultValues(qa));case Sr:return t.year===0&&t.month===0&&t.day===0&&t.hour===0&&t.minute===0&&t.second===0&&t.millisecond===0;case Ar:return t.keyAttrId===N&&!("keyAttr"in t);default:return super.defaultValues(e)}}static schema(e={}){const t=y(e,"names",{});return new I({name:t.blockName||N,value:[new M({name:t.subjectKeyIdentifier||N}),new ke({optional:!0,name:t.date||N}),rs.schema(t.other||{})]})}fromSchema(e){U(e,eS);const t=K(e,e,cs.schema({names:{subjectKeyIdentifier:qa,date:Sr,other:{names:{blockName:Ar}}}}));j.assertSchema(t,this.className),this.subjectKeyIdentifier=t.result.subjectKeyIdentifier,Sr in t.result&&(this.date=t.result.date),Ar in t.result&&(this.other=new rs({schema:t.result.other}))}toSchema(){const e=[];return e.push(this.subjectKeyIdentifier),this.date&&e.push(this.date),this.other&&e.push(this.other.toSchema()),new I({value:e})}toJSON(){const e={subjectKeyIdentifier:this.subjectKeyIdentifier.toJSON()};return this.date&&(e.date=this.date.toJSON()),this.other&&(e.other=this.other.toJSON()),e}}cs.CLASS_NAME="RecipientKeyIdentifier";const Ec="variant",Cc="value",tS=["blockName"];class ps extends ${constructor(e={}){super(),this.variant=y(e,Ec,ps.defaultValues(Ec)),this.value=y(e,Cc,ps.defaultValues(Cc)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Ec:return-1;case Cc:return{};default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Ec:return t===-1;case Cc:return Object.keys(t).length===0;default:return super.defaultValues(e)}}static schema(e={}){const t=y(e,"names",{});return new Ne({value:[$e.schema(t.issuerAndSerialNumber||{names:{blockName:t.blockName||N}}),new D({name:t.blockName||N,idBlock:{tagClass:3,tagNumber:0},value:cs.schema(t.rKeyId||{names:{blockName:t.blockName||N}}).valueBlock.value})]})}fromSchema(e){U(e,tS);const t=K(e,e,ps.schema({names:{blockName:"blockName"}}));j.assertSchema(t,this.className),t.result.blockName.idBlock.tagClass===1?(this.variant=1,this.value=new $e({schema:t.result.blockName})):(this.variant=2,this.value=new cs({schema:new I({value:t.result.blockName.valueBlock.value})}))}toSchema(){switch(this.variant){case 1:return this.value.toSchema();case 2:return new D({idBlock:{tagClass:3,tagNumber:0},value:this.value.toSchema().valueBlock.value});default:return new Z}}toJSON(){const e={variant:this.variant};return(this.variant===1||this.variant===2)&&(e.value=this.value.toJSON()),e}}ps.CLASS_NAME="KeyAgreeRecipientIdentifier";const pi="rid",Wa="encryptedKey",sS=[pi,Wa];class $s extends ${constructor(e={}){super(),this.rid=y(e,pi,$s.defaultValues(pi)),this.encryptedKey=y(e,Wa,$s.defaultValues(Wa)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case pi:return new ps;case Wa:return new M;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case pi:return t.variant===-1&&!("value"in t);case Wa:return t.isEqual($s.defaultValues(Wa));default:return super.defaultValues(e)}}static schema(e={}){const t=y(e,"names",{});return new I({name:t.blockName||N,value:[ps.schema(t.rid||{}),new M({name:t.encryptedKey||N})]})}fromSchema(e){U(e,sS);const t=K(e,e,$s.schema({names:{rid:{names:{blockName:pi}},encryptedKey:Wa}}));j.assertSchema(t,this.className),this.rid=new ps({schema:t.result.rid}),this.encryptedKey=t.result.encryptedKey}toSchema(){return new I({value:[this.rid.toSchema(),this.encryptedKey]})}toJSON(){return{rid:this.rid.toJSON(),encryptedKey:this.encryptedKey.toJSON()}}}$s.CLASS_NAME="RecipientEncryptedKey";const xc="encryptedKeys",Uw="RecipientEncryptedKeys",rS=[Uw];class ta extends ${constructor(e={}){super(),this.encryptedKeys=y(e,xc,ta.defaultValues(xc)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case xc:return[];default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case xc:return t.length===0;default:return super.defaultValues(e)}}static schema(e={}){const t=y(e,"names",{});return new I({name:t.blockName||N,value:[new ee({name:t.RecipientEncryptedKeys||N,value:$s.schema()})]})}fromSchema(e){U(e,rS);const t=K(e,e,ta.schema({names:{RecipientEncryptedKeys:Uw}}));j.assertSchema(t,this.className),this.encryptedKeys=Array.from(t.result.RecipientEncryptedKeys,s=>new $s({schema:s}))}toSchema(){return new I({value:Array.from(this.encryptedKeys,e=>e.toSchema())})}toJSON(){return{encryptedKeys:Array.from(this.encryptedKeys,e=>e.toJSON())}}}ta.CLASS_NAME="RecipientEncryptedKeys";const di="version",gi="originator",ks="ukm",wi="keyEncryptionAlgorithm",yi="recipientEncryptedKeys",Ic="recipientCertificate",Vc="recipientPublicKey",aS=[di,gi,ks,wi,yi];class Et extends ${constructor(e={}){super(),this.version=y(e,di,Et.defaultValues(di)),this.originator=y(e,gi,Et.defaultValues(gi)),ks in e&&(this.ukm=y(e,ks,Et.defaultValues(ks))),this.keyEncryptionAlgorithm=y(e,wi,Et.defaultValues(wi)),this.recipientEncryptedKeys=y(e,yi,Et.defaultValues(yi)),this.recipientCertificate=y(e,Ic,Et.defaultValues(Ic)),this.recipientPublicKey=y(e,Vc,Et.defaultValues(Vc)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case di:return 0;case gi:return new Hs;case ks:return new M;case wi:return new T;case yi:return new ta;case Ic:return new ue;case Vc:return null;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case di:return t===0;case gi:return t.variant===-1&&!("value"in t);case ks:return t.isEqual(Et.defaultValues(ks));case wi:return t.algorithmId===N&&!("algorithmParams"in t);case yi:return t.encryptedKeys.length===0;case Ic:return!1;case Vc:return!1;default:return super.defaultValues(e)}}static schema(e={}){const t=y(e,"names",{});return new I({name:t.blockName||N,value:[new R({name:t.version||N}),new D({idBlock:{tagClass:3,tagNumber:0},value:[Hs.schema(t.originator||{})]}),new D({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[new M({name:t.ukm||N})]}),T.schema(t.keyEncryptionAlgorithm||{}),ta.schema(t.recipientEncryptedKeys||{})]})}fromSchema(e){U(e,aS);const t=K(e,e,Et.schema({names:{version:di,originator:{names:{blockName:gi}},ukm:ks,keyEncryptionAlgorithm:{names:{blockName:wi}},recipientEncryptedKeys:{names:{blockName:yi}}}}));j.assertSchema(t,this.className),this.version=t.result.version.valueBlock.valueDec,this.originator=new Hs({schema:t.result.originator}),ks in t.result&&(this.ukm=t.result.ukm),this.keyEncryptionAlgorithm=new T({schema:t.result.keyEncryptionAlgorithm}),this.recipientEncryptedKeys=new ta({schema:t.result.recipientEncryptedKeys})}toSchema(){const e=[];return e.push(new R({value:this.version})),e.push(new D({idBlock:{tagClass:3,tagNumber:0},value:[this.originator.toSchema()]})),this.ukm&&e.push(new D({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[this.ukm]})),e.push(this.keyEncryptionAlgorithm.toSchema()),e.push(this.recipientEncryptedKeys.toSchema()),new I({value:e})}toJSON(){const e={version:this.version,originator:this.originator.toJSON(),keyEncryptionAlgorithm:this.keyEncryptionAlgorithm.toJSON(),recipientEncryptedKeys:this.recipientEncryptedKeys.toJSON()};return this.ukm&&(e.ukm=this.ukm.toJSON()),e}}Et.CLASS_NAME="KeyAgreeRecipientInfo";const Ga="keyIdentifier",Nr="date",kr="other",nS=[Ga,Nr,kr];class es extends ${constructor(e={}){super(),this.keyIdentifier=y(e,Ga,es.defaultValues(Ga)),Nr in e&&(this.date=y(e,Nr,es.defaultValues(Nr))),kr in e&&(this.other=y(e,kr,es.defaultValues(kr))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Ga:return new M;case Nr:return new ke;case kr:return new rs;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Ga:return t.isEqual(es.defaultValues(Ga));case Nr:return t.year===0&&t.month===0&&t.day===0&&t.hour===0&&t.minute===0&&t.second===0&&t.millisecond===0;case kr:return t.compareWithDefault("keyAttrId",t.keyAttrId)&&!("keyAttr"in t);default:return super.defaultValues(e)}}static schema(e={}){const t=y(e,"names",{});return new I({name:t.blockName||N,value:[new M({name:t.keyIdentifier||N}),new ke({optional:!0,name:t.date||N}),rs.schema(t.other||{})]})}fromSchema(e){U(e,nS);const t=K(e,e,es.schema({names:{keyIdentifier:Ga,date:Nr,other:{names:{blockName:kr}}}}));j.assertSchema(t,this.className),this.keyIdentifier=t.result.keyIdentifier,Nr in t.result&&(this.date=t.result.date),kr in t.result&&(this.other=new rs({schema:t.result.other}))}toSchema(){const e=[];return e.push(this.keyIdentifier),this.date&&e.push(this.date),this.other&&e.push(this.other.toSchema()),new I({value:e})}toJSON(){const e={keyIdentifier:this.keyIdentifier.toJSON()};return this.date&&(e.date=this.date),this.other&&(e.other=this.other.toJSON()),e}}es.CLASS_NAME="KEKIdentifier";const vi="version",bi="kekid",Si="keyEncryptionAlgorithm",_a="encryptedKey",Pc="preDefinedKEK",iS=[vi,bi,Si,_a];class Pt extends ${constructor(e={}){super(),this.version=y(e,vi,Pt.defaultValues(vi)),this.kekid=y(e,bi,Pt.defaultValues(bi)),this.keyEncryptionAlgorithm=y(e,Si,Pt.defaultValues(Si)),this.encryptedKey=y(e,_a,Pt.defaultValues(_a)),this.preDefinedKEK=y(e,Pc,Pt.defaultValues(Pc)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case vi:return 0;case bi:return new es;case Si:return new T;case _a:return new M;case Pc:return Le;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case"KEKRecipientInfo":return t===Pt.defaultValues(vi);case bi:return t.compareWithDefault("keyIdentifier",t.keyIdentifier)&&!("date"in t)&&!("other"in t);case Si:return t.algorithmId===N&&!("algorithmParams"in t);case _a:return t.isEqual(Pt.defaultValues(_a));case Pc:return t.byteLength===0;default:return super.defaultValues(e)}}static schema(e={}){const t=y(e,"names",{});return new I({name:t.blockName||N,value:[new R({name:t.version||N}),es.schema(t.kekid||{}),T.schema(t.keyEncryptionAlgorithm||{}),new M({name:t.encryptedKey||N})]})}fromSchema(e){U(e,iS);const t=K(e,e,Pt.schema({names:{version:vi,kekid:{names:{blockName:bi}},keyEncryptionAlgorithm:{names:{blockName:Si}},encryptedKey:_a}}));j.assertSchema(t,this.className),this.version=t.result.version.valueBlock.valueDec,this.kekid=new es({schema:t.result.kekid}),this.keyEncryptionAlgorithm=new T({schema:t.result.keyEncryptionAlgorithm}),this.encryptedKey=t.result.encryptedKey}toSchema(){return new I({value:[new R({value:this.version}),this.kekid.toSchema(),this.keyEncryptionAlgorithm.toSchema(),this.encryptedKey]})}toJSON(){return{version:this.version,kekid:this.kekid.toJSON(),keyEncryptionAlgorithm:this.keyEncryptionAlgorithm.toJSON(),encryptedKey:this.encryptedKey.toJSON()}}}Pt.CLASS_NAME="KEKRecipientInfo";const Ai="version",Er="keyDerivationAlgorithm",Ni="keyEncryptionAlgorithm",Xa="encryptedKey",Oc="password",oS=[Ai,Er,Ni,Xa];class Kt extends ${constructor(e={}){super(),this.version=y(e,Ai,Kt.defaultValues(Ai)),Er in e&&(this.keyDerivationAlgorithm=y(e,Er,Kt.defaultValues(Er))),this.keyEncryptionAlgorithm=y(e,Ni,Kt.defaultValues(Ni)),this.encryptedKey=y(e,Xa,Kt.defaultValues(Xa)),this.password=y(e,Oc,Kt.defaultValues(Oc)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Ai:return-1;case Er:return new T;case Ni:return new T;case Xa:return new M;case Oc:return Le;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Ai:return t===-1;case Er:case Ni:return t.algorithmId===N&&!("algorithmParams"in t);case Xa:return t.isEqual(Kt.defaultValues(Xa));case Oc:return t.byteLength===0;default:return super.defaultValues(e)}}static schema(e={}){const t=y(e,"names",{});return new I({name:t.blockName||N,value:[new R({name:t.version||N}),new D({name:t.keyDerivationAlgorithm||N,optional:!0,idBlock:{tagClass:3,tagNumber:0},value:T.schema().valueBlock.value}),T.schema(t.keyEncryptionAlgorithm||{}),new M({name:t.encryptedKey||N})]})}fromSchema(e){U(e,oS);const t=K(e,e,Kt.schema({names:{version:Ai,keyDerivationAlgorithm:Er,keyEncryptionAlgorithm:{names:{blockName:Ni}},encryptedKey:Xa}}));j.assertSchema(t,this.className),this.version=t.result.version.valueBlock.valueDec,Er in t.result&&(this.keyDerivationAlgorithm=new T({schema:new I({value:t.result.keyDerivationAlgorithm.valueBlock.value})})),this.keyEncryptionAlgorithm=new T({schema:t.result.keyEncryptionAlgorithm}),this.encryptedKey=t.result.encryptedKey}toSchema(){const e=[];return e.push(new R({value:this.version})),this.keyDerivationAlgorithm&&e.push(new D({idBlock:{tagClass:3,tagNumber:0},value:this.keyDerivationAlgorithm.toSchema().valueBlock.value})),e.push(this.keyEncryptionAlgorithm.toSchema()),e.push(this.encryptedKey),new I({value:e})}toJSON(){const e={version:this.version,keyEncryptionAlgorithm:this.keyEncryptionAlgorithm.toJSON(),encryptedKey:this.encryptedKey.toJSON()};return this.keyDerivationAlgorithm&&(e.keyDerivationAlgorithm=this.keyDerivationAlgorithm.toJSON()),e}}Kt.CLASS_NAME="PasswordRecipientInfo";const ki="oriType",za="oriValue",uS=[ki,za];class Qr extends ${constructor(e={}){super(),this.oriType=y(e,ki,Qr.defaultValues(ki)),this.oriValue=y(e,za,Qr.defaultValues(za)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case ki:return N;case za:return{};default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case ki:return t===N;case za:return Object.keys(t).length===0;default:return super.defaultValues(e)}}static schema(e={}){const t=y(e,"names",{});return new I({name:t.blockName||N,value:[new W({name:t.oriType||N}),new Z({name:t.oriValue||N})]})}fromSchema(e){U(e,uS);const t=K(e,e,Qr.schema({names:{oriType:ki,oriValue:za}}));j.assertSchema(t,this.className),this.oriType=t.result.oriType.valueBlock.toString(),this.oriValue=t.result.oriValue}toSchema(){return new I({value:[new W({value:this.oriType}),this.oriValue]})}toJSON(){const e={oriType:this.oriType};return Qr.compareWithDefault(za,this.oriValue)||(e.oriValue=this.oriValue.toJSON()),e}}Qr.CLASS_NAME="OtherRecipientInfo";const Bc="variant",Ko="value",lS=["blockName"];class Mt extends ${constructor(e={}){super(),this.variant=y(e,Bc,Mt.defaultValues(Bc)),Ko in e&&(this.value=y(e,Ko,Mt.defaultValues(Ko))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Bc:return-1;case Ko:return{};default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Bc:return t===Mt.defaultValues(e);case Ko:return Object.keys(t).length===0;default:return super.defaultValues(e)}}static schema(e={}){const t=y(e,"names",{});return new Ne({value:[Vt.schema({names:{blockName:t.blockName||N}}),new D({name:t.blockName||N,idBlock:{tagClass:3,tagNumber:1},value:Et.schema().valueBlock.value}),new D({name:t.blockName||N,idBlock:{tagClass:3,tagNumber:2},value:Pt.schema().valueBlock.value}),new D({name:t.blockName||N,idBlock:{tagClass:3,tagNumber:3},value:Kt.schema().valueBlock.value}),new D({name:t.blockName||N,idBlock:{tagClass:3,tagNumber:4},value:Qr.schema().valueBlock.value})]})}fromSchema(e){U(e,lS);const t=K(e,e,Mt.schema({names:{blockName:"blockName"}}));if(j.assertSchema(t,this.className),t.result.blockName.idBlock.tagClass===1)this.variant=1,this.value=new Vt({schema:t.result.blockName});else{const s=new I({value:t.result.blockName.valueBlock.value});switch(t.result.blockName.idBlock.tagNumber){case 1:this.variant=2,this.value=new Et({schema:s});break;case 2:this.variant=3,this.value=new Pt({schema:s});break;case 3:this.variant=4,this.value=new Kt({schema:s});break;case 4:this.variant=5,this.value=new Qr({schema:s});break;default:throw new Error("Incorrect structure of RecipientInfo block")}}}toSchema(){ie.assertEmpty(this.value,"value","RecipientInfo");const e=this.value.toSchema();switch(this.variant){case 1:return e;case 2:case 3:case 4:return e.idBlock.tagClass=3,e.idBlock.tagNumber=this.variant-1,e;default:return new Z}}toJSON(){const e={variant:this.variant};return this.value&&this.variant>=1&&this.variant<=4&&(e.value=this.value.toJSON()),e}}Mt.CLASS_NAME="RecipientInfo";const Cr="hashAlgorithm",xr="maskGenAlgorithm",Ir="pSourceAlgorithm",cS=[Cr,xr,Ir];class gt extends ${constructor(e={}){super(),this.hashAlgorithm=y(e,Cr,gt.defaultValues(Cr)),this.maskGenAlgorithm=y(e,xr,gt.defaultValues(xr)),this.pSourceAlgorithm=y(e,Ir,gt.defaultValues(Ir)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Cr:return new T({algorithmId:"1.3.14.3.2.26",algorithmParams:new Me});case xr:return new T({algorithmId:"1.2.840.113549.1.1.8",algorithmParams:new T({algorithmId:"1.3.14.3.2.26",algorithmParams:new Me}).toSchema()});case Ir:return new T({algorithmId:"1.2.840.113549.1.1.9",algorithmParams:new M({valueHex:new Uint8Array([218,57,163,238,94,107,75,13,50,85,191,239,149,96,24,144,175,216,7,9]).buffer})});default:return super.defaultValues(e)}}static schema(e={}){const t=y(e,"names",{});return new I({name:t.blockName||N,value:[new D({idBlock:{tagClass:3,tagNumber:0},optional:!0,value:[T.schema(t.hashAlgorithm||{})]}),new D({idBlock:{tagClass:3,tagNumber:1},optional:!0,value:[T.schema(t.maskGenAlgorithm||{})]}),new D({idBlock:{tagClass:3,tagNumber:2},optional:!0,value:[T.schema(t.pSourceAlgorithm||{})]})]})}fromSchema(e){U(e,cS);const t=K(e,e,gt.schema({names:{hashAlgorithm:{names:{blockName:Cr}},maskGenAlgorithm:{names:{blockName:xr}},pSourceAlgorithm:{names:{blockName:Ir}}}}));j.assertSchema(t,this.className),Cr in t.result&&(this.hashAlgorithm=new T({schema:t.result.hashAlgorithm})),xr in t.result&&(this.maskGenAlgorithm=new T({schema:t.result.maskGenAlgorithm})),Ir in t.result&&(this.pSourceAlgorithm=new T({schema:t.result.pSourceAlgorithm}))}toSchema(){const e=[];return this.hashAlgorithm.isEqual(gt.defaultValues(Cr))||e.push(new D({idBlock:{tagClass:3,tagNumber:0},value:[this.hashAlgorithm.toSchema()]})),this.maskGenAlgorithm.isEqual(gt.defaultValues(xr))||e.push(new D({idBlock:{tagClass:3,tagNumber:1},value:[this.maskGenAlgorithm.toSchema()]})),this.pSourceAlgorithm.isEqual(gt.defaultValues(Ir))||e.push(new D({idBlock:{tagClass:3,tagNumber:2},value:[this.pSourceAlgorithm.toSchema()]})),new I({value:e})}toJSON(){const e={};return this.hashAlgorithm.isEqual(gt.defaultValues(Cr))||(e.hashAlgorithm=this.hashAlgorithm.toJSON()),this.maskGenAlgorithm.isEqual(gt.defaultValues(xr))||(e.maskGenAlgorithm=this.maskGenAlgorithm.toJSON()),this.pSourceAlgorithm.isEqual(gt.defaultValues(Ir))||(e.pSourceAlgorithm=this.pSourceAlgorithm.toJSON()),e}}gt.CLASS_NAME="RSAESOAEPParams";const Ei="keyInfo",Vr="entityUInfo",Ci="suppPubInfo",hS=[Ei,Vr,Ci];class Os extends ${constructor(e={}){super(),this.keyInfo=y(e,Ei,Os.defaultValues(Ei)),Vr in e&&(this.entityUInfo=y(e,Vr,Os.defaultValues(Vr))),this.suppPubInfo=y(e,Ci,Os.defaultValues(Ci)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Ei:return new T;case Vr:return new M;case Ci:return new M;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Ei:case Vr:case Ci:return t.isEqual(Os.defaultValues(e));default:return super.defaultValues(e)}}static schema(e={}){const t=y(e,"names",{});return new I({name:t.blockName||N,value:[T.schema(t.keyInfo||{}),new D({name:t.entityUInfo||N,idBlock:{tagClass:3,tagNumber:0},optional:!0,value:[new M]}),new D({name:t.suppPubInfo||N,idBlock:{tagClass:3,tagNumber:2},value:[new M]})]})}fromSchema(e){U(e,hS);const t=K(e,e,Os.schema({names:{keyInfo:{names:{blockName:Ei}},entityUInfo:Vr,suppPubInfo:Ci}}));j.assertSchema(t,this.className),this.keyInfo=new T({schema:t.result.keyInfo}),Vr in t.result&&(this.entityUInfo=t.result.entityUInfo.valueBlock.value[0]),this.suppPubInfo=t.result.suppPubInfo.valueBlock.value[0]}toSchema(){const e=[];return e.push(this.keyInfo.toSchema()),this.entityUInfo&&e.push(new D({idBlock:{tagClass:3,tagNumber:0},value:[this.entityUInfo]})),e.push(new D({idBlock:{tagClass:3,tagNumber:2},value:[this.suppPubInfo]})),new I({value:e})}toJSON(){const e={keyInfo:this.keyInfo.toJSON(),suppPubInfo:this.suppPubInfo.toJSON()};return this.entityUInfo&&(e.entityUInfo=this.entityUInfo.toJSON()),e}}Os.CLASS_NAME="ECCCMSSharedInfo";const xi="version",Pr="originatorInfo",Ii="recipientInfos",Vi="encryptedContentInfo",Or="unprotectedAttrs",mS=[xi,Pr,Ii,Vi,Or],wg={kdfAlgorithm:"SHA-512",kekEncryptionLength:256},fS={"P-256":256,"P-384":384,"P-521":528};class Yt extends ${constructor(e={}){super(),this.version=y(e,xi,Yt.defaultValues(xi)),Pr in e&&(this.originatorInfo=y(e,Pr,Yt.defaultValues(Pr))),this.recipientInfos=y(e,Ii,Yt.defaultValues(Ii)),this.encryptedContentInfo=y(e,Vi,Yt.defaultValues(Vi)),Or in e&&(this.unprotectedAttrs=y(e,Or,Yt.defaultValues(Or))),this.policy={disableSplit:!!e.disableSplit},e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case xi:return 0;case Pr:return new xn;case Ii:return[];case Vi:return new Oe;case Or:return[];default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case xi:return t===Yt.defaultValues(e);case Pr:return t.certs.certificates.length===0&&t.crls.crls.length===0;case Ii:case Or:return t.length===0;case Vi:return Oe.compareWithDefault("contentType",t.contentType)&&Oe.compareWithDefault("contentEncryptionAlgorithm",t.contentEncryptionAlgorithm)&&Oe.compareWithDefault("encryptedContent",t.encryptedContent);default:return super.defaultValues(e)}}static schema(e={}){const t=y(e,"names",{});return new I({name:t.blockName||N,value:[new R({name:t.version||N}),new D({name:t.originatorInfo||N,optional:!0,idBlock:{tagClass:3,tagNumber:0},value:xn.schema().valueBlock.value}),new Fe({value:[new ee({name:t.recipientInfos||N,value:Mt.schema()})]}),Oe.schema(t.encryptedContentInfo||{}),new D({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[new ee({name:t.unprotectedAttrs||N,value:we.schema()})]})]})}fromSchema(e){U(e,mS);const t=K(e,e,Yt.schema({names:{version:xi,originatorInfo:Pr,recipientInfos:Ii,encryptedContentInfo:{names:{blockName:Vi}},unprotectedAttrs:Or}}));j.assertSchema(t,this.className),this.version=t.result.version.valueBlock.valueDec,Pr in t.result&&(this.originatorInfo=new xn({schema:new I({value:t.result.originatorInfo.valueBlock.value})})),this.recipientInfos=Array.from(t.result.recipientInfos,s=>new Mt({schema:s})),this.encryptedContentInfo=new Oe({schema:t.result.encryptedContentInfo}),Or in t.result&&(this.unprotectedAttrs=Array.from(t.result.unprotectedAttrs,s=>new we({schema:s})))}toSchema(){const e=[];return e.push(new R({value:this.version})),this.originatorInfo&&e.push(new D({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:this.originatorInfo.toSchema().valueBlock.value})),e.push(new Fe({value:Array.from(this.recipientInfos,t=>t.toSchema())})),e.push(this.encryptedContentInfo.toSchema()),this.unprotectedAttrs&&e.push(new D({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:Array.from(this.unprotectedAttrs,t=>t.toSchema())})),new I({value:e})}toJSON(){const e={version:this.version,recipientInfos:Array.from(this.recipientInfos,t=>t.toJSON()),encryptedContentInfo:this.encryptedContentInfo.toJSON()};return this.originatorInfo&&(e.originatorInfo=this.originatorInfo.toJSON()),this.unprotectedAttrs&&(e.unprotectedAttrs=Array.from(this.unprotectedAttrs,t=>t.toJSON())),e}addRecipientByCertificate(e,t,s,a=te(!0)){const u=Object.assign({useOAEP:!0,oaepHashAlgorithm:"SHA-512"},wg,t||{});if(e.subjectPublicKeyInfo.algorithm.algorithmId.indexOf("1.2.840.113549")!==-1)s=1;else if(e.subjectPublicKeyInfo.algorithm.algorithmId.indexOf("1.2.840.10045")!==-1)s=2;else throw new Error("Unknown type of certificate's public key: ".concat(e.subjectPublicKeyInfo.algorithm.algorithmId));switch(s){case 1:{let c,i;if(u.useOAEP===!0){c=a.getOIDByAlgorithm({name:"RSA-OAEP"},!0,"keyEncryptionAlgorithm");const n=a.getOIDByAlgorithm({name:u.oaepHashAlgorithm},!0,"RSAES-OAEP-params"),l=new T({algorithmId:n,algorithmParams:new Me});i=new gt({hashAlgorithm:l,maskGenAlgorithm:new T({algorithmId:"1.2.840.113549.1.1.8",algorithmParams:l.toSchema()})}).toSchema()}else{if(c=a.getOIDByAlgorithm({name:"RSAES-PKCS1-v1_5"}),c===N)throw new Error("Can not find OID for RSAES-PKCS1-v1_5");i=new Me}const o=new Vt({version:0,rid:new $e({issuer:e.issuer,serialNumber:e.serialNumber}),keyEncryptionAlgorithm:new T({algorithmId:c,algorithmParams:i}),recipientCertificate:e});this.recipientInfos.push(new Mt({variant:1,value:o}))}break;case 2:{const c=new ps({variant:1,value:new $e({issuer:e.issuer,serialNumber:e.serialNumber})});this._addKeyAgreeRecipientInfo(c,u,{recipientCertificate:e},a)}break;default:throw new Error('Unknown "variant" value: '.concat(s))}return!0}addRecipientByPreDefinedData(e,t={},s,a=te(!0)){if(me.assert(e,"preDefinedData","ArrayBuffer"),!e.byteLength)throw new Error("Pre-defined data could have zero length");if(!t.keyIdentifier){const u=new ArrayBuffer(16),c=new Uint8Array(u);a.getRandomValues(c),t.keyIdentifier=u}switch(t.hmacHashAlgorithm||(t.hmacHashAlgorithm="SHA-512"),t.iterationCount===void 0&&(t.iterationCount=2048),t.keyEncryptionAlgorithm||(t.keyEncryptionAlgorithm={name:"AES-KW",length:256}),t.keyEncryptionAlgorithmParams||(t.keyEncryptionAlgorithmParams=new Me),s){case 1:{const u=a.getOIDByAlgorithm(t.keyEncryptionAlgorithm,!0,"keyEncryptionAlgorithm"),c=new Pt({version:4,kekid:new es({keyIdentifier:new M({valueHex:t.keyIdentifier})}),keyEncryptionAlgorithm:new T({algorithmId:u,algorithmParams:t.keyEncryptionAlgorithmParams}),preDefinedKEK:e});this.recipientInfos.push(new Mt({variant:3,value:c}))}break;case 2:{const u=a.getOIDByAlgorithm({name:"PBKDF2"},!0,"keyDerivationAlgorithm"),c=new ArrayBuffer(64),i=new Uint8Array(c);a.getRandomValues(i);const o=a.getOIDByAlgorithm({name:"HMAC",hash:{name:t.hmacHashAlgorithm}},!0,"hmacHashAlgorithm"),n=new ht({salt:new M({valueHex:c}),iterationCount:t.iterationCount,prf:new T({algorithmId:o,algorithmParams:new Me})}),l=a.getOIDByAlgorithm(t.keyEncryptionAlgorithm,!0,"keyEncryptionAlgorithm"),m=new Kt({version:0,keyDerivationAlgorithm:new T({algorithmId:u,algorithmParams:n.toSchema()}),keyEncryptionAlgorithm:new T({algorithmId:l,algorithmParams:t.keyEncryptionAlgorithmParams}),password:e});this.recipientInfos.push(new Mt({variant:4,value:m}))}break;default:throw new Error('Unknown value for "variant": '.concat(s))}}addRecipientByKeyIdentifier(e,t,s,a=te(!0)){const u=Object.assign({},wg,s||{}),c=new ps({variant:2,value:new cs({subjectKeyIdentifier:new M({valueHex:t})})});this._addKeyAgreeRecipientInfo(c,u,{recipientPublicKey:e},a)}_addKeyAgreeRecipientInfo(e,t,s,a=te(!0)){const u=new $s({rid:e}),c=a.getOIDByAlgorithm({name:"AES-KW",length:t.kekEncryptionLength},!0,"keyEncryptionAlgorithm"),i=new T({algorithmId:c}),o=a.getOIDByAlgorithm({name:"ECDH",kdf:t.kdfAlgorithm},!0,"KeyAgreeRecipientInfo"),n=new ArrayBuffer(64),l=new Uint8Array(n);a.getRandomValues(l);const m={version:3,ukm:new M({valueHex:n}),keyEncryptionAlgorithm:new T({algorithmId:o,algorithmParams:i.toSchema()}),recipientEncryptedKeys:new ta({encryptedKeys:[u]})},h=new Et(Object.assign(m,s));this.recipientInfos.push(new Mt({variant:2,value:h}))}async encrypt(e,t,s=te(!0)){const a=new ArrayBuffer(16),u=new Uint8Array(a);s.getRandomValues(u);const c=new Uint8Array(t),i=s.getOIDByAlgorithm(e,!0,"contentEncryptionAlgorithm"),o=await s.generateKey(e,!0,["encrypt"]),n=await s.encrypt({name:e.name,iv:u},o,c),l=await s.exportKey("raw",o);this.version=2,this.encryptedContentInfo=new Oe({disableSplit:this.policy.disableSplit,contentType:"1.2.840.113549.1.7.1",contentEncryptionAlgorithm:new T({algorithmId:i,algorithmParams:new M({valueHex:a})}),encryptedContent:new M({valueHex:n})});const m=async b=>{const d=this.recipientInfos[b].value;let f,A;if(d.recipientPublicKey)f=d.recipientPublicKey.algorithm.namedCurve,A=d.recipientPublicKey;else if(d.recipientCertificate){const X=d.recipientCertificate.subjectPublicKeyInfo.algorithm.algorithmParams;if(X.constructor.blockName()!==W.blockName())throw new Error('Incorrect "recipientCertificate" for index '.concat(b));switch(X.valueBlock.toString()){case"1.2.840.10045.3.1.7":f="P-256";break;case"1.3.132.0.34":f="P-384";break;case"1.3.132.0.35":f="P-521";break;default:throw new Error("Incorrect curve OID for index ".concat(b))}A=await d.recipientCertificate.getPublicKey({algorithm:{algorithm:{name:"ECDH",namedCurve:f},usages:[]}},s)}else throw new Error("Unsupported RecipientInfo");const C=fS[f],S=await s.generateKey({name:"ECDH",namedCurve:f},!0,["deriveBits"]),v=await s.exportKey("spki",S.publicKey),E=await s.deriveBits({name:"ECDH",public:A},S.privateKey,C),k=new T({schema:d.keyEncryptionAlgorithm.algorithmParams}),x=s.getAlgorithmByOID(k.algorithmId,!0,"aesKWAlgorithm");let V=x.length;const O=new ArrayBuffer(4),P=new Uint8Array(O);for(let X=3;X>=0;X--)P[X]=V,V>>=8;const B=new Os({keyInfo:new T({algorithmId:k.algorithmId}),entityUInfo:d.ukm,suppPubInfo:new M({valueHex:O})}).toSchema().toBER(!1),L=s.getAlgorithmByOID(d.keyEncryptionAlgorithm.algorithmId,!0,"ecdhAlgorithm"),H=await ag(L.kdf,E,x.length,B,s),z=await s.importKey("raw",H,{name:"AES-KW"},!0,["wrapKey"]),re=await s.wrapKey("raw",o,z,{name:"AES-KW"}),_=new Hs;return _.variant=3,_.value=js.fromBER(v),d.originator=_,d.recipientEncryptedKeys.encryptedKeys[0].encryptedKey=new M({valueHex:re}),{ecdhPrivateKey:S.privateKey}},h=async b=>{const d=this.recipientInfos[b].value,f=s.getAlgorithmByOID(d.keyEncryptionAlgorithm.algorithmId,!0,"keyEncryptionAlgorithm");if(f.name==="RSA-OAEP"){const A=d.keyEncryptionAlgorithm.algorithmParams,C=new gt({schema:A});if(f.hash=s.getAlgorithmByOID(C.hashAlgorithm.algorithmId),!("name"in f.hash))throw new Error("Incorrect OID for hash algorithm: ".concat(C.hashAlgorithm.algorithmId))}try{const A=await d.recipientCertificate.getPublicKey({algorithm:{algorithm:f,usages:["encrypt","wrapKey"]}},s),C=await s.encrypt(A.algorithm,A,l);d.encryptedKey=new M({valueHex:C})}catch(A){}},g=async b=>{const d=this.recipientInfos[b].value,f=s.getAlgorithmByOID(d.keyEncryptionAlgorithm.algorithmId,!0,"kekAlgorithm"),A=await s.importKey("raw",new Uint8Array(d.preDefinedKEK),f,!0,["wrapKey"]),C=await s.wrapKey("raw",o,A,f);d.encryptedKey=new M({valueHex:C})},p=async b=>{const d=this.recipientInfos[b].value;let f;if(!d.keyDerivationAlgorithm)throw new Error('Please append encoded "keyDerivationAlgorithm"');if(!d.keyDerivationAlgorithm.algorithmParams)throw new Error('Incorrectly encoded "keyDerivationAlgorithm"');try{f=new ht({schema:d.keyDerivationAlgorithm.algorithmParams})}catch(O){throw new Error('Incorrectly encoded "keyDerivationAlgorithm"')}const A=new Uint8Array(d.password),C=await s.importKey("raw",A,"PBKDF2",!1,["deriveKey"]),S=s.getAlgorithmByOID(d.keyEncryptionAlgorithm.algorithmId,!0,"kekAlgorithm");let v="SHA-1";f.prf&&(v=s.getAlgorithmByOID(f.prf.algorithmId,!0,"prfAlgorithm").hash.name);const E=new Uint8Array(f.salt.valueBlock.valueHex),k=f.iterationCount,x=await s.deriveKey({name:"PBKDF2",hash:{name:v},salt:E,iterations:k},C,S,!0,["wrapKey"]),V=await s.wrapKey("raw",o,x,S);d.encryptedKey=new M({valueHex:V})},w=[];for(let b=0;b<this.recipientInfos.length;b++)switch(this.recipientInfos[b].variant){case 1:w.push(await h(b));break;case 2:w.push(await m(b));break;case 3:w.push(await g(b));break;case 4:w.push(await p(b));break;default:throw new Error("Unknown recipient type in array with index ".concat(b))}return w}async decrypt(e,t,s=te(!0)){const a=t||{};if(e+1>this.recipientInfos.length)throw new Error('Maximum value for "index" is: '.concat(this.recipientInfos.length-1));const u=async w=>{const b=this.recipientInfos[w].value;let d,f,A;const C=b.originator;if(a.recipientCertificate){const H=a.recipientCertificate.subjectPublicKeyInfo.algorithm.algorithmParams;if(H.constructor.blockName()!==W.blockName())throw new Error('Incorrect "recipientCertificate" for index '.concat(w));d=H.valueBlock.toString()}else if(C.value.algorithm.algorithmParams){const H=C.value.algorithm.algorithmParams;if(H.constructor.blockName()!==W.blockName())throw new Error("Incorrect originator for index ".concat(w));d=H.valueBlock.toString()}else throw new Error('Parameter "recipientCertificate" is mandatory for "KeyAgreeRecipientInfo" if algorithm params are missing from originator');if(!a.recipientPrivateKey)throw new Error('Parameter "recipientPrivateKey" is mandatory for "KeyAgreeRecipientInfo"');switch(d){case"1.2.840.10045.3.1.7":f="P-256",A=256;break;case"1.3.132.0.34":f="P-384",A=384;break;case"1.3.132.0.35":f="P-521",A=528;break;default:throw new Error("Incorrect curve OID for index ".concat(w))}let S,v=s;ge.isBufferSource(a.recipientPrivateKey)?S=await s.importKey("pkcs8",a.recipientPrivateKey,{name:"ECDH",namedCurve:f},!0,["deriveBits"]):(S=a.recipientPrivateKey,"crypto"in a&&a.crypto&&(v=a.crypto.subtle)),"algorithmParams"in C.value.algorithm||(C.value.algorithm.algorithmParams=new W({value:d}));const E=C.value.toSchema().toBER(!1),k=await s.importKey("spki",E,{name:"ECDH",namedCurve:f},!0,[]),x=await v.deriveBits({name:"ECDH",public:k},S,A);async function V(H){H=H||!1;const z=new T({schema:b.keyEncryptionAlgorithm.algorithmParams}),re=s.getAlgorithmByOID(z.algorithmId,!0,"kwAlgorithm");let _=re.length;const X=new ArrayBuffer(4),J=new Uint8Array(X);for(let oe=3;oe>=0;oe--)J[oe]=_,_>>=8;const G={algorithmId:z.algorithmId};H&&(G.algorithmParams=new Me);const q=new Os({keyInfo:new T(G),entityUInfo:b.ukm,suppPubInfo:new M({valueHex:X})}).toSchema().toBER(!1),se=s.getAlgorithmByOID(b.keyEncryptionAlgorithm.algorithmId,!0,"ecdhAlgorithm");if(!se.name)throw new Error("Incorrect OID for key encryption algorithm: ".concat(b.keyEncryptionAlgorithm.algorithmId));return ag(se.kdf,x,re.length,q,s)}const O=await V(),P=async H=>s.importKey("raw",H,{name:"AES-KW"},!0,["unwrapKey"]),B=await P(O),L=async H=>{const z=this.encryptedContentInfo.contentEncryptionAlgorithm.algorithmId,re=s.getAlgorithmByOID(z,!0,"contentEncryptionAlgorithm");return s.unwrapKey("raw",b.recipientEncryptedKeys.encryptedKeys[0].encryptedKey.valueBlock.valueHexView,H,{name:"AES-KW"},re,!0,["decrypt"])};try{return await L(B)}catch(H){const z=await V(!0),re=await P(z);return L(re)}},c=async w=>{const b=this.recipientInfos[w].value;if(!a.recipientPrivateKey)throw new Error('Parameter "recipientPrivateKey" is mandatory for "KeyTransRecipientInfo"');const d=s.getAlgorithmByOID(b.keyEncryptionAlgorithm.algorithmId,!0,"keyEncryptionAlgorithm");if(d.name==="RSA-OAEP"){const E=b.keyEncryptionAlgorithm.algorithmParams,k=new gt({schema:E});if(d.hash=s.getAlgorithmByOID(k.hashAlgorithm.algorithmId),!("name"in d.hash))throw new Error("Incorrect OID for hash algorithm: ".concat(k.hashAlgorithm.algorithmId))}let f,A=s;ge.isBufferSource(a.recipientPrivateKey)?f=await s.importKey("pkcs8",a.recipientPrivateKey,d,!0,["decrypt"]):(f=a.recipientPrivateKey,"crypto"in a&&a.crypto&&(A=a.crypto.subtle));const C=await A.decrypt(f.algorithm,f,b.encryptedKey.valueBlock.valueHexView),S=this.encryptedContentInfo.contentEncryptionAlgorithm.algorithmId,v=s.getAlgorithmByOID(S,!0,"contentEncryptionAlgorithm");if(!("name"in v))throw new Error('Incorrect "contentEncryptionAlgorithm": '.concat(S));return s.importKey("raw",C,v,!0,["decrypt"])},i=async w=>{const b=this.recipientInfos[w].value;if(!a.preDefinedData)throw new Error('Parameter "preDefinedData" is mandatory for "KEKRecipientInfo"');const d=s.getAlgorithmByOID(b.keyEncryptionAlgorithm.algorithmId,!0,"kekAlgorithm"),f=await s.importKey("raw",a.preDefinedData,d,!0,["unwrapKey"]),A=this.encryptedContentInfo.contentEncryptionAlgorithm.algorithmId,C=s.getAlgorithmByOID(A,!0,"contentEncryptionAlgorithm");if(!C.name)throw new Error('Incorrect "contentEncryptionAlgorithm": '.concat(A));return s.unwrapKey("raw",b.encryptedKey.valueBlock.valueHexView,f,d,C,!0,["decrypt"])},o=async w=>{const b=this.recipientInfos[w].value;let d;if(!a.preDefinedData)throw new Error('Parameter "preDefinedData" is mandatory for "KEKRecipientInfo"');if(!b.keyDerivationAlgorithm)throw new Error('Please append encoded "keyDerivationAlgorithm"');if(!b.keyDerivationAlgorithm.algorithmParams)throw new Error('Incorrectly encoded "keyDerivationAlgorithm"');try{d=new ht({schema:b.keyDerivationAlgorithm.algorithmParams})}catch(V){throw new Error('Incorrectly encoded "keyDerivationAlgorithm"')}const f=await s.importKey("raw",a.preDefinedData,"PBKDF2",!1,["deriveKey"]),A=s.getAlgorithmByOID(b.keyEncryptionAlgorithm.algorithmId,!0,"keyEncryptionAlgorithm"),C=d.prf?s.getAlgorithmByOID(d.prf.algorithmId,!0,"prfAlgorithm").hash.name:"SHA-1",S=new Uint8Array(d.salt.valueBlock.valueHex),v=d.iterationCount,E=await s.deriveKey({name:"PBKDF2",hash:{name:C},salt:S,iterations:v},f,A,!0,["unwrapKey"]),k=this.encryptedContentInfo.contentEncryptionAlgorithm.algorithmId,x=s.getAlgorithmByOID(k,!0,"contentEncryptionAlgorithm");return s.unwrapKey("raw",b.encryptedKey.valueBlock.valueHexView,E,A,x,!0,["decrypt"])};let n;switch(this.recipientInfos[e].variant){case 1:n=await c(e);break;case 2:n=await u(e);break;case 3:n=await i(e);break;case 4:n=await o(e);break;default:throw new Error("Unknown recipient type in array with index ".concat(e))}const l=this.encryptedContentInfo.contentEncryptionAlgorithm.algorithmId,m=s.getAlgorithmByOID(l,!0,"contentEncryptionAlgorithm"),h=this.encryptedContentInfo.contentEncryptionAlgorithm.algorithmParams.valueBlock.valueHex,g=new Uint8Array(h);if(!this.encryptedContentInfo.encryptedContent)throw new Error("Required property `encryptedContent` is empty");const p=this.encryptedContentInfo.getEncryptedContent();return s.decrypt({name:m.name,iv:g},n,p)}}Yt.CLASS_NAME="EnvelopedData";const Ln="safeContents",Ho="parsedValue",yg="contentInfos";class In extends ${constructor(e={}){super(),this.safeContents=y(e,Ln,In.defaultValues(Ln)),Ho in e&&(this.parsedValue=y(e,Ho,In.defaultValues(Ho))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Ln:return[];case Ho:return{};default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Ln:return t.length===0;case Ho:return t instanceof Object&&Object.keys(t).length===0;default:return super.defaultValues(e)}}static schema(e={}){const t=y(e,"names",{});return new I({name:t.blockName||N,value:[new ee({name:t.contentInfos||N,value:pe.schema()})]})}fromSchema(e){U(e,[yg]);const t=K(e,e,In.schema({names:{contentInfos:yg}}));j.assertSchema(t,this.className),this.safeContents=Array.from(t.result.contentInfos,s=>new pe({schema:s}))}toSchema(){return new I({value:Array.from(this.safeContents,e=>e.toSchema())})}toJSON(){return{safeContents:Array.from(this.safeContents,e=>e.toJSON())}}async parseInternalValues(e,t=te(!0)){if(ie.assert(e,Ln),me.assert(e.safeContents,Ln,"Array"),e.safeContents.length!==this.safeContents.length)throw new me('Length of "parameters.safeContents" must be equal to "this.safeContents.length"');this.parsedValue={safeContents:[]};for(const[s,a]of this.safeContents.entries()){const u=e.safeContents[s],c="parameters.safeContents[".concat(s,"]");switch(a.contentType){case Ap:{me.assert(a.content,"this.safeContents[j].content",M);const i=a.content.getValue();this.parsedValue.safeContents.push({privacyMode:0,value:Ls.fromBER(i)})}break;case Ow:{const i=new Yt({schema:a.content});ie.assert(c,u,"recipientCertificate","recipientKey");const o=u,n=o.recipientCertificate,l=o.recipientKey,m=await i.decrypt(0,{recipientCertificate:n,recipientPrivateKey:l},t);this.parsedValue.safeContents.push({privacyMode:2,value:Ls.fromBER(m)})}break;case Bw:{const i=new ms({schema:a.content});ie.assert(c,u,"password");const o=u.password,n=await i.decrypt({password:o},t);this.parsedValue.safeContents.push({privacyMode:1,value:Ls.fromBER(n)})}break;default:throw new Error('Unknown "contentType" for AuthenticatedSafe: " '.concat(a.contentType))}}}async makeInternalValues(e,t=te(!0)){if(!this.parsedValue)throw new Error('Please run "parseValues" first or add "parsedValue" manually');if(me.assert(this.parsedValue,"this.parsedValue","object"),me.assert(this.parsedValue.safeContents,"this.parsedValue.safeContents","Array"),me.assert(e,"parameters","object"),ie.assert(e,"safeContents"),me.assert(e.safeContents,"parameters.safeContents","Array"),e.safeContents.length!==this.parsedValue.safeContents.length)throw new me('Length of "parameters.safeContents" must be equal to "this.parsedValue.safeContents"');this.safeContents=[];for(const[s,a]of this.parsedValue.safeContents.entries())switch(ie.assert("content",a,"privacyMode","value"),me.assert(a.value,"content.value",Ls),a.privacyMode){case 0:{const u=a.value.toSchema().toBER(!1);this.safeContents.push(new pe({contentType:"1.2.840.113549.1.7.1",content:new M({valueHex:u})}))}break;case 1:{const u=new ms,c=e.safeContents[s];c.contentToEncrypt=a.value.toSchema().toBER(!1),await u.encrypt(c,t),this.safeContents.push(new pe({contentType:"1.2.840.113549.1.7.6",content:u.toSchema()}))}break;case 2:{const u=new Yt,c=a.value.toSchema().toBER(!1),i=e.safeContents[s];switch(ie.assert("parameters.safeContents[".concat(s,"]"),i,"encryptingCertificate","encryptionAlgorithm"),!0){case i.encryptionAlgorithm.name.toLowerCase()==="aes-cbc":case i.encryptionAlgorithm.name.toLowerCase()==="aes-gcm":break;default:throw new Error('Incorrect parameter "encryptionAlgorithm" in "parameters.safeContents[i]": '.concat(i.encryptionAlgorithm))}switch(!0){case i.encryptionAlgorithm.length===128:case i.encryptionAlgorithm.length===192:case i.encryptionAlgorithm.length===256:break;default:throw new Error('Incorrect parameter "encryptionAlgorithm.length" in "parameters.safeContents[i]": '.concat(i.encryptionAlgorithm.length))}const o=i.encryptionAlgorithm;u.addRecipientByCertificate(i.encryptingCertificate,{},void 0,t),await u.encrypt(o,c,t),this.safeContents.push(new pe({contentType:"1.2.840.113549.1.7.3",content:u.toSchema()}))}break;default:throw new Error('Incorrect value for "content.privacyMode": '.concat(a.privacyMode))}return this}}In.CLASS_NAME="AuthenticatedSafe";const Qa="hashAlgorithm",Pi="issuerNameHash",Oi="issuerKeyHash",Ya="serialNumber",pS=[Qa,Pi,Oi,Ya];class De extends ${static async create(e,t,s=te(!0)){const a=new De;return await a.createForCertificate(e,t,s),a}constructor(e={}){super(),this.hashAlgorithm=y(e,Qa,De.defaultValues(Qa)),this.issuerNameHash=y(e,Pi,De.defaultValues(Pi)),this.issuerKeyHash=y(e,Oi,De.defaultValues(Oi)),this.serialNumber=y(e,Ya,De.defaultValues(Ya)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Qa:return new T;case Pi:case Oi:return new M;case Ya:return new R;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Qa:return t.algorithmId===N&&!("algorithmParams"in t);case Pi:case Oi:case Ya:return t.isEqual(De.defaultValues(Ya));default:return super.defaultValues(e)}}static schema(e={}){const t=y(e,"names",{});return new I({name:t.blockName||N,value:[T.schema(t.hashAlgorithmObject||{names:{blockName:t.hashAlgorithm||N}}),new M({name:t.issuerNameHash||N}),new M({name:t.issuerKeyHash||N}),new R({name:t.serialNumber||N})]})}fromSchema(e){U(e,pS);const t=K(e,e,De.schema({names:{hashAlgorithm:Qa,issuerNameHash:Pi,issuerKeyHash:Oi,serialNumber:Ya}}));j.assertSchema(t,this.className),this.hashAlgorithm=new T({schema:t.result.hashAlgorithm}),this.issuerNameHash=t.result.issuerNameHash,this.issuerKeyHash=t.result.issuerKeyHash,this.serialNumber=t.result.serialNumber}toSchema(){return new I({value:[this.hashAlgorithm.toSchema(),this.issuerNameHash,this.issuerKeyHash,this.serialNumber]})}toJSON(){return{hashAlgorithm:this.hashAlgorithm.toJSON(),issuerNameHash:this.issuerNameHash.toJSON(),issuerKeyHash:this.issuerKeyHash.toJSON(),serialNumber:this.serialNumber.toJSON()}}isEqual(e){return!(this.hashAlgorithm.algorithmId!==e.hashAlgorithm.algorithmId||!ge.isEqual(this.issuerNameHash.valueBlock.valueHexView,e.issuerNameHash.valueBlock.valueHexView)||!ge.isEqual(this.issuerKeyHash.valueBlock.valueHexView,e.issuerKeyHash.valueBlock.valueHexView)||!this.serialNumber.isEqual(e.serialNumber))}async createForCertificate(e,t,s=te(!0)){ie.assert(t,Qa,"issuerCertificate");const a=s.getOIDByAlgorithm({name:t.hashAlgorithm},!0,"hashAlgorithm");this.hashAlgorithm=new T({algorithmId:a,algorithmParams:new Me});const u=t.issuerCertificate;this.serialNumber=e.serialNumber;const c=await s.digest({name:t.hashAlgorithm},u.subject.toSchema().toBER(!1));this.issuerNameHash=new M({valueHex:c});const i=u.subjectPublicKeyInfo.subjectPublicKey.valueBlock.valueHexView,o=await s.digest({name:t.hashAlgorithm},i);this.issuerKeyHash=new M({valueHex:o})}}De.CLASS_NAME="CertID";const Bi="certID",Di="certStatus",Ti="thisUpdate",Br="nextUpdate",Za="singleExtensions",dS=[Bi,Di,Ti,Br,Za];class Zt extends ${constructor(e={}){super(),this.certID=y(e,Bi,Zt.defaultValues(Bi)),this.certStatus=y(e,Di,Zt.defaultValues(Di)),this.thisUpdate=y(e,Ti,Zt.defaultValues(Ti)),Br in e&&(this.nextUpdate=y(e,Br,Zt.defaultValues(Br))),Za in e&&(this.singleExtensions=y(e,Za,Zt.defaultValues(Za))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Bi:return new De;case Di:return{};case Ti:case Br:return new Date(0,0,0);case Za:return[];default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Bi:return De.compareWithDefault("hashAlgorithm",t.hashAlgorithm)&&De.compareWithDefault("issuerNameHash",t.issuerNameHash)&&De.compareWithDefault("issuerKeyHash",t.issuerKeyHash)&&De.compareWithDefault("serialNumber",t.serialNumber);case Di:return Object.keys(t).length===0;case Ti:case Br:return t===Zt.defaultValues(e);default:return super.defaultValues(e)}}static schema(e={}){const t=y(e,"names",{});return new I({name:t.blockName||N,value:[De.schema(t.certID||{}),new Ne({value:[new Y({name:t.certStatus||N,idBlock:{tagClass:3,tagNumber:0}}),new D({name:t.certStatus||N,idBlock:{tagClass:3,tagNumber:1},value:[new ke,new D({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new Gl]})]}),new Y({name:t.certStatus||N,idBlock:{tagClass:3,tagNumber:2},lenBlock:{length:1}})]}),new ke({name:t.thisUpdate||N}),new D({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new ke({name:t.nextUpdate||N})]}),new D({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[je.schema(t.singleExtensions||{})]})]})}fromSchema(e){U(e,dS);const t=K(e,e,Zt.schema({names:{certID:{names:{blockName:Bi}},certStatus:Di,thisUpdate:Ti,nextUpdate:Br,singleExtensions:{names:{blockName:Za}}}}));j.assertSchema(t,this.className),this.certID=new De({schema:t.result.certID}),this.certStatus=t.result.certStatus,this.thisUpdate=t.result.thisUpdate.toDate(),Br in t.result&&(this.nextUpdate=t.result.nextUpdate.toDate()),Za in t.result&&(this.singleExtensions=Array.from(t.result.singleExtensions.valueBlock.value,s=>new Be({schema:s})))}toSchema(){const e=[];return e.push(this.certID.toSchema()),e.push(this.certStatus),e.push(new ke({valueDate:this.thisUpdate})),this.nextUpdate&&e.push(new D({idBlock:{tagClass:3,tagNumber:0},value:[new ke({valueDate:this.nextUpdate})]})),this.singleExtensions&&e.push(new I({value:Array.from(this.singleExtensions,t=>t.toSchema())})),new I({value:e})}toJSON(){const e={certID:this.certID.toJSON(),certStatus:this.certStatus.toJSON(),thisUpdate:this.thisUpdate};return this.nextUpdate&&(e.nextUpdate=this.nextUpdate),this.singleExtensions&&(e.singleExtensions=Array.from(this.singleExtensions,t=>t.toJSON())),e}}Zt.CLASS_NAME="SingleResponse";const Dc="tbs",en="version",Sl="responderID",Al="producedAt",Nl="responses",Ri="responseExtensions",On="ResponseData",Xc="".concat(On,".").concat(en),Li="".concat(On,".").concat(Sl),Rf="".concat(On,".").concat(Al),Lf="".concat(On,".").concat(Nl),zc="".concat(On,".").concat(Ri),gS=[On,Xc,Li,Rf,Lf,zc];class Ge extends ${get tbs(){return ge.toArrayBuffer(this.tbsView)}set tbs(e){this.tbsView=new Uint8Array(e)}constructor(e={}){super(),this.tbsView=new Uint8Array(y(e,Dc,Ge.defaultValues(Dc))),en in e&&(this.version=y(e,en,Ge.defaultValues(en))),this.responderID=y(e,Sl,Ge.defaultValues(Sl)),this.producedAt=y(e,Al,Ge.defaultValues(Al)),this.responses=y(e,Nl,Ge.defaultValues(Nl)),Ri in e&&(this.responseExtensions=y(e,Ri,Ge.defaultValues(Ri))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case en:return 0;case Dc:return Le;case Sl:return{};case Al:return new Date(0,0,0);case Nl:case Ri:return[];default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Dc:return t.byteLength===0;case Sl:return Object.keys(t).length===0;case Al:return t===Ge.defaultValues(e);case Nl:case Ri:return t.length===0;default:return super.defaultValues(e)}}static schema(e={}){const t=y(e,"names",{});return new I({name:t.blockName||On,value:[new D({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new R({name:t.version||Xc})]}),new Ne({value:[new D({name:t.responderID||Li,idBlock:{tagClass:3,tagNumber:1},value:[fe.schema(t.ResponseDataByName||{names:{blockName:"ResponseData.byName"}})]}),new D({name:t.responderID||Li,idBlock:{tagClass:3,tagNumber:2},value:[new M({name:t.ResponseDataByKey||"ResponseData.byKey"})]})]}),new ke({name:t.producedAt||Rf}),new I({value:[new ee({name:Lf,value:Zt.schema(t.response||{})})]}),new D({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[je.schema(t.extensions||{names:{blockName:zc}})]})]})}fromSchema(e){U(e,gS);const t=K(e,e,Ge.schema());j.assertSchema(t,this.className),this.tbsView=t.result.ResponseData.valueBeforeDecodeView,Xc in t.result&&(this.version=t.result[Xc].valueBlock.valueDec),t.result[Li].idBlock.tagNumber===1?this.responderID=new fe({schema:t.result[Li].valueBlock.value[0]}):this.responderID=t.result[Li].valueBlock.value[0],this.producedAt=t.result[Rf].toDate(),this.responses=Array.from(t.result[Lf],s=>new Zt({schema:s})),zc in t.result&&(this.responseExtensions=Array.from(t.result[zc].valueBlock.value,s=>new Be({schema:s})))}toSchema(e=!1){let t;if(e===!1){if(!this.tbsView.byteLength)return Ge.schema();const s=Re(this.tbsView);j.assert(s,"TBS Response Data"),t=s.result}else{const s=[];en in this&&s.push(new D({idBlock:{tagClass:3,tagNumber:0},value:[new R({value:this.version})]})),this.responderID instanceof fe?s.push(new D({idBlock:{tagClass:3,tagNumber:1},value:[this.responderID.toSchema()]})):s.push(new D({idBlock:{tagClass:3,tagNumber:2},value:[this.responderID]})),s.push(new ke({valueDate:this.producedAt})),s.push(new I({value:Array.from(this.responses,a=>a.toSchema())})),this.responseExtensions&&s.push(new D({idBlock:{tagClass:3,tagNumber:1},value:[new I({value:Array.from(this.responseExtensions,a=>a.toSchema())})]})),t=new I({value:s})}return t}toJSON(){const e={};return en in this&&(e.version=this.version),this.responderID&&(e.responderID=this.responderID),this.producedAt&&(e.producedAt=this.producedAt),this.responses&&(e.responses=Array.from(this.responses,t=>t.toJSON())),this.responseExtensions&&(e.responseExtensions=Array.from(this.responseExtensions,t=>t.toJSON())),e}}Ge.CLASS_NAME="ResponseData";const af="trustedCerts",nf="certs",of="crls",uf="ocsps",lf="checkDate",cf="findOrigin",hf="findIssuer";var hn;(function(r){r[r.unknown=-1]="unknown",r[r.success=0]="success",r[r.noRevocation=11]="noRevocation",r[r.noPath=60]="noPath",r[r.noValidPath=97]="noValidPath"})(hn||(hn={}));class Fr extends Error{constructor(e,t){super(t),this.name=Fr.NAME,this.code=e,this.message=t}}Fr.NAME="ChainValidationError";function wS(r,e){for(let t=0;t<e.length;t++)if(ge.isEqual(r.tbsView,e[t].tbsView))return!0;return!1}class Wh{constructor(e={}){this.trustedCerts=y(e,af,this.defaultValues(af)),this.certs=y(e,nf,this.defaultValues(nf)),this.crls=y(e,of,this.defaultValues(of)),this.ocsps=y(e,uf,this.defaultValues(uf)),this.checkDate=y(e,lf,this.defaultValues(lf)),this.findOrigin=y(e,cf,this.defaultValues(cf)),this.findIssuer=y(e,hf,this.defaultValues(hf))}static defaultFindOrigin(e,t){e.tbsView.byteLength===0&&(e.tbsView=new Uint8Array(e.encodeTBS().toBER()));for(const s of t.certs)if(s.tbsView.byteLength===0&&(s.tbsView=new Uint8Array(s.encodeTBS().toBER())),ge.isEqual(e.tbsView,s.tbsView))return"Intermediate Certificates";for(const s of t.trustedCerts)if(s.tbsView.byteLength===0&&(s.tbsView=new Uint8Array(s.encodeTBS().toBER())),ge.isEqual(e.tbsView,s.tbsView))return"Trusted Certificates";return"Unknown"}async defaultFindIssuer(e,t,s=te(!0)){const a=[];let u=null,c=null,i=null;if(e.subject.isEqual(e.issuer))try{if(await e.verify(void 0,s))return[e]}catch(n){}if(e.extensions){for(const n of e.extensions)if(n.extnID===bp&&n.parsedValue instanceof Gr){n.parsedValue.keyIdentifier?u=n.parsedValue.keyIdentifier:(n.parsedValue.authorityCertIssuer&&(c=n.parsedValue.authorityCertIssuer),n.parsedValue.authorityCertSerialNumber&&(i=n.parsedValue.authorityCertSerialNumber));break}}function o(n){if(u!==null&&n.extensions){let m=!1;for(const h of n.extensions)if(h.extnID===S1&&h.parsedValue){m=!0,ge.isEqual(h.parsedValue.valueBlock.valueHex,u.valueBlock.valueHexView)&&a.push(n);break}if(m)return}let l=!1;i!==null&&(l=n.serialNumber.isEqual(i)),c!==null?n.subject.isEqual(c)&&l&&a.push(n):e.issuer.isEqual(n.subject)&&a.push(n)}for(const n of t.trustedCerts)o(n);for(const n of t.certs)o(n);for(let n=a.length-1;n>=0;n--)try{await e.verify(a[n],s)===!1&&a.splice(n,1)}catch(l){a.splice(n,1)}return a}defaultValues(e){switch(e){case af:return[];case nf:return[];case of:return[];case uf:return[];case lf:return new Date;case cf:return Wh.defaultFindOrigin;case hf:return this.defaultFindIssuer;default:throw new Error("Invalid member name for CertificateChainValidationEngine class: ".concat(e))}}async sort(e=!1,t=te(!0)){const s=[],a=async(p,w)=>{const b=[];function d(A){let C=!0;for(let S=0;S<A.length;S++){for(let v=0;v<A.length;v++)if(v!==S&&A[S]===A[v]){C=!1;break}if(!C)break}return C}if(wS(p,this.trustedCerts))return[[p]];const f=await this.findIssuer(p,this,w);if(f.length===0)throw new Error("No valid certificate paths found");for(let A=0;A<f.length;A++){if(ge.isEqual(f[A].tbsView,p.tbsView)){b.push([f[A]]);continue}const C=await a(f[A],w);for(let S=0;S<C.length;S++){const v=C[S].slice();v.splice(0,0,f[A]),d(v)?b.push(v):b.push(C[S])}}return b},u=async p=>{const w=[],b=[],d=[];if(w.push(...s.filter(f=>p.issuer.isEqual(f.subject))),w.length===0)return{status:1,statusMessage:"No certificate's issuers"};if(b.push(...this.crls.filter(f=>f.issuer.isEqual(p.issuer))),b.length===0)return{status:2,statusMessage:"No CRLs for specific certificate issuer"};for(let f=0;f<b.length;f++){const A=b[f];if(!(A.nextUpdate&&A.nextUpdate.value<this.checkDate))for(let C=0;C<w.length;C++)try{if(await b[f].verify({issuerCertificate:w[C]},t)){d.push({crl:b[f],certificate:w[C]});break}}catch(S){}}return d.length?{status:0,statusMessage:N,result:d}:{status:3,statusMessage:"No valid CRLs found"}},c=async(p,w)=>{const b=t.getAlgorithmByOID(p.signatureAlgorithm.algorithmId);if(!b.name||!b.hash)return 1;for(let d=0;d<this.ocsps.length;d++){const f=await this.ocsps[d].getCertificateStatus(p,w,t);if(f.isForCertificate)return f.status===0?0:1}return 2};async function i(p,w=!1){let b=!1,d=!1,f=!1,A=!1;if(p.extensions){for(let C=0;C<p.extensions.length;C++){const S=p.extensions[C];if(S.critical&&!S.parsedValue)return{result:!1,resultCode:6,resultMessage:"Unable to parse critical certificate extension: ".concat(S.extnID)};if(S.extnID===A1){f=!0;const v=new Uint8Array(S.parsedValue.valueBlock.valueHex);(v[0]&4)===4&&(d=!0),(v[0]&2)===2&&(A=!0)}S.extnID===yp&&"cA"in S.parsedValue&&S.parsedValue.cA===!0&&(b=!0)}if(d===!0&&b===!1)return{result:!1,resultCode:3,resultMessage:'Unable to build certificate chain - using "keyCertSign" flag set without BasicConstraints'};if(f===!0&&b===!0&&d===!1)return{result:!1,resultCode:4,resultMessage:'Unable to build certificate chain - "keyCertSign" flag was not set'};if(b===!0&&f===!0&&w&&A===!1)return{result:!1,resultCode:5,resultMessage:'Unable to build certificate chain - intermediate certificate must have "cRLSign" key usage flag'}}return b===!1?{result:!1,resultCode:7,resultMessage:"Unable to build certificate chain - more than one possible end-user certificate"}:{result:!0,resultCode:0,resultMessage:N}}const o=async(p,w)=>{for(let b=0;b<p.length;b++)if(p[b].notBefore.value>w||p[b].notAfter.value<w)return{result:!1,resultCode:8,resultMessage:"The certificate is either not yet valid or expired"};if(p.length<2)return{result:!1,resultCode:9,resultMessage:"Too short certificate path"};for(let b=p.length-2;b>=0;b--)if(p[b].issuer.isEqual(p[b].subject)===!1&&p[b].issuer.isEqual(p[b+1].subject)===!1)return{result:!1,resultCode:10,resultMessage:"Incorrect name chaining"};if(this.crls.length!==0||this.ocsps.length!==0)for(let b=0;b<p.length-1;b++){let d=2,f={status:0,statusMessage:N};if(this.ocsps.length!==0)switch(d=await c(p[b],p[b+1]),d){case 0:continue;case 1:return{result:!1,resultCode:12,resultMessage:"One of certificates was revoked via OCSP response"}}if(this.crls.length!==0){if(f=await u(p[b]),f.status===0&&f.result)for(let A=0;A<f.result.length;A++){if(f.result[A].crl.isCertificateRevoked(p[b]))return{result:!1,resultCode:12,resultMessage:"One of certificates had been revoked"};if((await i(f.result[A].certificate,!0)).result===!1)return{result:!1,resultCode:13,resultMessage:"CRL issuer certificate is not a CA certificate or does not have crlSign flag"}}else if(e===!1)throw new Fr(hn.noRevocation,"No revocation values found for one of certificates: ".concat(f.statusMessage))}else if(d===2)return{result:!1,resultCode:11,resultMessage:"No revocation values found for one of certificates"};if(d===2&&f.status===2&&e){const A=p[b+1];let C=!1;if(A.extensions)for(const S of A.extensions)switch(S.extnID){case Cw:case vp:case Sp:C=!0;break}if(C)throw new Fr(hn.noRevocation,"No revocation values found for one of certificates: ".concat(f.statusMessage))}}for(const[b,d]of p.entries())if(b&&!(await i(d)).result)return{result:!1,resultCode:14,resultMessage:"One of intermediate certificates is not a CA certificate"};return{result:!0}};s.push(...this.trustedCerts),s.push(...this.certs);for(let p=0;p<s.length;p++)for(let w=0;w<s.length;w++)if(p!==w&&ge.isEqual(s[p].tbsView,s[w].tbsView)){s.splice(w,1),p=0;break}const n=s[s.length-1];let l;const m=[n];if(l=await a(n,t),l.length===0)throw new Fr(hn.noPath,"Unable to find certificate path");for(let p=l.length-1;p>=0;p--){let w=!1;for(let b=0;b<l[p].length;b++){const d=l[p][b];for(let f=0;f<this.trustedCerts.length;f++)if(ge.isEqual(d.tbsView,this.trustedCerts[f].tbsView)){w=!0;break}if(w)break}w||l.splice(p,1)}if(l.length===0)throw new Fr(hn.noValidPath,"No valid certificate paths found");let h=l[0].length,g=0;for(let p=0;p<l.length;p++)l[p].length<h&&(h=l[p].length,g=p);for(let p=0;p<l[g].length;p++)m.push(l[g][p]);if(l=await o(m,this.checkDate),l.result===!1)throw l;return m}async verify(e={},t=te(!0)){function s(o,n){const l=Ur(o),m=Ur(n),h=l.split("."),g=m.split("."),p=h.length,w=g.length;if(p===0||w===0||p<w)return!1;for(let b=0;b<p;b++)if(h[b].length===0)return!1;for(let b=0;b<w;b++)if(g[b].length===0){if(b===0){if(w===1)return!1;continue}return!1}for(let b=0;b<w;b++)if(g[w-1-b].length!==0&&h[p-1-b].localeCompare(g[w-1-b])!==0)return!1;return!0}function a(o,n){const l=Ur(o),m=Ur(n),h=l.split("@"),g=m.split("@");if(h.length===0||g.length===0||h.length<g.length)return!1;if(g.length===1){if(s(h[1],g[0])){const p=h[1].split("."),w=g[0].split(".");return w[0].length===0?!0:p.length===w.length}return!1}return l.localeCompare(m)===0}function u(o,n){let l=Ur(o);const m=Ur(n),h=l.split("/");if(m.split("/").length>1)return!1;if(h.length>1){for(let g=0;g<h.length;g++)if(h[g].length>0&&h[g].charAt(h[g].length-1)!==":"){l=h[g].split(":")[0];break}}if(s(l,m)){const g=l.split("."),p=m.split(".");return p[0].length===0?!0:g.length===p.length}return!1}function c(o,n){const l=o.valueBlock.valueHexView,m=n.valueBlock.valueHexView;if(l.length===4&&m.length===8){for(let h=0;h<4;h++)if((l[h]^m[h])&m[h+4])return!1;return!0}if(l.length===16&&m.length===32){for(let h=0;h<16;h++)if((l[h]^m[h])&m[h+16])return!1;return!0}return!1}function i(o,n){if(o.typesAndValues.length===0||n.typesAndValues.length===0)return!0;if(o.typesAndValues.length<n.typesAndValues.length)return!1;let l=!0,m=0;for(let h=0;h<n.typesAndValues.length;h++){let g=!1;for(let p=m;p<o.typesAndValues.length;p++)if(g=o.typesAndValues[p].isEqual(n.typesAndValues[h]),o.typesAndValues[p].type===n.typesAndValues[h].type&&(l=l&&g),g===!0)if(m===0||m===p){m=p+1;break}else return!1;if(g===!1)return!1}return m===0?!1:l}try{if(this.certs.length===0)throw new Error("Empty certificate array");const o=e.passedWhenNotRevValues||!1,n=e.initialPolicySet||[jt],l=e.initialExplicitPolicy||!1,m=e.initialPolicyMappingInhibit||!1,h=e.initialInhibitPolicy||!1,g=e.initialPermittedSubtreesSet||[],p=e.initialExcludedSubtreesSet||[],w=e.initialRequiredNameForms||[];let b=l,d=m,f=h;const A=[!1,!1,!1];let C=0,S=0,v=0,E=g,k=p;const x=w;let V=1;this.certs=await this.sort(o,t);const O=[];O.push(jt);const P=[],B=new Array(this.certs.length-1);for(let J=0;J<this.certs.length-1;J++)B[J]=!0;P.push(B);const L=new Array(this.certs.length-1),H=new Array(this.certs.length-1);let z=b?this.certs.length-1:-1;for(let J=this.certs.length-2;J>=0;J--,V++){const G=this.certs[J];if(G.extensions){for(let q=0;q<G.extensions.length;q++){const se=G.extensions[q];if(se.extnID===xw){H[J]=se.parsedValue;for(let oe=0;oe<O.length;oe++)if(O[oe]===jt){delete P[oe][J];break}for(let oe=0;oe<se.parsedValue.certificatePolicies.length;oe++){let xe=-1;const Gt=se.parsedValue.certificatePolicies[oe].policyIdentifier;for(let Ie=0;Ie<O.length;Ie++)if(Gt===O[Ie]){xe=Ie;break}if(xe===-1){O.push(Gt);const Ie=new Array(this.certs.length-1);Ie[J]=!0,P.push(Ie)}else P[xe][J]=!0}}if(se.extnID===Iw){if(d)return{result:!1,resultCode:98,resultMessage:"Policy mapping prohibited"};L[J]=se.parsedValue}se.extnID===Vw&&b===!1&&(se.parsedValue.requireExplicitPolicy===0?(b=!0,z=J):A[0]===!1?(A[0]=!0,C=se.parsedValue.requireExplicitPolicy):C=C>se.parsedValue.requireExplicitPolicy?se.parsedValue.requireExplicitPolicy:C,se.parsedValue.inhibitPolicyMapping===0?d=!0:A[1]===!1?(A[1]=!0,S=se.parsedValue.inhibitPolicyMapping+1):S=S>se.parsedValue.inhibitPolicyMapping+1?se.parsedValue.inhibitPolicyMapping+1:S),se.extnID===P1&&f===!1&&(se.parsedValue.valueBlock.valueDec===0?f=!0:A[2]===!1?(A[2]=!0,v=se.parsedValue.valueBlock.valueDec):v=v>se.parsedValue.valueBlock.valueDec?se.parsedValue.valueBlock.valueDec:v)}if(f===!0){let q=-1;for(let se=0;se<O.length;se++)if(O[se]===jt){q=se;break}q!==-1&&delete P[0][J]}b===!1&&A[0]===!0&&(C--,C===0&&(b=!0,z=J,A[0]=!1)),d===!1&&A[1]===!0&&(S--,S===0&&(d=!0,A[1]=!1)),f===!1&&A[2]===!0&&(v--,v===0&&(f=!0,A[2]=!1))}}for(let J=0;J<this.certs.length-1;J++)if(J<this.certs.length-2&&typeof L[J+1]<"u")for(let G=0;G<L[J+1].mappings.length;G++){if(L[J+1].mappings[G].issuerDomainPolicy===jt||L[J+1].mappings[G].subjectDomainPolicy===jt)return{result:!1,resultCode:99,resultMessage:'The "anyPolicy" should not be a part of policy mapping scheme'};let q=-1,se=-1;for(let oe=0;oe<O.length;oe++)O[oe]===L[J+1].mappings[G].issuerDomainPolicy&&(q=oe),O[oe]===L[J+1].mappings[G].subjectDomainPolicy&&(se=oe);typeof P[q][J]<"u"&&delete P[q][J];for(let oe=0;oe<H[J].certificatePolicies.length;oe++)if(L[J+1].mappings[G].subjectDomainPolicy===H[J].certificatePolicies[oe].policyIdentifier&&q!==-1&&se!==-1)for(let xe=0;xe<=J;xe++)typeof P[se][xe]<"u"&&(P[q][xe]=!0,delete P[se][xe])}for(let J=0;J<O.length;J++)if(O[J]===jt)for(let G=0;G<z;G++)delete P[J][G];const re=[];for(let J=0;J<P.length;J++){let G=!0;for(let q=0;q<this.certs.length-1;q++){let se=!1;if(q<z&&O[J]===jt&&O.length>1){G=!1;break}if(typeof P[J][q]>"u"){if(q>=z){for(let oe=0;oe<O.length;oe++)if(O[oe]===jt){P[oe][q]===!0&&(se=!0);break}}if(!se){G=!1;break}}}G===!0&&re.push(O[J])}let _=[];if(n.length===1&&n[0]===jt&&b===!1)_=n;else if(re.length===1&&re[0]===jt)_=n;else for(let J=0;J<re.length;J++)for(let G=0;G<n.length;G++)if(n[G]===re[J]||n[G]===jt){_.push(re[J]);break}const X={result:_.length>0,resultCode:0,resultMessage:_.length>0?N:'Zero "userConstrPolicies" array, no intersections with "authConstrPolicies"',authConstrPolicies:re,userConstrPolicies:_,explicitPolicyIndicator:b,policyMappings:L,certificatePath:this.certs};if(_.length===0||X.result===!1)return X;V=1;for(let J=this.certs.length-2;J>=0;J--,V++){const G=this.certs[J];let q=[],se=[],oe=[];if(G.extensions)for(let ce=0;ce<G.extensions.length;ce++){const Q=G.extensions[ce];Q.extnID===Ew&&("permittedSubtrees"in Q.parsedValue&&(se=se.concat(Q.parsedValue.permittedSubtrees)),"excludedSubtrees"in Q.parsedValue&&(oe=oe.concat(Q.parsedValue.excludedSubtrees))),Q.extnID===Sw&&(q=q.concat(Q.parsedValue.altNames))}let xe=x.length<=0;for(let ce=0;ce<x.length;ce++)switch(x[ce].base.type){case 4:{if(x[ce].base.value.typesAndValues.length!==G.subject.typesAndValues.length)continue;xe=!0;for(let Q=0;Q<G.subject.typesAndValues.length;Q++)if(G.subject.typesAndValues[Q].type!==x[ce].base.value.typesAndValues[Q].type){xe=!1;break}if(xe===!0)break}break;default:}if(xe===!1)throw X.result=!1,X.resultCode=21,X.resultMessage="No necessary name form found",X;const Gt=[[],[],[],[],[]];for(let ce=0;ce<E.length;ce++)switch(E[ce].base.type){case 1:Gt[0].push(E[ce]);break;case 2:Gt[1].push(E[ce]);break;case 4:Gt[2].push(E[ce]);break;case 6:Gt[3].push(E[ce]);break;case 7:Gt[4].push(E[ce]);break;default:}for(let ce=0;ce<5;ce++){let Q=!1,na=!1;const Js=Gt[ce];for(let qs=0;qs<Js.length;qs++){switch(ce){case 0:if(q.length>0)for(let ye=0;ye<q.length;ye++)q[ye].type===1&&(na=!0,Q=Q||a(q[ye].value,Js[qs].base.value));else for(let ye=0;ye<G.subject.typesAndValues.length;ye++)(G.subject.typesAndValues[ye].type==="1.2.840.113549.1.9.1"||G.subject.typesAndValues[ye].type==="0.9.2342.19200300.100.1.3")&&(na=!0,Q=Q||a(G.subject.typesAndValues[ye].value.valueBlock.value,Js[qs].base.value));break;case 1:if(q.length>0)for(let ye=0;ye<q.length;ye++)q[ye].type===2&&(na=!0,Q=Q||s(q[ye].value,Js[qs].base.value));break;case 2:na=!0,Q=i(G.subject,Js[qs].base.value);break;case 3:if(q.length>0)for(let ye=0;ye<q.length;ye++)q[ye].type===6&&(na=!0,Q=Q||u(q[ye].value,Js[qs].base.value));break;case 4:if(q.length>0)for(let ye=0;ye<q.length;ye++)q[ye].type===7&&(na=!0,Q=Q||c(q[ye].value,Js[qs].base.value));break;default:}if(Q)break}if(Q===!1&&Js.length>0&&na)throw X.result=!1,X.resultCode=41,X.resultMessage='Failed to meet "permitted sub-trees" name constraint',X}let Ie=!1;for(let ce=0;ce<k.length;ce++){switch(k[ce].base.type){case 1:if(q.length>=0)for(let Q=0;Q<q.length;Q++)q[Q].type===1&&(Ie=Ie||a(q[Q].value,k[ce].base.value));else for(let Q=0;Q<G.subject.typesAndValues.length;Q++)(G.subject.typesAndValues[Q].type==="1.2.840.113549.1.9.1"||G.subject.typesAndValues[Q].type==="0.9.2342.19200300.100.1.3")&&(Ie=Ie||a(G.subject.typesAndValues[Q].value.valueBlock.value,k[ce].base.value));break;case 2:if(q.length>0)for(let Q=0;Q<q.length;Q++)q[Q].type===2&&(Ie=Ie||s(q[Q].value,k[ce].base.value));break;case 4:Ie=Ie||i(G.subject,k[ce].base.value);break;case 6:if(q.length>0)for(let Q=0;Q<q.length;Q++)q[Q].type===6&&(Ie=Ie||u(q[Q].value,k[ce].base.value));break;case 7:if(q.length>0)for(let Q=0;Q<q.length;Q++)q[Q].type===7&&(Ie=Ie||c(q[Q].value,k[ce].base.value));break;default:}if(Ie)break}if(Ie===!0)throw X.result=!1,X.resultCode=42,X.resultMessage='Failed to meet "excluded sub-trees" name constraint',X;E=E.concat(se),k=k.concat(oe)}return X}catch(o){return o instanceof Error?o instanceof Fr?{result:!1,resultCode:o.code,resultMessage:o.message,error:o}:{result:!1,resultCode:hn.unknown,resultMessage:o.message,error:o}:o&&typeof o=="object"&&"resultMessage"in o?o:{result:!1,resultCode:-1,resultMessage:"".concat(o)}}}}const Qc="tbsResponseData",kl="signatureAlgorithm",El="signature",ji="certs",ac="BasicOCSPResponse",jf="".concat(ac,".").concat(Qc),$f="".concat(ac,".").concat(kl),Uf="".concat(ac,".").concat(El),Yc="".concat(ac,".").concat(ji),yS=[jf,$f,Uf,Yc];class Ft extends ${constructor(e={}){super(),this.tbsResponseData=y(e,Qc,Ft.defaultValues(Qc)),this.signatureAlgorithm=y(e,kl,Ft.defaultValues(kl)),this.signature=y(e,El,Ft.defaultValues(El)),ji in e&&(this.certs=y(e,ji,Ft.defaultValues(ji))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Qc:return new Ge;case kl:return new T;case El:return new ne;case ji:return[];default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case"type":{let s=Ge.compareWithDefault("tbs",t.tbs)&&Ge.compareWithDefault("responderID",t.responderID)&&Ge.compareWithDefault("producedAt",t.producedAt)&&Ge.compareWithDefault("responses",t.responses);return"responseExtensions"in t&&(s=s&&Ge.compareWithDefault("responseExtensions",t.responseExtensions)),s}case kl:return t.algorithmId===N&&!("algorithmParams"in t);case El:return t.isEqual(Ft.defaultValues(e));case ji:return t.length===0;default:return super.defaultValues(e)}}static schema(e={}){const t=y(e,"names",{});return new I({name:t.blockName||ac,value:[Ge.schema(t.tbsResponseData||{names:{blockName:jf}}),T.schema(t.signatureAlgorithm||{names:{blockName:$f}}),new ne({name:t.signature||Uf}),new D({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new I({value:[new ee({name:Yc,value:ue.schema(t.certs||{})})]})]})]})}fromSchema(e){U(e,yS);const t=K(e,e,Ft.schema());j.assertSchema(t,this.className),this.tbsResponseData=new Ge({schema:t.result[jf]}),this.signatureAlgorithm=new T({schema:t.result[$f]}),this.signature=t.result[Uf],Yc in t.result&&(this.certs=Array.from(t.result[Yc],s=>new ue({schema:s})))}toSchema(){const e=[];return e.push(this.tbsResponseData.toSchema()),e.push(this.signatureAlgorithm.toSchema()),e.push(this.signature),this.certs&&e.push(new D({idBlock:{tagClass:3,tagNumber:0},value:[new I({value:Array.from(this.certs,t=>t.toSchema())})]})),new I({value:e})}toJSON(){const e={tbsResponseData:this.tbsResponseData.toJSON(),signatureAlgorithm:this.signatureAlgorithm.toJSON(),signature:this.signature.toJSON()};return this.certs&&(e.certs=Array.from(this.certs,t=>t.toJSON())),e}async getCertificateStatus(e,t,s=te(!0)){const a={isForCertificate:!1,status:2},u={},c=[];for(const i of this.tbsResponseData.responses){const o=s.getAlgorithmByOID(i.certID.hashAlgorithm.algorithmId,!0,"CertID.hashAlgorithm");if(!u[o.name]){u[o.name]=1;const n=new De;c.push(n),await n.createForCertificate(e,{hashAlgorithm:o.name,issuerCertificate:t},s)}}for(const i of this.tbsResponseData.responses)for(const o of c)if(i.certID.isEqual(o)){a.isForCertificate=!0;try{switch(i.certStatus.idBlock.isConstructed){case!0:i.certStatus.idBlock.tagNumber===1&&(a.status=1);break;case!1:switch(i.certStatus.idBlock.tagNumber){case 0:a.status=0;break;case 2:a.status=2;break;default:}break;default:}}catch(n){}return a}return a}async sign(e,t="SHA-1",s=te(!0)){if(!e)throw new Error("Need to provide a private key for signing");const a=await s.getSignatureParameters(e,t),u=a.parameters.algorithm;if(!("name"in u))throw new Error("Empty algorithm");this.signatureAlgorithm=a.signatureAlgorithm,this.tbsResponseData.tbsView=new Uint8Array(this.tbsResponseData.toSchema(!0).toBER());const c=await s.signWithPrivateKey(this.tbsResponseData.tbsView,e,{algorithm:u});this.signature=new ne({valueHex:c})}async verify(e={},t=te(!0)){let s=null,a=-1;const u=e.trustedCerts||[];if(!this.certs)throw new Error("No certificates attached to the BasicOCSPResponse");switch(!0){case this.tbsResponseData.responderID instanceof fe:for(const[i,o]of this.certs.entries())if(o.subject.isEqual(this.tbsResponseData.responderID)){a=i;break}break;case this.tbsResponseData.responderID instanceof M:for(const[i,o]of this.certs.entries()){const n=await t.digest({name:"sha-1"},o.subjectPublicKeyInfo.subjectPublicKey.valueBlock.valueHexView);if(Wl(n,this.tbsResponseData.responderID.valueBlock.valueHex)){a=i;break}}break;default:throw new Error("Wrong value for responderID")}if(a===-1)throw new Error("Correct certificate was not found in OCSP response");s=this.certs[a];const c=[s];for(const i of this.certs){const o=await $w(i,s);o&&c.push(o)}if(!(await new Wh({certs:c,trustedCerts:u}).verify({},t)).result)throw new Error("Validation of signer's certificate failed");return t.verifyWithPublicKey(this.tbsResponseData.tbsView,this.signature,this.certs[a].subjectPublicKeyInfo,this.signatureAlgorithm)}}Ft.CLASS_NAME="BasicOCSPResponse";const mf="tbs",ff="version",pf="subject",df="subjectPublicKeyInfo",jn="attributes",Cl="signatureAlgorithm",xl="signatureValue",Eo="CertificationRequestInfo",Pp="".concat(Eo,".version"),Op="".concat(Eo,".subject"),Bp="".concat(Eo,".subjectPublicKeyInfo"),$h="".concat(Eo,".attributes"),vS=[Eo,Pp,Op,Bp,$h,Cl,xl];function bS(r={}){const e=y(r,"names",{});return new I({name:e.CertificationRequestInfo||Eo,value:[new R({name:e.CertificationRequestInfoVersion||Pp}),fe.schema(e.subject||{names:{blockName:Op}}),Nt.schema({names:{blockName:Bp}}),new D({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new ee({optional:!0,name:e.CertificationRequestInfoAttributes||$h,value:we.schema(e.attributes||{})})]})]})}class Qt extends ${get tbs(){return ge.toArrayBuffer(this.tbsView)}set tbs(e){this.tbsView=new Uint8Array(e)}constructor(e={}){super(),this.tbsView=new Uint8Array(y(e,mf,Qt.defaultValues(mf))),this.version=y(e,ff,Qt.defaultValues(ff)),this.subject=y(e,pf,Qt.defaultValues(pf)),this.subjectPublicKeyInfo=y(e,df,Qt.defaultValues(df)),jn in e&&(this.attributes=y(e,jn,Qt.defaultValues(jn))),this.signatureAlgorithm=y(e,Cl,Qt.defaultValues(Cl)),this.signatureValue=y(e,xl,Qt.defaultValues(xl)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case mf:return Le;case ff:return 0;case pf:return new fe;case df:return new Nt;case jn:return[];case Cl:return new T;case xl:return new ne;default:return super.defaultValues(e)}}static schema(e={}){const t=y(e,"names",{});return new I({value:[bS(t.certificationRequestInfo||{}),new I({name:t.signatureAlgorithm||Cl,value:[new W,new Z({optional:!0})]}),new ne({name:t.signatureValue||xl})]})}fromSchema(e){U(e,vS);const t=K(e,e,Qt.schema());j.assertSchema(t,this.className),this.tbsView=t.result.CertificationRequestInfo.valueBeforeDecodeView,this.version=t.result[Pp].valueBlock.valueDec,this.subject=new fe({schema:t.result[Op]}),this.subjectPublicKeyInfo=new Nt({schema:t.result[Bp]}),$h in t.result&&(this.attributes=Array.from(t.result[$h],s=>new we({schema:s}))),this.signatureAlgorithm=new T({schema:t.result.signatureAlgorithm}),this.signatureValue=t.result.signatureValue}encodeTBS(){const e=[new R({value:this.version}),this.subject.toSchema(),this.subjectPublicKeyInfo.toSchema()];return jn in this&&e.push(new D({idBlock:{tagClass:3,tagNumber:0},value:Array.from(this.attributes||[],t=>t.toSchema())})),new I({value:e})}toSchema(e=!1){let t;if(e===!1){if(this.tbsView.byteLength===0)return Qt.schema();const s=Re(this.tbsView);j.assert(s,"PKCS#10 Certificate Request"),t=s.result}else t=this.encodeTBS();return new I({value:[t,this.signatureAlgorithm.toSchema(),this.signatureValue]})}toJSON(){const e={tbs:he.ToHex(this.tbsView),version:this.version,subject:this.subject.toJSON(),subjectPublicKeyInfo:this.subjectPublicKeyInfo.toJSON(),signatureAlgorithm:this.signatureAlgorithm.toJSON(),signatureValue:this.signatureValue.toJSON()};return jn in this&&(e.attributes=Array.from(this.attributes||[],t=>t.toJSON())),e}async sign(e,t="SHA-1",s=te(!0)){if(!e)throw new Error("Need to provide a private key for signing");const a=await s.getSignatureParameters(e,t),u=a.parameters;this.signatureAlgorithm=a.signatureAlgorithm,this.tbsView=new Uint8Array(this.encodeTBS().toBER());const c=await s.signWithPrivateKey(this.tbsView,e,u);this.signatureValue=new ne({valueHex:c})}async verify(e=te(!0)){return e.verifyWithPublicKey(this.tbsView,this.signatureValue,this.subjectPublicKeyInfo,this.signatureAlgorithm)}async getPublicKey(e,t=te(!0)){return t.getPublicKey(this.subjectPublicKeyInfo,this.signatureAlgorithm,e)}}Qt.CLASS_NAME="CertificationRequest";const tn="digestAlgorithm",sn="digest",SS=[tn,sn];class qt extends ${constructor(e={}){super(),this.digestAlgorithm=y(e,tn,qt.defaultValues(tn)),this.digest=y(e,sn,qt.defaultValues(sn)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case tn:return new T;case sn:return new M;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case tn:return T.compareWithDefault("algorithmId",t.algorithmId)&&!("algorithmParams"in t);case sn:return t.isEqual(qt.defaultValues(e));default:return super.defaultValues(e)}}static schema(e={}){const t=y(e,"names",{});return new I({name:t.blockName||N,value:[T.schema(t.digestAlgorithm||{names:{blockName:tn}}),new M({name:t.digest||sn})]})}fromSchema(e){U(e,SS);const t=K(e,e,qt.schema({names:{digestAlgorithm:{names:{blockName:tn}},digest:sn}}));j.assertSchema(t,this.className),this.digestAlgorithm=new T({schema:t.result.digestAlgorithm}),this.digest=t.result.digest}toSchema(){return new I({value:[this.digestAlgorithm.toSchema(),this.digest]})}toJSON(){return{digestAlgorithm:this.digestAlgorithm.toJSON(),digest:this.digest.toJSON()}}}qt.CLASS_NAME="DigestInfo";const $i="eContentType",zt="eContent",AS=[$i,zt];class xt extends ${constructor(e={}){if(super(),this.eContentType=y(e,$i,xt.defaultValues($i)),zt in e&&(this.eContent=y(e,zt,xt.defaultValues(zt)),this.eContent.idBlock.tagClass===1&&this.eContent.idBlock.tagNumber===4&&this.eContent.idBlock.isConstructed===!1)){const t=new M({idBlock:{isConstructed:!0},isConstructed:!0});let s=0;const a=this.eContent.valueBlock.valueHexView.slice().buffer;let u=a.byteLength;for(;u>0;){const c=new Uint8Array(a,s,s+65536>a.byteLength?a.byteLength-s:65536),i=new ArrayBuffer(c.length),o=new Uint8Array(i);for(let n=0;n<o.length;n++)o[n]=c[n];t.valueBlock.value.push(new M({valueHex:i})),u-=c.length,s+=c.length}this.eContent=t}e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case $i:return N;case zt:return new M;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case $i:return t===N;case zt:return t.idBlock.tagClass===1&&t.idBlock.tagNumber===4?t.isEqual(xt.defaultValues(zt)):!1;default:return super.defaultValues(e)}}static schema(e={}){const t=y(e,"names",{});return new I({name:t.blockName||N,value:[new W({name:t.eContentType||N}),new D({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new Z({name:t.eContent||N})]})]})}fromSchema(e){U(e,AS);const t=K(e,e,xt.schema({names:{eContentType:$i,eContent:zt}}));j.assertSchema(t,this.className),this.eContentType=t.result.eContentType.valueBlock.toString(),zt in t.result&&(this.eContent=t.result.eContent)}toSchema(){const e=[];return e.push(new W({value:this.eContentType})),this.eContent&&xt.compareWithDefault(zt,this.eContent)===!1&&e.push(new D({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[this.eContent]})),new I({value:e})}toJSON(){const e={eContentType:this.eContentType};return this.eContent&&xt.compareWithDefault(zt,this.eContent)===!1&&(e.eContent=this.eContent.toJSON()),e}}xt.CLASS_NAME="EncapsulatedContentInfo";const rn="mac",an="macSalt",Es="iterations",NS=[rn,an,Es];class wt extends ${constructor(e={}){super(),this.mac=y(e,rn,wt.defaultValues(rn)),this.macSalt=y(e,an,wt.defaultValues(an)),Es in e&&(this.iterations=y(e,Es,wt.defaultValues(Es))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case rn:return new qt;case an:return new M;case Es:return 1;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case rn:return qt.compareWithDefault("digestAlgorithm",t.digestAlgorithm)&&qt.compareWithDefault("digest",t.digest);case an:return t.isEqual(wt.defaultValues(e));case Es:return t===wt.defaultValues(e);default:return super.defaultValues(e)}}static schema(e={}){const t=y(e,"names",{});return new I({name:t.blockName||N,optional:t.optional||!0,value:[qt.schema(t.mac||{names:{blockName:rn}}),new M({name:t.macSalt||an}),new R({optional:!0,name:t.iterations||Es})]})}fromSchema(e){U(e,NS);const t=K(e,e,wt.schema({names:{mac:{names:{blockName:rn}},macSalt:an,iterations:Es}}));j.assertSchema(t,this.className),this.mac=new qt({schema:t.result.mac}),this.macSalt=t.result.macSalt,Es in t.result&&(this.iterations=t.result.iterations.valueBlock.valueDec)}toSchema(){const e=[this.mac.toSchema(),this.macSalt];return this.iterations!==void 0&&e.push(new R({value:this.iterations})),new I({value:e})}toJSON(){const e={mac:this.mac.toJSON(),macSalt:this.macSalt.toJSON()};return this.iterations!==void 0&&(e.iterations=this.iterations),e}}wt.CLASS_NAME="MacData";const mn="hashAlgorithm",fn="hashedMessage",kS=[mn,fn];class at extends ${static async create(e,t,s=te(!0)){const a=s.getOIDByAlgorithm({name:e},!0,"hashAlgorithm"),u=await s.digest(e,t);return new at({hashAlgorithm:new T({algorithmId:a,algorithmParams:new Me}),hashedMessage:new M({valueHex:u})})}constructor(e={}){super(),this.hashAlgorithm=y(e,mn,at.defaultValues(mn)),this.hashedMessage=y(e,fn,at.defaultValues(fn)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case mn:return new T;case fn:return new M;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case mn:return t.algorithmId===N&&!("algorithmParams"in t);case fn:return t.isEqual(at.defaultValues(e))===0;default:return super.defaultValues(e)}}static schema(e={}){const t=y(e,"names",{});return new I({name:t.blockName||N,value:[T.schema(t.hashAlgorithm||{}),new M({name:t.hashedMessage||N})]})}fromSchema(e){U(e,kS);const t=K(e,e,at.schema({names:{hashAlgorithm:{names:{blockName:mn}},hashedMessage:fn}}));j.assertSchema(t,this.className),this.hashAlgorithm=new T({schema:t.result.hashAlgorithm}),this.hashedMessage=t.result.hashedMessage}toSchema(){return new I({value:[this.hashAlgorithm.toSchema(),this.hashedMessage]})}toJSON(){return{hashAlgorithm:this.hashAlgorithm.toJSON(),hashedMessage:this.hashedMessage.toJSON()}}}at.CLASS_NAME="MessageImprint";const Ui="reqCert",Dr="singleRequestExtensions",ES=[Ui,Dr];let Uh=class Il extends ${constructor(e={}){super(),this.reqCert=y(e,Ui,Il.defaultValues(Ui)),Dr in e&&(this.singleRequestExtensions=y(e,Dr,Il.defaultValues(Dr))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Ui:return new De;case Dr:return[];default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Ui:return t.isEqual(Il.defaultValues(e));case Dr:return t.length===0;default:return super.defaultValues(e)}}static schema(e={}){const t=y(e,"names",{});return new I({name:t.blockName||N,value:[De.schema(t.reqCert||{}),new D({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[Be.schema(t.extensions||{names:{blockName:t.singleRequestExtensions||N}})]})]})}fromSchema(e){U(e,ES);const t=K(e,e,Il.schema({names:{reqCert:{names:{blockName:Ui}},extensions:{names:{blockName:Dr}}}}));j.assertSchema(t,this.className),this.reqCert=new De({schema:t.result.reqCert}),Dr in t.result&&(this.singleRequestExtensions=Array.from(t.result.singleRequestExtensions.valueBlock.value,s=>new Be({schema:s})))}toSchema(){const e=[];return e.push(this.reqCert.toSchema()),this.singleRequestExtensions&&e.push(new D({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new I({value:Array.from(this.singleRequestExtensions,t=>t.toSchema())})]})),new I({value:e})}toJSON(){const e={reqCert:this.reqCert.toJSON()};return this.singleRequestExtensions&&(e.singleRequestExtensions=Array.from(this.singleRequestExtensions,t=>t.toJSON())),e}};Uh.CLASS_NAME="Request";const Tc="tbs",Ki="version",Hi="requestorName",Rc="requestList",Mi="requestExtensions",Co="TBSRequest",Zc="".concat(Co,".").concat(Ki),eh="".concat(Co,".").concat(Hi),Kf="".concat(Co,".requests"),th="".concat(Co,".").concat(Mi),CS=[Co,Zc,eh,Kf,th];class st extends ${get tbs(){return ge.toArrayBuffer(this.tbsView)}set tbs(e){this.tbsView=new Uint8Array(e)}constructor(e={}){super(),this.tbsView=new Uint8Array(y(e,Tc,st.defaultValues(Tc))),Ki in e&&(this.version=y(e,Ki,st.defaultValues(Ki))),Hi in e&&(this.requestorName=y(e,Hi,st.defaultValues(Hi))),this.requestList=y(e,Rc,st.defaultValues(Rc)),Mi in e&&(this.requestExtensions=y(e,Mi,st.defaultValues(Mi))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Tc:return Le;case Ki:return 0;case Hi:return new le;case Rc:case Mi:return[];default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Tc:return t.byteLength===0;case Ki:return t===st.defaultValues(e);case Hi:return t.type===le.defaultValues("type")&&Object.keys(t.value).length===0;case Rc:case Mi:return t.length===0;default:return super.defaultValues(e)}}static schema(e={}){const t=y(e,"names",{});return new I({name:t.blockName||Co,value:[new D({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new R({name:t.TBSRequestVersion||Zc})]}),new D({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[le.schema(t.requestorName||{names:{blockName:eh}})]}),new I({name:t.requestList||"TBSRequest.requestList",value:[new ee({name:t.requests||Kf,value:Uh.schema(t.requestNames||{})})]}),new D({optional:!0,idBlock:{tagClass:3,tagNumber:2},value:[je.schema(t.extensions||{names:{blockName:t.requestExtensions||th}})]})]})}fromSchema(e){U(e,CS);const t=K(e,e,st.schema());j.assertSchema(t,this.className),this.tbsView=t.result.TBSRequest.valueBeforeDecodeView,Zc in t.result&&(this.version=t.result[Zc].valueBlock.valueDec),eh in t.result&&(this.requestorName=new le({schema:t.result[eh]})),this.requestList=Array.from(t.result[Kf],s=>new Uh({schema:s})),th in t.result&&(this.requestExtensions=Array.from(t.result[th].valueBlock.value,s=>new Be({schema:s})))}toSchema(e=!1){let t;if(e===!1){if(this.tbsView.byteLength===0)return st.schema();const s=Re(this.tbsView);if(j.assert(s,"TBS Request"),!(s.result instanceof I))throw new Error("ASN.1 result should be SEQUENCE");t=s.result}else{const s=[];this.version!==void 0&&s.push(new D({idBlock:{tagClass:3,tagNumber:0},value:[new R({value:this.version})]})),this.requestorName&&s.push(new D({idBlock:{tagClass:3,tagNumber:1},value:[this.requestorName.toSchema()]})),s.push(new I({value:Array.from(this.requestList,a=>a.toSchema())})),this.requestExtensions&&s.push(new D({idBlock:{tagClass:3,tagNumber:2},value:[new I({value:Array.from(this.requestExtensions,a=>a.toSchema())})]})),t=new I({value:s})}return t}toJSON(){const e={};return this.version!=null&&(e.version=this.version),this.requestorName&&(e.requestorName=this.requestorName.toJSON()),e.requestList=Array.from(this.requestList,t=>t.toJSON()),this.requestExtensions&&(e.requestExtensions=Array.from(this.requestExtensions,t=>t.toJSON())),e}}st.CLASS_NAME="TBSRequest";const $n="signatureAlgorithm",Un="signature",Ys="certs";class Bt extends ${constructor(e={}){super(),this.signatureAlgorithm=y(e,$n,Bt.defaultValues($n)),this.signature=y(e,Un,Bt.defaultValues(Un)),Ys in e&&(this.certs=y(e,Ys,Bt.defaultValues(Ys))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case $n:return new T;case Un:return new ne;case Ys:return[];default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case $n:return t.algorithmId===N&&!("algorithmParams"in t);case Un:return t.isEqual(Bt.defaultValues(e));case Ys:return t.length===0;default:return super.defaultValues(e)}}static schema(e={}){const t=y(e,"names",{});return new I({name:t.blockName||N,value:[T.schema(t.signatureAlgorithm||{}),new ne({name:t.signature||N}),new D({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new I({value:[new ee({name:t.certs||N,value:ue.schema({})})]})]})]})}fromSchema(e){U(e,[$n,Un,Ys]);const t=K(e,e,Bt.schema({names:{signatureAlgorithm:{names:{blockName:$n}},signature:Un,certs:Ys}}));j.assertSchema(t,this.className),this.signatureAlgorithm=new T({schema:t.result.signatureAlgorithm}),this.signature=t.result.signature,Ys in t.result&&(this.certs=Array.from(t.result.certs,s=>new ue({schema:s})))}toSchema(){const e=[];return e.push(this.signatureAlgorithm.toSchema()),e.push(this.signature),this.certs&&e.push(new D({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new I({value:Array.from(this.certs,t=>t.toSchema())})]})),new I({value:e})}toJSON(){const e={signatureAlgorithm:this.signatureAlgorithm.toJSON(),signature:this.signature.toJSON()};return this.certs&&(e.certs=Array.from(this.certs,t=>t.toJSON())),e}}Bt.CLASS_NAME="Signature";const Fi="tbsRequest",Tr="optionalSignature",xS=[Fi,Tr];class Fl extends ${constructor(e={}){super(),this.tbsRequest=y(e,Fi,Fl.defaultValues(Fi)),Tr in e&&(this.optionalSignature=y(e,Tr,Fl.defaultValues(Tr))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Fi:return new st;case Tr:return new Bt;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Fi:return st.compareWithDefault("tbs",t.tbs)&&st.compareWithDefault("version",t.version)&&st.compareWithDefault("requestorName",t.requestorName)&&st.compareWithDefault("requestList",t.requestList)&&st.compareWithDefault("requestExtensions",t.requestExtensions);case Tr:return Bt.compareWithDefault("signatureAlgorithm",t.signatureAlgorithm)&&Bt.compareWithDefault("signature",t.signature)&&Bt.compareWithDefault("certs",t.certs);default:return super.defaultValues(e)}}static schema(e={}){const t=y(e,"names",{});return new I({name:t.blockName||"OCSPRequest",value:[st.schema(t.tbsRequest||{names:{blockName:Fi}}),new D({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[Bt.schema(t.optionalSignature||{names:{blockName:Tr}})]})]})}fromSchema(e){U(e,xS);const t=K(e,e,Fl.schema());j.assertSchema(t,this.className),this.tbsRequest=new st({schema:t.result.tbsRequest}),Tr in t.result&&(this.optionalSignature=new Bt({schema:t.result.optionalSignature}))}toSchema(e=!1){const t=[];return t.push(this.tbsRequest.toSchema(e)),this.optionalSignature&&t.push(new D({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[this.optionalSignature.toSchema()]})),new I({value:t})}toJSON(){const e={tbsRequest:this.tbsRequest.toJSON()};return this.optionalSignature&&(e.optionalSignature=this.optionalSignature.toJSON()),e}async createForCertificate(e,t,s=te(!0)){const a=new De;await a.createForCertificate(e,t,s),this.tbsRequest.requestList.push(new Uh({reqCert:a}))}async sign(e,t="SHA-1",s=te(!0)){if(ie.assertEmpty(e,"privateKey","OCSPRequest.sign method"),!this.optionalSignature)throw new Error('Need to create "optionalSignature" field before signing');const a=await s.getSignatureParameters(e,t),u=a.parameters;this.optionalSignature.signatureAlgorithm=a.signatureAlgorithm;const c=this.tbsRequest.toSchema(!0).toBER(!1),i=await s.signWithPrivateKey(c,e,u);this.optionalSignature.signature=new ne({valueHex:i})}verify(){}}Fl.CLASS_NAME="OCSPRequest";const Ji="responseType",qi="response",IS=[Ji,qi];class ts extends ${constructor(e={}){super(),this.responseType=y(e,Ji,ts.defaultValues(Ji)),this.response=y(e,qi,ts.defaultValues(qi)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Ji:return N;case qi:return new M;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Ji:return t===N;case qi:return t.isEqual(ts.defaultValues(e));default:return super.defaultValues(e)}}static schema(e={}){const t=y(e,"names",{});return new I({name:t.blockName||N,value:[new W({name:t.responseType||N}),new M({name:t.response||N})]})}fromSchema(e){U(e,IS);const t=K(e,e,ts.schema({names:{responseType:Ji,response:qi}}));j.assertSchema(t,this.className),this.responseType=t.result.responseType.valueBlock.toString(),this.response=t.result.response}toSchema(){return new I({value:[new W({value:this.responseType}),this.response]})}toJSON(){return{responseType:this.responseType,response:this.response.toJSON()}}}ts.CLASS_NAME="ResponseBytes";const Kn="responseStatus",gs="responseBytes";class co extends ${constructor(e={}){super(),this.responseStatus=y(e,Kn,co.defaultValues(Kn)),gs in e&&(this.responseBytes=y(e,gs,co.defaultValues(gs))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Kn:return new Gl;case gs:return new ts;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Kn:return t.isEqual(co.defaultValues(e));case gs:return ts.compareWithDefault("responseType",t.responseType)&&ts.compareWithDefault("response",t.response);default:return super.defaultValues(e)}}static schema(e={}){const t=y(e,"names",{});return new I({name:t.blockName||"OCSPResponse",value:[new Gl({name:t.responseStatus||Kn}),new D({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[ts.schema(t.responseBytes||{names:{blockName:gs}})]})]})}fromSchema(e){U(e,[Kn,gs]);const t=K(e,e,co.schema());j.assertSchema(t,this.className),this.responseStatus=t.result.responseStatus,gs in t.result&&(this.responseBytes=new ts({schema:t.result.responseBytes}))}toSchema(){const e=[];return e.push(this.responseStatus),this.responseBytes&&e.push(new D({idBlock:{tagClass:3,tagNumber:0},value:[this.responseBytes.toSchema()]})),new I({value:e})}toJSON(){const e={responseStatus:this.responseStatus.toJSON()};return this.responseBytes&&(e.responseBytes=this.responseBytes.toJSON()),e}async getCertificateStatus(e,t,s=te(!0)){let a;const u={isForCertificate:!1,status:2};if(!this.responseBytes||this.responseBytes.responseType!==Hc)return u;try{const c=Re(this.responseBytes.response.valueBlock.valueHexView);j.assert(c,"Basic OCSP response"),a=new Ft({schema:c.result})}catch(c){return u}return a.getCertificateStatus(e,t,s)}async sign(e,t,s=te(!0)){var a;if(this.responseBytes&&this.responseBytes.responseType===Hc)return Ft.fromBER(this.responseBytes.response.valueBlock.valueHexView).sign(e,t,s);throw new Error("Unknown ResponseBytes type: ".concat(((a=this.responseBytes)===null||a===void 0?void 0:a.responseType)||"Unknown"))}async verify(e=null,t=te(!0)){var s;if(!(gs in this))throw new Error("Empty ResponseBytes field");if(this.responseBytes&&this.responseBytes.responseType===Hc){const a=Ft.fromBER(this.responseBytes.response.valueBlock.valueHexView);return e!==null&&(a.certs||(a.certs=[]),a.certs.push(e)),a.verify({},t)}throw new Error("Unknown ResponseBytes type: ".concat(((s=this.responseBytes)===null||s===void 0?void 0:s.responseType)||"Unknown"))}}co.CLASS_NAME="OCSPResponse";const ca="type",Cs="attributes",Lc="encodedValue",VS=[Cs];class Se extends ${constructor(e={}){super(),this.type=y(e,ca,Se.defaultValues(ca)),this.attributes=y(e,Cs,Se.defaultValues(Cs)),this.encodedValue=y(e,Lc,Se.defaultValues(Lc)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case ca:return-1;case Cs:return[];case Lc:return Le;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case ca:return t===Se.defaultValues(ca);case Cs:return t.length===0;case Lc:return t.byteLength===0;default:return super.defaultValues(e)}}static schema(e={}){const t=y(e,"names",{});return new D({name:t.blockName||N,optional:!0,idBlock:{tagClass:3,tagNumber:t.tagNumber||0},value:[new ee({name:t.attributes||N,value:we.schema()})]})}fromSchema(e){U(e,VS);const t=K(e,e,Se.schema({names:{tagNumber:this.type,attributes:Cs}}));j.assertSchema(t,this.className),this.type=t.result.idBlock.tagNumber,this.encodedValue=ge.toArrayBuffer(t.result.valueBeforeDecodeView);const s=new Uint8Array(this.encodedValue);if(s[0]=49,!(Cs in t.result)){if(this.type===0)throw new Error("Wrong structure of SignedUnsignedAttributes");return}this.attributes=Array.from(t.result.attributes,a=>new we({schema:a}))}toSchema(){if(Se.compareWithDefault(ca,this.type)||Se.compareWithDefault(Cs,this.attributes))throw new Error('Incorrectly initialized "SignedAndUnsignedAttributes" class');return new D({optional:!0,idBlock:{tagClass:3,tagNumber:this.type},value:Array.from(this.attributes,e=>e.toSchema())})}toJSON(){if(Se.compareWithDefault(ca,this.type)||Se.compareWithDefault(Cs,this.attributes))throw new Error('Incorrectly initialized "SignedAndUnsignedAttributes" class');return{type:this.type,attributes:Array.from(this.attributes,e=>e.toJSON())}}}Se.CLASS_NAME="SignedAndUnsignedAttributes";const Wi="version",nn="sid",Gi="digestAlgorithm",Rr="signedAttrs",_i="signatureAlgorithm",Vl="signature",Lr="unsignedAttrs",aa="SignerInfo",Hf="".concat(aa,".").concat(Wi),Pl="".concat(aa,".").concat(nn),Mf="".concat(aa,".").concat(Gi),sh="".concat(aa,".").concat(Rr),Ff="".concat(aa,".").concat(_i),Jf="".concat(aa,".").concat(Vl),rh="".concat(aa,".").concat(Lr),PS=[Hf,Pl,Mf,sh,Ff,Jf,rh];class Ve extends ${constructor(e={}){super(),this.version=y(e,Wi,Ve.defaultValues(Wi)),this.sid=y(e,nn,Ve.defaultValues(nn)),this.digestAlgorithm=y(e,Gi,Ve.defaultValues(Gi)),Rr in e&&(this.signedAttrs=y(e,Rr,Ve.defaultValues(Rr))),this.signatureAlgorithm=y(e,_i,Ve.defaultValues(_i)),this.signature=y(e,Vl,Ve.defaultValues(Vl)),Lr in e&&(this.unsignedAttrs=y(e,Lr,Ve.defaultValues(Lr))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Wi:return 0;case nn:return new Z;case Gi:return new T;case Rr:return new Se({type:0});case _i:return new T;case Vl:return new M;case Lr:return new Se({type:1});default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Wi:return Ve.defaultValues(Wi)===t;case nn:return t instanceof Z;case Gi:return t instanceof T?t.isEqual(Ve.defaultValues(Gi)):!1;case Rr:return Se.compareWithDefault("type",t.type)&&Se.compareWithDefault("attributes",t.attributes)&&Se.compareWithDefault("encodedValue",t.encodedValue);case _i:return t instanceof T?t.isEqual(Ve.defaultValues(_i)):!1;case Vl:case Lr:return Se.compareWithDefault("type",t.type)&&Se.compareWithDefault("attributes",t.attributes)&&Se.compareWithDefault("encodedValue",t.encodedValue);default:return super.defaultValues(e)}}static schema(e={}){const t=y(e,"names",{});return new I({name:aa,value:[new R({name:t.version||Hf}),new Ne({value:[$e.schema(t.sidSchema||{names:{blockName:Pl}}),new Ne({value:[new D({optional:!0,name:t.sid||Pl,idBlock:{tagClass:3,tagNumber:0},value:[new M]}),new Y({optional:!0,name:t.sid||Pl,idBlock:{tagClass:3,tagNumber:0}})]})]}),T.schema(t.digestAlgorithm||{names:{blockName:Mf}}),Se.schema(t.signedAttrs||{names:{blockName:sh,tagNumber:0}}),T.schema(t.signatureAlgorithm||{names:{blockName:Ff}}),new M({name:t.signature||Jf}),Se.schema(t.unsignedAttrs||{names:{blockName:rh,tagNumber:1}})]})}fromSchema(e){U(e,PS);const t=K(e,e,Ve.schema());j.assertSchema(t,this.className),this.version=t.result[Hf].valueBlock.valueDec;const s=t.result[Pl];s.idBlock.tagClass===1?this.sid=new $e({schema:s}):this.sid=s,this.digestAlgorithm=new T({schema:t.result[Mf]}),sh in t.result&&(this.signedAttrs=new Se({type:0,schema:t.result[sh]})),this.signatureAlgorithm=new T({schema:t.result[Ff]}),this.signature=t.result[Jf],rh in t.result&&(this.unsignedAttrs=new Se({type:1,schema:t.result[rh]}))}toSchema(){if(Ve.compareWithDefault(nn,this.sid))throw new Error('Incorrectly initialized "SignerInfo" class');const e=[];return e.push(new R({value:this.version})),this.sid instanceof $e?e.push(this.sid.toSchema()):e.push(this.sid),e.push(this.digestAlgorithm.toSchema()),this.signedAttrs&&Ve.compareWithDefault(Rr,this.signedAttrs)===!1&&e.push(this.signedAttrs.toSchema()),e.push(this.signatureAlgorithm.toSchema()),e.push(this.signature),this.unsignedAttrs&&Ve.compareWithDefault(Lr,this.unsignedAttrs)===!1&&e.push(this.unsignedAttrs.toSchema()),new I({value:e})}toJSON(){if(Ve.compareWithDefault(nn,this.sid))throw new Error('Incorrectly initialized "SignerInfo" class');const e={version:this.version,digestAlgorithm:this.digestAlgorithm.toJSON(),signatureAlgorithm:this.signatureAlgorithm.toJSON(),signature:this.signature.toJSON()};return this.sid instanceof Z||(e.sid=this.sid.toJSON()),this.signedAttrs&&Ve.compareWithDefault(Rr,this.signedAttrs)===!1&&(e.signedAttrs=this.signedAttrs.toJSON()),this.unsignedAttrs&&Ve.compareWithDefault(Lr,this.unsignedAttrs)===!1&&(e.unsignedAttrs=this.unsignedAttrs.toJSON()),e}}Ve.CLASS_NAME="SignerInfo";const Ol="version",Bl="policy",Dl="messageImprint",Tl="serialNumber",Rl="genTime",on="ordering",un="nonce",Xi="accuracy",zi="tsa",Qi="extensions",as="TSTInfo",qf="".concat(as,".").concat(Ol),Wf="".concat(as,".").concat(Bl),Gf="".concat(as,".").concat(Dl),_f="".concat(as,".").concat(Tl),Xf="".concat(as,".").concat(Rl),ah="".concat(as,".").concat(Xi),nh="".concat(as,".").concat(on),ih="".concat(as,".").concat(un),oh="".concat(as,".").concat(zi),uh="".concat(as,".").concat(Qi),OS=[qf,Wf,Gf,_f,Xf,ah,nh,ih,oh,uh];class ut extends ${constructor(e={}){super(),this.version=y(e,Ol,ut.defaultValues(Ol)),this.policy=y(e,Bl,ut.defaultValues(Bl)),this.messageImprint=y(e,Dl,ut.defaultValues(Dl)),this.serialNumber=y(e,Tl,ut.defaultValues(Tl)),this.genTime=y(e,Rl,ut.defaultValues(Rl)),Xi in e&&(this.accuracy=y(e,Xi,ut.defaultValues(Xi))),on in e&&(this.ordering=y(e,on,ut.defaultValues(on))),un in e&&(this.nonce=y(e,un,ut.defaultValues(un))),zi in e&&(this.tsa=y(e,zi,ut.defaultValues(zi))),Qi in e&&(this.extensions=y(e,Qi,ut.defaultValues(Qi))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Ol:return 0;case Bl:return N;case Dl:return new at;case Tl:return new R;case Rl:return new Date(0,0,0);case Xi:return new Ot;case on:return!1;case un:return new R;case zi:return new le;case Qi:return[];default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Ol:case Bl:case Rl:case on:return t===ut.defaultValues(on);case Dl:return at.compareWithDefault(mn,t.hashAlgorithm)&&at.compareWithDefault(fn,t.hashedMessage);case Tl:case un:return t.isEqual(ut.defaultValues(un));case Xi:return Ot.compareWithDefault(tr,t.seconds)&&Ot.compareWithDefault(sr,t.millis)&&Ot.compareWithDefault(rr,t.micros);case zi:return le.compareWithDefault(qo,t.type)&&le.compareWithDefault(Wo,t.value);case Qi:return t.length===0;default:return super.defaultValues(e)}}static schema(e={}){const t=y(e,"names",{});return new I({name:t.blockName||as,value:[new R({name:t.version||qf}),new W({name:t.policy||Wf}),at.schema(t.messageImprint||{names:{blockName:Gf}}),new R({name:t.serialNumber||_f}),new ke({name:t.genTime||Xf}),Ot.schema(t.accuracy||{names:{blockName:ah}}),new ra({name:t.ordering||nh,optional:!0}),new R({name:t.nonce||ih,optional:!0}),new D({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[le.schema(t.tsa||{names:{blockName:oh}})]}),new D({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[new ee({name:t.extensions||uh,value:Be.schema(t.extension||{})})]})]})}fromSchema(e){U(e,OS);const t=K(e,e,ut.schema());j.assertSchema(t,this.className),this.version=t.result[qf].valueBlock.valueDec,this.policy=t.result[Wf].valueBlock.toString(),this.messageImprint=new at({schema:t.result[Gf]}),this.serialNumber=t.result[_f],this.genTime=t.result[Xf].toDate(),ah in t.result&&(this.accuracy=new Ot({schema:t.result[ah]})),nh in t.result&&(this.ordering=t.result[nh].valueBlock.value),ih in t.result&&(this.nonce=t.result[ih]),oh in t.result&&(this.tsa=new le({schema:t.result[oh]})),uh in t.result&&(this.extensions=Array.from(t.result[uh],s=>new Be({schema:s})))}toSchema(){const e=[];return e.push(new R({value:this.version})),e.push(new W({value:this.policy})),e.push(this.messageImprint.toSchema()),e.push(this.serialNumber),e.push(new ke({valueDate:this.genTime})),this.accuracy&&e.push(this.accuracy.toSchema()),this.ordering!==void 0&&e.push(new ra({value:this.ordering})),this.nonce&&e.push(this.nonce),this.tsa&&e.push(new D({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[this.tsa.toSchema()]})),this.extensions&&e.push(new D({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:Array.from(this.extensions,t=>t.toSchema())})),new I({value:e})}toJSON(){const e={version:this.version,policy:this.policy,messageImprint:this.messageImprint.toJSON(),serialNumber:this.serialNumber.toJSON(),genTime:this.genTime};return this.accuracy&&(e.accuracy=this.accuracy.toJSON()),this.ordering!==void 0&&(e.ordering=this.ordering),this.nonce&&(e.nonce=this.nonce.toJSON()),this.tsa&&(e.tsa=this.tsa.toJSON()),this.extensions&&(e.extensions=Array.from(this.extensions,t=>t.toJSON())),e}async verify(e,t=te(!0)){if(!e.data)throw new Error('"data" is a mandatory attribute for TST_INFO verification');const s=e.data;if(e.notBefore&&this.genTime<e.notBefore)throw new Error("Generation time for TSTInfo object is less than notBefore value");if(e.notAfter&&this.genTime>e.notAfter)throw new Error("Generation time for TSTInfo object is more than notAfter value");const a=t.getAlgorithmByOID(this.messageImprint.hashAlgorithm.algorithmId,!0,"MessageImprint.hashAlgorithm"),u=await t.digest(a.name,new Uint8Array(s));return ge.isEqual(u,this.messageImprint.hashedMessage.valueBlock.valueHexView)}}ut.CLASS_NAME="TSTInfo";const Yi="version",Ll="digestAlgorithms",jl="encapContentInfo",Zi="certificates",eo="crls",$l="signerInfos",Mo="ocsps",Bn="SignedData",zf="".concat(Bn,".").concat(Yi),lh="".concat(Bn,".").concat(Ll),Qf="".concat(Bn,".").concat(jl),ch="".concat(Bn,".").concat(Zi),hh="".concat(Bn,".").concat(eo),mh="".concat(Bn,".").concat($l),BS=[zf,lh,Qf,ch,hh,mh];class ot extends Error{constructor({message:e,code:t=0,date:s=new Date,signatureVerified:a=null,signerCertificate:u=null,signerCertificateVerified:c=null,timestampSerial:i=null,certificatePath:o=[]}){super(e),this.name="SignedDataVerifyError",this.date=s,this.code=t,this.timestampSerial=i,this.signatureVerified=a,this.signerCertificate=u,this.signerCertificateVerified=c,this.certificatePath=o}}class tt extends ${constructor(e={}){super(),this.version=y(e,Yi,tt.defaultValues(Yi)),this.digestAlgorithms=y(e,Ll,tt.defaultValues(Ll)),this.encapContentInfo=y(e,jl,tt.defaultValues(jl)),Zi in e&&(this.certificates=y(e,Zi,tt.defaultValues(Zi))),eo in e&&(this.crls=y(e,eo,tt.defaultValues(eo))),Mo in e&&(this.ocsps=y(e,Mo,tt.defaultValues(Mo))),this.signerInfos=y(e,$l,tt.defaultValues($l)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Yi:return 0;case Ll:return[];case jl:return new xt;case Zi:return[];case eo:return[];case Mo:return[];case $l:return[];default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Yi:return t===tt.defaultValues(Yi);case jl:return xt.compareWithDefault("eContentType",t.eContentType)&&xt.compareWithDefault("eContent",t.eContent);case Ll:case Zi:case eo:case Mo:case $l:return t.length===0;default:return super.defaultValues(e)}}static schema(e={}){const t=y(e,"names",{});return t.optional===void 0&&(t.optional=!1),new I({name:t.blockName||Bn,optional:t.optional,value:[new R({name:t.version||zf}),new Fe({value:[new ee({name:t.digestAlgorithms||lh,value:T.schema()})]}),xt.schema(t.encapContentInfo||{names:{blockName:Qf}}),new D({name:t.certificates||ch,optional:!0,idBlock:{tagClass:3,tagNumber:0},value:fs.schema().valueBlock.value}),new D({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:Ks.schema(t.crls||{names:{crls:hh}}).valueBlock.value}),new Fe({value:[new ee({name:t.signerInfos||mh,value:Ve.schema()})]})]})}fromSchema(e){U(e,BS);const t=K(e,e,tt.schema());if(j.assertSchema(t,this.className),this.version=t.result[zf].valueBlock.valueDec,lh in t.result&&(this.digestAlgorithms=Array.from(t.result[lh],s=>new T({schema:s}))),this.encapContentInfo=new xt({schema:t.result[Qf]}),ch in t.result){const s=new fs({schema:new Fe({value:t.result[ch].valueBlock.value})});this.certificates=s.certificates.slice(0)}hh in t.result&&(this.crls=Array.from(t.result[hh],s=>s.idBlock.tagClass===1?new He({schema:s}):(s.idBlock.tagClass=1,s.idBlock.tagNumber=16,new Us({schema:s})))),mh in t.result&&(this.signerInfos=Array.from(t.result[mh],s=>new Ve({schema:s})))}toSchema(e=!1){const t=[];if(this.certificates&&this.certificates.length&&this.certificates.some(s=>s instanceof ea)||this.crls&&this.crls.length&&this.crls.some(s=>s instanceof Us)?this.version=5:this.certificates&&this.certificates.length&&this.certificates.some(s=>s instanceof Tt)?this.version=4:this.certificates&&this.certificates.length&&this.certificates.some(s=>s instanceof Ts)||this.signerInfos.some(s=>s.version===3)||this.encapContentInfo.eContentType!==tt.ID_DATA?this.version=3:this.version=1,t.push(new R({value:this.version})),t.push(new Fe({value:Array.from(this.digestAlgorithms,s=>s.toSchema())})),t.push(this.encapContentInfo.toSchema()),this.certificates){const s=new fs({certificates:this.certificates}).toSchema();t.push(new D({idBlock:{tagClass:3,tagNumber:0},value:s.valueBlock.value}))}return this.crls&&t.push(new D({idBlock:{tagClass:3,tagNumber:1},value:Array.from(this.crls,s=>{if(s instanceof Us){const a=s.toSchema();return a.idBlock.tagClass=3,a.idBlock.tagNumber=1,a}return s.toSchema(e)})})),t.push(new Fe({value:Array.from(this.signerInfos,s=>s.toSchema())})),new I({value:t})}toJSON(){const e={version:this.version,digestAlgorithms:Array.from(this.digestAlgorithms,t=>t.toJSON()),encapContentInfo:this.encapContentInfo.toJSON(),signerInfos:Array.from(this.signerInfos,t=>t.toJSON())};return this.certificates&&(e.certificates=Array.from(this.certificates,t=>t.toJSON())),this.crls&&(e.crls=Array.from(this.crls,t=>t.toJSON())),e}async verify({signer:e=-1,data:t=Le,trustedCerts:s=[],checkDate:a=new Date,checkChain:u=!1,passedWhenNotRevValues:c=!1,extendedMode:i=!1,findOrigin:o=null,findIssuer:n=null}={},l=te(!0)){let m=null,h=null;try{let g=Le,p=N,w=[];const b=this.signerInfos[e];if(!b)throw new ot({date:a,code:1,message:"Unable to get signer by supplied index"});if(!this.certificates)throw new ot({date:a,code:2,message:"No certificates attached to this signed data"});if(b.sid instanceof $e){for(const C of this.certificates)if(C instanceof ue&&C.issuer.isEqual(b.sid.issuer)&&C.serialNumber.isEqual(b.sid.serialNumber)){m=C;break}}else{const C=b.sid,S=C.idBlock.isConstructed?C.valueBlock.value[0].valueBlock.valueHex:C.valueBlock.valueHex;for(const v of this.certificates){if(!(v instanceof ue))continue;const E=await l.digest({name:"sha-1"},v.subjectPublicKeyInfo.subjectPublicKey.valueBlock.valueHexView);if(Wl(E,S)){m=v;break}}}if(!m)throw new ot({date:a,code:3,message:"Unable to find signer certificate"});if(this.encapContentInfo.eContentType===L1){if(!this.encapContentInfo.eContent)throw new ot({date:a,code:15,message:"Error during verification: TSTInfo eContent is empty",signatureVerified:null,signerCertificate:m,timestampSerial:h,signerCertificateVerified:!0});let C;try{C=ut.fromBER(this.encapContentInfo.eContent.valueBlock.valueHexView)}catch(S){throw new ot({date:a,code:15,message:"Error during verification: TSTInfo wrong ASN.1 schema ",signatureVerified:null,signerCertificate:m,timestampSerial:h,signerCertificateVerified:!0})}if(a=C.genTime,h=C.serialNumber.valueBlock.valueHexView.slice(),t.byteLength===0)throw new ot({date:a,code:4,message:"Missed detached data input array"});if(!await C.verify({data:t},l))throw new ot({date:a,code:15,message:"Error during verification: TSTInfo verification is failed",signatureVerified:!1,signerCertificate:m,timestampSerial:h,signerCertificateVerified:!0})}if(u){const C=this.certificates.filter(k=>k instanceof ue&&!!$w(k,m)),S={checkDate:a,certs:C,trustedCerts:s};n&&(S.findIssuer=n),o&&(S.findOrigin=o);const v=new Wh(S);if(v.certs.push(m),this.crls)for(const k of this.crls)"thisUpdate"in k?v.crls.push(k):k.otherRevInfoFormat===Hc&&v.ocsps.push(new Ft({schema:k.otherRevInfo}));this.ocsps&&v.ocsps.push(...this.ocsps);const E=await v.verify({passedWhenNotRevValues:c},l).catch(k=>{throw new ot({date:a,code:5,message:"Validation of signer's certificate failed with error: ".concat(k instanceof Object?k.resultMessage:k),signerCertificate:m,signerCertificateVerified:!1})});if(E.certificatePath&&(w=E.certificatePath),!E.result)throw new ot({date:a,code:5,message:"Validation of signer's certificate failed: ".concat(E.resultMessage),signerCertificate:m,signerCertificateVerified:!1})}const d=l.getAlgorithmByOID(b.digestAlgorithm.algorithmId);if(!("name"in d))throw new ot({date:a,code:7,message:"Unsupported signature algorithm: ".concat(b.digestAlgorithm.algorithmId),signerCertificate:m,signerCertificateVerified:!0});p=d.name;const f=this.encapContentInfo.eContent;if(f)f.idBlock.tagClass===1&&f.idBlock.tagNumber===4?t=f.getValue():t=f.valueBlock.valueBeforeDecodeView;else if(t.byteLength===0)throw new ot({date:a,code:8,message:"Missed detached data input array",signerCertificate:m,signerCertificateVerified:!0});if(b.signedAttrs){let C=!1,S=!1;for(const v of b.signedAttrs.attributes)if(v.type==="1.2.840.113549.1.9.3"&&(C=!0),v.type==="1.2.840.113549.1.9.4"&&(S=!0,g=v.values[0].valueBlock.valueHex),C&&S)break;if(C===!1)throw new ot({date:a,code:9,message:'Attribute "content-type" is a mandatory attribute for "signed attributes"',signerCertificate:m,signerCertificateVerified:!0});if(S===!1)throw new ot({date:a,code:10,message:'Attribute "message-digest" is a mandatory attribute for "signed attributes"',signatureVerified:null,signerCertificate:m,signerCertificateVerified:!0})}if(b.signedAttrs){const C=await l.digest(p,new Uint8Array(t));if(!Wl(C,g))throw new ot({date:a,code:15,message:"Error during verification: Message digest doesn't match",signatureVerified:null,signerCertificate:m,timestampSerial:h,signerCertificateVerified:!0});t=b.signedAttrs.encodedValue}const A=b.signatureAlgorithm.algorithmId==="1.2.840.113549.1.1.1"?await l.verifyWithPublicKey(t,b.signature,m.subjectPublicKeyInfo,b.signatureAlgorithm,p):await l.verifyWithPublicKey(t,b.signature,m.subjectPublicKeyInfo,b.signatureAlgorithm);return i?{date:a,code:14,message:N,signatureVerified:A,signerCertificate:m,timestampSerial:h,signerCertificateVerified:!0,certificatePath:w}:A}catch(g){throw g instanceof ot?g:new ot({date:a,code:15,message:"Error during verification: ".concat(g instanceof Error?g.message:g),signatureVerified:null,signerCertificate:m,timestampSerial:h,signerCertificateVerified:!0})}}async sign(e,t,s="SHA-1",a=Le,u=te(!0)){var c;if(!e)throw new Error("Need to provide a private key for signing");const i=this.signerInfos[t];if(!i)throw new RangeError("SignerInfo index is out of range");!(!((c=i.signedAttrs)===null||c===void 0)&&c.attributes.length)&&"hash"in e.algorithm&&"hash"in e.algorithm&&e.algorithm.hash&&(s=e.algorithm.hash.name);const o=u.getOIDByAlgorithm({name:s},!0,"hashAlgorithm");this.digestAlgorithms.filter(h=>h.algorithmId===o).length===0&&this.digestAlgorithms.push(new T({algorithmId:o,algorithmParams:new Me})),i.digestAlgorithm=new T({algorithmId:o,algorithmParams:new Me});const n=await u.getSignatureParameters(e,s),l=n.parameters;if(i.signatureAlgorithm=n.signatureAlgorithm,i.signedAttrs)if(i.signedAttrs.encodedValue.byteLength!==0)a=i.signedAttrs.encodedValue;else{a=i.signedAttrs.toSchema().toBER();const h=ge.toUint8Array(a);h[0]=49}else{const h=this.encapContentInfo.eContent;if(h)h.idBlock.tagClass===1&&h.idBlock.tagNumber===4?a=h.getValue():a=h.valueBlock.valueBeforeDecodeView;else if(a.byteLength===0)throw new Error("Missed detached data input array")}const m=await u.signWithPrivateKey(a,e,l);i.signature=new M({valueHex:m})}}tt.CLASS_NAME="SignedData",tt.ID_DATA=Ap;const ln="version",cn="authSafe",xs="macData",Fo="parsedValue",DS=[ln,cn,xs];class Hr extends ${constructor(e={}){super(),this.version=y(e,ln,Hr.defaultValues(ln)),this.authSafe=y(e,cn,Hr.defaultValues(cn)),xs in e&&(this.macData=y(e,xs,Hr.defaultValues(xs))),Fo in e&&(this.parsedValue=y(e,Fo,Hr.defaultValues(Fo))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case ln:return 3;case cn:return new pe;case xs:return new wt;case Fo:return{};default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case ln:return t===Hr.defaultValues(e);case cn:return pe.compareWithDefault("contentType",t.contentType)&&pe.compareWithDefault("content",t.content);case xs:return wt.compareWithDefault("mac",t.mac)&&wt.compareWithDefault("macSalt",t.macSalt)&&wt.compareWithDefault("iterations",t.iterations);case Fo:return t instanceof Object&&Object.keys(t).length===0;default:return super.defaultValues(e)}}static schema(e={}){const t=y(e,"names",{});return new I({name:t.blockName||N,value:[new R({name:t.version||ln}),pe.schema(t.authSafe||{names:{blockName:cn}}),wt.schema(t.macData||{names:{blockName:xs,optional:!0}})]})}fromSchema(e){U(e,DS);const t=K(e,e,Hr.schema({names:{version:ln,authSafe:{names:{blockName:cn}},macData:{names:{blockName:xs}}}}));j.assertSchema(t,this.className),this.version=t.result.version.valueBlock.valueDec,this.authSafe=new pe({schema:t.result.authSafe}),xs in t.result&&(this.macData=new wt({schema:t.result.macData}))}toSchema(){const e=[new R({value:this.version}),this.authSafe.toSchema()];return this.macData&&e.push(this.macData.toSchema()),new I({value:e})}toJSON(){const e={version:this.version,authSafe:this.authSafe.toJSON()};return this.macData&&(e.macData=this.macData.toJSON()),e}async makeInternalValues(e={},t=te(!0)){if(me.assert(e,"parameters","object"),!this.parsedValue)throw new Error('Please call "parseValues" function first in order to make "parsedValue" data');switch(ie.assertEmpty(this.parsedValue.integrityMode,"integrityMode","parsedValue"),ie.assertEmpty(this.parsedValue.authenticatedSafe,"authenticatedSafe","parsedValue"),this.parsedValue.integrityMode){case 0:{if(!("iterations"in e))throw new ie("iterations");ie.assertEmpty(e.pbkdf2HashAlgorithm,"pbkdf2HashAlgorithm"),ie.assertEmpty(e.hmacHashAlgorithm,"hmacHashAlgorithm"),ie.assertEmpty(e.password,"password");const s=new ArrayBuffer(64),a=new Uint8Array(s);t.getRandomValues(a);const u=this.parsedValue.authenticatedSafe.toSchema().toBER(!1);this.authSafe=new pe({contentType:pe.DATA,content:new M({valueHex:u})});const c=await t.stampDataWithPassword({password:e.password,hashAlgorithm:e.hmacHashAlgorithm,salt:s,iterationCount:e.iterations,contentToStamp:u});this.macData=new wt({mac:new qt({digestAlgorithm:new T({algorithmId:t.getOIDByAlgorithm({name:e.hmacHashAlgorithm},!0,"hmacHashAlgorithm")}),digest:new M({valueHex:c})}),macSalt:new M({valueHex:s}),iterations:e.iterations})}break;case 1:{if(!("signingCertificate"in e))throw new ie("signingCertificate");ie.assertEmpty(e.privateKey,"privateKey"),ie.assertEmpty(e.hashAlgorithm,"hashAlgorithm");const s=this.parsedValue.authenticatedSafe.toSchema().toBER(!1),a=new tt({version:1,encapContentInfo:new xt({eContentType:"1.2.840.113549.1.7.1",eContent:new M({valueHex:s})}),certificates:[e.signingCertificate]}),u=await t.digest({name:e.hashAlgorithm},new Uint8Array(s)),c=[];c.push(new we({type:"1.2.840.113549.1.9.3",values:[new W({value:"1.2.840.113549.1.7.1"})]})),c.push(new we({type:"1.2.840.113549.1.9.5",values:[new Sf({valueDate:new Date})]})),c.push(new we({type:"1.2.840.113549.1.9.4",values:[new M({valueHex:u})]})),a.signerInfos.push(new Ve({version:1,sid:new $e({issuer:e.signingCertificate.issuer,serialNumber:e.signingCertificate.serialNumber}),signedAttrs:new Se({type:0,attributes:c})})),await a.sign(e.privateKey,0,e.hashAlgorithm,void 0,t),this.authSafe=new pe({contentType:"1.2.840.113549.1.7.2",content:a.toSchema(!0)})}break;default:throw new Error('Parameter "integrityMode" has unknown value: '.concat(this.parsedValue.integrityMode))}}async parseInternalValues(e,t=te(!0)){switch(me.assert(e,"parameters","object"),e.checkIntegrity===void 0&&(e.checkIntegrity=!0),this.parsedValue={},this.authSafe.contentType){case pe.DATA:{ie.assertEmpty(e.password,"password"),this.parsedValue.integrityMode=0,me.assert(this.authSafe.content,"authSafe.content",M);const s=this.authSafe.content.getValue();if(this.parsedValue.authenticatedSafe=In.fromBER(s),e.checkIntegrity){if(!this.macData)throw new Error('Absent "macData" value, can not check PKCS#12 data integrity');const a=t.getAlgorithmByOID(this.macData.mac.digestAlgorithm.algorithmId,!0,"digestAlgorithm");if(!await t.verifyDataStampedWithPassword({password:e.password,hashAlgorithm:a.name,salt:ge.toArrayBuffer(this.macData.macSalt.valueBlock.valueHexView),iterationCount:this.macData.iterations||1,contentToVerify:s,signatureToVerify:ge.toArrayBuffer(this.macData.mac.digest.valueBlock.valueHexView)}))throw new Error("Integrity for the PKCS#12 data is broken!")}}break;case pe.SIGNED_DATA:{this.parsedValue.integrityMode=1;const s=new tt({schema:this.authSafe.content}),a=s.encapContentInfo.eContent;ie.assert(a,"eContent","cmsSigned.encapContentInfo"),me.assert(a,"eContent",M);const u=a.getValue();if(this.parsedValue.authenticatedSafe=In.fromBER(u),!await s.verify({signer:0,checkChain:!1},t))throw new Error("Integrity for the PKCS#12 data is broken!")}break;default:throw new Error('Incorrect value for "this.authSafe.contentType": '.concat(this.authSafe.contentType))}}}Hr.CLASS_NAME="PFX";const to="status",jr="statusStrings",$r="failInfo",TS=[to,jr,$r];var vg;(function(r){r[r.granted=0]="granted",r[r.grantedWithMods=1]="grantedWithMods",r[r.rejection=2]="rejection",r[r.waiting=3]="waiting",r[r.revocationWarning=4]="revocationWarning",r[r.revocationNotification=5]="revocationNotification"})(vg||(vg={}));class Jt extends ${constructor(e={}){super(),this.status=y(e,to,Jt.defaultValues(to)),jr in e&&(this.statusStrings=y(e,jr,Jt.defaultValues(jr))),$r in e&&(this.failInfo=y(e,$r,Jt.defaultValues($r))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case to:return 2;case jr:return[];case $r:return new ne;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case to:return t===Jt.defaultValues(e);case jr:return t.length===0;case $r:return t.isEqual(Jt.defaultValues(e));default:return super.defaultValues(e)}}static schema(e={}){const t=y(e,"names",{});return new I({name:t.blockName||N,value:[new R({name:t.status||N}),new I({optional:!0,value:[new ee({name:t.statusStrings||N,value:new bh})]}),new ne({name:t.failInfo||N,optional:!0})]})}fromSchema(e){U(e,TS);const t=K(e,e,Jt.schema({names:{status:to,statusStrings:jr,failInfo:$r}}));j.assertSchema(t,this.className);const s=t.result.status;if(s.valueBlock.isHexOnly===!0||s.valueBlock.valueDec<0||s.valueBlock.valueDec>5)throw new Error('PKIStatusInfo "status" has invalid value');this.status=s.valueBlock.valueDec,jr in t.result&&(this.statusStrings=t.result.statusStrings),$r in t.result&&(this.failInfo=t.result.failInfo)}toSchema(){const e=[];return e.push(new R({value:this.status})),this.statusStrings&&e.push(new I({optional:!0,value:this.statusStrings})),this.failInfo&&e.push(this.failInfo),new I({value:e})}toJSON(){const e={status:this.status};return this.statusStrings&&(e.statusStrings=Array.from(this.statusStrings,t=>t.toJSON())),this.failInfo&&(e.failInfo=this.failInfo.toJSON()),e}}Jt.CLASS_NAME="PKIStatusInfo";const Ul="version",Kl="messageImprint",so="reqPolicy",ro="nonce",Is="certReq",ao="extensions",Dn="TimeStampReq",Yf="".concat(Dn,".").concat(Ul),Zf="".concat(Dn,".").concat(Kl),fh="".concat(Dn,".").concat(so),ph="".concat(Dn,".").concat(ro),dh="".concat(Dn,".").concat(Is),gh="".concat(Dn,".").concat(ao),RS=[Yf,Zf,fh,ph,dh,gh];class It extends ${constructor(e={}){super(),this.version=y(e,Ul,It.defaultValues(Ul)),this.messageImprint=y(e,Kl,It.defaultValues(Kl)),so in e&&(this.reqPolicy=y(e,so,It.defaultValues(so))),ro in e&&(this.nonce=y(e,ro,It.defaultValues(ro))),Is in e&&(this.certReq=y(e,Is,It.defaultValues(Is))),ao in e&&(this.extensions=y(e,ao,It.defaultValues(ao))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Ul:return 0;case Kl:return new at;case so:return N;case ro:return new R;case Is:return!1;case ao:return[];default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Ul:case so:case Is:return t===It.defaultValues(e);case Kl:return at.compareWithDefault("hashAlgorithm",t.hashAlgorithm)&&at.compareWithDefault("hashedMessage",t.hashedMessage);case ro:return t.isEqual(It.defaultValues(e));case ao:return t.length===0;default:return super.defaultValues(e)}}static schema(e={}){const t=y(e,"names",{});return new I({name:t.blockName||Dn,value:[new R({name:t.version||Yf}),at.schema(t.messageImprint||{names:{blockName:Zf}}),new W({name:t.reqPolicy||fh,optional:!0}),new R({name:t.nonce||ph,optional:!0}),new ra({name:t.certReq||dh,optional:!0}),new D({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new ee({name:t.extensions||gh,value:Be.schema()})]})]})}fromSchema(e){U(e,RS);const t=K(e,e,It.schema());j.assertSchema(t,this.className),this.version=t.result[Yf].valueBlock.valueDec,this.messageImprint=new at({schema:t.result[Zf]}),fh in t.result&&(this.reqPolicy=t.result[fh].valueBlock.toString()),ph in t.result&&(this.nonce=t.result[ph]),dh in t.result&&(this.certReq=t.result[dh].valueBlock.value),gh in t.result&&(this.extensions=Array.from(t.result[gh],s=>new Be({schema:s})))}toSchema(){const e=[];return e.push(new R({value:this.version})),e.push(this.messageImprint.toSchema()),this.reqPolicy&&e.push(new W({value:this.reqPolicy})),this.nonce&&e.push(this.nonce),Is in this&&It.compareWithDefault(Is,this.certReq)===!1&&e.push(new ra({value:this.certReq})),this.extensions&&e.push(new D({idBlock:{tagClass:3,tagNumber:0},value:Array.from(this.extensions,t=>t.toSchema())})),new I({value:e})}toJSON(){const e={version:this.version,messageImprint:this.messageImprint.toJSON()};return this.reqPolicy!==void 0&&(e.reqPolicy=this.reqPolicy),this.nonce!==void 0&&(e.nonce=this.nonce.toJSON()),this.certReq!==void 0&&It.compareWithDefault(Is,this.certReq)===!1&&(e.certReq=this.certReq),this.extensions&&(e.extensions=Array.from(this.extensions,t=>t.toJSON())),e}}It.CLASS_NAME="TimeStampReq";const no="status",io="timeStampToken",Dp="TimeStampResp",ep="".concat(Dp,".").concat(no),wh="".concat(Dp,".").concat(io),LS=[ep,wh];class Jl extends ${constructor(e={}){super(),this.status=y(e,no,Jl.defaultValues(no)),io in e&&(this.timeStampToken=y(e,io,Jl.defaultValues(io))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case no:return new Jt;case io:return new pe;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case no:return Jt.compareWithDefault(no,t.status)&&!("statusStrings"in t)&&!("failInfo"in t);case io:return t.contentType===N&&t.content instanceof Z;default:return super.defaultValues(e)}}static schema(e={}){const t=y(e,"names",{});return new I({name:t.blockName||Dp,value:[Jt.schema(t.status||{names:{blockName:ep}}),pe.schema(t.timeStampToken||{names:{blockName:wh,optional:!0}})]})}fromSchema(e){U(e,LS);const t=K(e,e,Jl.schema());j.assertSchema(t,this.className),this.status=new Jt({schema:t.result[ep]}),wh in t.result&&(this.timeStampToken=new pe({schema:t.result[wh]}))}toSchema(){const e=[];return e.push(this.status.toSchema()),this.timeStampToken&&e.push(this.timeStampToken.toSchema()),new I({value:e})}toJSON(){const e={status:this.status.toJSON()};return this.timeStampToken&&(e.timeStampToken=this.timeStampToken.toJSON()),e}async sign(e,t,s=te(!0)){return this.assertContentType(),new tt({schema:this.timeStampToken.content}).sign(e,0,t,void 0,s)}async verify(e={signer:0,trustedCerts:[],data:Le},t=te(!0)){return this.assertContentType(),new tt({schema:this.timeStampToken.content}).verify(e,t)}assertContentType(){if(!this.timeStampToken)throw new Error("timeStampToken is absent in TSP response");if(this.timeStampToken.contentType!==Pw)throw new Error("Wrong format of timeStampToken: ".concat(this.timeStampToken.contentType))}}Jl.CLASS_NAME="TimeStampResp";function jS(){if(typeof self<"u"){if("crypto"in self){let r="webcrypto";"webkitSubtle"in self.crypto&&(r="safari"),rg(r,new Zl({name:r,crypto}))}}else if(typeof crypto<"u"&&"webcrypto"in crypto){const r="NodeJS ^15",e=crypto.webcrypto;rg(r,new Zl({name:r,crypto:e}))}}jS();function $S(r){return String.fromCharCode(...r)}function Kw(r){return Uint8Array.from(r,e=>e.charCodeAt(0))}function US(r){return Array.from(r).map(e=>e.toString(16).padStart(2,"0")).join("")}function ds(r){return Kw(atob(r))}function Tp(r){const e=r.replace(/-----BEGIN ((PRIVATE KEY)|(PUBLIC KEY)|(CERTIFICATE))-----/,"").replace(/-----END ((PRIVATE KEY)|(PUBLIC KEY)|(CERTIFICATE))-----/,"").replace(/\n/g,"");return ds(e)}var KS=Object.defineProperty,HS=Object.defineProperties,MS=Object.getOwnPropertyDescriptors,bg=Object.getOwnPropertySymbols,FS=Object.prototype.hasOwnProperty,JS=Object.prototype.propertyIsEnumerable,Sg=(r,e,t)=>e in r?KS(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,tp=(r,e)=>{for(var t in e||(e={}))FS.call(e,t)&&Sg(r,t,e[t]);if(bg)for(var t of bg(e))JS.call(e,t)&&Sg(r,t,e[t]);return r},Ag=(r,e)=>HS(r,MS(e));async function Rp(r,e,t={}){return await self.crypto.subtle.decrypt(tp({name:"AES-GCM"},t),e,r)}async function qS(r,e){return await self.crypto.subtle.decrypt({name:"RSA-OAEP"},e,r)}async function Hw(r){return await self.crypto.subtle.importKey("raw",r,{name:"AES-GCM",length:128},!0,["decrypt","encrypt"])}async function WS(r,e){return await self.crypto.subtle.importKey("spki",r,{name:"RSASSA-PKCS1-v1_5",hash:e},!0,["verify"])}async function GS(r){return await self.crypto.subtle.importKey("pkcs8",r,{name:"RSA-OAEP",hash:"SHA-256"},!0,["decrypt"])}async function _S(r){return new Uint8Array(await self.crypto.subtle.exportKey("raw",r))}async function XS(r){const e=await self.crypto.subtle.digest("SHA-256",r);return US(new Uint8Array(e))}async function zS(r,e){const t=new my(r),s=await WS(Tp(e),t.signatureAlgorithm.hash.name);return t.verify({publicKey:s},QS())}function QS(){return Ag(tp({},self.crypto),{subtle:Ag(tp({},self.crypto.subtle),{async verify(r,e,t,s){return self.crypto.subtle.verify(r,e,new Uint8Array(t),new Uint8Array(s))}})})}async function YS(r,e,t){const s=pe.fromBER(e),a=new tt({schema:s.content}),u=a.signerInfos[0].sid.issuer.typesAndValues.find(({type:o})=>o==="2.5.4.3").value.valueBlock.value,c=t.find(({userId:o})=>o===u);if(c===void 0)throw new Error("Signer not found in the users array");const i=ue.fromBER(Tp(c.certificate));return await a.verify({signer:0,trustedCerts:[i],data:r,checkChain:!0},eA())}class ZS extends Zl{verify(e,t,s,a){return super.verify(e,t,s,new Uint8Array(a))}}function eA(){return new ZS({crypto:self.crypto})}var tA=Object.defineProperty,Ng=Object.getOwnPropertySymbols,sA=Object.prototype.hasOwnProperty,rA=Object.prototype.propertyIsEnumerable,kg=(r,e,t)=>e in r?tA(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,aA=(r,e)=>{for(var t in e||(e={}))sA.call(e,t)&&kg(r,t,e[t]);if(Ng)for(var t of Ng(e))rA.call(e,t)&&kg(r,t,e[t]);return r};async function nA(r,e){_e.debug("Decrypting private key",{privateKeyInfo:r,mnemonic:e});const t=await Promise.all([await gf(e,r.salt,{hash:"SHA-256",iterations:6e5}),await gf(e,r.salt,{hash:"SHA-1",iterations:1024}),await gf(e,r.salt,{hash:"SHA-1",iterations:6e5})]);for(const s of t)try{const a=await Rp(r.encryptedPrivateKey,s,{iv:r.iv,tagLength:128}),u=atob($S(new Uint8Array(a)));return GS(Tp(u))}catch(a){}throw new Error("Failed to decrypt private key")}async function gf(r,e,t){const s=await crypto.subtle.importKey("raw",new TextEncoder().encode(r.replaceAll(" ","")),{name:"PBKDF2"},!1,["deriveKey"]);return await crypto.subtle.deriveKey(aA({name:"PBKDF2",salt:e},t),s,{name:"AES-GCM",length:256},!0,["decrypt","encrypt"])}const Eg="apps/end_to_end_encryption/api/v2",Mw={PrivateKey:Eg+"/private-key",ServerKey:Eg+"/server-key"};async function iA(){const r=(await Pg.get(Og(Mw.PrivateKey),{headers:{"X-E2EE-SUPPORTED":"true"}})).data.ocs.data["private-key"],[e,t,s]=r.split("|");return{encryptedPrivateKey:ds(e),iv:ds(t),salt:ds(s)}}async function oA(){return await(await Pg.get(Og(Mw.ServerKey),{headers:{"X-E2EE-SUPPORTED":"true"}})).data.ocs.data["public-key"]}const uA={name:"AlertCircleOutlineIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var lA=function(){var r=this,e=r._self._c;return e("span",r._b({staticClass:"material-design-icon alert-circle-outline-icon",attrs:{"aria-hidden":r.title?null:"true","aria-label":r.title,role:"img"},on:{click:function(t){return r.$emit("click",t)}}},"span",r.$attrs,!1),[e("svg",{staticClass:"material-design-icon__svg",attrs:{fill:r.fillColor,width:r.size,height:r.size,viewBox:"0 0 24 24"}},[e("path",{attrs:{d:"M11,15H13V17H11V15M11,7H13V13H11V7M12,2C6.47,2 2,6.5 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4A8,8 0 0,1 20,12A8,8 0 0,1 12,20Z"}},[r.title?e("title",[r._v(r._s(r.title))]):r._e()])])])},cA=[],hA=Hh(uA,lA,cA,!1,null,null);const mA=hA.exports,fA={name:"NcInputField",components:{NcButton:Qw,AlertCircle:mA,Check:yy},inheritAttrs:!1,model:{prop:"modelValue",event:"update:modelValue"},props:{value:{type:[String,Number],default:void 0},modelValue:{type:[String,Number],default:void 0},type:{type:String,default:"text",validator:r=>["text","password","email","tel","url","search","number"].includes(r)},label:{type:String,default:void 0},labelOutside:{type:Boolean,default:!1},placeholder:{type:String,default:void 0},showTrailingButton:{type:Boolean,default:!1},trailingButtonLabel:{type:String,default:""},success:{type:Boolean,default:!1},error:{type:Boolean,default:!1},helperText:{type:String,default:""},disabled:{type:Boolean,default:!1},pill:{type:Boolean,default:!1},inputClass:{type:[Object,String],default:""}},emits:["update:value","update:modelValue","update:model-value","trailing-button-click"],setup(){return{model:Dg("value","update:value",!0)}},computed:{computedId(){return this.$attrs.id&&this.$attrs.id!==""?this.$attrs.id:this.inputName},inputName(){return"input"+Yw()},hasTrailingIcon(){return this.success},hasPlaceholder(){return this.placeholder!==""&&this.placeholder!==void 0},computedPlaceholder(){return this.hasPlaceholder?this.placeholder:this.label},isValidLabel(){const r=this.label||this.labelOutside;return r||console.warn("You need to add a label to the NcInputField component. Either use the prop label or use an external one, as per the example in the documentation."),r},ariaDescribedby(){const r=[];return this.helperText.length>0&&r.push("".concat(this.inputName,"-helper-text")),this.$attrs["aria-describedby"]&&r.push(this.$attrs["aria-describedby"]),r.join(" ")||null}},methods:{focus(){this.$refs.input.focus()},select(){this.$refs.input.select()},handleInput(r){const e=this.type==="number"&&typeof this.model=="number"?parseFloat(r.target.value,10):r.target.value;this.model=e},handleTrailingButtonClick(r){this.$emit("trailing-button-click",r)}}};var pA=function(){var t;var r=this,e=r._self._c;return e("div",{staticClass:"input-field",class:{"input-field--disabled":r.disabled,"input-field--label-outside":r.labelOutside||!r.isValidLabel,"input-field--leading-icon":!!r.$scopedSlots.icon||!!r.$scopedSlots.default||!!r.$slots.default,"input-field--trailing-icon":r.showTrailingButton||r.hasTrailingIcon,"input-field--pill":r.pill}},[e("div",{staticClass:"input-field__main-wrapper"},[e("input",r._g(r._b({ref:"input",staticClass:"input-field__input",class:[r.inputClass,{"input-field__input--success":r.success,"input-field__input--error":r.error}],attrs:{id:r.computedId,type:r.type,disabled:r.disabled,placeholder:r.computedPlaceholder,"aria-describedby":r.ariaDescribedby,"aria-live":"polite"},domProps:{value:(t=r.model)==null?void 0:t.toString()},on:{input:r.handleInput}},"input",r.$attrs,!1),r.$listeners)),!r.labelOutside&&r.isValidLabel?e("label",{staticClass:"input-field__label",attrs:{for:r.computedId}},[r._v(" "+r._s(r.label)+" ")]):r._e(),e("div",{directives:[{name:"show",rawName:"v-show",value:!!r.$scopedSlots.icon||!!r.$scopedSlots.default||!!r.$slots.default,expression:"!!$scopedSlots.icon || !!$scopedSlots.default || !!$slots.default"}],staticClass:"input-field__icon input-field__icon--leading"},[r._t("icon",function(){return[r._t("default")]})],2),r.showTrailingButton?e("NcButton",{staticClass:"input-field__trailing-button",attrs:{type:"tertiary-no-background","aria-label":r.trailingButtonLabel,disabled:r.disabled},on:{click:r.handleTrailingButtonClick},scopedSlots:r._u([{key:"icon",fn:function(){return[r._t("trailing-button-icon")]},proxy:!0}],null,!0)}):r.success||r.error?e("div",{staticClass:"input-field__icon input-field__icon--trailing"},[r.success?e("Check",{staticStyle:{color:"var(--color-success-text)"},attrs:{size:20}}):r.error?e("AlertCircle",{staticStyle:{color:"var(--color-error-text)"},attrs:{size:20}}):r._e()],1):r._e()],1),r.helperText.length>0?e("p",{staticClass:"input-field__helper-text-message",class:{"input-field__helper-text-message--error":r.error,"input-field__helper-text-message--success":r.success},attrs:{id:"".concat(r.inputName,"-helper-text")}},[r.success?e("Check",{staticClass:"input-field__helper-text-message__icon",attrs:{size:18}}):r.error?e("AlertCircle",{staticClass:"input-field__helper-text-message__icon",attrs:{size:18}}):r._e(),r._v(" "+r._s(r.helperText)+" ")],1):r._e()])},dA=[],gA=Hh(fA,pA,dA,!1,null,"ceb23641");const sp=gA.exports,wA={name:"UndoVariantIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var yA=function(){var r=this,e=r._self._c;return e("span",r._b({staticClass:"material-design-icon undo-variant-icon",attrs:{"aria-hidden":r.title?null:"true","aria-label":r.title,role:"img"},on:{click:function(t){return r.$emit("click",t)}}},"span",r.$attrs,!1),[e("svg",{staticClass:"material-design-icon__svg",attrs:{fill:r.fillColor,width:r.size,height:r.size,viewBox:"0 0 24 24"}},[e("path",{attrs:{d:"M13.5,7A6.5,6.5 0 0,1 20,13.5A6.5,6.5 0 0,1 13.5,20H10V18H13.5C16,18 18,16 18,13.5C18,11 16,9 13.5,9H7.83L10.91,12.09L9.5,13.5L4,8L9.5,2.5L10.92,3.91L7.83,7H13.5M6,18H8V20H6V18Z"}},[r.title?e("title",[r._v(r._s(r.title))]):r._e()])])])},vA=[],bA=Hh(wA,yA,vA,!1,null,null);const SA=bA.exports;Zw(ty,ey);const AA=new Set(Object.keys(sp.props)),NA={name:"NcTextField",components:{NcInputField:sp,Close:sy,ArrowRight:fy,Undo:SA},inheritAttrs:!1,model:{prop:"modelValue",event:"update:modelValue"},props:ns(nt({" ":{}},sp.props),{trailingButtonLabel:{type:String,default:""},trailingButtonIcon:{type:String,default:"close",validator:r=>["close","arrowRight","undo"].includes(r)}}),emits:["update:value","update:modelValue","update:model-value"],setup(){return{model:Dg("value","update:value")}},computed:{propsAndAttrsToForward(){const r={undo:Xh("Undo changes"),close:Xh("Clear text"),arrowRight:Xh("Save changes")};return ns(nt(nt({},this.$attrs),Object.fromEntries(Object.entries(this.$props).filter(([e])=>AA.has(e)))),{trailingButtonLabel:this.trailingButtonLabel||r[this.trailingButtonIcon]})}},methods:{focus(){this.$refs.inputField.focus()},select(){this.$refs.inputField.select()}}};var kA=function(){var r=this,e=r._self._c;return e("NcInputField",r._g(r._b({ref:"inputField",scopedSlots:r._u([r.$scopedSlots.icon||r.$slots.default||r.$scopedSlots.default?{key:"icon",fn:function(){return[r._t("icon",function(){return[r._t("default")]})]},proxy:!0}:null,r.type!=="search"?{key:"trailing-button-icon",fn:function(){return[r.trailingButtonIcon==="close"?e("Close",{attrs:{size:20}}):r.trailingButtonIcon==="arrowRight"?e("ArrowRight",{attrs:{size:20}}):r.trailingButtonIcon==="undo"?e("Undo",{attrs:{size:20}}):r._e()]},proxy:!0}:null],null,!0)},"NcInputField",r.propsAndAttrsToForward,!1),r.$listeners))},EA=[],CA=Hh(NA,kA,EA,!1,null,null);const xA=CA.exports,IA=ry({__name:"MnemonicPromptDialog",emits:["close"],setup(r,{emit:e}){const t=zh(),s=zh(""),a=zh(!1),u=$p(()=>a.value===!0&&s.value.trim().split(/\s+/g).length===12);function c(){e("close",s.value)}const i=$p(()=>[{label:vf("end_to_en_encryption","Submit"),nativeType:"submit",type:"primary",disabled:!u.value,callback:c}]);return{__sfc:!0,emit:e,dialogRef:t,mnemonic:s,confirmToggle:a,isFormValid:u,submit:c,buttons:i,t:vf,NcDialog:gy,NcTextField:xA,NcNoteCard:dy,NcCheckboxRadioSwitch:py}}});var VA=function(){var r=this,e=r._self._c,t=r._self._setupProxy;return e(t.NcDialog,{ref:"dialogRef",attrs:{name:t.t("end_to_end_encryption","Enter your 12 words mnemonic"),buttons:t.buttons,"is-form":!0},on:{submit:t.submit}},[e(t.NcNoteCard,{attrs:{type:"warning","show-alert":!0,heading:t.t("end_to_end_encryption","Decrypting your files in the browser can weaken security")}},[r._v(" "+r._s(t.t("end_to_end_encryption","The server could serve malicious source code to extract the secret that protects your files."))+" "),e(t.NcCheckboxRadioSwitch,{attrs:{required:!0,"data-cy-e2ee-mnemonic-prompt":"i_understand_the_risks",type:"switch"},model:{value:t.confirmToggle,callback:function(s){t.confirmToggle=s},expression:"confirmToggle"}},[r._v(" "+r._s(t.t("end_to_end_encryption","I understand the risks"))+" ")])],1),e(t.NcTextField,{attrs:{value:t.mnemonic,required:"true",pattern:"^(\\w+\\s+){11}\\w+$",label:t.t("end_to_end_encryption","Mnemonic"),autofocus:!0},on:{"update:value":function(s){t.mnemonic=s}}})],1)},PA=[],OA=ay(IA,VA,PA,!1,null,null);const BA=OA.exports;async function DA(){const r=Promise.withResolvers();return wy(BA,void 0,e=>{e!==void 0?r.resolve(e):r.reject()}),r.promise}async function TA(r,e){_e.debug("Decrypting metadata info",{metadata:r});const[t,s]=r.metadata.ciphertext.split("|"),a=await Rp(ds(t),e,{iv:ds(s)}),u=JSON.parse(await jA(a));return RA(u,r),await LA(u,e),u}function RA(r,e){var t,s;if(((t=r.keyChecksums)==null?void 0:t.length)!==((s=e.users)==null?void 0:s.length))throw new Error("Key checksums length does not match users length")}async function LA(r,e){if(r.keyChecksums===void 0)return;const t=await _S(e),s=await XS(t);if(!r.keyChecksums.includes(s))throw new Error("Key checksum is not in keyChecksums")}async function jA(r){const e=new ReadableStream({start(t){t.enqueue(new Uint8Array(r)),t.close()}}).pipeThrough(new DecompressionStream("gzip"));return await new Response(e).text()}async function $A(r,e,t){var s;_e.debug("Getting metadata private key",{metadata:r,userId:e});const a=(s=r.users)==null?void 0:s.find(i=>i.userId===e);if(!a)throw new Error("User not found in metadata");const u=ds(a.encryptedMetadataKey),c=await qS(u,t);return await Hw(new Uint8Array(c))}async function Cg(r,e,t){const s=JSON.stringify(r,(u,c)=>{if(u!=="filedrop")return c}),a=await YS(Kw(btoa(s)),ds(e),t.users);if(!a)throw new Error("Metadata signature verification failed");return a}async function UA(r,e){const t=r.users.map(async({userId:s,certificate:a})=>{const u=await zS(a,e);if(!u)throw new Error("Certificate verification failed for user ".concat(s));return u});return await Promise.all(t)}const KA=Qv(),ct={_userPrivateKey:void 0,_serverPublicKey:void 0,_metadataCache:{},async getUserPrivateKey(){var r;return(r=this._userPrivateKey)!=null||(this._userPrivateKey=await nA(await iA(),await DA())),this._userPrivateKey},async getServerPublicKeyPEM(){var r;return(r=this._serverPublicKey)!=null||(this._serverPublicKey=await oA()),this._serverPublicKey},async getMetadata(r){if(this._metadataCache[r])return _e.debug("Found metadata in cache",{path:r,state:ct}),this._metadataCache[r];if(_e.debug("Fetching PROPFIND for metadata",{path:r,state:ct}),await KA.stat(decodeURI(r).replace("remote.php/dav/",""),{details:!0,data:Gv()}),this._metadataCache[r])return _e.debug("Found metadata in cache after PROPFIND",{path:r,state:ct}),this._metadataCache[r];throw new Error("Could not find metadata for ".concat(r))},async setMetadata(r,e,t){const s=JSON.parse(e);Kc(s)?(await Cg(s,t,s),await UA(s,await this.getServerPublicKeyPEM())):await Cg(s,t,await this.getRootMetadata(vo.dirname(r))),this._metadataCache[r]=s,_e.debug("Added metadata in cache",{path:r,state:ct})},async getMetadataInfo(r){const e=await this.getMetadata(r),t=await this.getRootMetadata(r),s=ap();if(s===null)throw new Error("No user logged in");return TA(e,await $A(t,s.uid,await ct.getUserPrivateKey()))},async getRootMetadata(r){const e=Object.entries(ct._metadataCache).filter(([t])=>r.startsWith(t)).map(([,t])=>t).find(t=>Kc(t));if(e)return _e.debug("Found root metadata in cache",{path:r,state:ct}),e;for(_e.debug("Looking for root metadata",{path:r,state:ct});r!=="/";){const t=await ct.getMetadata(r);if(Kc(t))return _e.debug("Fetched root metadata",{path:r,state:ct}),t;r=vo.dirname(r)}throw new Error("Found no root metadata for ".concat(r))}};var HA=Object.defineProperty,MA=Object.defineProperties,FA=Object.getOwnPropertyDescriptors,xg=Object.getOwnPropertySymbols,JA=Object.prototype.hasOwnProperty,qA=Object.prototype.propertyIsEnumerable,Ig=(r,e,t)=>e in r?HA(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,WA=(r,e)=>{for(var t in e||(e={}))JA.call(e,t)&&Ig(r,t,e[t]);if(xg)for(var t of xg(e))qA.call(e,t)&&Ig(r,t,e[t]);return r},GA=(r,e)=>MA(r,FA(e));let Kh;function _A(){Kh=window.fetch,_e.debug("Setting up WebDAV decryption proxy"),window.fetch=async(r,e={})=>{let t=new Request(r,e);if(!(t.url.includes("/remote.php/dav/files/")&&(t.method==="GET"||t.method==="PROPFIND")))return Kh(t);_e.debug("Proxying ".concat(t.method," ").concat(t.url),{request:t});const s=new Headers(t.headers);switch(s.set("X-E2EE-SUPPORTED","true"),t=new Request(t,{headers:s}),t.method){case"PROPFIND":return zA(t);case"GET":default:return XA(t)}}}async function XA(r){const e=new URL(r.url).pathname,t=Kh(r);try{const s=await ct.getMetadataInfo(vo.dirname(e)),a=s.files[vo.basename(r.url)];if(a===void 0)throw _e.debug("Could not find file in metadata",{path:e,metadataInfo:s}),new Error("Could not find file in metadata");return await QA(await t,a)}catch(s){return await t}}async function zA(r){var e;_e.debug("Fetching raw PROPFIND",{request:r});const t=await Kh(r),s=new URL(r.url).pathname,a=await t.text(),u=await Fv(a),c=Mv(u,s,!0);if(((e=c.props)==null?void 0:e["e2ee-is-encrypted"])!==1)return _e.debug("Node is not e2ee",{xml:u}),new Response(a,t);if(c.type==="directory"){const i=c.props["e2ee-metadata"],o=c.props["e2ee-metadata-signature"];i!==void 0&&o!==void 0&&await ct.setMetadata(s,i,o);const n=await ct.getMetadata(s),l=await ct.getMetadataInfo(s);if(Kc(n))wf(u,s,l);else{const m=await ct.getMetadataInfo(vo.dirname(s));wf(u,s,l,m)}}else if(c.type==="file"){const i=await ct.getMetadataInfo(vo.dirname(s));if(i===void 0)return _e.debug("Cannot find metadata for parent folder",{path:s}),new Response(a,t);wf(u,s,void 0,i)}return new Response(new x0.XMLBuilder().build(u),t)}function wf(r,e,t,s){_e.debug("Updating PROPFIND info",{path:e,decryptedMetadata:t,decryptedParentMetadata:s,xml:r}),r.multistatus.response.forEach(a=>{if(a.propstat===void 0)return;const u=a.href===e?s:t,c=a.propstat.prop.displayname;let i=c;u!==void 0&&(u.files[c]?(i=u.files[c].filename,a.propstat.prop.getcontenttype=u.files[c].mimetype):u.folders[c]&&(i=u.folders[c],a.propstat.prop.getcontenttype="httpd/unix-directory")),a.propstat.prop.displayname=i,a.propstat.prop.permissions=a.propstat.prop.permissions.replace(/(R)|(D)|(N)|(V)|(W)|(CK)/g,"")})}async function QA(r,e){_e.debug("Decrypting encrypted file",{response:r,fileEncryptionInfo:e});const t=await Rp(new Uint8Array(await r.arrayBuffer()),await Hw(ds(e.key)),{iv:ds(e.nonce)}),s=new Headers(r.headers);return s.set("Content-Type",e.mimetype),new Response(t,GA(WA({},r),{headers:s}))}const YA='<svg xmlns="http://www.w3.org/2000/svg" id="mdi-arrow-down" viewBox="0 0 24 24"><path d="M11,4H13V16L18.5,10.5L19.92,11.92L12,19.84L4.08,11.92L5.5,10.5L11,16V4Z" /></svg>';function ZA(r){if(!(r.permissions&rw.READ))return!1;if(r.attributes["share-attributes"]){const e=JSON.parse(r.attributes["share-attributes"]||"[]").find(({scope:t,key:s})=>t==="permissions"&&s==="download");if(e!==void 0)return e.value===!0}return!0}async function eN([r]){const e=await(await fetch(r.encodedSource)).arrayBuffer(),t=new Blob([e],{type:r.mime}),s=document.createElement("a");s.href=window.URL.createObjectURL(t),s.download=r.displayname,s.click()}const tN=new Yv({id:"download_unencrypted",default:pp.DEFAULT,displayName:()=>vf("files","Download unencrypted"),iconSvgInline:()=>YA,enabled(r){return r.length!==1||r.some(e=>e.attributes["e2ee-is-encrypted"]!==1)||r.some(e=>!e.isDavRessource)||r.some(e=>e.type!==aw.File)?!1:r.every(ZA)},async exec(r){return eN([r]),null},order:30}),sN=rp("end_to_end_encryption","userConfig",{e2eeInBrowserEnabled:!1});sN.e2eeInBrowserEnabled&&(_A(),im("nc:e2ee-is-encrypted",{nc:"http://nextcloud.org/ns"}),im("nc:e2ee-metadata",{nc:"http://nextcloud.org/ns"}),im("nc:e2ee-metadata-signature",{nc:"http://nextcloud.org/ns"}),Zv(tN),Vg("download"),Vg("move-copy"));function Vg(r){_e.debug("Inhibiting ".concat(r," actions for e2ee files"));const e=e0().find(s=>s.id===r),t=e._action.enabled;e._action.enabled=(s,a)=>s.some(u=>u.attributes["e2ee-is-encrypted"]===1)?!1:t(s,a)}
